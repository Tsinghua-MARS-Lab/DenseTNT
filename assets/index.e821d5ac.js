var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,i)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,__spreadValues=(e,t)=>{for(var i in t||(t={}))__hasOwnProp.call(t,i)&&__defNormalProp(e,i,t[i]);if(__getOwnPropSymbols)for(var i of __getOwnPropSymbols(t))__propIsEnum.call(t,i)&&__defNormalProp(e,i,t[i]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__objRest=(e,t)=>{var i={};for(var n in e)__hasOwnProp.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))t.indexOf(n)<0&&__propIsEnum.call(e,n)&&(i[n]=e[n]);return i};import{s as getDefaultExportFromCjs,t as commonjsGlobal,N as NProgress,r as resolveComponent,e as openBlock,v as createElementBlock,w as createBaseVNode,x as createVNode,y as withCtx,z as createTextVNode}from"./vendor.486e2c16.js";const version="2.3.3",{PI:PI}=Math;function angle_norm(e){if(0==e)return 0;for(;e<=0;)e+=2*PI;for(;e>2*PI;)e-=2*PI;return e}function angle_dist(e,t){return angle_norm(e-t)}function angle_between(e,t,i,n=!1){const o=angle_dist(t,i);if(0==o)return!1;if(o==2*PI)return!0;const r=angle_norm(e),s=angle_dist(t,r)<=o&&angle_dist(r,i)<=o;return n?!s:s}function random$1(){return Math.random()}function randomIn(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}function atan2(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])}function resolve_angle(e,t){return-to_radians_coeff(t)*e}function to_radians_coeff(e){switch(e){case"deg":return PI/180;case"rad":return 1;case"grad":return PI/200;case"turn":return 2*PI}}function rnorm(e,t){let i,n;for(;i=random$1(),n=random$1(),n=(2*n-1)*Math.sqrt(1/Math.E*2),!(-4*i*i*Math.log(i)>=n*n););let o=n/i;return o=e+t*o,o}function clamp(e,t,i){return e<t?t:e>i?i:e}function log$1(e,t=Math.E){return Math.log(e)/Math.log(t)}class AssertionError extends Error{}function assert(e,t){if(!(!0===e||!1!==e&&e()))throw new AssertionError(null!=t?t:"Assertion failed")}function unreachable(){throw new Error("unreachable code")}function is_empty(e){return 0==e.length}function splice(e,t,i,...n){const o=e.length;t<0&&(t+=o),t<0?t=0:t>o&&(t=o),null==i||i>o-t?i=o-t:i<0&&(i=0);const r=o-i+n.length,s=new e.constructor(r);let a=0;for(;a<t;a++)s[a]=e[a];for(const l of n)s[a++]=l;for(let l=t+i;l<o;l++)s[a++]=e[l];return s}function head$1(e,t){return splice(e,t,e.length-t)}function indexOf(e,t){for(let i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}function mul(e,t,i){const n=e.length,o=null!=i?i:new e.constructor(n);for(let r=0;r<n;r++)o[r]=e[r]*t;return o}function map(e,t){const i=e.length,n=new e.constructor(i);for(let o=0;o<i;o++)n[o]=t(e[o],o,e);return n}function inplace_map(e,t,i){const n=e.length,o=null!=i?i:e;for(let r=0;r<n;r++)o[r]=t(e[r],r)}function filter(e,t){const i=e.length,n=new e.constructor(i);let o=0;for(let r=0;r<i;r++){const i=e[r];t(i,r,e)&&(n[o++]=i)}return head$1(n,o)}function reduce(e,t,i){const n=e.length;if(void 0===i&&0==n)throw new Error("can't reduce an empty array without an initial value");let o,r;for(void 0===i?(o=e[0],r=1):(o=i,r=0);r<n;r++)o=t(o,e[r],r,e);return o}function min$6(e){let t,i=1/0;for(let n=0,o=e.length;n<o;n++)t=e[n],!isNaN(t)&&t<i&&(i=t);return i}function max$7(e){let t,i=-1/0;for(let n=0,o=e.length;n<o;n++)t=e[n],!isNaN(t)&&t>i&&(i=t);return i}function minmax(e){let t,i=1/0,n=-1/0;for(let o=0,r=e.length;o<r;o++)t=e[o],isNaN(t)||(t<i&&(i=t),t>n&&(n=t));return[i,n]}function min_by(e,t){if(0==e.length)throw new Error("min_by() called with an empty array");let i=e[0],n=t(i);for(let o=1,r=e.length;o<r;o++){const r=e[o],s=t(r);s<n&&(i=r,n=s)}return i}function max_by(e,t){if(0==e.length)throw new Error("max_by() called with an empty array");let i=e[0],n=t(i);for(let o=1,r=e.length;o<r;o++){const r=e[o],s=t(r);s>n&&(i=r,n=s)}return i}function sum$1(e){let t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i];return t}function cumsum(e){const t=new e.constructor(e.length);return reduce(e,((e,i,n)=>t[n]=e+i),0),t}function every(e,t){for(let i=0,n=e.length;i<n;i++)if(!t(e[i]))return!1;return!0}function some(e,t){for(let i=0,n=e.length;i<n;i++)if(t(e[i]))return!0;return!1}function index_of(e,t){for(let i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}function _find_index(e){return function(t,i){const n=t.length;let o=e>0?0:n-1;for(;o>=0&&o<n;o+=e)if(i(t[o]))return o;return-1}}AssertionError.__name__="AssertionError";const find_index=_find_index(1),find_last_index=_find_index(-1);function find(e,t){const i=find_index(e,t);return-1==i?void 0:e[i]}function find_last(e,t){const i=find_last_index(e,t);return-1==i?void 0:e[i]}function sorted_index(e,t){let i=0,n=e.length;for(;i<n;){const o=Math.floor((i+n)/2);e[o]<t?i=o+1:n=o}return i}function bin_counts(e,t){const i=t.length-1,n=Array(i).fill(0);for(let o=0;o<e.length;o++){n[clamp(sorted_index(t,e[o])-1,0,i-1)]+=1}return n}function interpolate(e,t,i){const n=e.length,o=new Array(n);for(let r=0;r<n;r++){const n=e[r];if(isNaN(n)){o[r]=n;continue}const s=left_edge_index(n,t);if(-1==s)o[r]=i[0];else if(s==t.length)o[r]=i[i.length-1];else if(s==t.length-1||t[s]==n)o[r]=i[s];else{const e=t[s],a=i[s],l=t[s+1],c=i[s+1];o[r]=lerp(n,e,a,l,c)}}return o}function lerp(e,t,i,n,o){const r=(o-i)/(n-t);let s=r*(e-t)+i;return isFinite(s)||(s=r*(e-n)+o,isFinite(s)||i!=o||(s=i)),s}function left_edge_index(e,t){if(e<t[0])return-1;if(e>t[t.length-1])return t.length;let i=0,n=t.length-1;for(;n-i!=1;){const o=i+Math.floor((n-i)/2);e>=t[o]?i=o:n=o}return i}const slice$2=Array.prototype.slice;function head(e){return e[0]}function tail(e){return e[e.length-1]}function last(e){return e[e.length-1]}function copy(e){return slice$2.call(e)}function concat$1(e){return[].concat(...e)}function includes(e,t){return-1!==e.indexOf(t)}const contains=includes;function nth(e,t){return e[t>=0?t:e.length+t]}function zip(...e){if(0==e.length)return[];const t=min$6(e.map((e=>e.length))),i=e.length,n=new Array(t);for(let o=0;o<t;o++){n[o]=new Array(i);for(let t=0;t<i;t++)n[o][t]=e[t][o]}return n}function unzip(e){const t=e.length,i=min$6(e.map((e=>e.length))),n=Array(i);for(let o=0;o<i;o++)n[o]=new Array(t);for(let o=0;o<t;o++)for(let t=0;t<i;t++)n[t][o]=e[o][t];return n}function range(e,t,i=1){assert(i>0,"'step' must be a positive number"),null==t&&(t=e,e=0);const{max:n,ceil:o,abs:r}=Math,s=e<=t?i:-i,a=n(o(r(t-e)/i),0),l=new Array(a);for(let c=0;c<a;c++,e+=s)l[c]=e;return l}function linspace(e,t,i=100){const n=(t-e)/(i-1),o=new Array(i);for(let r=0;r<i;r++)o[r]=e+n*r;return o}function transpose(e){const t=e.length,i=e[0].length,n=[];for(let o=0;o<i;o++){n[o]=[];for(let i=0;i<t;i++)n[o][i]=e[i][o]}return n}function argmin(e){return min_by(range(e.length),(t=>e[t]))}function argmax(e){return max_by(range(e.length),(t=>e[t]))}function sort_by(e,t){const i=e.map(((e,i)=>({value:e,index:i,key:t(e)})));return i.sort(((e,t)=>{const i=e.key,n=t.key;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index})),i.map((e=>e.value))}function uniq(e){const t=new Set;for(const i of e)t.add(i);return[...t]}function uniq_by(e,t){const i=[],n=[];for(const o of e){const e=t(o);includes(n,e)||(n.push(e),i.push(o))}return i}function union$2(...e){const t=new Set;for(const i of e)for(const e of i)t.add(e);return[...t]}function intersection(e,...t){const i=[];e:for(const n of e)if(!includes(i,n)){for(const e of t)if(!includes(e,n))continue e;i.push(n)}return i}function difference$1(e,...t){const i=concat$1(t);return e.filter((e=>!includes(i,e)))}function remove_at(e,t){const i=copy(e);return i.splice(t,1),i}function remove_by(e,t){for(let i=0;i<e.length;)t(e[i])?e.splice(i,1):i++}function shuffle(e){const t=e.length,i=new Array(t);for(let n=0;n<t;n++){const t=randomIn(0,n);t!==n&&(i[n]=i[t]),i[t]=e[n]}return i}function pairwise(e,t){const i=e.length,n=new Array(i-1);for(let o=0;o<i-1;o++)n[o]=t(e[o],e[o+1]);return n}function reversed(e){const t=e.length,i=new Array(t);for(let n=0;n<t;n++)i[t-n-1]=e[n];return i}function repeat(e,t){const i=new Array(t);for(let n=0;n<t;n++)i[n]=e;return i}const toString$2=Object.prototype.toString;function isBoolean(e){return!0===e||!1===e||"[object Boolean]"===toString$2.call(e)}function isNumber(e){return"[object Number]"===toString$2.call(e)}function isInteger(e){return isNumber(e)&&Number.isInteger(e)}function isString(e){return"[object String]"===toString$2.call(e)}function isPrimitive(e){return null===e||isBoolean(e)||isNumber(e)||isString(e)}function isFunction(e){return"[object Function]"===toString$2.call(e)}function isArray(e){return Array.isArray(e)}function isArrayOf(e,t){return every(e,t)}function isArrayableOf(e,t){for(let i=0,n=e.length;i<n;i++)if(!t(e[i]))return!1;return!0}function isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function isObject(e){const t=typeof e;return"function"===t||"object"===t&&!!e}function isPlainObject(e){return isObject(e)&&(null==e.constructor||e.constructor===Object)}function isIterable(e){return isObject(e)&&void 0!==e[Symbol.iterator]}function isArrayable(e){return isIterable(e)&&"length"in e}const{hasOwnProperty:hasOwnProperty$5}=Object.prototype,{keys:keys,values:values,entries:entries,assign:extend$1}=Object;function clone$1(e){return __spreadValues({},e)}function merge(e,t){const i=Object.create(Object.prototype),n=concat$1([Object.keys(e),Object.keys(t)]);for(const o of n){const n=hasOwnProperty$5.call(e,o)?e[o]:[],r=hasOwnProperty$5.call(t,o)?t[o]:[];i[o]=union$2(n,r)}return i}function size$1(e){return Object.keys(e).length}function isEmpty(e){return 0==size$1(e)}function to_object(e){const t={};for(const[i,n]of e)t[i]=n;return t}const channel=new MessageChannel,tasks=new Map;channel.port1.onmessage=e=>{const t=e.data,i=tasks.get(t);if(null!=i)try{i()}finally{tasks.delete(t)}};let counter$1=1;function defer(){return new Promise((e=>{const t=counter$1++;tasks.set(t,e),channel.port2.postMessage(t)}))}class Signal{constructor(e,t){this.sender=e,this.name=t}connect(e,t=null){receiversForSender.has(this.sender)||receiversForSender.set(this.sender,[]);const i=receiversForSender.get(this.sender);if(null!=find_connection(i,this,e,t))return!1;const n=null!=t?t:e;sendersForReceiver.has(n)||sendersForReceiver.set(n,[]);const o=sendersForReceiver.get(n),r={signal:this,slot:e,context:t};return i.push(r),o.push(r),!0}disconnect(e,t=null){const i=receiversForSender.get(this.sender);if(null==i||0===i.length)return!1;const n=find_connection(i,this,e,t);if(null==n)return!1;const o=null!=t?t:e,r=sendersForReceiver.get(o);return n.signal=null,schedule_cleanup(i),schedule_cleanup(r),!0}emit(e){var t;const i=null!=(t=receiversForSender.get(this.sender))?t:[];for(const{signal:n,slot:o,context:r}of i)n===this&&o.call(r,e,this.sender)}}Signal.__name__="Signal";class Signal0 extends Signal{emit(){super.emit(void 0)}}function Signalable(){return class{connect(e,t){return e.connect(t,this)}disconnect(e,t){return e.disconnect(t,this)}}}Signal0.__name__="Signal0",function(e){function t(e,t){const i=receiversForSender.get(e);if(null==i||0===i.length)return;const n=sendersForReceiver.get(t);if(null!=n&&0!==n.length){for(const t of n){if(null==t.signal)return;t.signal.sender===e&&(t.signal=null)}schedule_cleanup(i),schedule_cleanup(n)}}function i(e){var t;const i=receiversForSender.get(e);if(null!=i&&0!==i.length){for(const e of i){if(null==e.signal)return;const i=null!=(t=e.context)?t:e.slot;e.signal=null,schedule_cleanup(sendersForReceiver.get(i))}schedule_cleanup(i)}}function n(e,t,i){const n=sendersForReceiver.get(e);if(null!=n&&0!==n.length){for(const e of n){if(null==e.signal)return;if(null!=t&&e.slot!=t)continue;const n=e.signal.sender;null!=i&&i.has(n)||(e.signal=null,schedule_cleanup(receiversForSender.get(n)))}schedule_cleanup(n)}}function o(e){const t=receiversForSender.get(e);if(null!=t&&0!==t.length){for(const e of t)e.signal=null;schedule_cleanup(t)}const i=sendersForReceiver.get(e);if(null!=i&&0!==i.length){for(const e of i)e.signal=null;schedule_cleanup(i)}}e.disconnect_between=t,e.disconnect_sender=i,e.disconnect_receiver=n,e.disconnect_all=o,e.disconnectBetween=t,e.disconnectSender=i,e.disconnectReceiver=n,e.disconnectAll=o}(Signal||(Signal={}));const receiversForSender=new WeakMap,sendersForReceiver=new WeakMap;function find_connection(e,t,i,n){return find(e,(e=>e.signal===t&&e.slot===i&&e.context===n))}const dirty_set=new Set;function schedule_cleanup(e){0===dirty_set.size&&(async()=>{await defer(),cleanup_dirty_set()})(),dirty_set.add(e)}function cleanup_dirty_set(){for(const e of dirty_set)remove_by(e,(e=>null==e.signal));dirty_set.clear()}function is_ref(e){if(isPlainObject(e)){const t=keys(e);return 1==t.length&&"id"==t[0]}return!1}const _loggers={};class LogLevel{constructor(e,t){this.name=e,this.level=t}}LogLevel.__name__="LogLevel";class Logger{constructor(e,t=Logger.INFO){this._name=e,this.set_level(t)}static get levels(){return Object.keys(Logger.log_levels)}static get(e,t=Logger.INFO){if(e.length>0){let i=_loggers[e];return null==i&&(_loggers[e]=i=new Logger(e,t)),i}throw new TypeError("Logger.get() expects a non-empty string name and an optional log-level")}get level(){return this.get_level()}get_level(){return this._log_level}set_level(e){if(e instanceof LogLevel)this._log_level=e;else{if(!isString(e)||null==Logger.log_levels[e])throw new Error("Logger.set_level() expects a log-level object or a string name of a log-level");this._log_level=Logger.log_levels[e]}const t=`[${this._name}]`;for(const[i,n]of entries(Logger.log_levels))n.level<this._log_level.level||this._log_level.level===Logger.OFF.level?this[i]=function(){}:this[i]=_method_factory(i,t)}trace(...e){}debug(...e){}info(...e){}warn(...e){}error(...e){}}function _method_factory(e,t){return null!=console[e]?console[e].bind(console,t):null!=console.log?console.log.bind(console,t):function(){}}Logger.__name__="Logger",Logger.TRACE=new LogLevel("trace",0),Logger.DEBUG=new LogLevel("debug",1),Logger.INFO=new LogLevel("info",2),Logger.WARN=new LogLevel("warn",6),Logger.ERROR=new LogLevel("error",7),Logger.FATAL=new LogLevel("fatal",8),Logger.OFF=new LogLevel("off",9),Logger.log_levels={trace:Logger.TRACE,debug:Logger.DEBUG,info:Logger.INFO,warn:Logger.WARN,error:Logger.ERROR,fatal:Logger.FATAL,off:Logger.OFF};const logger=Logger.get("bokeh");function set_log_level(e){const t=logger.level;return isString(e)&&null==Logger.log_levels[e]?(console.log(`[bokeh] unrecognized logging level '${e}' passed to Bokeh.set_log_level(), ignoring`),console.log(`[bokeh] valid log levels are: ${Logger.levels.join(", ")}`)):(console.log(`[bokeh] setting log level to: '${isString(e)?e:e.level}'`),logger.set_level(e)),t}const _named_colors={aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},named_colors=_named_colors;function is_named_color(e){return e in named_colors}const{round:round$3}=Math;function byte(e){return clamp(round$3(e),0,255)}function transparent(){return[0,0,0,0]}function encode_rgba([e,t,i,n]){return e<<24|t<<16|i<<8|n}function decode_rgba(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}function color2rgba(e,t){var i;let n,o,r,s;return null==e?[n,o,r,s]=transparent():isInteger(e)?[n,o,r,s]=decode_rgba(e):isString(e)?[n,o,r,s]=null!=(i=css4_parse(e))?i:transparent():([n,o,r,s=1]=e,s=byte(255*s)),255==s&&null!=t&&(s=byte(255*t)),[n,o,r,s]}const _hex_table={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"a",11:"b",12:"c",13:"d",14:"e",15:"f"};function hex$1(e){return _hex_table[e>>4]+_hex_table[15&e]}function color2css(e,t){const[i,n,o,r]=color2rgba(e,t);return`rgba(${i}, ${n}, ${o}, ${r/255})`}function color2hex(e,t){const[i,n,o,r]=color2rgba(e,t),s=`#${hex$1(i)}${hex$1(n)}${hex$1(o)}`;return 255==r?s:`${s}${hex$1(r)}`}function color2hexrgb(e){const[t,i,n]=color2rgba(e);return`#${hex$1(t)}${hex$1(i)}${hex$1(n)}`}const rgb_modern=/^rgba?\(\s*([^\s,]+?)\s+([^\s,]+?)\s+([^\s,]+?)(?:\s*\/\s*([^\s,]+?))?\s*\)$/,rgb_legacy=/^rgba?\(\s*([^\s,]+?)\s*,\s*([^\s,]+?)\s*,\s*([^\s,]+?)(?:\s*,\s*([^\s,]+?))?\s*\)$/,css4_normalize=(()=>{const e=document.createElement("canvas");e.width=1,e.height=1;const t=e.getContext("2d"),i=t.createLinearGradient(0,0,1,1);return e=>{t.fillStyle=i,t.fillStyle=e;const n=t.fillStyle;return n!=i?n:null}})();function css4_parse(e){var t;if(!(e=e.trim().toLowerCase()))return null;if("transparent"==e)return transparent();if(is_named_color(e))return decode_rgba(named_colors[e]);if("#"==e[0]){const t=Number("0x"+e.substr(1));if(isNaN(t))return null;switch(e.length-1){case 3:{const e=t>>8&15,i=t>>4&15,n=t>>0&15;return[e<<4|e,i<<4|i,n<<4|n,255]}case 4:{const e=t>>12&15,i=t>>8&15,n=t>>4&15,o=t>>0&15;return[e<<4|e,i<<4|i,n<<4|n,o<<4|o]}case 6:return[t>>16&255,t>>8&255,t>>0&255,255];case 8:return[t>>24&255,t>>16&255,t>>8&255,t>>0&255]}}else if(e.startsWith("rgb")){const i=null!=(t=e.match(rgb_modern))?t:e.match(rgb_legacy);if(null!=i){let[,e,t,n,o="1"]=i;const r=e.endsWith("%"),s=t.endsWith("%"),a=n.endsWith("%"),l=o.endsWith("%");if(!(r&&s&&a)&&(r||s||a))return null;r&&(e=e.slice(0,-1)),s&&(t=t.slice(0,-1)),a&&(n=n.slice(0,-1)),l&&(o=o.slice(0,-1));let c=Number(e),d=Number(t),h=Number(n),u=Number(o);return isNaN(c+d+h+u)?null:(r&&(c=c/100*255),s&&(d=d/100*255),a&&(h=h/100*255),u=255*(l?u/100:u),c=byte(c),d=byte(d),h=byte(h),u=byte(u),[c,d,h,u])}}else{const t=css4_normalize(e);if(null!=t)return css4_parse(t)}return null}function is_Color(e){return!!isInteger(e)||(!(!isString(e)||null==css4_parse(e))||!(!isArray(e)||3!=e.length&&4!=e.length))}function is_dark([e,t,i]){return 1-(.299*e+.587*t+.114*i)/255>=.6}const ESMap=window.Map,{hasOwnProperty:hasOwnProperty$4}=Object.prototype;class Kind{}var Kinds;Kind.__name__="Kind",function(e){class t extends Kind{valid(e){return!0}}t.__name__="Any",e.Any=t;class i extends Kind{valid(e){return!0}}i.__name__="Unknown",e.Unknown=i;class n extends Kind{valid(e){return isBoolean(e)}}n.__name__="Boolean",e.Boolean=n;class o extends Kind{constructor(e){super(),this.obj_type=e}valid(e){return!0}}o.__name__="Ref",e.Ref=o;class r extends Kind{valid(e){return!0}}r.__name__="AnyRef",e.AnyRef=r;class s extends Kind{valid(e){return isNumber(e)}}s.__name__="Number",e.Number=s;class a extends s{valid(e){return super.valid(e)&&isInteger(e)}}a.__name__="Int",e.Int=a;class l extends s{valid(e){return super.valid(e)&&0<=e&&e<=1}}l.__name__="Percent",e.Percent=l;class c extends Kind{constructor(e){super(),this.types=e,this.types=e}valid(e){return this.types.some((t=>t.valid(e)))}}c.__name__="Or",e.Or=c;class d extends Kind{constructor(e){super(),this.types=e,this.types=e}valid(e){if(!isArray(e))return!1;for(let t=0;t<this.types.length;t++){const i=this.types[t],n=e[t];if(!i.valid(n))return!1}return!0}}d.__name__="Tuple",e.Tuple=d;class h extends Kind{constructor(e){super(),this.struct_type=e}valid(e){if(!isPlainObject(e))return!1;const{struct_type:t}=this;if(size$1(t)!=size$1(e))return!1;for(const i in t)if(hasOwnProperty$4.call(t,i)){if(!hasOwnProperty$4.call(e,i))return!1;const n=t[i],o=e[i];if(!n.valid(o))return!1}return!0}}h.__name__="Struct",e.Struct=h;class u extends Kind{valid(e){return isArray(e)||isTypedArray(e)}}u.__name__="Arrayable",e.Arrayable=u;class p extends Kind{constructor(e){super(),this.item_type=e}valid(e){return isArray(e)&&e.every((e=>this.item_type.valid(e)))}}p.__name__="Array",e.Array=p;class _ extends Kind{valid(e){return null===e}}_.__name__="Null",e.Null=_;class f extends Kind{constructor(e){super(),this.base_type=e}valid(e){return null===e||this.base_type.valid(e)}}f.__name__="Nullable",e.Nullable=f;class g extends Kind{constructor(e){super(),this.base_type=e}valid(e){return void 0===e||this.base_type.valid(e)}}g.__name__="Opt",e.Opt=g;class m extends Kind{valid(e){return isString(e)}}m.__name__="String",e.String=m;class v extends Kind{constructor(e){super(),this.values=new Set(e)}valid(e){return this.values.has(e)}*[Symbol.iterator](){yield*this.values}}v.__name__="Enum",e.Enum=v;class b extends Kind{constructor(e){super(),this.item_type=e}valid(e){if(!isPlainObject(e))return!1;for(const t in e)if(hasOwnProperty$4.call(e,t)){const i=e[t];if(!this.item_type.valid(i))return!1}return!0}}b.__name__="Dict",e.Dict=b;class y extends Kind{constructor(e,t){super(),this.key_type=e,this.item_type=t}valid(e){if(!(e instanceof ESMap))return!1;for(const[t,i]of e.entries())if(!this.key_type.valid(t)||!this.item_type.valid(i))return!1;return!0}}y.__name__="Map",e.Map=y;class w extends Kind{valid(e){return is_Color(e)}}w.__name__="Color",e.Color=w;class A extends Kind{valid(e){return isFunction(e)}}A.__name__="Function",e.Function=A}(Kinds||(Kinds={}));const Any$1=new Kinds.Any,Unknown=new Kinds.Unknown,Boolean$1=new Kinds.Boolean,Number$2=new Kinds.Number,Int$1=new Kinds.Int,String$2=new Kinds.String,Null=new Kinds.Null,Nullable=e=>new Kinds.Nullable(e),Opt=e=>new Kinds.Opt(e),Or=(...e)=>new Kinds.Or(e),Tuple=(...e)=>new Kinds.Tuple(e),Struct=e=>new Kinds.Struct(e),Arrayable=new Kinds.Arrayable,Array$2=e=>new Kinds.Array(e),Dict=e=>new Kinds.Dict(e),Map$1=(e,t)=>new Kinds.Map(e,t),Enum=(...e)=>new Kinds.Enum(e),Ref=e=>new Kinds.Ref(e),AnyRef=()=>new Kinds.AnyRef,Function$1=()=>new Kinds.Function,Percent$1=new Kinds.Percent,Alpha=Percent$1,Color$1=new Kinds.Color,Auto=Enum("auto"),FontSize$1=String$2,Font$1=String$2,Angle$1=Number$2;var kinds=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Kind:Kind,get Kinds(){return Kinds},Any:Any$1,Unknown:Unknown,Boolean:Boolean$1,Number:Number$2,Int:Int$1,String:String$2,Null:Null,Nullable:Nullable,Opt:Opt,Or:Or,Tuple:Tuple,Struct:Struct,Arrayable:Arrayable,Array:Array$2,Dict:Dict,Map:Map$1,Enum:Enum,Ref:Ref,AnyRef:AnyRef,Function:Function$1,Percent:Percent$1,Alpha:Alpha,Color:Color$1,Auto:Auto,FontSize:FontSize$1,Font:Font$1,Angle:Angle$1});const Align=Enum("start","center","end"),Anchor=Enum("top_left","top_center","top_right","center_left","center_center","center_right","bottom_left","bottom_center","bottom_right","top","left","center","right","bottom"),AngleUnits=Enum("deg","rad","grad","turn"),BoxOrigin=Enum("corner","center"),ButtonType=Enum("default","primary","success","warning","danger","light"),CalendarPosition=Enum("auto","above","below"),Dimension=Enum("width","height"),Dimensions=Enum("width","height","both"),Direction$1=Enum("clock","anticlock"),Distribution=Enum("uniform","normal"),FontStyle=Enum("normal","italic","bold","bold italic"),HatchPatternType=Enum("blank","dot","ring","horizontal_line","vertical_line","cross","horizontal_dash","vertical_dash","spiral","right_diagonal_line","left_diagonal_line","diagonal_cross","right_diagonal_dash","left_diagonal_dash","horizontal_wave","vertical_wave","criss_cross"," ",".","o","-","|","+",'"',":","@","/","\\","x",",","`","v",">","*"),HTTPMethod=Enum("POST","GET"),HexTileOrientation=Enum("pointytop","flattop"),HoverMode=Enum("mouse","hline","vline"),LatLon=Enum("lat","lon"),LegendClickPolicy=Enum("none","hide","mute"),LegendLocation=Anchor,LineCap=Enum("butt","round","square"),LineJoin=Enum("miter","round","bevel"),LineDash=Enum("solid","dashed","dotted","dotdash","dashdot"),LinePolicy=Enum("prev","next","nearest","interp","none"),Location=Enum("above","below","left","right"),Logo=Enum("normal","grey"),MarkerType=Enum("asterisk","circle","circle_cross","circle_dot","circle_x","circle_y","cross","dash","diamond","diamond_cross","diamond_dot","dot","hex","hex_dot","inverted_triangle","plus","square","square_cross","square_dot","square_pin","square_x","star","star_dot","triangle","triangle_dot","triangle_pin","x","y"),MutedPolicy=Enum("show","ignore"),Orientation=Enum("vertical","horizontal"),OutputBackend=Enum("canvas","svg","webgl"),PaddingUnits=Enum("percent","absolute");Enum("above","below","left","right","center");const PointPolicy=Enum("snap_to_data","follow_mouse","none"),RadiusDimension=Enum("x","y","max","min"),RenderLevel=Enum("image","underlay","glyph","guide","annotation","overlay"),RenderMode=Enum("canvas","css"),ResetPolicy=Enum("standard","event_only"),RoundingFunction=Enum("round","nearest","floor","rounddown","ceil","roundup"),SelectionMode=Enum("replace","append","intersect","subtract");Enum("above","below","left","right");const SizingMode=Enum("stretch_width","stretch_height","stretch_both","scale_width","scale_height","scale_both","fixed"),Sort=Enum("ascending","descending"),SpatialUnits=Enum("screen","data"),StartEnd=Enum("start","end"),StepMode=Enum("after","before","center"),TapBehavior=Enum("select","inspect"),TextAlign=Enum("left","right","center"),TextBaseline=Enum("top","middle","bottom","alphabetic","hanging","ideographic"),TextureRepetition=Enum("repeat","repeat_x","repeat_y","no_repeat"),TickLabelOrientation=Enum("vertical","horizontal","parallel","normal"),TooltipAttachment=Enum("horizontal","vertical","left","right","above","below"),UpdateMode=Enum("replace","append"),VerticalAlign=Enum("top","middle","bottom"),{hasOwnProperty:hasOwnProperty$3}=Object.prototype,equals=Symbol("equals");function is_Equatable(e){return isObject(e)&&void 0!==e[equals]}const wildcard=Symbol("wildcard"),toString$1=Object.prototype.toString;class Comparator{constructor(){this.a_stack=[],this.b_stack=[]}eq(e,t){if(Object.is(e,t))return!0;if(e===wildcard||t===wildcard)return!0;if(null==e||null==t)return e===t;const i=toString$1.call(e);if(i!=toString$1.call(t))return!1;switch(i){case"[object Number]":return this.numbers(e,t);case"[object RegExp]":case"[object String]":return`${e}`==`${t}`;case"[object Date]":case"[object Boolean]":return+e==+t}const{a_stack:n,b_stack:o}=this;let r=n.length;for(;r--;)if(n[r]===e)return o[r]===t;n.push(e),o.push(t);const s=(()=>{if(is_Equatable(e)&&is_Equatable(t))return e[equals](t,this);switch(i){case"[object Array]":case"[object Uint8Array]":case"[object Int8Array]":case"[object Uint16Array]":case"[object Int16Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":return this.arrays(e,t);case"[object Map]":return this.maps(e,t);case"[object Set]":return this.sets(e,t);case"[object Object]":if(e.constructor==t.constructor&&(null==e.constructor||e.constructor===Object))return this.objects(e,t);case"[object Function]":if(e.constructor==t.constructor&&e.constructor===Function)return this.eq(`${e}`,`${t}`)}if(e instanceof Node)return this.nodes(e,t);throw Error(`can't compare objects of type ${i}`)})();return n.pop(),o.pop(),s}numbers(e,t){return Object.is(e,t)}arrays(e,t){const{length:i}=e;if(i!=t.length)return!1;for(let n=0;n<i;n++)if(!this.eq(e[n],t[n]))return!1;return!0}iterables(e,t){const i=e[Symbol.iterator](),n=t[Symbol.iterator]();for(;;){const e=i.next(),t=n.next();if(e.done&&t.done)return!0;if(e.done||t.done)return!1;if(!this.eq(e.value,t.value))return!1}}maps(e,t){if(e.size!=t.size)return!1;for(const[i,n]of e)if(!t.has(i)||!this.eq(n,t.get(i)))return!1;return!0}sets(e,t){if(e.size!=t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}objects(e,t){const i=Object.keys(e);if(i.length!=Object.keys(t).length)return!1;for(const n of i)if(!hasOwnProperty$3.call(t,n)||!this.eq(e[n],t[n]))return!1;return!0}nodes(e,t){return e.nodeType==t.nodeType&&(e.textContent==t.textContent&&!!this.iterables(e.childNodes,t.childNodes))}}Comparator.__name__="Comparator";const{abs:abs$3}=Math;class SimilarComparator extends Comparator{constructor(e=1e-4){super(),this.tolerance=e}numbers(e,t){return super.numbers(e,t)||abs$3(e-t)<this.tolerance}}function is_equal(e,t){return(new Comparator).eq(e,t)}function is_similar(e,t,i){return new SimilarComparator(i).eq(e,t)}SimilarComparator.__name__="SimilarComparator";const isEqual=is_equal;class BitSet{constructor(e,t=0){this.size=e,this[Symbol.toStringTag]="BitSet",this._count=null,this._nwords=Math.ceil(e/32),0==t||1==t?(this._array=new Uint32Array(this._nwords),1==t&&this._array.fill(4294967295)):(assert(t.length==this._nwords,"Initializer size mismatch"),this._array=t)}clone(){return new BitSet(this.size,new Uint32Array(this._array))}[equals](e,t){if(!t.eq(this.size,e.size))return!1;const{_nwords:i}=this,n=this.size%i,o=0==n?i:i-1;for(let r=0;r<o;r++)if(this._array[r]!=e._array[r])return!1;if(0==n)return!0;{const t=1<<n-1,i=t-1^t;return(this._array[o]&i)==(e._array[o]&i)}}static all_set(e){return new BitSet(e,1)}static all_unset(e){return new BitSet(e,0)}static from_indices(e,t){const i=new BitSet(e);for(const n of t)i.set(n);return i}static from_booleans(e,t){const i=new BitSet(e),n=Math.min(e,t.length);for(let o=0;o<n;o++)t[o]&&i.set(o);return i}_check_bounds(e){assert(0<=e&&e<this.size,`Out of bounds: 0 <= ${e} < ${this.size}`)}get(e){this._check_bounds(e);const t=e>>>5,i=31&e;return!!(this._array[t]>>i&1)}set(e,t=!0){this._check_bounds(e),this._count=null;const i=e>>>5,n=31&e;t?this._array[i]|=1<<n:this._array[i]&=~(1<<n)}unset(e){this.set(e,!1)}*[Symbol.iterator](){yield*this.ones()}get count(){let e=this._count;return null==e&&(this._count=e=this._get_count()),e}_get_count(){const{_array:e,_nwords:t,size:i}=this;let n=0;for(let o=0,r=0;r<t;r++){const t=e[r];if(0==t)o+=32;else for(let e=0;e<32&&o<i;e++,o++)t>>>e&1&&(n+=1)}return n}*ones(){const{_array:e,_nwords:t,size:i}=this;for(let n=0,o=0;o<t;o++){const t=e[o];if(0!=t)for(let e=0;e<32&&n<i;e++,n++)t>>>e&1&&(yield n);else n+=32}}*zeros(){const{_array:e,_nwords:t,size:i}=this;for(let n=0,o=0;o<t;o++){const t=e[o];if(4294967295!=t)for(let e=0;e<32&&n<i;e++,n++)t>>>e&1||(yield n);else n+=32}}_check_size(e){assert(this.size==e.size,"Size mismatch")}add(e){this._check_size(e);for(let t=0;t<this._nwords;t++)this._array[t]|=e._array[t]}intersect(e){this._check_size(e);for(let t=0;t<this._nwords;t++)this._array[t]&=e._array[t]}subtract(e){this._check_size(e);for(let t=0;t<this._nwords;t++){const i=this._array[t],n=e._array[t];this._array[t]=(i^n)&i}}union(e){this._check_size(e);const t=this.clone();for(let i=0;i<this._nwords;i++)t._array[i]|=e._array[i];return t}intersection(e){this._check_size(e);const t=this.clone();for(let i=0;i<this._nwords;i++)t._array[i]&=e._array[i];return t}difference(e){this._check_size(e);const t=this.clone();for(let i=0;i<this._nwords;i++){const n=this._array[i],o=e._array[i];t._array[i]=(n^o)&n}return t}select(e){assert(this.size<=e.length,"Size mismatch");const t=this.count,i=new e.constructor(t);let n=0;for(const o of this)i[n++]=e[o];return i}}BitSet.__name__="BitSet";const GeneratorFunction=Object.getPrototypeOf((function*(){})).constructor,ColorArray=Uint32Array,RGBAArray=Uint8ClampedArray;function infer_type(e,t){return e instanceof Float64Array||e instanceof Array||t instanceof Float64Array||t instanceof Array?Float64Array:Float32Array}const ScreenArray=Float32Array;function to_screen(e){return e instanceof Float32Array?e:new Float32Array(e)}navigator.appVersion.includes("Windows");const is_ie=(()=>{const e=navigator.userAgent;return e.includes("MSIE")||e.includes("Trident")||e.includes("Edge")})(),is_mobile="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0),is_little_endian=(()=>{const e=new ArrayBuffer(4),t=new Uint8Array(e);new Uint32Array(e)[1]=168496141;let i=!0;return 10==t[4]&&11==t[5]&&12==t[6]&&13==t[7]&&(i=!1),i})(),BYTE_ORDER=is_little_endian?"little":"big";function to_big_endian(e){if(is_little_endian){const t=new Uint32Array(e.length),i=new DataView(t.buffer);let n=0;for(const o of e)i.setUint32(n,o),n+=4;return t}return e}class Settings{constructor(){this._dev=!1,this._wireframe=!1}set dev(e){this._dev=e}get dev(){return this._dev}set wireframe(e){this._wireframe=e}get wireframe(){return this._wireframe}}Settings.__name__="Settings";const settings=new Settings,serialize=Symbol("serialize");function is_Serializable(e){return isObject(e)&&void 0!==e[serialize]}class SerializationError extends Error{}SerializationError.__name__="SerializationError";class Serializer{constructor(e){var t;this._references=new Map,this._definitions=new Map,this._refmap=new Map,this.include_defaults=null==(t=null==e?void 0:e.include_defaults)||t}get_ref(e){return this._references.get(e)}add_ref(e,t){assert(!this._references.has(e)),this._references.set(e,t)}add_def(e,t){const i=this.get_ref(e);assert(null!=i),this._definitions.set(e,t),this._refmap.set(i,t)}get objects(){return new Set(this._references.keys())}get references(){return new Set(this._references.values())}get definitions(){return new Set(this._definitions.values())}resolve_ref(e){return this._refmap.get(e)}remove_ref(e){return this._references.delete(e)}remove_def(e){return this._definitions.delete(e)}to_serializable(e){const t=this.get_ref(e);if(null!=t)return t;if(is_Serializable(e))return e[serialize](this);if(isArray(e)||isTypedArray(e)){const t=e.length,i=new Array(t);for(let n=0;n<t;n++){const t=e[n];i[n]=this.to_serializable(t)}return i}if(isPlainObject(e)){const t={};for(const[i,n]of entries(e))t[i]=this.to_serializable(n);return t}if(null===e||isBoolean(e)||isNumber(e)||isString(e))return e;throw new SerializationError(`${Object.prototype.toString.call(e)} is not serializable`)}}function buffer_to_base64(e){const t=new Uint8Array(e),i=Array.from(t).map((e=>String.fromCharCode(e)));return btoa(i.join(""))}function base64_to_buffer(e){const t=atob(e),i=t.length,n=new Uint8Array(i);for(let o=0,r=i;o<r;o++)n[o]=t.charCodeAt(o);return n.buffer}function swap16(e){const t=new Uint8Array(e.buffer,e.byteOffset,2*e.length);for(let i=0,n=t.length;i<n;i+=2){const e=t[i];t[i]=t[i+1],t[i+1]=e}}function swap32(e){const t=new Uint8Array(e.buffer,e.byteOffset,4*e.length);for(let i=0,n=t.length;i<n;i+=4){let e=t[i];t[i]=t[i+3],t[i+3]=e,e=t[i+1],t[i+1]=t[i+2],t[i+2]=e}}function swap64(e){const t=new Uint8Array(e.buffer,e.byteOffset,8*e.length);for(let i=0,n=t.length;i<n;i+=8){let e=t[i];t[i]=t[i+7],t[i+7]=e,e=t[i+1],t[i+1]=t[i+6],t[i+6]=e,e=t[i+2],t[i+2]=t[i+5],t[i+5]=e,e=t[i+3],t[i+3]=t[i+4],t[i+4]=e}}function swap$1(e){switch(e.BYTES_PER_ELEMENT){case 2:swap16(e);break;case 4:swap32(e);break;case 8:swap64(e)}}function is_NDArray_ref(e){return isPlainObject(e)&&("__buffer__"in e||"__ndarray__"in e)}function decode_NDArray(e,t){const{shape:i,dtype:n,order:o}=e;let r;if("__buffer__"in e){const i=t.get(e.__buffer__);if(null==i)throw new Error(`buffer for ${e.__buffer__} not found`);r=i}else r=base64_to_buffer(e.__ndarray__);const s=(()=>{switch(n){case"uint8":return new Uint8NDArray(r,i);case"int8":return new Int8NDArray(r,i);case"uint16":return new Uint16NDArray(r,i);case"int16":return new Int16NDArray(r,i);case"uint32":return new Uint32NDArray(r,i);case"int32":return new Int32NDArray(r,i);case"float32":return new Float32NDArray(r,i);case"float64":return new Float64NDArray(r,i)}})();return o!==BYTE_ORDER&&swap$1(s),s}function encode_NDArray(e,t){const i={order:BYTE_ORDER,dtype:e.dtype,shape:e.shape};if(null!=t){const n=`${t.size}`;return t.set(n,e.buffer),__spreadValues({__buffer__:n},i)}return __spreadValues({__ndarray__:{toJSON:()=>buffer_to_base64(e.buffer)}},i)}var _a,_b,_c,_d,_e,_f,_g,_h;Serializer.__name__="Serializer";const __ndarray__=Symbol("__ndarray__");class Uint8NDArray extends Uint8Array{constructor(e,t){super(e),this[_a]=!0,this.dtype="uint8",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_a=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}Uint8NDArray.__name__="Uint8NDArray";class Int8NDArray extends Int8Array{constructor(e,t){super(e),this[_b]=!0,this.dtype="int8",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_b=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}Int8NDArray.__name__="Int8NDArray";class Uint16NDArray extends Uint16Array{constructor(e,t){super(e),this[_c]=!0,this.dtype="uint16",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_c=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}Uint16NDArray.__name__="Uint16NDArray";class Int16NDArray extends Int16Array{constructor(e,t){super(e),this[_d]=!0,this.dtype="int16",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_d=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}Int16NDArray.__name__="Int16NDArray";class Uint32NDArray extends Uint32Array{constructor(e,t){super(e),this[_e]=!0,this.dtype="uint32",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_e=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}Uint32NDArray.__name__="Uint32NDArray";class Int32NDArray extends Int32Array{constructor(e,t){super(e),this[_f]=!0,this.dtype="int32",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_f=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}Int32NDArray.__name__="Int32NDArray";class Float32NDArray extends Float32Array{constructor(e,t){super(e),this[_g]=!0,this.dtype="float32",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_g=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}Float32NDArray.__name__="Float32NDArray";class Float64NDArray extends Float64Array{constructor(e,t){super(e),this[_h]=!0,this.dtype="float64",this.shape=null!=t?t:is_NDArray(e)?e.shape:[this.length],this.dimension=this.shape.length}[(_h=__ndarray__,equals)](e,t){return t.eq(this.shape,e.shape)&&t.arrays(this,e)}[serialize](e){return encode_NDArray(this)}}function is_NDArray(e){return isObject(e)&&void 0!==e[__ndarray__]}Float64NDArray.__name__="Float64NDArray";class Uniform{is_Scalar(){return this.is_scalar}is_Vector(){return!this.is_scalar}}Uniform.__name__="Uniform";class UniformScalar extends Uniform{constructor(e,t){super(),this.value=e,this.length=t,this.is_scalar=!0}get(e){return this.value}*[Symbol.iterator](){const{length:e,value:t}=this;for(let i=0;i<e;i++)yield t}select(e){return new UniformScalar(this.value,e.count)}[equals](e,t){return t.eq(this.length,e.length)&&t.eq(this.value,e.value)}}UniformScalar.__name__="UniformScalar";class UniformVector extends Uniform{constructor(e){super(),this.array=e,this.is_scalar=!1,this.length=this.array.length}get(e){return this.array[e]}*[Symbol.iterator](){yield*this.array}select(e){const t=e.select(this.array);return new this.constructor(t)}[equals](e,t){return t.eq(this.length,e.length)&&t.eq(this.array,e.array)}}UniformVector.__name__="UniformVector";class ColorUniformVector extends UniformVector{constructor(e){super(e),this.array=e,this._view=new DataView(e.buffer)}get(e){return this._view.getUint32(4*e)}*[Symbol.iterator](){const e=this.length;for(let t=0;t<e;t++)yield this.get(t)}}function valueToString(e){try{return JSON.stringify(e)}catch{return e.toString()}}function isSpec(e){return isPlainObject(e)&&(void 0===e.value?0:1)+(void 0===e.field?0:1)+(void 0===e.expr?0:1)==1}ColorUniformVector.__name__="ColorUniformVector";class Property{constructor(e,t,i,n,o,r={}){var s;let a;if(this.obj=e,this.attr=t,this.kind=i,this.default_value=n,this._dirty=!1,this.change=new Signal0(this.obj,"change"),this.internal=null!=(s=r.internal)&&s,this.on_update=r.on_update,void 0!==o)a=o,this._dirty=!0;else{const t=this._default_override();if(void 0!==t)a=t;else{if(void 0===n)return void(this.spec={value:null});a=n(e)}}this._update(a)}get is_value(){return void 0!==this.spec.value}get syncable(){return!this.internal}get_value(){return this.spec.value}set_value(e){this._update(e),this._dirty=!0}_default_override(){}get dirty(){return this._dirty}_update(e){var t;this.validate(e),this.spec={value:e},null==(t=this.on_update)||t.call(this,e,this.obj)}toString(){return`Prop(${this.obj}.${this.attr}, spec: ${valueToString(this.spec)})`}normalize(e){return e}validate(e){if(!this.valid(e))throw new Error(`${this.obj}.${this.attr} given invalid value: ${valueToString(e)}`)}valid(e){return this.kind.valid(e)}_value(e=!0){if(!this.is_value)throw new Error("attempted to retrieve property value for property without value specification");let t=this.normalize([this.spec.value])[0];return null!=this.spec.transform&&e&&(t=this.spec.transform.compute(t)),t}}Property.__name__="Property";class PropertyAlias{constructor(e){this.attr=e}}function Alias(e){return new PropertyAlias(e)}PropertyAlias.__name__="PropertyAlias";class PrimitiveProperty extends Property{}PrimitiveProperty.__name__="PrimitiveProperty";class Any extends Property{}Any.__name__="Any";class Array$1 extends Property{valid(e){return isArray(e)||isTypedArray(e)}}Array$1.__name__="Array";class Boolean extends Property{valid(e){return isBoolean(e)}}Boolean.__name__="Boolean";class Color extends Property{valid(e){return is_Color(e)}}Color.__name__="Color";class Instance extends Property{}Instance.__name__="Instance";class Number$1 extends Property{valid(e){return isNumber(e)}}Number$1.__name__="Number";class Int extends Number$1{valid(e){return isNumber(e)&&(0|e)==e}}Int.__name__="Int";class Angle extends Number$1{}Angle.__name__="Angle";class Percent extends Number$1{valid(e){return isNumber(e)&&0<=e&&e<=1}}Percent.__name__="Percent";class String$1 extends Property{valid(e){return isString(e)}}String$1.__name__="String";class NullString extends Property{valid(e){return null===e||isString(e)}}NullString.__name__="NullString";class FontSize extends String$1{}FontSize.__name__="FontSize";class Font extends String$1{_default_override(){return settings.dev?"Bokeh":void 0}}Font.__name__="Font";class EnumProperty extends Property{valid(e){return isString(e)&&includes(this.enum_values,e)}}EnumProperty.__name__="EnumProperty";class Direction extends EnumProperty{get enum_values(){return[...Direction$1]}normalize(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)switch(e[i]){case"clock":t[i]=0;break;case"anticlock":t[i]=1}return t}}Direction.__name__="Direction";class ScalarSpec extends Property{get_value(){const{value:e,expr:t,transform:i}=this.spec;return null!=t||null!=i?this.spec:e}_update(e){isSpec(e)?this.spec=e:this.spec={value:e},null!=this.spec.value&&this.validate(this.spec.value)}materialize(e){return e}scalar(e,t){return new UniformScalar(e,t)}uniform(e){var t;const{expr:i,value:n,transform:o}=this.spec,r=null!=(t=e.get_length())?t:1;if(null!=i){let t=i.compute(e);return null!=o&&(t=o.compute(t)),t=this.materialize(t),this.scalar(t,r)}{let e=n;return null!=o&&(e=o.compute(e)),e=this.materialize(e),this.scalar(e,r)}}}ScalarSpec.__name__="ScalarSpec";class AnyScalar extends ScalarSpec{}AnyScalar.__name__="AnyScalar";class ColorScalar extends ScalarSpec{}ColorScalar.__name__="ColorScalar";class NumberScalar extends ScalarSpec{}NumberScalar.__name__="NumberScalar";class StringScalar extends ScalarSpec{}StringScalar.__name__="StringScalar";class NullStringScalar extends ScalarSpec{}NullStringScalar.__name__="NullStringScalar";class ArrayScalar extends ScalarSpec{}ArrayScalar.__name__="ArrayScalar";class LineJoinScalar extends ScalarSpec{}LineJoinScalar.__name__="LineJoinScalar";class LineCapScalar extends ScalarSpec{}LineCapScalar.__name__="LineCapScalar";class LineDashScalar extends ScalarSpec{}LineDashScalar.__name__="LineDashScalar";class FontScalar extends ScalarSpec{_default_override(){return settings.dev?"Bokeh":void 0}}FontScalar.__name__="FontScalar";class FontSizeScalar extends ScalarSpec{}FontSizeScalar.__name__="FontSizeScalar";class FontStyleScalar extends ScalarSpec{}FontStyleScalar.__name__="FontStyleScalar";class TextAlignScalar extends ScalarSpec{}TextAlignScalar.__name__="TextAlignScalar";class TextBaselineScalar extends ScalarSpec{}TextBaselineScalar.__name__="TextBaselineScalar";class VectorSpec extends Property{get_value(){return null===this.spec.value?null:this.spec}_update(e){isSpec(e)?this.spec=e:this.spec={value:e},null!=this.spec.value&&this.validate(this.spec.value)}materialize(e){return e}v_materialize(e){return e}scalar(e,t){return new UniformScalar(e,t)}vector(e){return new UniformVector(e)}uniform(e){var t;const{field:i,expr:n,value:o,transform:r}=this.spec,s=null!=(t=e.get_length())?t:1;if(null!=i){let t=e.get_column(i);return null!=t?(null!=r&&(t=r.v_compute(t)),t=this.v_materialize(t),this.vector(t)):(logger.warn(`attempted to retrieve property array for nonexistent field '${i}'`),this.scalar(null,s))}if(null!=n){let t=n.v_compute(e);return null!=r&&(t=r.v_compute(t)),t=this.v_materialize(t),this.vector(t)}{let e=o;return null!=r&&(e=r.compute(e)),e=this.materialize(e),this.scalar(e,s)}}array(e){var t;let i;const n=null!=(t=e.get_length())?t:1;if(null!=this.spec.field){const t=e.get_column(this.spec.field);if(null!=t)i=this.normalize(t);else{logger.warn(`attempted to retrieve property array for nonexistent field '${this.spec.field}'`);const e=new Float64Array(n);e.fill(NaN),i=e}}else if(null!=this.spec.expr)i=this.normalize(this.spec.expr.v_compute(e));else{const e=this._value(!1);if(isNumber(e)){const t=new Float64Array(n);t.fill(e),i=t}else i=repeat(e,n)}return null!=this.spec.transform&&(i=this.spec.transform.v_compute(i)),i}}VectorSpec.__name__="VectorSpec";class DataSpec extends VectorSpec{}DataSpec.__name__="DataSpec";class UnitsSpec extends VectorSpec{_update(e){super._update(e);const{units:t}=this.spec;if(null!=t&&!includes(this.valid_units,t))throw new Error(`units must be one of ${this.valid_units.join(", ")}; got: ${t}`)}get units(){var e;return null!=(e=this.spec.units)?e:this.default_units}set units(e){e!=this.default_units?this.spec.units=e:delete this.spec.units}}UnitsSpec.__name__="UnitsSpec";class NumberUnitsSpec extends UnitsSpec{array(e){return new Float64Array(super.array(e))}}NumberUnitsSpec.__name__="NumberUnitsSpec";class BaseCoordinateSpec extends DataSpec{}BaseCoordinateSpec.__name__="BaseCoordinateSpec";class CoordinateSpec extends BaseCoordinateSpec{}CoordinateSpec.__name__="CoordinateSpec";class CoordinateSeqSpec extends BaseCoordinateSpec{}CoordinateSeqSpec.__name__="CoordinateSeqSpec";class CoordinateSeqSeqSeqSpec extends BaseCoordinateSpec{}CoordinateSeqSeqSeqSpec.__name__="CoordinateSeqSeqSeqSpec";class XCoordinateSpec extends CoordinateSpec{constructor(){super(...arguments),this.dimension="x"}}XCoordinateSpec.__name__="XCoordinateSpec";class YCoordinateSpec extends CoordinateSpec{constructor(){super(...arguments),this.dimension="y"}}YCoordinateSpec.__name__="YCoordinateSpec";class XCoordinateSeqSpec extends CoordinateSeqSpec{constructor(){super(...arguments),this.dimension="x"}}XCoordinateSeqSpec.__name__="XCoordinateSeqSpec";class YCoordinateSeqSpec extends CoordinateSeqSpec{constructor(){super(...arguments),this.dimension="y"}}YCoordinateSeqSpec.__name__="YCoordinateSeqSpec";class XCoordinateSeqSeqSeqSpec extends CoordinateSeqSeqSeqSpec{constructor(){super(...arguments),this.dimension="x"}}XCoordinateSeqSeqSeqSpec.__name__="XCoordinateSeqSeqSeqSpec";class YCoordinateSeqSeqSeqSpec extends CoordinateSeqSeqSeqSpec{constructor(){super(...arguments),this.dimension="y"}}YCoordinateSeqSeqSeqSpec.__name__="YCoordinateSeqSeqSeqSpec";class AngleSpec extends NumberUnitsSpec{get default_units(){return"rad"}get valid_units(){return[...AngleUnits]}materialize(e){return e*-to_radians_coeff(this.units)}v_materialize(e){const t=-to_radians_coeff(this.units),i=new Float32Array(e.length);return mul(e,t,i),i}array(e){throw new Error("not supported")}}AngleSpec.__name__="AngleSpec";class DistanceSpec extends NumberUnitsSpec{get default_units(){return"data"}get valid_units(){return[...SpatialUnits]}}DistanceSpec.__name__="DistanceSpec";class NullDistanceSpec extends DistanceSpec{materialize(e){return null!=e?e:NaN}}NullDistanceSpec.__name__="NullDistanceSpec";class ScreenDistanceSpec extends DistanceSpec{get default_units(){return"screen"}}ScreenDistanceSpec.__name__="ScreenDistanceSpec";class BooleanSpec extends DataSpec{v_materialize(e){return new Uint8Array(e)}array(e){return new Uint8Array(super.array(e))}}BooleanSpec.__name__="BooleanSpec";class NumberSpec extends DataSpec{v_materialize(e){return isTypedArray(e)?e:new Float64Array(e)}array(e){return new Float64Array(super.array(e))}}NumberSpec.__name__="NumberSpec";class ColorSpec extends DataSpec{materialize(e){return encode_rgba(color2rgba(e))}v_materialize(e){if(!is_NDArray(e)){const t=e.length,i=new RGBAArray(4*t);let n=0;for(const o of e){const[e,t,r,s]=color2rgba(o);i[n++]=e,i[n++]=t,i[n++]=r,i[n++]=s}return new ColorArray(i.buffer)}if("uint32"==e.dtype&&1==e.dimension)return to_big_endian(e);if("uint8"==e.dtype&&1==e.dimension){const[t]=e.shape,i=new RGBAArray(4*t);let n=0;for(const o of e)i[n++]=o,i[n++]=o,i[n++]=o,i[n++]=255;return new ColorArray(i.buffer)}if("uint8"==e.dtype&&2==e.dimension){const[t,i]=e.shape;if(4==i)return new ColorArray(e.buffer);if(3==i){const n=new RGBAArray(4*t);for(let o=0,r=0;o<i*t;)n[r++]=e[o++],n[r++]=e[o++],n[r++]=e[o++],n[r++]=255;return new ColorArray(n.buffer)}}else if(("float32"==e.dtype||"float64"==e.dtype)&&2==e.dimension){const[t,i]=e.shape;if(3==i||4==i){const n=new RGBAArray(4*t);for(let o=0,r=0;o<i*t;)n[r++]=255*e[o++],n[r++]=255*e[o++],n[r++]=255*e[o++],n[r++]=255*(3==i?1:e[o++]);return new ColorArray(n.buffer)}}throw new Error("invalid color array")}vector(e){return new ColorUniformVector(e)}}ColorSpec.__name__="ColorSpec";class NDArraySpec extends DataSpec{}NDArraySpec.__name__="NDArraySpec";class AnySpec extends DataSpec{}AnySpec.__name__="AnySpec";class StringSpec extends DataSpec{}StringSpec.__name__="StringSpec";class NullStringSpec extends DataSpec{}NullStringSpec.__name__="NullStringSpec";class ArraySpec extends DataSpec{}ArraySpec.__name__="ArraySpec";class MarkerSpec extends DataSpec{}MarkerSpec.__name__="MarkerSpec";class LineJoinSpec extends DataSpec{}LineJoinSpec.__name__="LineJoinSpec";class LineCapSpec extends DataSpec{}LineCapSpec.__name__="LineCapSpec";class LineDashSpec extends DataSpec{}LineDashSpec.__name__="LineDashSpec";class FontSpec extends DataSpec{_default_override(){return settings.dev?"Bokeh":void 0}}FontSpec.__name__="FontSpec";class FontSizeSpec extends DataSpec{}FontSizeSpec.__name__="FontSizeSpec";class FontStyleSpec extends DataSpec{}FontStyleSpec.__name__="FontStyleSpec";class TextAlignSpec extends DataSpec{}TextAlignSpec.__name__="TextAlignSpec";class TextBaselineSpec extends DataSpec{}function startsWith(e,t,i=0){return e.substr(i,t.length)==t}function uuid4(){const e=new Array(32),t="0123456789ABCDEF";for(let i=0;i<32;i++)e[i]=t.substr(Math.floor(16*Math.random()),1);return e[12]="4",e[16]=t.substr(3&e[16].charCodeAt(0)|8,1),e.join("")}TextBaselineSpec.__name__="TextBaselineSpec";let counter=1e3;function uniqueId(e){const t=settings.dev?"j"+counter++:uuid4();return null!=e?`${e}-${t}`:t}function escape(e){return e.replace(/(?:[&<>"'`])/g,(e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#x27;";case"`":return"&#x60;";default:return e}}))}function unescape(e){return e.replace(/&(amp|lt|gt|quot|#x27|#x60);/g,((e,t)=>{switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';case"#x27":return"'";case"#x60":return"`";default:return t}}))}function use_strict(e){return`'use strict';\n${e}`}function to_fixed(e,t){return e.toFixed(t).replace(/(\.[0-9]*?)0+$/,"$1").replace(/\.$/,"")}class DocumentEvent{constructor(e){this.document=e}}DocumentEvent.__name__="DocumentEvent";class DocumentEventBatch extends DocumentEvent{constructor(e,t,i){super(e),this.events=t,this.setter_id=i}}DocumentEventBatch.__name__="DocumentEventBatch";class DocumentChangedEvent extends DocumentEvent{}DocumentChangedEvent.__name__="DocumentChangedEvent";class MessageSentEvent extends DocumentChangedEvent{constructor(e,t,i){super(e),this.msg_type=t,this.msg_data=i}[serialize](e){const t=this.msg_data,i=e.to_serializable(t);return{kind:"MessageSent",msg_type:this.msg_type,msg_data:i}}}MessageSentEvent.__name__="MessageSentEvent";class ModelChangedEvent extends DocumentChangedEvent{constructor(e,t,i,n,o,r,s){super(e),this.model=t,this.attr=i,this.old=n,this.new_=o,this.setter_id=r,this.hint=s}[serialize](e){if(null!=this.hint)return e.to_serializable(this.hint);const t=this.new_,i=e.to_serializable(t);return this.model!=t&&e.remove_def(this.model),{kind:"ModelChanged",model:this.model.ref(),attr:this.attr,new:i}}}ModelChangedEvent.__name__="ModelChangedEvent";class ColumnsPatchedEvent extends DocumentChangedEvent{constructor(e,t,i){super(e),this.column_source=t,this.patches=i}[serialize](e){return{kind:"ColumnsPatched",column_source:this.column_source,patches:this.patches}}}ColumnsPatchedEvent.__name__="ColumnsPatchedEvent";class ColumnsStreamedEvent extends DocumentChangedEvent{constructor(e,t,i,n){super(e),this.column_source=t,this.data=i,this.rollover=n}[serialize](e){return{kind:"ColumnsStreamed",column_source:this.column_source,data:this.data,rollover:this.rollover}}}ColumnsStreamedEvent.__name__="ColumnsStreamedEvent";class TitleChangedEvent extends DocumentChangedEvent{constructor(e,t,i){super(e),this.title=t,this.setter_id=i}[serialize](e){return{kind:"TitleChanged",title:this.title}}}TitleChangedEvent.__name__="TitleChangedEvent";class RootAddedEvent extends DocumentChangedEvent{constructor(e,t,i){super(e),this.model=t,this.setter_id=i}[serialize](e){return{kind:"RootAdded",model:e.to_serializable(this.model)}}}RootAddedEvent.__name__="RootAddedEvent";class RootRemovedEvent extends DocumentChangedEvent{constructor(e,t,i){super(e),this.model=t,this.setter_id=i}[serialize](e){return{kind:"RootRemoved",model:this.model.ref()}}}RootRemovedEvent.__name__="RootRemovedEvent";const pretty=Symbol("pretty"),clone=Symbol("clone");function is_Cloneable(e){return isObject(e)&&void 0!==e[clone]}class CloningError extends Error{}CloningError.__name__="CloningError";class Cloner{constructor(){}clone(e){if(is_Cloneable(e))return e[clone](this);if(isArray(e)){const t=e.length,i=new Array(t);for(let n=0;n<t;n++){const t=e[n];i[n]=this.clone(t)}return i}if(isPlainObject(e)){const t={};for(const[i,n]of entries(e))t[i]=this.clone(n);return t}if(null===e||isBoolean(e)||isNumber(e)||isString(e))return e;throw new CloningError(`${Object.prototype.toString.call(e)} is not cloneable`)}}Cloner.__name__="Cloner";class HasProps extends(Signalable()){constructor(e={}){var t,i;super(),this._subtype=void 0,this.document=null,this.destroyed=new Signal0(this,"destroyed"),this.change=new Signal0(this,"change"),this.transformchange=new Signal0(this,"transformchange"),this.exprchange=new Signal0(this,"exprchange"),this.properties={},this._pending=!1,this._changing=!1;const n=e instanceof Map?e.get.bind(e):t=>e[t];this.id=null!=(t=n("id"))?t:uniqueId();for(const[o,{type:r,default_value:s,options:a}]of entries(this._props)){let e;r instanceof PropertyAlias?Object.defineProperty(this.properties,o,{get:()=>this.properties[r.attr],configurable:!1,enumerable:!1}):(e=r instanceof Kind?new PrimitiveProperty(this,o,r,s,n(o),a):new r(this,o,Any$1,s,n(o),a),this.properties[o]=e)}null!=(i=n("__deferred__"))&&i||(this.finalize(),this.connect_signals())}get is_syncable(){return!0}set type(e){console.warn("prototype.type = 'ModelName' is deprecated, use static __name__ instead"),this.constructor.__name__=e}get type(){return this.constructor.__qualified__}static get __qualified__(){const{__module__:e,__name__:t}=this;return null!=e?`${e}.${t}`:t}static get[Symbol.toStringTag](){return this.__name__}static init_HasProps(){this.prototype._props={},this.prototype._mixins=[]}static _fix_default(e,t){if(void 0===e||isFunction(e))return e;if(isPrimitive(e))return()=>e;{const t=new Cloner;return()=>t.clone(e)}}static define(e){for(const[t,i]of entries(isFunction(e)?e(kinds):e)){if(null!=this.prototype._props[t])throw new Error(`attempted to redefine property '${this.prototype.type}.${t}'`);if(null!=this.prototype[t])throw new Error(`attempted to redefine attribute '${this.prototype.type}.${t}'`);Object.defineProperty(this.prototype,t,{get(){return this.properties[t].get_value()},set(e){return this.setv({[t]:e}),this},configurable:!1,enumerable:!0});const[e,n,o={}]=i,r={type:e,default_value:this._fix_default(n,t),options:o},s=__spreadValues({},this.prototype._props);s[t]=r,this.prototype._props=s}}static internal(e){const t={};for(const[i,n]of entries(isFunction(e)?e(kinds):e)){const[e,o,r={}]=n;t[i]=[e,o,__spreadProps(__spreadValues({},r),{internal:!0})]}this.define(t)}static mixins(e){function t(e,t){const i={};for(const[n,o]of entries(t))i[e+n]=o;return i}const i={},n=[];for(const o of isArray(e)?e:[e])if(isArray(o)){const[e,r]=o;extend$1(i,t(e,r)),n.push([e,r])}else{const e=o;extend$1(i,e),n.push(["",e])}this.define(i),this.prototype._mixins=[...this.prototype._mixins,...n]}static override(e){for(const[t,i]of entries(e)){const e=this._fix_default(i,t),n=this.prototype._props[t];if(null==n)throw new Error(`attempted to override nonexistent '${this.prototype.type}.${t}'`);const o=__spreadValues({},this.prototype._props);o[t]=__spreadProps(__spreadValues({},n),{default_value:e}),this.prototype._props=o}}toString(){return`${this.type}(${this.id})`}property(e){const t=this.properties[e];if(null!=t)return t;throw new Error(`unknown property ${this.type}.${e}`)}get attributes(){const e={};for(const t of this)e[t.attr]=t.get_value();return e}[clone](e){const t=new Map;for(const i of this)i.dirty&&t.set(i.attr,e.clone(i.get_value()));return new this.constructor(t)}[equals](e,t){for(const i of this){const n=e.property(i.attr);if(t.eq(i.get_value(),n.get_value()))return!1}return!0}[pretty](e){const t=e.token,i=[];for(const n of this)if(n.dirty){const o=n.get_value();i.push(`${n.attr}${t(":")} ${e.to_string(o)}`)}return`${this.constructor.__qualified__}${t("(")}${t("{")}${i.join(`${t(",")} `)}${t("}")}${t(")")}`}[serialize](e){const t=this.ref();e.add_ref(this,t);const i=this.struct();for(const n of this)n.syncable&&(e.include_defaults||n.dirty)&&(i.attributes[n.attr]=e.to_serializable(n.get_value()));return e.add_def(this,i),t}finalize(){for(const e of this){if(!(e instanceof VectorSpec||e instanceof ScalarSpec))continue;const t=e.get_value();if(null!=t){const{transform:e,expr:i}=t;null!=e&&this.connect(e.change,(()=>this.transformchange.emit())),null!=i&&this.connect(i.change,(()=>this.exprchange.emit()))}}this.initialize()}initialize(){}connect_signals(){}disconnect_signals(){Signal.disconnectReceiver(this)}destroy(){this.disconnect_signals(),this.destroyed.emit()}clone(){return(new Cloner).clone(this)}_setv(e,t){const i=t.check_eq,n=[],o=this._changing;this._changing=!0;for(const[r,s]of e)!1!==i&&is_equal(r.get_value(),s)||(r.set_value(s),n.push(r));n.length>0&&(this._pending=!0);for(const r of n)r.change.emit();if(!o){if(!t.no_change)for(;this._pending;)this._pending=!1,this.change.emit();this._pending=!1,this._changing=!1}}setv(e,t={}){const i=entries(e);if(0==i.length)return;if(!0===t.silent){for(const[e,t]of i)this.properties[e].set_value(t);return}const n=new Map,o=new Map;for(const[s,a]of i){const e=this.properties[s];n.set(e,a),o.set(e,e.get_value())}this._setv(n,t);const{document:r}=this;if(null!=r){const e=[];for(const[t,i]of o)e.push([t,i,t.get_value()]);for(const[,t,i]of e)if(this._needs_invalidate(t,i)){r._invalidate_all_models();break}this._push_changes(e,t)}}getv(e){return this.property(e).get_value()}ref(){return{id:this.id}}struct(){const e={type:this.type,id:this.id,attributes:{}};return null!=this._subtype&&(e.subtype=this._subtype),e}set_subtype(e){this._subtype=e}*[Symbol.iterator](){yield*values(this.properties)}*syncable_properties(){for(const e of this)e.syncable&&(yield e)}serializable_attributes(){const e={};for(const t of this.syncable_properties())e[t.attr]=t.get_value();return e}static _json_record_references(e,t,i,n){const{recursive:o}=n;if(is_ref(t)){const n=e.get_model_by_id(t.id);null==n||i.has(n)||HasProps._value_record_references(n,i,{recursive:o})}else if(isArray(t))for(const r of t)HasProps._json_record_references(e,r,i,{recursive:o});else if(isPlainObject(t))for(const r of values(t))HasProps._json_record_references(e,r,i,{recursive:o})}static _value_record_references(e,t,i){const{recursive:n}=i;if(e instanceof HasProps){if(!t.has(e)&&(t.add(e),n))for(const o of e.syncable_properties()){const e=o.get_value();HasProps._value_record_references(e,t,{recursive:n})}}else if(isArray(e))for(const o of e)HasProps._value_record_references(o,t,{recursive:n});else if(isPlainObject(e))for(const o of values(e))HasProps._value_record_references(o,t,{recursive:n})}references(){const e=new Set;return HasProps._value_record_references(this,e,{recursive:!0}),e}_doc_attached(){}_doc_detached(){}attach_document(e){if(null!=this.document&&this.document!=e)throw new Error("models must be owned by only a single document");this.document=e,this._doc_attached()}detach_document(){this._doc_detached(),this.document=null}_needs_invalidate(e,t){const i=new Set;HasProps._value_record_references(t,i,{recursive:!1});const n=new Set;HasProps._value_record_references(e,n,{recursive:!1});for(const o of i)if(!n.has(o))return!0;for(const o of n)if(!i.has(o))return!0;return!1}_push_changes(e,t={}){if(!this.is_syncable)return;const{document:i}=this;if(null==i)return;const{setter_id:n}=t,o=[];for(const[r,s,a]of e)r.syncable&&o.push(new ModelChangedEvent(i,this,r.attr,s,a,n));if(0!=o.length){let e;1==o.length?[e]=o:e=new DocumentEventBatch(i,o,n),i._trigger_on_change(e)}}on_change(e,t){for(const i of isArray(e)?e:[e])this.connect(i.change,t)}}HasProps.init_HasProps();const _createElement=e=>(t={},...i)=>{const n=document.createElement(e);n.classList.add("bk");for(let[e,r]of entries(t))if(null!=r&&(!isBoolean(r)||r))if("class"===e&&(isString(r)&&(r=r.split(/\s+/)),isArray(r)))for(const t of r)null!=t&&n.classList.add(t);else if("style"===e&&isPlainObject(r))for(const[t,i]of entries(r))n.style[t]=i;else if("data"===e&&isPlainObject(r))for(const[t,i]of entries(r))n.dataset[t]=i;else n.setAttribute(e,r);function o(e){if(isString(e))n.appendChild(document.createTextNode(e));else if(e instanceof Node)n.appendChild(e);else if(e instanceof NodeList||e instanceof HTMLCollection)for(const t of e)n.appendChild(t);else if(null!=e&&!1!==e)throw new Error(`expected a DOM element, string, false or null, got ${JSON.stringify(e)}`)}for(const e of i)if(isArray(e))for(const t of e)o(t);else o(e);return n};function createElement$1(e,t,...i){return _createElement(e)(t,...i)}const div=_createElement("div"),span=_createElement("span"),canvas=_createElement("canvas"),style$2=_createElement("style"),a=_createElement("a"),p=_createElement("p"),i=_createElement("i"),pre=_createElement("pre"),button=_createElement("button"),label=_createElement("label"),input$1=_createElement("input"),select=_createElement("select"),option=_createElement("option"),optgroup=_createElement("optgroup"),textarea=_createElement("textarea");function nbsp(){return document.createTextNode("")}function append(e,...t){for(const i of t)e.appendChild(i)}function remove(e){const t=e.parentNode;null!=t&&t.removeChild(e)}const removeElement=remove;function replaceWith(e,t){const i=e.parentNode;null!=i&&i.replaceChild(t,e)}function prepend(e,...t){const i=e.firstChild;for(const n of t)e.insertBefore(n,i)}function empty$1(e,t=!1){let i;for(;i=e.firstChild;)e.removeChild(i);if(t&&e instanceof Element)for(const n of e.attributes)e.removeAttributeNode(n)}function display(e){e.style.display=""}function undisplay(e){e.style.display="none"}function show$1(e){e.style.visibility=""}function hide(e){e.style.visibility="hidden"}function offset(e){const t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}}function num(e){return parseFloat(e)||0}function extents(e){const t=getComputedStyle(e);return{border:{top:num(t.borderTopWidth),bottom:num(t.borderBottomWidth),left:num(t.borderLeftWidth),right:num(t.borderRightWidth)},margin:{top:num(t.marginTop),bottom:num(t.marginBottom),left:num(t.marginLeft),right:num(t.marginRight)},padding:{top:num(t.paddingTop),bottom:num(t.paddingBottom),left:num(t.paddingLeft),right:num(t.paddingRight)}}}function size(e){const t=e.getBoundingClientRect();return{width:Math.ceil(t.width),height:Math.ceil(t.height)}}function scroll_size(e){return{width:Math.ceil(e.scrollWidth),height:Math.ceil(e.scrollHeight)}}function content_size(e){const{left:t,top:i}=e.getBoundingClientRect(),{padding:n}=extents(e);let o=0,r=0;for(const s of e.children){const e=s.getBoundingClientRect();o=Math.max(o,Math.ceil(e.left-t-n.left+e.width)),r=Math.max(r,Math.ceil(e.top-i-n.top+e.height))}return{width:o,height:r}}function position(e,t,i){const{style:n}=e;if(n.left=`${t.x}px`,n.top=`${t.y}px`,n.width=`${t.width}px`,n.height=`${t.height}px`,null==i)n.margin="";else{const{top:e,right:t,bottom:o,left:r}=i;n.margin=`${e}px ${t}px ${o}px ${r}px`}}function children(e){return Array.from(e.children)}class ClassList{constructor(e){this.el=e,this.classList=e.classList}get values(){const e=[];for(let t=0;t<this.classList.length;t++){const i=this.classList.item(t);null!=i&&e.push(i)}return e}has(e){return this.classList.contains(e)}add(...e){for(const t of e)this.classList.add(t);return this}remove(...e){for(const t of e)this.classList.remove(t);return this}clear(){for(const e of this.values)"bk"!=e&&this.classList.remove(e);return this}toggle(e,t){return(null!=t?t:!this.has(e))?this.add(e):this.remove(e),this}}function classes(e){return new ClassList(e)}function toggle_attribute(e,t,i){null==i&&(i=!e.hasAttribute(t)),i?e.setAttribute(t,"true"):e.removeAttribute(t)}var Keys,Keys2;function undisplayed(e,t){const{display:i}=e.style;e.style.display="none";try{return t()}finally{e.style.display=i}}function unsized(e,t){return sized(e,{},t)}function sized(e,t,i){const{width:n,height:o,position:r,display:s}=e.style;e.style.position="absolute",e.style.display="",e.style.width=null!=t.width&&t.width!=1/0?`${t.width}px`:"auto",e.style.height=null!=t.height&&t.height!=1/0?`${t.height}px`:"auto";try{return i()}finally{e.style.position=r,e.style.display=s,e.style.width=n,e.style.height=o}}ClassList.__name__="ClassList",Keys2=Keys||(Keys={}),Keys2[Keys2.Backspace=8]="Backspace",Keys2[Keys2.Tab=9]="Tab",Keys2[Keys2.Enter=13]="Enter",Keys2[Keys2.Esc=27]="Esc",Keys2[Keys2.PageUp=33]="PageUp",Keys2[Keys2.PageDown=34]="PageDown",Keys2[Keys2.Left=37]="Left",Keys2[Keys2.Up=38]="Up",Keys2[Keys2.Right=39]="Right",Keys2[Keys2.Down=40]="Down",Keys2[Keys2.Delete=46]="Delete";class StyleSheet{constructor(e){this.root=e,this.known=new Set,this.style=style$2({type:"text/css"}),prepend(e,this.style)}append(e){this.known.has(e)||(this.style.appendChild(document.createTextNode(e)),this.known.add(e))}}StyleSheet.__name__="StyleSheet";const stylesheet=new StyleSheet(document.head);async function dom_ready(){if("loading"==document.readyState)return new Promise(((e,t)=>{document.addEventListener("DOMContentLoaded",(()=>e()),{once:!0})}))}const root$3="bk-root";var root_css=".bk-root{position:relative;width:auto;height:auto;box-sizing:border-box;font-family:Helvetica, Arial, sans-serif;font-size:13px;}.bk-root .bk,.bk-root .bk:before,.bk-root .bk:after{box-sizing:inherit;margin:0;border:0;padding:0;background-image:none;font-family:inherit;font-size:100%;line-height:1.42857143;}.bk-root pre.bk{font-family:Courier, monospace;}";class View{constructor(e){this.removed=new Signal0(this,"removed"),this._ready=Promise.resolve(void 0),this._slots=new WeakMap;const{model:t,parent:i}=e;this.model=t,this.parent=i,this.root=null==i?this:i.root,this.removed.emit()}get ready(){return this._ready}connect(e,t){let i=this._slots.get(t);return null==i&&(i=(e,i)=>{const n=Promise.resolve(t.call(this,e,i));this._ready=this._ready.then((()=>n))},this._slots.set(t,i)),e.connect(i,this)}disconnect(e,t){return e.disconnect(t,this)}initialize(){this._has_finished=!1,this.is_root&&(this._stylesheet=stylesheet);for(const e of this.styles())this.stylesheet.append(e)}async lazy_initialize(){}remove(){this.disconnect_signals(),this.removed.emit()}toString(){return`${this.model.type}View(${this.model.id})`}serializable_state(){return{type:this.model.type}}get is_root(){return null==this.parent}assert_root(){if(!this.is_root)throw new Error(`${this.toString()} is not a root layout`)}has_finished(){return this._has_finished}get is_idle(){return this.has_finished()}connect_signals(){}disconnect_signals(){Signal.disconnect_receiver(this)}on_change(e,t){for(const i of isArray(e)?e:[e])this.connect(i.change,t)}cursor(e,t){return null}get stylesheet(){return this.is_root?this._stylesheet:this.root.stylesheet}styles(){return[root_css]}}View.__name__="View";class VisualProperties{constructor(e,t=""){this.obj=e,this.prefix=t;const i=this;this._props=[];for(const n of this.attrs){const o=e.model.properties[t+n];o.change.connect((()=>this.update())),i[n]=o,this._props.push(o)}this.update()}*[Symbol.iterator](){yield*this._props}update(){}}VisualProperties.__name__="VisualProperties";class VisualUniforms{constructor(e,t=""){this.obj=e,this.prefix=t;for(const i of this.attrs)Object.defineProperty(this,i,{get:()=>e[t+i]})}*[Symbol.iterator](){for(const e of this.attrs)yield this.obj.model.properties[this.prefix+e]}update(){}}VisualUniforms.__name__="VisualUniforms";const Line$2={line_color:[Nullable(Color$1),"black"],line_alpha:[Alpha,1],line_width:[Number$2,1],line_join:[LineJoin,"bevel"],line_cap:[LineCap,"butt"],line_dash:[Or(LineDash,Array$2(Number$2)),[]],line_dash_offset:[Number$2,0]},Fill$1={fill_color:[Nullable(Color$1),"gray"],fill_alpha:[Alpha,1]},Hatch$1={hatch_color:[Nullable(Color$1),"black"],hatch_alpha:[Alpha,1],hatch_scale:[Number$2,12],hatch_pattern:[Nullable(Or(HatchPatternType,String$2)),null],hatch_weight:[Number$2,1],hatch_extra:[Dict(AnyRef()),{}]},Text$2={text_color:[Nullable(Color$1),"#444444"],text_alpha:[Alpha,1],text_font:[Font,"helvetica"],text_font_size:[FontSize$1,"16px"],text_font_style:[FontStyle,"normal"],text_align:[TextAlign,"left"],text_baseline:[TextBaseline,"bottom"],text_line_height:[Number$2,1.2]},LineScalar$1={line_color:[ColorScalar,"black"],line_alpha:[NumberScalar,1],line_width:[NumberScalar,1],line_join:[LineJoinScalar,"bevel"],line_cap:[LineCapScalar,"butt"],line_dash:[LineDashScalar,[]],line_dash_offset:[NumberScalar,0]},FillScalar$1={fill_color:[ColorScalar,"gray"],fill_alpha:[NumberScalar,1]},HatchScalar$1={hatch_color:[ColorScalar,"black"],hatch_alpha:[NumberScalar,1],hatch_scale:[NumberScalar,12],hatch_pattern:[NullStringScalar,null],hatch_weight:[NumberScalar,1],hatch_extra:[AnyScalar,{}]},TextScalar$1={text_color:[ColorScalar,"#444444"],text_alpha:[NumberScalar,1],text_font:[FontScalar,"helvetica"],text_font_size:[FontSizeScalar,"16px"],text_font_style:[FontStyleScalar,"normal"],text_align:[TextAlignScalar,"left"],text_baseline:[TextBaselineScalar,"bottom"],text_line_height:[NumberScalar,1.2]},LineVector$1={line_color:[ColorSpec,"black"],line_alpha:[NumberSpec,1],line_width:[NumberSpec,1],line_join:[LineJoinSpec,"bevel"],line_cap:[LineCapSpec,"butt"],line_dash:[LineDashSpec,[]],line_dash_offset:[NumberSpec,0]},FillVector$1={fill_color:[ColorSpec,"gray"],fill_alpha:[NumberSpec,1]},HatchVector$1={hatch_color:[ColorSpec,"black"],hatch_alpha:[NumberSpec,1],hatch_scale:[NumberSpec,12],hatch_pattern:[NullStringSpec,null],hatch_weight:[NumberSpec,1],hatch_extra:[AnyScalar,{}]},TextVector$1={text_color:[ColorSpec,"#444444"],text_alpha:[NumberSpec,1],text_font:[FontSpec,"helvetica"],text_font_size:[FontSizeSpec,"16px"],text_font_style:[FontStyleSpec,"normal"],text_align:[TextAlignSpec,"left"],text_baseline:[TextBaselineSpec,"bottom"],text_line_height:[NumberSpec,1.2]};function attrs_of(e,t,i,n=!1){const o={};for(const r of keys(i)){const i=`${t}${r}`,s=e[i];o[n?i:r]=s}return o}function resolve_line_dash(e){if(isArray(e))return e;switch(e){case"solid":return[];case"dashed":return[6];case"dotted":return[2,4];case"dotdash":return[2,4,6,4];case"dashdot":return[6,4,2,4];default:return e.split(" ").map(Number).filter(isInteger)}}class Line$1 extends VisualProperties{get doit(){const e=this.line_color.get_value(),t=this.line_alpha.get_value(),i=this.line_width.get_value();return!(null==e||0==t||0==i)}set_value(e){const t=this.line_color.get_value(),i=this.line_alpha.get_value();e.strokeStyle=color2css(t,i),e.lineWidth=this.line_width.get_value(),e.lineJoin=this.line_join.get_value(),e.lineCap=this.line_cap.get_value(),e.lineDash=resolve_line_dash(this.line_dash.get_value()),e.lineDashOffset=this.line_dash_offset.get_value()}}Line$1.__name__="Line";class LineScalar extends VisualUniforms{get doit(){const e=this.line_color.value,t=this.line_alpha.value,i=this.line_width.value;return!(0==e||0==t||0==i)}set_value(e){const t=this.line_color.value,i=this.line_alpha.value;e.strokeStyle=color2css(t,i),e.lineWidth=this.line_width.value,e.lineJoin=this.line_join.value,e.lineCap=this.line_cap.value,e.lineDash=resolve_line_dash(this.line_dash.value),e.lineDashOffset=this.line_dash_offset.value}}LineScalar.__name__="LineScalar";class LineVector extends VisualUniforms{get doit(){const{line_color:e}=this;if(e.is_Scalar()&&0==e.value)return!1;const{line_alpha:t}=this;if(t.is_Scalar()&&0==t.value)return!1;const{line_width:i}=this;return!i.is_Scalar()||0!=i.value}set_vectorize(e,t){const i=this.line_color.get(t),n=this.line_alpha.get(t),o=this.line_width.get(t),r=this.line_join.get(t),s=this.line_cap.get(t),a=this.line_dash.get(t),l=this.line_dash_offset.get(t);e.strokeStyle=color2css(i,n),e.lineWidth=o,e.lineJoin=r,e.lineCap=s,e.lineDash=resolve_line_dash(a),e.lineDashOffset=l}}LineVector.__name__="LineVector",Line$1.prototype.type="line",Line$1.prototype.attrs=Object.keys(Line$2),LineScalar.prototype.type="line",LineScalar.prototype.attrs=Object.keys(LineScalar$1),LineVector.prototype.type="line",LineVector.prototype.attrs=Object.keys(LineVector$1);class Fill extends VisualProperties{get doit(){const e=this.fill_color.get_value(),t=this.fill_alpha.get_value();return!(null==e||0==t)}set_value(e){const t=this.fill_color.get_value(),i=this.fill_alpha.get_value();e.fillStyle=color2css(t,i)}}Fill.__name__="Fill";class FillScalar extends VisualUniforms{get doit(){const e=this.fill_color.value,t=this.fill_alpha.value;return!(0==e||0==t)}set_value(e){const t=this.fill_color.value,i=this.fill_alpha.value;e.fillStyle=color2css(t,i)}}FillScalar.__name__="FillScalar";class FillVector extends VisualUniforms{get doit(){const{fill_color:e}=this;if(e.is_Scalar()&&0==e.value)return!1;const{fill_alpha:t}=this;return!t.is_Scalar()||0!=t.value}set_vectorize(e,t){const i=this.fill_color.get(t),n=this.fill_alpha.get(t);e.fillStyle=color2css(i,n)}}FillVector.__name__="FillVector",Fill.prototype.type="fill",Fill.prototype.attrs=Object.keys(Fill$1),FillScalar.prototype.type="fill",FillScalar.prototype.attrs=Object.keys(FillScalar$1),FillVector.prototype.type="fill",FillVector.prototype.attrs=Object.keys(FillVector$1);class Text$1 extends VisualProperties{get doit(){const e=this.text_color.get_value(),t=this.text_alpha.get_value();return!(null==e||0==t)}set_value(e){const t=this.text_color.get_value(),i=this.text_alpha.get_value();e.fillStyle=color2css(t,i),e.font=this.font_value(),e.textAlign=this.text_align.get_value(),e.textBaseline=this.text_baseline.get_value()}font_value(){return`${this.text_font_style.get_value()} ${this.text_font_size.get_value()} ${this.text_font.get_value()}`}}Text$1.__name__="Text";class TextScalar extends VisualUniforms{get doit(){const e=this.text_color.value,t=this.text_alpha.value;return!(0==e||0==t)}set_value(e){const t=this.text_color.value,i=this.text_alpha.value,n=this.font_value(),o=this.text_align.value,r=this.text_baseline.value;e.fillStyle=color2css(t,i),e.font=n,e.textAlign=o,e.textBaseline=r}font_value(){return`${this.text_font_style.value} ${this.text_font_size.value} ${this.text_font.value}`}}TextScalar.__name__="TextScalar";class TextVector extends VisualUniforms{get doit(){const{text_color:e}=this;if(e.is_Scalar()&&0==e.value)return!1;const{text_alpha:t}=this;return!t.is_Scalar()||0!=t.value}set_vectorize(e,t){const i=this.text_color.get(t),n=this.text_alpha.get(t),o=this.font_value(t),r=this.text_align.get(t),s=this.text_baseline.get(t);e.fillStyle=color2css(i,n),e.font=o,e.textAlign=r,e.textBaseline=s}font_value(e){return`${this.text_font_style.get(e)} ${this.text_font_size.get(e)} ${this.text_font.get(e)}`}}function _horz(e,t,i){e.moveTo(0,i+.5),e.lineTo(t,i+.5),e.stroke()}function _vert(e,t,i){e.moveTo(i+.5,0),e.lineTo(i+.5,t),e.stroke()}function _x(e,t){e.moveTo(0,t),e.lineTo(t,0),e.stroke(),e.moveTo(0,0),e.lineTo(t,t),e.stroke()}TextVector.__name__="TextVector",Text$1.prototype.type="text",Text$1.prototype.attrs=Object.keys(Text$2),TextScalar.prototype.type="text",TextScalar.prototype.attrs=Object.keys(TextScalar$1),TextVector.prototype.type="text",TextVector.prototype.attrs=Object.keys(TextVector$1);const hatch_aliases={" ":"blank",".":"dot",o:"ring","-":"horizontal_line","|":"vertical_line","+":"cross",'"':"horizontal_dash",":":"vertical_dash","@":"spiral","/":"right_diagonal_line","\\":"left_diagonal_line",x:"diagonal_cross",",":"right_diagonal_dash","`":"left_diagonal_dash",v:"horizontal_wave",">":"vertical_wave","*":"criss_cross"};function get_pattern(e,t,i,n,o,r){return e.resize(o,o),e.prepare(),create_hatch_canvas(e.ctx,t,i,n,o,r),e.canvas}function create_hatch_canvas(e,t,i,n,o,r){var s;const a=o,l=a/2,c=l/2,d=color2css(i,n);switch(e.strokeStyle=d,e.fillStyle=d,e.lineCap="square",e.lineWidth=r,null!=(s=hatch_aliases[t])?s:t){case"blank":break;case"dot":e.arc(l,l,l/2,0,2*Math.PI,!0),e.fill();break;case"ring":e.arc(l,l,l/2,0,2*Math.PI,!0),e.stroke();break;case"horizontal_line":_horz(e,a,l);break;case"vertical_line":_vert(e,a,l);break;case"cross":_horz(e,a,l),_vert(e,a,l);break;case"horizontal_dash":_horz(e,l,l);break;case"vertical_dash":_vert(e,l,l);break;case"spiral":{const t=a/30;e.moveTo(l,l);for(let i=0;i<360;i++){const n=.1*i,o=l+t*n*Math.cos(n),r=l+t*n*Math.sin(n);e.lineTo(o,r)}e.stroke();break}case"right_diagonal_line":e.moveTo(.5-c,a),e.lineTo(c+.5,0),e.stroke(),e.moveTo(c+.5,a),e.lineTo(3*c+.5,0),e.stroke(),e.moveTo(3*c+.5,a),e.lineTo(5*c+.5,0),e.stroke(),e.stroke();break;case"left_diagonal_line":e.moveTo(c+.5,a),e.lineTo(.5-c,0),e.stroke(),e.moveTo(3*c+.5,a),e.lineTo(c+.5,0),e.stroke(),e.moveTo(5*c+.5,a),e.lineTo(3*c+.5,0),e.stroke(),e.stroke();break;case"diagonal_cross":_x(e,a);break;case"right_diagonal_dash":e.moveTo(c+.5,3*c+.5),e.lineTo(3*c+.5,c+.5),e.stroke();break;case"left_diagonal_dash":e.moveTo(c+.5,c+.5),e.lineTo(3*c+.5,3*c+.5),e.stroke();break;case"horizontal_wave":e.moveTo(0,c),e.lineTo(l,3*c),e.lineTo(a,c),e.stroke();break;case"vertical_wave":e.moveTo(c,0),e.lineTo(3*c,l),e.lineTo(c,a),e.stroke();break;case"criss_cross":_x(e,a),_horz(e,a,l),_vert(e,a,l)}}class Hatch extends VisualProperties{constructor(){super(...arguments),this._update_iteration=0}update(){if(this._update_iteration++,this._hatch_image=null,!this.doit)return;const e=this.hatch_color.get_value(),t=this.hatch_alpha.get_value(),i=this.hatch_scale.get_value(),n=this.hatch_pattern.get_value(),o=this.hatch_weight.get_value(),r=e=>{this._hatch_image=e},s=this.hatch_extra.get_value()[n];if(null!=s){const n=s.get_pattern(e,t,i,o);if(n instanceof Promise){const{_update_iteration:e}=this;n.then((t=>{this._update_iteration==e&&(r(t),this.obj.request_render())}))}else r(n)}else{const s=get_pattern(this.obj.canvas.create_layer(),n,e,t,i,o);r(s)}}get doit(){const e=this.hatch_color.get_value(),t=this.hatch_alpha.get_value(),i=this.hatch_pattern.get_value();return!(null==e||0==t||" "==i||"blank"==i||null==i)}set_value(e){const t=this.pattern(e);e.fillStyle=null!=t?t:"transparent"}pattern(e){const t=this._hatch_image;return null==t?null:e.createPattern(t,this.repetition())}repetition(){const e=this.hatch_pattern.get_value(),t=this.hatch_extra.get_value()[e];if(null==t)return"repeat";switch(t.repetition){case"repeat":return"repeat";case"repeat_x":return"repeat-x";case"repeat_y":return"repeat-y";case"no_repeat":return"no-repeat"}}}Hatch.__name__="Hatch";class HatchScalar extends VisualUniforms{constructor(){super(...arguments),this._static_doit=!1,this._update_iteration=0}_compute_static_doit(){const e=this.hatch_color.value,t=this.hatch_alpha.value,i=this.hatch_pattern.value;return!(null==e||0==t||" "==i||"blank"==i||null==i)}update(){this._update_iteration++;const e=this.hatch_color.length;if(this._hatch_image=new UniformScalar(null,e),this._static_doit=this._compute_static_doit(),!this._static_doit)return;const t=this.hatch_color.value,i=this.hatch_alpha.value,n=this.hatch_scale.value,o=this.hatch_pattern.value,r=this.hatch_weight.value,s=t=>{this._hatch_image=new UniformScalar(t,e)},a=this.hatch_extra.value[o];if(null!=a){const e=a.get_pattern(t,i,n,r);if(e instanceof Promise){const{_update_iteration:t}=this;e.then((e=>{this._update_iteration==t&&(s(e),this.obj.request_render())}))}else s(e)}else{const e=get_pattern(this.obj.canvas.create_layer(),o,t,i,n,r);s(e)}}get doit(){return this._static_doit}set_value(e){var t;e.fillStyle=null!=(t=this.pattern(e))?t:"transparent"}pattern(e){const t=this._hatch_image.value;return null==t?null:e.createPattern(t,this.repetition())}repetition(){const e=this.hatch_pattern.value,t=this.hatch_extra.value[e];if(null==t)return"repeat";switch(t.repetition){case"repeat":return"repeat";case"repeat_x":return"repeat-x";case"repeat_y":return"repeat-y";case"no_repeat":return"no-repeat"}}}HatchScalar.__name__="HatchScalar";class HatchVector extends VisualUniforms{constructor(){super(...arguments),this._static_doit=!1,this._update_iteration=0}_compute_static_doit(){const{hatch_color:e}=this;if(e.is_Scalar()&&0==e.value)return!1;const{hatch_alpha:t}=this;if(t.is_Scalar()&&0==t.value)return!1;const{hatch_pattern:i}=this;if(i.is_Scalar()){const e=i.value;if(" "==e||"blank"==e||null==e)return!1}return!0}update(){this._update_iteration++;const e=this.hatch_color.length;if(this._hatch_image=new UniformScalar(null,e),this._static_doit=this._compute_static_doit(),!this._static_doit)return;const t=(e,t,i,n,o,r)=>{const s=this.hatch_extra.value[e];if(null!=s){const e=s.get_pattern(t,i,n,o);if(e instanceof Promise){const{_update_iteration:t}=this;e.then((e=>{this._update_iteration==t&&(r(e),this.obj.request_render())}))}else r(e)}else{const s=get_pattern(this.obj.canvas.create_layer(),e,t,i,n,o);r(s)}};if(this.hatch_color.is_Scalar()&&this.hatch_alpha.is_Scalar()&&this.hatch_scale.is_Scalar()&&this.hatch_pattern.is_Scalar()&&this.hatch_weight.is_Scalar()){const i=this.hatch_color.value,n=this.hatch_alpha.value,o=this.hatch_scale.value;t(this.hatch_pattern.value,i,n,o,this.hatch_weight.value,(t=>{this._hatch_image=new UniformScalar(t,e)}))}else{const i=new Array(e);i.fill(null),this._hatch_image=new UniformVector(i);for(let n=0;n<e;n++){const e=this.hatch_color.get(n),o=this.hatch_alpha.get(n),r=this.hatch_scale.get(n);t(this.hatch_pattern.get(n),e,o,r,this.hatch_weight.get(n),(e=>{i[n]=e}))}}}get doit(){return this._static_doit}set_vectorize(e,t){var i;e.fillStyle=null!=(i=this.pattern(e,t))?i:"transparent"}pattern(e,t){const i=this._hatch_image.get(t);return null==i?null:e.createPattern(i,this.repetition(t))}repetition(e){const t=this.hatch_pattern.get(e),i=this.hatch_extra.value[t];if(null==i)return"repeat";switch(i.repetition){case"repeat":return"repeat";case"repeat_x":return"repeat-x";case"repeat_y":return"repeat-y";case"no_repeat":return"no-repeat"}}}HatchVector.__name__="HatchVector",Hatch.prototype.type="hatch",Hatch.prototype.attrs=Object.keys(Hatch$1),HatchScalar.prototype.type="hatch",HatchScalar.prototype.attrs=Object.keys(HatchScalar$1),HatchVector.prototype.type="hatch",HatchVector.prototype.attrs=Object.keys(HatchVector$1);class Visuals{constructor(e){this._visuals=[];for(const[t,i]of e.model._mixins){const n=(()=>{switch(i){case Line$2:return new Line$1(e,t);case LineScalar$1:return new LineScalar(e,t);case LineVector$1:return new LineVector(e,t);case Fill$1:return new Fill(e,t);case FillScalar$1:return new FillScalar(e,t);case FillVector$1:return new FillVector(e,t);case Text$2:return new Text$1(e,t);case TextScalar$1:return new TextScalar(e,t);case TextVector$1:return new TextVector(e,t);case Hatch$1:return new Hatch(e,t);case HatchScalar$1:return new HatchScalar(e,t);case HatchVector$1:return new HatchVector(e,t);default:throw new Error("unknown visual")}})();this._visuals.push(n),Object.defineProperty(this,t+n.type,{get:()=>n,configurable:!1,enumerable:!0})}}*[Symbol.iterator](){yield*this._visuals}}Visuals.__name__="Visuals";class Model extends HasProps{constructor(e){super(e)}get is_syncable(){return this.syncable}static init_Model(){this.define((({Any:e,Unknown:t,Boolean:i,String:n,Array:o,Dict:r,Nullable:s})=>({tags:[o(t),[]],name:[s(n),null],js_property_callbacks:[r(o(e)),{}],js_event_callbacks:[r(o(e)),{}],subscribed_events:[o(n),[]],syncable:[i,!0]})))}initialize(){super.initialize(),this._js_callbacks=new Map}connect_signals(){super.connect_signals(),this._update_property_callbacks(),this.connect(this.properties.js_property_callbacks.change,(()=>this._update_property_callbacks())),this.connect(this.properties.js_event_callbacks.change,(()=>this._update_event_callbacks())),this.connect(this.properties.subscribed_events.change,(()=>this._update_event_callbacks()))}_process_event(e){var t;for(const i of null!=(t=this.js_event_callbacks[e.event_name])?t:[])i.execute(e);null!=this.document&&this.subscribed_events.some((t=>t==e.event_name))&&this.document.event_manager.send_event(e)}trigger_event(e){null!=this.document&&(e.origin=this,this.document.event_manager.trigger(e))}_update_event_callbacks(){null!=this.document?this.document.event_manager.subscribed_models.add(this):logger.warn("WARNING: Document not defined for updating event callbacks")}_update_property_callbacks(){const e=e=>{const[t,i=null]=e.split(":");return null!=i?this.properties[i][t]:this[t]};for(const[t,i]of this._js_callbacks){const n=e(t);for(const e of i)this.disconnect(n,e)}this._js_callbacks.clear();for(const[t,i]of entries(this.js_property_callbacks)){const n=i.map((e=>()=>e.execute(this)));this._js_callbacks.set(t,n);const o=e(t);for(const e of n)this.connect(o,e)}}_doc_attached(){isEmpty(this.js_event_callbacks)&&0==this.subscribed_events.length||this._update_event_callbacks()}_doc_detached(){this.document.event_manager.subscribed_models.delete(this)}select(e){if(isString(e))return[...this.references()].filter((t=>t instanceof Model&&t.name===e));if(e.prototype instanceof HasProps)return[...this.references()].filter((t=>t instanceof e));throw new Error("invalid selector")}select_one(e){const t=this.select(e);switch(t.length){case 0:return null;case 1:return t[0];default:throw new Error("found more than one object matching given selector")}}}Model.__name__="Model",Model.init_Model();class CoordinateTransform{constructor(e,t){this.x_scale=e,this.y_scale=t,this.x_range=this.x_scale.source_range,this.y_range=this.y_scale.source_range,this.ranges=[this.x_range,this.y_range],this.scales=[this.x_scale,this.y_scale]}map_to_screen(e,t){return[this.x_scale.v_compute(e),this.y_scale.v_compute(t)]}map_from_screen(e,t){return[this.x_scale.v_invert(e),this.y_scale.v_invert(t)]}}CoordinateTransform.__name__="CoordinateTransform";class RendererView extends View{get coordinates(){const{_coordinates:e}=this;return null!=e?e:this._coordinates=this._initialize_coordinates()}initialize(){super.initialize(),this.visuals=new Visuals(this),this.needs_webgl_blit=!1}connect_signals(){super.connect_signals();const{x_range_name:e,y_range_name:t}=this.model.properties;this.on_change([e,t],(()=>this._initialize_coordinates()))}_initialize_coordinates(){const{x_range_name:e,y_range_name:t}=this.model,{frame:i}=this.plot_view,n=i.x_scales.get(e),o=i.y_scales.get(t);return new CoordinateTransform(n,o)}get plot_view(){return this.parent}get plot_model(){return this.parent.model}get layer(){const{overlays:e,primary:t}=this.canvas;return"overlay"==this.model.level?e:t}get canvas(){return this.plot_view.canvas_view}request_render(){this.request_paint()}request_paint(){this.plot_view.request_paint(this)}notify_finished(){this.plot_view.notify_finished()}get needs_clip(){return!1}get has_webgl(){return!1}render(){this.model.visible&&this._render(),this._has_finished=!0}renderer_view(e){}}RendererView.__name__="RendererView";class Renderer extends Model{constructor(e){super(e)}static init_Renderer(){this.define((({Boolean:e,String:t})=>({level:[RenderLevel,"image"],visible:[e,!0],x_range_name:[t,"default"],y_range_name:[t,"default"]})))}}Renderer.__name__="Renderer",Renderer.init_Renderer();class AnnotationView extends RendererView{get_size(){if(this.model.visible){const{width:e,height:t}=this._get_size();return{width:Math.round(e),height:Math.round(t)}}return{width:0,height:0}}_get_size(){throw new Error("not implemented")}connect_signals(){super.connect_signals();const e=this.model.properties;this.on_change(e.visible,(()=>{null!=this.layout&&(this.layout.visible=this.model.visible,this.plot_view.request_layout())}))}get needs_clip(){return null==this.layout}serializable_state(){const e=super.serializable_state();return null==this.layout?e:__spreadProps(__spreadValues({},e),{bbox:this.layout.bbox.box})}}AnnotationView.__name__="AnnotationView";class Annotation extends Renderer{constructor(e){super(e)}static init_Annotation(){this.override({level:"annotation"})}}Annotation.__name__="Annotation",Annotation.init_Annotation();class Selection extends Model{constructor(e){super(e)}get_view(){return this.view}static init_Selection(){this.define((({Int:e,Array:t,Dict:i})=>({indices:[t(e),[]],line_indices:[t(e),[]],multiline_indices:[i(t(e)),{}]}))),this.internal((({Int:e,Array:t,AnyRef:i,Struct:n,Nullable:o})=>({selected_glyphs:[t(i()),[]],view:[o(i()),null],image_indices:[t(n({index:e,dim1:e,dim2:e,flat_index:e})),[]]})))}get selected_glyph(){return this.selected_glyphs.length>0?this.selected_glyphs[0]:null}add_to_selected_glyphs(e){this.selected_glyphs.push(e)}update(e,t=!0,i="replace"){switch(i){case"replace":this.indices=e.indices,this.line_indices=e.line_indices,this.selected_glyphs=e.selected_glyphs,this.view=e.view,this.multiline_indices=e.multiline_indices,this.image_indices=e.image_indices;break;case"append":this.update_through_union(e);break;case"intersect":this.update_through_intersection(e);break;case"subtract":this.update_through_subtraction(e)}}clear(){this.indices=[],this.line_indices=[],this.multiline_indices={},this.view=null,this.selected_glyphs=[]}is_empty(){return 0==this.indices.length&&0==this.line_indices.length&&0==this.image_indices.length}update_through_union(e){this.indices=union$2(this.indices,e.indices),this.selected_glyphs=union$2(e.selected_glyphs,this.selected_glyphs),this.line_indices=union$2(e.line_indices,this.line_indices),this.view=e.view,this.multiline_indices=merge(e.multiline_indices,this.multiline_indices)}update_through_intersection(e){this.indices=intersection(this.indices,e.indices),this.selected_glyphs=union$2(e.selected_glyphs,this.selected_glyphs),this.line_indices=union$2(e.line_indices,this.line_indices),this.view=e.view,this.multiline_indices=merge(e.multiline_indices,this.multiline_indices)}update_through_subtraction(e){this.indices=difference$1(this.indices,e.indices),this.selected_glyphs=union$2(e.selected_glyphs,this.selected_glyphs),this.line_indices=union$2(e.line_indices,this.line_indices),this.view=e.view,this.multiline_indices=merge(e.multiline_indices,this.multiline_indices)}}Selection.__name__="Selection",Selection.init_Selection();class DataSource extends Model{constructor(e){super(e)}static init_DataSource(){this.define((({Ref:e})=>({selected:[e(Selection),()=>new Selection]})))}}DataSource.__name__="DataSource",DataSource.init_DataSource();class DataRendererView extends RendererView{get xscale(){return this.coordinates.x_scale}get yscale(){return this.coordinates.y_scale}}DataRendererView.__name__="DataRendererView";class DataRenderer extends Renderer{constructor(e){super(e)}static init_DataRenderer(){this.override({level:"glyph"})}get selection_manager(){return this.get_selection_manager()}}function globals(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}DataRenderer.__name__="DataRenderer",DataRenderer.init_DataRenderer();var PJD_3PARAM=1,PJD_7PARAM=2,PJD_GRIDSHIFT=3,PJD_WGS84=4,PJD_NODATUM=5,SRS_WGS84_SEMIMAJOR=6378137,SRS_WGS84_SEMIMINOR=6356752.314,SRS_WGS84_ESQUARED=.0066943799901413165,SEC_TO_RAD=484813681109536e-20,HALF_PI=Math.PI/2,SIXTH=.16666666666666666,RA4=.04722222222222222,RA6=.022156084656084655,EPSLN=1e-10,D2R$1=.017453292519943295,R2D=57.29577951308232,FORTPI=Math.PI/4,TWO_PI=2*Math.PI,SPI=3.14159265359,exports$2={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},units={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},ignoredChar=/[\s_\-\/\(\)]/g;function match(e,t){if(e[t])return e[t];for(var i,n=Object.keys(e),o=t.toLowerCase().replace(ignoredChar,""),r=-1;++r<n.length;)if((i=n[r]).toLowerCase().replace(ignoredChar,"")===o)return e[i]}function projStr(e){var t,i,n,o={},r=e.split("+").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var i=t.split("=");return i.push(!0),e[i[0].toLowerCase()]=i[1],e}),{}),s={proj:"projName",datum:"datumCode",rf:function(e){o.rf=parseFloat(e)},lat_0:function(e){o.lat0=e*D2R$1},lat_1:function(e){o.lat1=e*D2R$1},lat_2:function(e){o.lat2=e*D2R$1},lat_ts:function(e){o.lat_ts=e*D2R$1},lon_0:function(e){o.long0=e*D2R$1},lon_1:function(e){o.long1=e*D2R$1},lon_2:function(e){o.long2=e*D2R$1},alpha:function(e){o.alpha=parseFloat(e)*D2R$1},gamma:function(e){o.rectified_grid_angle=parseFloat(e)},lonc:function(e){o.longc=e*D2R$1},x_0:function(e){o.x0=parseFloat(e)},y_0:function(e){o.y0=parseFloat(e)},k_0:function(e){o.k0=parseFloat(e)},k:function(e){o.k0=parseFloat(e)},a:function(e){o.a=parseFloat(e)},b:function(e){o.b=parseFloat(e)},r_a:function(){o.R_A=!0},zone:function(e){o.zone=parseInt(e,10)},south:function(){o.utmSouth=!0},towgs84:function(e){o.datum_params=e.split(",").map((function(e){return parseFloat(e)}))},to_meter:function(e){o.to_meter=parseFloat(e)},units:function(e){o.units=e;var t=match(units,e);t&&(o.to_meter=t.to_meter)},from_greenwich:function(e){o.from_greenwich=e*D2R$1},pm:function(e){var t=match(exports$2,e);o.from_greenwich=(t||parseFloat(e))*D2R$1},nadgrids:function(e){"@null"===e?o.datumCode="none":o.nadgrids=e},axis:function(e){var t="ewnsud";3===e.length&&-1!==t.indexOf(e.substr(0,1))&&-1!==t.indexOf(e.substr(1,1))&&-1!==t.indexOf(e.substr(2,1))&&(o.axis=e)},approx:function(){o.approx=!0}};for(t in r)i=r[t],t in s?"function"==typeof(n=s[t])?n(i):o[n]=i:o[t]=i;return"string"==typeof o.datumCode&&"WGS84"!==o.datumCode&&(o.datumCode=o.datumCode.toLowerCase()),o}var NEUTRAL=1,KEYWORD=2,NUMBER=3,QUOTED=4,AFTERQUOTE=5,ENDED=-1,whitespace=/\s/,latin=/[A-Za-z]/,keyword=/[A-Za-z84]/,endThings=/[,\]]/,digets=/[\d\.E\-\+]/;function Parser(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=NEUTRAL}function parseString(e){return new Parser(e).output()}function mapit(e,t,i){Array.isArray(t)&&(i.unshift(t),t=null);var n=t?{}:e,o=i.reduce((function(e,t){return sExpr(t,e),e}),n);t&&(e[t]=o)}function sExpr(e,t){if(Array.isArray(e)){var i=e.shift();if("PARAMETER"===i&&(i=e.shift()),1===e.length)return Array.isArray(e[0])?(t[i]={},void sExpr(e[0],t[i])):void(t[i]=e[0]);if(e.length)if("TOWGS84"!==i){if("AXIS"===i)return i in t||(t[i]=[]),void t[i].push(e);var n;switch(Array.isArray(i)||(t[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[i]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&sExpr(e[2],t[i]));case"SPHEROID":case"ELLIPSOID":return t[i]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&sExpr(e[3],t[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return e[0]=["name",e[0]],void mapit(t,i,e);default:for(n=-1;++n<e.length;)if(!Array.isArray(e[n]))return sExpr(e,t[i]);return mapit(t,i,e)}}else t[i]=e;else t[i]=!0}else t[e]=!0}Parser.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==QUOTED)for(;whitespace.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case NEUTRAL:return this.neutral(e);case KEYWORD:return this.keyword(e);case QUOTED:return this.quoted(e);case AFTERQUOTE:return this.afterquote(e);case NUMBER:return this.number(e);case ENDED:return}},Parser.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=QUOTED);if(endThings.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},Parser.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=NEUTRAL)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=NEUTRAL,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=ENDED))):void 0},Parser.prototype.number=function(e){if(!digets.test(e)){if(endThings.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},Parser.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=AFTERQUOTE},Parser.prototype.keyword=function(e){if(keyword.test(e))this.word+=e;else{if("["===e){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=NEUTRAL)}if(!endThings.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},Parser.prototype.neutral=function(e){if(latin.test(e))return this.word=e,void(this.state=KEYWORD);if('"'===e)return this.word="",void(this.state=QUOTED);if(digets.test(e))return this.word=e,void(this.state=NUMBER);if(!endThings.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},Parser.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===ENDED)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var D2R=.017453292519943295;function rename(e,t){var i=t[0],n=t[1];!(i in e)&&n in e&&(e[i]=e[n],3===t.length&&(e[i]=t[2](e[i])))}function d2r(e){return e*D2R}function cleanWKT(e){if("GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"==typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var t="",i=0,n=e.AXIS.length;i<n;++i){var o=[e.AXIS[i][0].toLowerCase(),e.AXIS[i][1].toLowerCase()];-1!==o[0].indexOf("north")||("y"===o[0]||"lat"===o[0])&&"north"===o[1]?t+="n":-1!==o[0].indexOf("south")||("y"===o[0]||"lat"===o[0])&&"south"===o[1]?t+="s":-1!==o[0].indexOf("east")||("x"===o[0]||"lon"===o[0])&&"east"===o[1]?t+="e":-1===o[0].indexOf("west")&&("x"!==o[0]&&"lon"!==o[0]||"west"!==o[1])||(t+="w")}2===t.length&&(t+="u"),3===t.length&&(e.axis=t)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var r=e.GEOGCS;function s(t){return t*(e.to_meter||1)}"GEOGCS"===e.type&&(r=e),r&&(r.DATUM?e.datumCode=r.DATUM.name.toLowerCase():e.datumCode=r.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==e.datumCode&&"new_zealand_1949"!==e.datumCode||(e.datumCode="nzgd49"),"wgs_1984"!==e.datumCode&&"world_geodetic_system_1984"!==e.datumCode||("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(e.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=r.DATUM.SPHEROID.a,e.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),r.DATUM&&r.DATUM.TOWGS84&&(e.datum_params=r.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",d2r],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",d2r],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",d2r],["lat0","latitude_of_origin",d2r],["lat0","standard_parallel_1",d2r],["lat1","standard_parallel_1",d2r],["lat2","standard_parallel_2",d2r],["azimuth","Azimuth"],["alpha","azimuth",d2r],["srsCode","name"]].forEach((function(t){return rename(e,t)})),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.projName&&"Lambert_Azimuthal_Equal_Area"!==e.projName||(e.long0=e.longc),e.lat_ts||!e.lat1||"Stereographic_South_Pole"!==e.projName&&"Polar Stereographic (variant B)"!==e.projName||(e.lat0=d2r(e.lat1>0?90:-90),e.lat_ts=e.lat1)}function wkt(e){var t=parseString(e),i=t.shift(),n=t.shift();t.unshift(["name",n]),t.unshift(["type",i]);var o={};return sExpr(t,o),cleanWKT(o),o}function defs(e){var t=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?defs[e]=projStr(arguments[1]):defs[e]=wkt(arguments[1]):defs[e]=i}else if(1===arguments.length){if(Array.isArray(e))return e.map((function(e){Array.isArray(e)?defs.apply(t,e):defs(e)}));if("string"==typeof e){if(e in defs)return defs[e]}else"EPSG"in e?defs["EPSG:"+e.EPSG]=e:"ESRI"in e?defs["ESRI:"+e.ESRI]=e:"IAU2000"in e?defs["IAU2000:"+e.IAU2000]=e:console.log(e);return}}function testObj(e){return"string"==typeof e}function testDef(e){return e in defs}globals(defs);var codeWords=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function testWKT(e){return codeWords.some((function(t){return e.indexOf(t)>-1}))}var codes=["3857","900913","3785","102113"];function checkMercator(e){var t=match(e,"authority");if(t){var i=match(t,"epsg");return i&&codes.indexOf(i)>-1}}function checkProjStr(e){var t=match(e,"extension");if(t)return match(t,"proj4")}function testProj(e){return"+"===e[0]}function parse(e){if(!testObj(e))return e;if(testDef(e))return defs[e];if(testWKT(e)){var t=wkt(e);if(checkMercator(t))return defs["EPSG:3857"];var i=checkProjStr(t);return i?projStr(i):t}return testProj(e)?projStr(e):void 0}function extend(e,t){var i,n;if(e=e||{},!t)return e;for(n in t)void 0!==(i=t[n])&&(e[n]=i);return e}function msfnz(e,t,i){var n=e*t;return i/Math.sqrt(1-n*n)}function sign(e){return e<0?-1:1}function adjust_lon(e){return Math.abs(e)<=SPI?e:e-sign(e)*TWO_PI}function tsfnz(e,t,i){var n=e*i,o=.5*e;return n=Math.pow((1-n)/(1+n),o),Math.tan(.5*(HALF_PI-t))/n}function phi2z(e,t){for(var i,n,o=.5*e,r=HALF_PI-2*Math.atan(t),s=0;s<=15;s++)if(i=e*Math.sin(r),r+=n=HALF_PI-2*Math.atan(t*Math.pow((1-i)/(1+i),o))-r,Math.abs(n)<=1e-10)return r;return-9999}function init$2(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function forward(e){var t,i,n=e.x,o=e.y;if(o*R2D>90&&o*R2D<-90&&n*R2D>180&&n*R2D<-180)return null;if(Math.abs(Math.abs(o)-HALF_PI)<=EPSLN)return null;if(this.sphere)t=this.x0+this.a*this.k0*adjust_lon(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(FORTPI+.5*o));else{var r=Math.sin(o),s=tsfnz(this.e,o,r);t=this.x0+this.a*this.k0*adjust_lon(n-this.long0),i=this.y0-this.a*this.k0*Math.log(s)}return e.x=t,e.y=i,e}function inverse(e){var t,i,n=e.x-this.x0,o=e.y-this.y0;if(this.sphere)i=HALF_PI-2*Math.atan(Math.exp(-o/(this.a*this.k0)));else{var r=Math.exp(-o/(this.a*this.k0));if(-9999===(i=phi2z(this.e,r)))return null}return t=adjust_lon(this.long0+n/(this.a*this.k0)),e.x=t,e.y=i,e}var names$2=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],merc={init:init$2,forward:forward,inverse:inverse,names:names$2};function init$1(){}function identity(e){return e}var names$1=["longlat","identity"],longlat={init:init$1,forward:identity,inverse:identity,names:names$1},projs=[merc,longlat],names={},projStore=[];function add(e,t){var i=projStore.length;return e.names?(projStore[i]=e,e.names.forEach((function(e){names[e.toLowerCase()]=i})),this):(console.log(t),!0)}function get(e){if(!e)return!1;var t=e.toLowerCase();return void 0!==names[t]&&projStore[names[t]]?projStore[names[t]]:void 0}function start(){projs.forEach(add)}var projections={start:start,add:add,get:get},exports$1={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},WGS84=exports$1.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};function eccentricity(e,t,i,n){var o=e*e,r=t*t,s=(o-r)/o,a=0;return n?(o=(e*=1-s*(SIXTH+s*(RA4+s*RA6)))*e,s=0):a=Math.sqrt(s),{es:s,e:a,ep2:(o-r)/r}}function sphere(e,t,i,n,o){if(!e){var r=match(exports$1,n);r||(r=WGS84),e=r.a,t=r.b,i=r.rf}return i&&!t&&(t=(1-1/i)*e),(0===i||Math.abs(e-t)<EPSLN)&&(o=!0,t=e),{a:e,b:t,rf:i,sphere:o}}exports$1.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var exports={};function datum(e,t,i,n,o,r,s){var a={};return a.datum_type=void 0===e||"none"===e?PJD_NODATUM:PJD_WGS84,t&&(a.datum_params=t.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=PJD_3PARAM),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=PJD_7PARAM,a.datum_params[3]*=SEC_TO_RAD,a.datum_params[4]*=SEC_TO_RAD,a.datum_params[5]*=SEC_TO_RAD,a.datum_params[6]=a.datum_params[6]/1e6+1))),s&&(a.datum_type=PJD_GRIDSHIFT,a.grids=s),a.a=i,a.b=n,a.es=o,a.ep2=r,a}exports.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},exports.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},exports.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},exports.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},exports.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},exports.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},exports.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},exports.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},exports.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},exports.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},exports.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},exports.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},exports.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},exports.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},exports.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},exports.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},exports.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var loadedNadgrids={};function getNadgrids(e){return void 0===e?null:e.split(",").map(parseNadgridString)}function parseNadgridString(e){if(0===e.length)return null;var t="@"===e[0];return t&&(e=e.slice(1)),"null"===e?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:loadedNadgrids[e]||null,isNull:!1}}function Projection(e,t){if(!(this instanceof Projection))return new Projection(e);t=t||function(e){if(e)throw e};var i=parse(e);if("object"==typeof i){var n=Projection.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var o=match(exports,i.datumCode);o&&(i.datum_params=i.datum_params||(o.towgs84?o.towgs84.split(","):null),i.ellps=o.ellipse,i.datumName=o.datumName?o.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var r=sphere(i.a,i.b,i.rf,i.ellps,i.sphere),s=eccentricity(r.a,r.b,r.rf,i.R_A),a=getNadgrids(i.nadgrids),l=i.datum||datum(i.datumCode,i.datum_params,r.a,r.b,s.es,s.ep2,a);extend(this,i),extend(this,n),this.a=r.a,this.b=r.b,this.rf=r.rf,this.sphere=r.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=l,this.init(),t(null,this)}else t(e)}else t(e)}function compareDatums(e,t){return e.datum_type===t.datum_type&&(!(e.a!==t.a||Math.abs(e.es-t.es)>5e-11)&&(e.datum_type===PJD_3PARAM?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type!==PJD_7PARAM||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]))}function geodeticToGeocentric(e,t,i){var n,o,r,s,a=e.x,l=e.y,c=e.z?e.z:0;if(l<-HALF_PI&&l>-1.001*HALF_PI)l=-HALF_PI;else if(l>HALF_PI&&l<1.001*HALF_PI)l=HALF_PI;else{if(l<-HALF_PI)return{x:-1/0,y:-1/0,z:e.z};if(l>HALF_PI)return{x:1/0,y:1/0,z:e.z}}return a>Math.PI&&(a-=2*Math.PI),o=Math.sin(l),s=Math.cos(l),r=o*o,{x:((n=i/Math.sqrt(1-t*r))+c)*s*Math.cos(a),y:(n+c)*s*Math.sin(a),z:(n*(1-t)+c)*o}}function geocentricToGeodetic(e,t,i,n){var o,r,s,a,l,c,d,h,u,p,_,f,g,m,v,b=1e-12,y=e.x,w=e.y,A=e.z?e.z:0;if(o=Math.sqrt(y*y+w*w),r=Math.sqrt(y*y+w*w+A*A),o/i<b){if(m=0,r/i<b)return HALF_PI,v=-n,{x:e.x,y:e.y,z:e.z}}else m=Math.atan2(w,y);s=A/r,h=(a=o/r)*(1-t)*(l=1/Math.sqrt(1-t*(2-t)*a*a)),u=s*l,g=0;do{g++,c=t*(d=i/Math.sqrt(1-t*u*u))/(d+(v=o*h+A*u-d*(1-t*u*u))),f=(_=s*(l=1/Math.sqrt(1-c*(2-c)*a*a)))*h-(p=a*(1-c)*l)*u,h=p,u=_}while(f*f>1e-24&&g<30);return{x:m,y:Math.atan(_/Math.abs(p)),z:v}}function geocentricToWgs84(e,t,i){if(t===PJD_3PARAM)return{x:e.x+i[0],y:e.y+i[1],z:e.z+i[2]};if(t===PJD_7PARAM){var n=i[0],o=i[1],r=i[2],s=i[3],a=i[4],l=i[5],c=i[6];return{x:c*(e.x-l*e.y+a*e.z)+n,y:c*(l*e.x+e.y-s*e.z)+o,z:c*(-a*e.x+s*e.y+e.z)+r}}}function geocentricFromWgs84(e,t,i){if(t===PJD_3PARAM)return{x:e.x-i[0],y:e.y-i[1],z:e.z-i[2]};if(t===PJD_7PARAM){var n=i[0],o=i[1],r=i[2],s=i[3],a=i[4],l=i[5],c=i[6],d=(e.x-n)/c,h=(e.y-o)/c,u=(e.z-r)/c;return{x:d+l*h-a*u,y:-l*d+h+s*u,z:a*d-s*h+u}}}function checkParams(e){return e===PJD_3PARAM||e===PJD_7PARAM}function datum_transform(e,t,i){if(compareDatums(e,t))return i;if(e.datum_type===PJD_NODATUM||t.datum_type===PJD_NODATUM)return i;var n=e.a,o=e.es;if(e.datum_type===PJD_GRIDSHIFT){if(0!==applyGridShift(e,!1,i))return;n=SRS_WGS84_SEMIMAJOR,o=SRS_WGS84_ESQUARED}var r=t.a,s=t.b,a=t.es;if(t.datum_type===PJD_GRIDSHIFT&&(r=SRS_WGS84_SEMIMAJOR,s=SRS_WGS84_SEMIMINOR,a=SRS_WGS84_ESQUARED),o===a&&n===r&&!checkParams(e.datum_type)&&!checkParams(t.datum_type))return i;if((i=geodeticToGeocentric(i,o,n),checkParams(e.datum_type)&&(i=geocentricToWgs84(i,e.datum_type,e.datum_params)),checkParams(t.datum_type)&&(i=geocentricFromWgs84(i,t.datum_type,t.datum_params)),i=geocentricToGeodetic(i,a,r,s),t.datum_type===PJD_GRIDSHIFT)&&0!==applyGridShift(t,!0,i))return;return i}function applyGridShift(e,t,i){if(null===e.grids||0===e.grids.length)return console.log("Grid shift grids not found"),-1;for(var n={x:-i.x,y:i.y},o={x:Number.NaN,y:Number.NaN},r=[],s=0;s<e.grids.length;s++){var a=e.grids[s];if(r.push(a.name),a.isNull){o=n;break}if(null!==a.grid){var l=a.grid.subgrids[0],c=(Math.abs(l.del[1])+Math.abs(l.del[0]))/1e4,d=l.ll[0]-c,h=l.ll[1]-c,u=l.ll[0]+(l.lim[0]-1)*l.del[0]+c,p=l.ll[1]+(l.lim[1]-1)*l.del[1]+c;if(!(h>n.y||d>n.x||p<n.y||u<n.x||(o=applySubgridShift(n,t,l),isNaN(o.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(o.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*R2D+" "+n.y*R2D+" tried: '"+r+"'"),-1):(i.x=-o.x,i.y=o.y,0)}function applySubgridShift(e,t,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return n;var o={x:e.x,y:e.y};o.x-=i.ll[0],o.y-=i.ll[1],o.x=adjust_lon(o.x-Math.PI)+Math.PI;var r=nadInterpolate(o,i);if(t){if(isNaN(r.x))return n;r.x=o.x-r.x,r.y=o.y-r.y;var s,a,l=9;do{if(a=nadInterpolate(r,i),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}s={x:o.x-(a.x+r.x),y:o.y-(a.y+r.y)},r.x+=s.x,r.y+=s.y}while(l--&&Math.abs(s.x)>1e-12&&Math.abs(s.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=adjust_lon(r.x+i.ll[0]),n.y=r.y+i.ll[1]}else isNaN(r.x)||(n.x=e.x+r.x,n.y=e.y+r.y);return n}function nadInterpolate(e,t){var i,n={x:e.x/t.del[0],y:e.y/t.del[1]},o=Math.floor(n.x),r=Math.floor(n.y),s=n.x-1*o,a=n.y-1*r,l={x:Number.NaN,y:Number.NaN};if(o<0||o>=t.lim[0])return l;if(r<0||r>=t.lim[1])return l;i=r*t.lim[0]+o;var c=t.cvs[i][0],d=t.cvs[i][1];i++;var h=t.cvs[i][0],u=t.cvs[i][1];i+=t.lim[0];var p=t.cvs[i][0],_=t.cvs[i][1];i--;var f=t.cvs[i][0],g=t.cvs[i][1],m=s*a,v=s*(1-a),b=(1-s)*(1-a),y=(1-s)*a;return l.x=b*c+v*h+y*f+m*p,l.y=b*d+v*u+y*g+m*_,l}function adjust_axis(e,t,i){var n,o,r,s=i.x,a=i.y,l=i.z||0,c={};for(r=0;r<3;r++)if(!t||2!==r||void 0!==i.z)switch(0===r?(n=s,o=-1!=="ew".indexOf(e.axis[r])?"x":"y"):1===r?(n=a,o=-1!=="ns".indexOf(e.axis[r])?"y":"x"):(n=l,o="z"),e.axis[r]){case"e":c[o]=n;break;case"w":c[o]=-n;break;case"n":c[o]=n;break;case"s":c[o]=-n;break;case"u":void 0!==i[o]&&(c.z=n);break;case"d":void 0!==i[o]&&(c.z=-n);break;default:return null}return c}function toPoint(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}function checkSanity(e){checkCoord(e.x),checkCoord(e.y)}function checkCoord(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function checkNotWGS(e,t){return(e.datum.datum_type===PJD_3PARAM||e.datum.datum_type===PJD_7PARAM)&&"WGS84"!==t.datumCode||(t.datum.datum_type===PJD_3PARAM||t.datum.datum_type===PJD_7PARAM)&&"WGS84"!==e.datumCode}function transform(e,t,i,n){var o;if(Array.isArray(i)&&(i=toPoint(i)),checkSanity(i),e.datum&&t.datum&&checkNotWGS(e,t)&&(i=transform(e,o=new Projection("WGS84"),i,n),e=o),n&&"enu"!==e.axis&&(i=adjust_axis(e,!1,i)),"longlat"===e.projName)i={x:i.x*D2R$1,y:i.y*D2R$1,z:i.z||0};else if(e.to_meter&&(i={x:i.x*e.to_meter,y:i.y*e.to_meter,z:i.z||0}),!(i=e.inverse(i)))return;if(e.from_greenwich&&(i.x+=e.from_greenwich),i=datum_transform(e.datum,t.datum,i))return t.from_greenwich&&(i={x:i.x-t.from_greenwich,y:i.y,z:i.z||0}),"longlat"===t.projName?i={x:i.x*R2D,y:i.y*R2D,z:i.z||0}:(i=t.forward(i),t.to_meter&&(i={x:i.x/t.to_meter,y:i.y/t.to_meter,z:i.z||0})),n&&"enu"!==t.axis?adjust_axis(t,!0,i):i}Projection.projections=projections,Projection.projections.start();var wgs84$1=Projection("WGS84");function transformer(e,t,i,n){var o,r,s;return Array.isArray(i)?(o=transform(e,t,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name?"number"==typeof o.z?[o.x,o.y,o.z].concat(i.splice(3)):[o.x,o.y,i[2]].concat(i.splice(3)):[o.x,o.y].concat(i.splice(2)):[o.x,o.y]):(r=transform(e,t,i,n),2===(s=Object.keys(i)).length||s.forEach((function(n){if(void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;r[n]=i[n]})),r)}function checkProj(e){return e instanceof Projection?e:e.oProj?e.oProj:Projection(e)}function proj4(e,t,i){e=checkProj(e);var n,o=!1;return void 0===t?(t=e,e=wgs84$1,o=!0):(void 0!==t.x||Array.isArray(t))&&(i=t,t=e,e=wgs84$1,o=!0),t=checkProj(t),i?transformer(e,t,i):(n={forward:function(i,n){return transformer(e,t,i,n)},inverse:function(i,n){return transformer(t,e,i,n)}},o&&(n.oProj=t),n)}const mercator=new Projection("GOOGLE"),wgs84=new Projection("WGS84"),_wgs84_mercator=proj4(wgs84,mercator),wgs84_mercator={compute:(e,t)=>isFinite(e)&&isFinite(t)?_wgs84_mercator.forward([e,t]):[NaN,NaN],invert:(e,t)=>isFinite(e)&&isFinite(t)?_wgs84_mercator.inverse([e,t]):[NaN,NaN]},mercator_bounds={lon:[-20026376.39,20026376.39],lat:[-20048966.1,20048966.1]},latlon_bounds={lon:[-180,180],lat:[-85.06,85.06]},{min:min$5,max:max$6}=Math;function clip_mercator(e,t,i){const[n,o]=mercator_bounds[i];return[max$6(e,n),min$5(t,o)]}function in_bounds(e,t){const[i,n]=latlon_bounds[t];return i<e&&e<n}var inplace;!function(e){function t(e,t,i,n){const o=min$5(e.length,t.length);i=null!=i?i:e,n=null!=n?n:t;for(let r=0;r<o;r++){const o=e[r],s=t[r],[a,l]=wgs84_mercator.compute(o,s);i[r]=a,n[r]=l}}e.project_xy=t,e.project_xsys=function(e,i,n,o){const r=min$5(e.length,i.length);n=null!=n?n:e,o=null!=o?o:i;for(let s=0;s<r;s++)t(e[s],i[s],n[s],o[s])}}(inplace||(inplace={}));const{min:min$4,max:max$5}=Math;function empty(){return{x0:1/0,y0:1/0,x1:-1/0,y1:-1/0}}function positive_x(){return{x0:Number.MIN_VALUE,y0:-1/0,x1:1/0,y1:1/0}}function positive_y(){return{x0:-1/0,y0:Number.MIN_VALUE,x1:1/0,y1:1/0}}function union$1(e,t){return{x0:min$4(e.x0,t.x0),x1:max$5(e.x1,t.x1),y0:min$4(e.y0,t.y0),y1:max$5(e.y1,t.y1)}}class BBox{constructor(e){if(null==e)this.x0=0,this.y0=0,this.x1=0,this.y1=0;else if("x0"in e){const{x0:t,y0:i,x1:n,y1:o}=e;if(!(t<=n&&i<=o))throw new Error(`invalid bbox {x0: ${t}, y0: ${i}, x1: ${n}, y1: ${o}}`);this.x0=t,this.y0=i,this.x1=n,this.y1=o}else if("x"in e){const{x:t,y:i,width:n,height:o}=e;if(!(n>=0&&o>=0))throw new Error(`invalid bbox {x: ${t}, y: ${i}, width: ${n}, height: ${o}}`);this.x0=t,this.y0=i,this.x1=t+n,this.y1=i+o}else{let t,i,n,o;if("width"in e)if("left"in e)t=e.left,i=t+e.width;else if("right"in e)i=e.right,t=i-e.width;else{const n=e.width/2;t=e.hcenter-n,i=e.hcenter+n}else t=e.left,i=e.right;if("height"in e)if("top"in e)n=e.top,o=n+e.height;else if("bottom"in e)o=e.bottom,n=o-e.height;else{const t=e.height/2;n=e.vcenter-t,o=e.vcenter+t}else n=e.top,o=e.bottom;if(!(t<=i&&n<=o))throw new Error(`invalid bbox {left: ${t}, top: ${n}, right: ${i}, bottom: ${o}}`);this.x0=t,this.y0=n,this.x1=i,this.y1=o}}static from_rect({left:e,right:t,top:i,bottom:n}){return new BBox({x0:Math.min(e,t),y0:Math.min(i,n),x1:Math.max(e,t),y1:Math.max(i,n)})}equals(e){return this.x0==e.x0&&this.y0==e.y0&&this.x1==e.x1&&this.y1==e.y1}[equals](e,t){return t.eq(this.x0,e.x0)&&t.eq(this.y0,e.y0)&&t.eq(this.x1,e.x1)&&t.eq(this.y1,e.y1)}toString(){return`BBox({left: ${this.left}, top: ${this.top}, width: ${this.width}, height: ${this.height}})`}get left(){return this.x0}get top(){return this.y0}get right(){return this.x1}get bottom(){return this.y1}get p0(){return[this.x0,this.y0]}get p1(){return[this.x1,this.y1]}get x(){return this.x0}get y(){return this.y0}get width(){return this.x1-this.x0}get height(){return this.y1-this.y0}get size(){return{width:this.width,height:this.height}}get rect(){const{x0:e,y0:t,x1:i,y1:n}=this;return{p0:{x:e,y:t},p1:{x:i,y:t},p2:{x:i,y:n},p3:{x:e,y:n}}}get box(){const{x:e,y:t,width:i,height:n}=this;return{x:e,y:t,width:i,height:n}}get h_range(){return{start:this.x0,end:this.x1}}get v_range(){return{start:this.y0,end:this.y1}}get ranges(){return[this.h_range,this.v_range]}get aspect(){return this.width/this.height}get hcenter(){return(this.left+this.right)/2}get vcenter(){return(this.top+this.bottom)/2}get area(){return this.width*this.height}relative(){const{width:e,height:t}=this;return new BBox({x:0,y:0,width:e,height:t})}translate(e,t){const{x:i,y:n,width:o,height:r}=this;return new BBox({x:e+i,y:t+n,width:o,height:r})}relativize(e,t){return[e-this.x,t-this.y]}contains(e,t){return this.x0<=e&&e<=this.x1&&this.y0<=t&&t<=this.y1}clip(e,t){return e<this.x0?e=this.x0:e>this.x1&&(e=this.x1),t<this.y0?t=this.y0:t>this.y1&&(t=this.y1),[e,t]}grow_by(e){return new BBox({left:this.left-e,right:this.right+e,top:this.top-e,bottom:this.bottom+e})}shrink_by(e){return new BBox({left:this.left+e,right:this.right-e,top:this.top+e,bottom:this.bottom-e})}union(e){return new BBox({x0:min$4(this.x0,e.x0),y0:min$4(this.y0,e.y0),x1:max$5(this.x1,e.x1),y1:max$5(this.y1,e.y1)})}intersection(e){return this.intersects(e)?new BBox({x0:max$5(this.x0,e.x0),y0:max$5(this.y0,e.y0),x1:min$4(this.x1,e.x1),y1:min$4(this.y1,e.y1)}):null}intersects(e){return!(e.x1<this.x0||e.x0>this.x1||e.y1<this.y0||e.y0>this.y1)}get xview(){return{compute:e=>this.left+e,v_compute:e=>{const t=new ScreenArray(e.length),i=this.left;for(let n=0;n<e.length;n++)t[n]=i+e[n];return t}}}get yview(){return{compute:e=>this.bottom-e,v_compute:e=>{const t=new ScreenArray(e.length),i=this.bottom;for(let n=0;n<e.length;n++)t[n]=i-e[n];return t}}}}BBox.__name__="BBox";class RaggedArray{constructor(e,t){this.offsets=e,this.array=t}[equals](e,t){return t.arrays(this.offsets,e.offsets)&&t.arrays(this.array,e.array)}get length(){return this.offsets.length}clone(){return new RaggedArray(this.offsets.slice(),this.array.slice())}static from(e,t){const i=e.length;let n=0;const o=(()=>{const t=new Uint32Array(i);for(let o=0;o<i;o++){const i=e[o].length;t[o]=n,n+=i}return n<256?new Uint8Array(t):n<65536?new Uint16Array(t):t})(),r=new t(n);for(let s=0;s<i;s++)r.set(e[s],o[s]);return new RaggedArray(o,r)}*[Symbol.iterator](){const{offsets:e,length:t}=this;for(let i=0;i<t;i++)yield this.array.subarray(e[i],e[i+1])}_check_bounds(e){assert(0<=e&&e<this.length,`Out of bounds: 0 <= ${e} < ${this.length}`)}get(e){this._check_bounds(e);const{offsets:t}=this;return this.array.subarray(t[e],t[e+1])}set(e,t){this._check_bounds(e),this.array.set(t,this.offsets[e])}}RaggedArray.__name__="RaggedArray",RaggedArray[Symbol.toStringTag]="RaggedArray";class FlatQueue{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(e,t){let i=this.length++;for(this.ids[i]=e,this.values[i]=t;i>0;){const e=i-1>>1,n=this.values[e];if(t>=n)break;this.ids[i]=this.ids[e],this.values[i]=n,i=e}this.ids[i]=e,this.values[i]=t}pop(){if(0===this.length)return;const e=this.ids[0];if(this.length--,this.length>0){const e=this.ids[0]=this.ids[this.length],t=this.values[0]=this.values[this.length],i=this.length>>1;let n=0;for(;n<i;){let e=1+(n<<1);const i=e+1;let o=this.ids[e],r=this.values[e];const s=this.values[i];if(i<this.length&&s<r&&(e=i,o=this.ids[i],r=s),r>=t)break;this.ids[n]=o,this.values[n]=r,n=e}this.ids[n]=e,this.values[n]=t}return e}peek(){if(0!==this.length)return this.ids[0]}peekValue(){if(0!==this.length)return this.values[0]}}const ARRAY_TYPES=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],VERSION=3;class Flatbush{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,i]=new Uint8Array(e,0,2);if(251!==t)throw new Error("Data does not appear to be in a Flatbush format.");if(i>>4!==VERSION)throw new Error(`Got v${i>>4} data when expected v${VERSION}.`);const[n]=new Uint16Array(e,2,1),[o]=new Uint32Array(e,4,1);return new Flatbush(o,n,ARRAY_TYPES[15&i],e)}constructor(e,t=16,i=Float64Array,n){if(void 0===e)throw new Error("Missing required argument: numItems.");if(isNaN(e)||e<=0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535);let o=e,r=o;this._levelBounds=[4*o];do{o=Math.ceil(o/this.nodeSize),r+=o,this._levelBounds.push(4*r)}while(1!==o);this.ArrayType=i||Float64Array,this.IndexArrayType=r<16384?Uint16Array:Uint32Array;const s=ARRAY_TYPES.indexOf(this.ArrayType),a=4*r*this.ArrayType.BYTES_PER_ELEMENT;if(s<0)throw new Error(`Unexpected typed array class: ${i}.`);n&&n instanceof ArrayBuffer?(this.data=n,this._boxes=new this.ArrayType(this.data,8,4*r),this._indices=new this.IndexArrayType(this.data,8+a,r),this._pos=4*r,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new ArrayBuffer(8+a+r*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,4*r),this._indices=new this.IndexArrayType(this.data,8+a,r),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(VERSION<<4)+s]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e),this._queue=new FlatQueue}add(e,t,i,n){const o=this._pos>>2;return this._indices[o]=o,this._boxes[this._pos++]=e,this._boxes[this._pos++]=t,this._boxes[this._pos++]=i,this._boxes[this._pos++]=n,e<this.minX&&(this.minX=e),t<this.minY&&(this.minY=t),i>this.maxX&&(this.maxX=i),n>this.maxY&&(this.maxY=n),o}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);if(this.numItems<=this.nodeSize)return this._boxes[this._pos++]=this.minX,this._boxes[this._pos++]=this.minY,this._boxes[this._pos++]=this.maxX,void(this._boxes[this._pos++]=this.maxY);const e=this.maxX-this.minX,t=this.maxY-this.minY,i=new Uint32Array(this.numItems);for(let n=0;n<this.numItems;n++){let o=4*n;const r=this._boxes[o++],s=this._boxes[o++],a=this._boxes[o++],l=this._boxes[o++],c=Math.floor(65535*((r+a)/2-this.minX)/e),d=Math.floor(65535*((s+l)/2-this.minY)/t);i[n]=hilbert(c,d)}sort(i,this._boxes,this._indices,0,this.numItems-1,this.nodeSize);for(let n=0,o=0;n<this._levelBounds.length-1;n++){const e=this._levelBounds[n];for(;o<e;){const t=o;let i=1/0,n=1/0,r=-1/0,s=-1/0;for(let a=0;a<this.nodeSize&&o<e;a++)i=Math.min(i,this._boxes[o++]),n=Math.min(n,this._boxes[o++]),r=Math.max(r,this._boxes[o++]),s=Math.max(s,this._boxes[o++]);this._indices[this._pos>>2]=t,this._boxes[this._pos++]=i,this._boxes[this._pos++]=n,this._boxes[this._pos++]=r,this._boxes[this._pos++]=s}}}search(e,t,i,n,o){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let r=this._boxes.length-4;const s=[],a=[];for(;void 0!==r;){const l=Math.min(r+4*this.nodeSize,upperBound$1(r,this._levelBounds));for(let c=r;c<l;c+=4){const l=0|this._indices[c>>2];i<this._boxes[c]||(n<this._boxes[c+1]||e>this._boxes[c+2]||t>this._boxes[c+3]||(r<4*this.numItems?(void 0===o||o(l))&&a.push(l):s.push(l)))}r=s.pop()}return a}neighbors(e,t,i=1/0,n=1/0,o){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let r=this._boxes.length-4;const s=this._queue,a=[],l=n*n;for(;void 0!==r;){const n=Math.min(r+4*this.nodeSize,upperBound$1(r,this._levelBounds));for(let i=r;i<n;i+=4){const n=0|this._indices[i>>2],a=axisDist(e,this._boxes[i],this._boxes[i+2]),l=axisDist(t,this._boxes[i+1],this._boxes[i+3]),c=a*a+l*l;r<4*this.numItems?(void 0===o||o(n))&&s.push(-n-1,c):s.push(n,c)}for(;s.length&&s.peek()<0;){if(s.peekValue()>l)return s.clear(),a;if(a.push(-s.pop()-1),a.length===i)return s.clear(),a}r=s.pop()}return s.clear(),a}}function axisDist(e,t,i){return e<t?t-e:e<=i?0:e-i}function upperBound$1(e,t){let i=0,n=t.length-1;for(;i<n;){const o=i+n>>1;t[o]>e?n=o:i=o+1}return t[i]}function sort(e,t,i,n,o,r){if(Math.floor(n/r)>=Math.floor(o/r))return;const s=e[n+o>>1];let a=n-1,l=o+1;for(;;){do{a++}while(e[a]<s);do{l--}while(e[l]>s);if(a>=l)break;swap(e,t,i,a,l)}sort(e,t,i,n,l,r),sort(e,t,i,l+1,o,r)}function swap(e,t,i,n,o){const r=e[n];e[n]=e[o],e[o]=r;const s=4*n,a=4*o,l=t[s],c=t[s+1],d=t[s+2],h=t[s+3];t[s]=t[a],t[s+1]=t[a+1],t[s+2]=t[a+2],t[s+3]=t[a+3],t[a]=l,t[a+1]=c,t[a+2]=d,t[a+3]=h;const u=i[n];i[n]=i[o],i[o]=u}function hilbert(e,t){let i=e^t,n=65535^i,o=65535^(e|t),r=e&(65535^t),s=i|n>>1,a=i>>1^i,l=o>>1^n&r>>1^o,c=i&o>>1^r>>1^r;i=s,n=a,o=l,r=c,s=i&i>>2^n&n>>2,a=i&n>>2^n&(i^n)>>2,l^=i&o>>2^n&r>>2,c^=n&o>>2^(i^n)&r>>2,i=s,n=a,o=l,r=c,s=i&i>>4^n&n>>4,a=i&n>>4^n&(i^n)>>4,l^=i&o>>4^n&r>>4,c^=n&o>>4^(i^n)&r>>4,i=s,n=a,o=l,r=c,l^=i&o>>8^n&r>>8,c^=n&o>>8^(i^n)&r>>8,i=l^l>>1,n=c^c>>1;let d=e^t,h=n|65535^(d|i);return d=16711935&(d|d<<8),d=252645135&(d|d<<4),d=858993459&(d|d<<2),d=1431655765&(d|d<<1),h=16711935&(h|h<<8),h=252645135&(h|h<<4),h=858993459&(h|h<<2),h=1431655765&(h|h<<1),(h<<1|d)>>>0}function upperBound(e,t){let i=0,n=t.length-1;for(;i<n;){const o=i+n>>1;t[o]>e?n=o:i=o+1}return t[i]}class _FlatBush extends Flatbush{search_indices(e,t,i,n){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const r=[],s=new BitSet(this.numItems);for(;void 0!==o;){const a=Math.min(o+4*this.nodeSize,upperBound(o,this._levelBounds));for(let l=o;l<a;l+=4){const a=0|this._indices[l>>2];i<this._boxes[l+0]||(n<this._boxes[l+1]||e>this._boxes[l+2]||t>this._boxes[l+3]||(o<4*this.numItems?s.set(a):r.push(a)))}o=r.pop()}return s}}_FlatBush.__name__="_FlatBush";class SpatialIndex{constructor(e){this.index=null,e>0&&(this.index=new _FlatBush(e))}add(e,t,i,n){var o;null==(o=this.index)||o.add(e,t,i,n)}add_empty(){var e;null==(e=this.index)||e.add(1/0,1/0,-1/0,-1/0)}finish(){var e;null==(e=this.index)||e.finish()}_normalize(e){let{x0:t,y0:i,x1:n,y1:o}=e;return t>n&&([t,n]=[n,t]),i>o&&([i,o]=[o,i]),{x0:t,y0:i,x1:n,y1:o}}get bbox(){if(null==this.index)return empty();{const{minX:e,minY:t,maxX:i,maxY:n}=this.index;return{x0:e,y0:t,x1:i,y1:n}}}indices(e){if(null==this.index)return new BitSet(0);{const{x0:t,y0:i,x1:n,y1:o}=this._normalize(e);return this.index.search_indices(t,i,n,o)}}bounds(e){const t=empty();for(const i of this.indices(e)){const e=this.index._boxes,n=e[4*i+0],o=e[4*i+1],r=e[4*i+2],s=e[4*i+3];n<t.x0&&(t.x0=n),r>t.x1&&(t.x1=r),o<t.y0&&(t.y0=o),s>t.y1&&(t.y1=s)}return t}}SpatialIndex.__name__="SpatialIndex";class Range$1 extends Model{constructor(e){super(e),this.have_updated_interactively=!1}static init_Range(){this.define((({Number:e,Tuple:t,Or:i,Auto:n,Nullable:o})=>({bounds:[o(i(t(o(e),o(e)),n)),null],min_interval:[o(e),null],max_interval:[o(e),null]}))),this.internal((({Array:e,AnyRef:t})=>({plots:[e(t()),[]]})))}get is_reversed(){return this.start>this.end}get is_valid(){return isFinite(this.min)&&isFinite(this.max)}}Range$1.__name__="Range",Range$1.init_Range(),Or(String$2,Tuple(String$2,String$2),Tuple(String$2,String$2,String$2));const FactorSeq=Or(Array$2(String$2),Array$2(Tuple(String$2,String$2)),Array$2(Tuple(String$2,String$2,String$2)));function map_one_level(e,t,i=0){const n=new Map;for(let o=0;o<e.length;o++){const r=e[o];if(n.has(r))throw new Error(`duplicate factor or subfactor: ${r}`);n.set(r,{value:.5+o*(1+t)+i})}return[n,(e.length-1)*t]}function map_two_levels(e,t,i,n=0){var o;const r=new Map,s=new Map;for(const[c,d]of e){const e=null!=(o=s.get(c))?o:[];s.set(c,[...e,d])}let a=n,l=0;for(const[c,d]of s){const e=d.length,[n,o]=map_one_level(d,i,a);l+=o;const s=sum$1(d.map((e=>n.get(e).value)));r.set(c,{value:s/e,mapping:n}),a+=e+t+o}return[r,(s.size-1)*t+l]}function map_three_levels(e,t,i,n,o=0){var r;const s=new Map,a=new Map;for(const[d,h,u]of e){const e=null!=(r=a.get(d))?r:[];a.set(d,[...e,[h,u]])}let l=o,c=0;for(const[d,h]of a){const e=h.length,[o,r]=map_two_levels(h,i,n,l);c+=r;const a=sum$1(h.map((([e])=>o.get(e).value)));s.set(d,{value:a/e,mapping:o}),l+=e+t+r}return[s,(a.size-1)*t+c]}class FactorRange extends Range$1{constructor(e){super(e)}static init_FactorRange(){this.define((({Number:e})=>({factors:[FactorSeq,[]],factor_padding:[e,0],subgroup_padding:[e,.8],group_padding:[e,1.4],range_padding:[e,0],range_padding_units:[PaddingUnits,"percent"],start:[e],end:[e]}))),this.internal((({Number:e,String:t,Array:i,Tuple:n,Nullable:o})=>({levels:[e],mids:[o(i(n(t,t))),null],tops:[o(i(t)),null]})))}get min(){return this.start}get max(){return this.end}initialize(){super.initialize(),this._init(!0)}connect_signals(){super.connect_signals(),this.connect(this.properties.factors.change,(()=>this.reset())),this.connect(this.properties.factor_padding.change,(()=>this.reset())),this.connect(this.properties.group_padding.change,(()=>this.reset())),this.connect(this.properties.subgroup_padding.change,(()=>this.reset())),this.connect(this.properties.range_padding.change,(()=>this.reset())),this.connect(this.properties.range_padding_units.change,(()=>this.reset()))}reset(){this._init(!1),this.change.emit()}_lookup(e){switch(e.length){case 1:{const[t]=e,i=this._mapping.get(t);return null!=i?i.value:NaN}case 2:{const[t,i]=e,n=this._mapping.get(t);if(null!=n){const e=n.mapping.get(i);if(null!=e)return e.value}return NaN}case 3:{const[t,i,n]=e,o=this._mapping.get(t);if(null!=o){const e=o.mapping.get(i);if(null!=e){const t=e.mapping.get(n);if(null!=t)return t.value}}return NaN}default:unreachable()}}synthetic(e){if(isNumber(e))return e;if(isString(e))return this._lookup([e]);let t=0;const i=e[e.length-1];return isNumber(i)&&(t=i,e=e.slice(0,-1)),this._lookup(e)+t}v_synthetic(e){const t=e.length,i=new ScreenArray(t);for(let n=0;n<t;n++)i[n]=this.synthetic(e[n]);return i}_init(e){const{levels:t,mapping:i,tops:n,mids:o,inside_padding:r}=(()=>{if(every(this.factors,isString)){const e=this.factors,[t,i]=map_one_level(e,this.factor_padding);return{levels:1,mapping:t,tops:null,mids:null,inside_padding:i}}if(every(this.factors,(e=>isArray(e)&&2==e.length&&isString(e[0])&&isString(e[1])))){const e=this.factors,[t,i]=map_two_levels(e,this.group_padding,this.factor_padding),n=[...t.keys()];return{levels:2,mapping:t,tops:n,mids:null,inside_padding:i}}if(every(this.factors,(e=>isArray(e)&&3==e.length&&isString(e[0])&&isString(e[1])&&isString(e[2])))){const e=this.factors,[t,i]=map_three_levels(e,this.group_padding,this.subgroup_padding,this.factor_padding),n=[...t.keys()],o=[];for(const[r,s]of t)for(const e of s.mapping.keys())o.push([r,e]);return{levels:3,mapping:t,tops:n,mids:o,inside_padding:i}}unreachable()})();this._mapping=i,this.tops=n,this.mids=o;let s=0,a=this.factors.length+r;if("percent"==this.range_padding_units){const e=(a-s)*this.range_padding/2;s-=e,a+=e}else s-=this.range_padding,a+=this.range_padding;this.setv({start:s,end:a,levels:t},{silent:e}),"auto"==this.bounds&&this.setv({bounds:[s,a]},{silent:!0})}}FactorRange.__name__="FactorRange",FactorRange.init_FactorRange();const{abs:abs$2,ceil:ceil}=Math;class GlyphView extends View{constructor(){super(...arguments),this._index=null,this._data_size=null,this._nohit_warned=new Set}get renderer(){return this.parent}get has_webgl(){return null!=this.glglyph}get index(){const{_index:e}=this;if(null!=e)return e;throw new Error(`${this}.index_data() wasn't called`)}get data_size(){const{_data_size:e}=this;if(null!=e)return e;throw new Error(`${this}.set_data() wasn't called`)}initialize(){super.initialize(),this.visuals=new Visuals(this)}request_render(){this.parent.request_render()}get canvas(){return this.renderer.parent.canvas_view}render(e,t,i){var n;null!=this.glglyph&&(this.renderer.needs_webgl_blit=this.glglyph.render(e,t,null!=(n=this.base)?n:this),this.renderer.needs_webgl_blit)||(e.beginPath(),this._render(e,t,null!=i?i:this.base))}has_finished(){return!0}notify_finished(){this.renderer.notify_finished()}_bounds(e){return e}bounds(){return this._bounds(this.index.bbox)}log_bounds(){const{x0:e,x1:t}=this.index.bounds(positive_x()),{y0:i,y1:n}=this.index.bounds(positive_y());return this._bounds({x0:e,y0:i,x1:t,y1:n})}get_anchor_point(e,t,[i,n]){switch(e){case"center":case"center_center":{const[e,o]=this.scenterxy(t,i,n);return{x:e,y:o}}default:return null}}scenterx(e,t,i){return this.scenterxy(e,t,i)[0]}scentery(e,t,i){return this.scenterxy(e,t,i)[1]}sdist(e,t,i,n="edge",o=!1){const r=t.length,s=new ScreenArray(r),a=e.s_compute;if("center"==n)for(let l=0;l<r;l++){const e=t[l],n=i.get(l)/2,o=a(e-n),r=a(e+n);s[l]=abs$2(r-o)}else for(let l=0;l<r;l++){const e=t[l],n=a(e),o=a(e+i.get(l));s[l]=abs$2(o-n)}return o&&inplace_map(s,(e=>ceil(e))),s}draw_legend_for_index(e,t,i){}hit_test(e){switch(e.type){case"point":if(null!=this._hit_point)return this._hit_point(e);break;case"span":if(null!=this._hit_span)return this._hit_span(e);break;case"rect":if(null!=this._hit_rect)return this._hit_rect(e);break;case"poly":if(null!=this._hit_poly)return this._hit_poly(e)}return this._nohit_warned.has(e.type)||(logger.debug(`'${e.type}' selection not available for ${this.model.type}`),this._nohit_warned.add(e.type)),null}_hit_rect_against_index(e){const{sx0:t,sx1:i,sy0:n,sy1:o}=e,[r,s]=this.renderer.coordinates.x_scale.r_invert(t,i),[a,l]=this.renderer.coordinates.y_scale.r_invert(n,o),c=[...this.index.indices({x0:r,x1:s,y0:a,y1:l})];return new Selection({indices:c})}_project_data(){}*_iter_visuals(){for(const e of this.visuals)for(const t of e)(t instanceof VectorSpec||t instanceof ScalarSpec)&&(yield t)}set_base(e){e!=this&&e instanceof this.constructor&&(this.base=e)}_configure(e,t){Object.defineProperty(this,isString(e)?e:e.attr,__spreadValues({configurable:!0,enumerable:!0},t))}set_visuals(e,t){var i;for(const n of this._iter_visuals()){const{base:i}=this;if(null!=i){const e=i.model.properties[n.attr];if(null!=e&&is_equal(n.get_value(),e.get_value())){this._configure(n,{get:()=>i[`${n.attr}`]});continue}}const o=n.uniform(e).select(t);this._configure(n,{value:o})}for(const n of this.visuals)n.update();null==(i=this.glglyph)||i.set_visuals_changed()}set_data(e,t,i){var n;const{x_range:o,y_range:r}=this.renderer.coordinates,s=new Set(this._iter_visuals());this._data_size=t.count;for(const a of this.model)if((a instanceof VectorSpec||a instanceof ScalarSpec)&&!s.has(a))if(a instanceof BaseCoordinateSpec){const i=a.array(e);let n=t.select(i);const s="x"==a.dimension?o:r;if(s instanceof FactorRange)if(a instanceof CoordinateSpec)n=s.v_synthetic(n);else if(a instanceof CoordinateSeqSpec)for(let e=0;e<n.length;e++)n[e]=s.v_synthetic(n[e]);let l;l=a instanceof CoordinateSeqSpec?RaggedArray.from(n,Float64Array):n,this._configure(`_${a.attr}`,{value:l})}else{const i=a.uniform(e).select(t);if(this._configure(a,{value:i}),a instanceof DistanceSpec){const e=i.is_Scalar()?i.value:max$7(i.array);this._configure(`max_${a.attr}`,{value:e})}}this.renderer.plot_view.model.use_map&&this._project_data(),this._set_data(null!=i?i:null),null==(n=this.glglyph)||n.set_data_changed(),this.index_data()}_set_data(e){}get _index_size(){return this.data_size}index_data(){const e=new SpatialIndex(this._index_size);this._index_data(e),e.finish(),this._index=e}mask_data(){return null==this._mask_data?BitSet.all_set(this.data_size):this._mask_data()}map_data(){var e;const t=this,{x_scale:i,y_scale:n}=this.renderer.coordinates;for(const o of this.model)if(o instanceof BaseCoordinateSpec){const e="x"==o.dimension?i:n;let r=t[`_${o.attr}`];if(r instanceof RaggedArray){const t=e.v_compute(r.array);r=new RaggedArray(r.offsets,t)}else r=e.v_compute(r);this[`s${o.attr}`]=r}this._map_data(),null==(e=this.glglyph)||e.set_data_changed()}_map_data(){}}GlyphView.__name__="GlyphView";class Glyph extends Model{constructor(e){super(e)}}Glyph.__name__="Glyph";class XYGlyphView extends GlyphView{_project_data(){inplace.project_xy(this._x,this._y)}_index_data(e){const{_x:t,_y:i,data_size:n}=this;for(let o=0;o<n;o++){const n=t[o],r=i[o];isNaN(n+r)||!isFinite(n+r)?e.add_empty():e.add(n,r,n,r)}}scenterxy(e){return[this.sx[e],this.sy[e]]}}XYGlyphView.__name__="XYGlyphView";class XYGlyph extends Glyph{constructor(e){super(e)}static init_XYGlyph(){this.define((({})=>({x:[XCoordinateSpec,{field:"x"}],y:[YCoordinateSpec,{field:"y"}]})))}}function point_in_poly(e,t,i,n){let o=!1,r=i[i.length-1],s=n[n.length-1];for(let a=0;a<i.length;a++){const l=i[a],c=n[a];s<t!=c<t&&r+(t-s)/(c-s)*(l-r)<e&&(o=!o),r=l,s=c}return o}function point_in_ellipse(e,t,i,n,o,r,s){return((Math.cos(i)/o)**2+(Math.sin(i)/n)**2)*(e-r)**2+2*Math.cos(i)*Math.sin(i)*((1/o)**2-(1/n)**2)*(e-r)*(t-s)+((Math.cos(i)/n)**2+(Math.sin(i)/o)**2)*(t-s)**2<=1}function dist_2_pts(e,t){return(e.x-t.x)**2+(e.y-t.y)**2}function dist_to_segment_squared(e,t,i){const n=dist_2_pts(t,i);if(0==n)return dist_2_pts(e,t);const o=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/n;if(o<0)return dist_2_pts(e,t);if(o>1)return dist_2_pts(e,i);return dist_2_pts(e,{x:t.x+o*(i.x-t.x),y:t.y+o*(i.y-t.y)})}function dist_to_segment(e,t,i){return Math.sqrt(dist_to_segment_squared(e,t,i))}function check_2_segments_intersect(e,t,i,n,o,r,s,a){const l=(a-r)*(i-e)-(s-o)*(n-t);if(0==l)return{hit:!1,x:null,y:null};{let c=t-r,d=e-o;const h=(i-e)*c-(n-t)*d;c=((s-o)*c-(a-r)*d)/l,d=h/l;return{hit:c>0&&c<1&&d>0&&d<1,x:e+c*(i-e),y:t+c*(n-t)}}}function generic_line_scalar_legend(e,t,{x0:i,x1:n,y0:o,y1:r}){t.save(),t.beginPath(),t.moveTo(i,(o+r)/2),t.lineTo(n,(o+r)/2),e.line.doit&&(e.line.set_value(t),t.stroke()),t.restore()}function generic_line_vector_legend(e,t,{x0:i,x1:n,y0:o,y1:r},s){t.save(),t.beginPath(),t.moveTo(i,(o+r)/2),t.lineTo(n,(o+r)/2),e.line.doit&&(e.line.set_vectorize(t,s),t.stroke()),t.restore()}function generic_area_scalar_legend(e,t,{x0:i,x1:n,y0:o,y1:r}){var s,a;const l=.1*Math.abs(n-i),c=.1*Math.abs(r-o),d=i+l,h=n-l,u=o+c,p=r-c;t.beginPath(),t.rect(d,u,h-d,p-u),e.fill.doit&&(e.fill.set_value(t),t.fill()),(null==(s=e.hatch)?void 0:s.doit)&&(e.hatch.set_value(t),t.fill()),(null==(a=e.line)?void 0:a.doit)&&(e.line.set_value(t),t.stroke())}function generic_area_vector_legend(e,t,{x0:i,x1:n,y0:o,y1:r},s){var a,l;const c=.1*Math.abs(n-i),d=.1*Math.abs(r-o),h=i+c,u=n-c,p=o+d,_=r-d;t.beginPath(),t.rect(h,p,u-h,_-p),e.fill.doit&&(e.fill.set_vectorize(t,s),t.fill()),(null==(a=e.hatch)?void 0:a.doit)&&(e.hatch.set_vectorize(t,s),t.fill()),(null==(l=e.line)?void 0:l.doit)&&(e.line.set_vectorize(t,s),t.stroke())}function line_interpolation(e,t,i,n,o,r){const{sx:s,sy:a}=t;let l,c,d,h;"point"==t.type?([d,h]=e.yscale.r_invert(a-1,a+1),[l,c]=e.xscale.r_invert(s-1,s+1)):"v"==t.direction?([d,h]=e.yscale.r_invert(a,a),[l,c]=[Math.min(i-1,o-1),Math.max(i+1,o+1)]):([l,c]=e.xscale.r_invert(s,s),[d,h]=[Math.min(n-1,r-1),Math.max(n+1,r+1)]);const{x:u,y:p}=check_2_segments_intersect(l,d,c,h,i,n,o,r);return[u,p]}XYGlyph.__name__="XYGlyph",XYGlyph.init_XYGlyph();class Buffer{constructor(e){this.gl=e,this._usage=35048,this.buffer_size=0,this.handle=this.gl.createBuffer()}delete(){this.gl.deleteBuffer(this.handle)}activate(){this.gl.bindBuffer(this._target,this.handle)}deactivate(){this.gl.bindBuffer(this._target,null)}set_size(e){e!=this.buffer_size&&(this.activate(),this.gl.bufferData(this._target,e,this._usage),this.buffer_size=e)}set_data(e,t){this.activate(),this.gl.bufferSubData(this._target,e,t)}}Buffer.__name__="Buffer";class VertexBuffer extends Buffer{constructor(){super(...arguments),this._target=34962}}VertexBuffer.__name__="VertexBuffer";class IndexBuffer extends Buffer{constructor(){super(...arguments),this._target=34963}}IndexBuffer.__name__="IndexBuffer";class Program{constructor(e){this.gl=e,this.UTYPEMAP={float:"uniform1fv",vec2:"uniform2fv",vec3:"uniform3fv",vec4:"uniform4fv",int:"uniform1iv",ivec2:"uniform2iv",ivec3:"uniform3iv",ivec4:"uniform4iv",bool:"uniform1iv",bvec2:"uniform2iv",bvec3:"uniform3iv",bvec4:"uniform4iv",mat2:"uniformMatrix2fv",mat3:"uniformMatrix3fv",mat4:"uniformMatrix4fv",sampler1D:"uniform1i",sampler2D:"uniform1i",sampler3D:"uniform1i"},this.ATYPEMAP={float:"vertexAttrib1f",vec2:"vertexAttrib2f",vec3:"vertexAttrib3f",vec4:"vertexAttrib4f"},this.ATYPEINFO={float:[1,5126],vec2:[2,5126],vec3:[3,5126],vec4:[4,5126],vec4_uint8:[4,5121]},this._linked=!1,this._validated=!1,this._unset_variables=new Set,this._known_invalid=new Set,this._locations=new Map,this._samplers=new Map,this._attributes=new Map,this.handle=this.gl.createProgram()}delete(){this.gl.deleteProgram(this.handle)}activate(){this.gl.useProgram(this.handle)}deactivate(){this.gl.useProgram(0)}set_shaders(e,t){const i=this.gl;this._linked=!1;const n=i.createShader(i.VERTEX_SHADER),o=i.createShader(i.FRAGMENT_SHADER),r=[[e,n,"vertex"],[t,o,"fragment"]];for(const[s,a,l]of r){i.shaderSource(a,s),i.compileShader(a);if(!i.getShaderParameter(a,i.COMPILE_STATUS)){const e=i.getShaderInfoLog(a);throw new Error(`errors in ${l} shader:\n${e}`)}}if(i.attachShader(this.handle,n),i.attachShader(this.handle,o),i.linkProgram(this.handle),!i.getProgramParameter(this.handle,i.LINK_STATUS)){const e=i.getProgramInfoLog(this.handle);throw new Error(`Program link error:\n${e}`)}this._unset_variables=this._get_active_attributes_and_uniforms(),i.detachShader(this.handle,n),i.detachShader(this.handle,o),i.deleteShader(n),i.deleteShader(o),this._known_invalid.clear(),this._linked=!0}_get_active_attributes_and_uniforms(){const e=this.gl;this._locations.clear();const t=new RegExp("(\\w+)\\s*(\\[(\\d+)\\])\\s*"),i=e.getProgramParameter(this.handle,e.ACTIVE_UNIFORMS),n=[],o=[],r=[[n,e.getProgramParameter(this.handle,e.ACTIVE_ATTRIBUTES),e.getActiveAttrib,e.getAttribLocation],[o,i,e.getActiveUniform,e.getUniformLocation]];for(const[a,l,c,d]of r)for(let i=0;i<l;i+=1){const n=c.call(e,this.handle,i),o=n.name,r=o.match(t);if(null!=r){const e=r[1];for(let t=0;t<n.size;t+=1)a.push([`${e}[${t}]`,n.type])}else a.push([o,n.type]);this._locations.set(o,d.call(e,this.handle,o))}const s=new Set;for(const[a]of n)s.add(a);for(const[a]of o)s.add(a);return s}set_texture(e,t){var i;if(!this._linked)throw new Error("Cannot set uniform when program has no code");const n=null!=(i=this._locations.get(e))?i:-1;if(n<0)this._known_invalid.has(e)||(this._known_invalid.add(e),console.log(`"Variable ${e} is not an active texture`));else{this._unset_variables.has(e)&&this._unset_variables.delete(e),this.activate();{let i=this._samplers.size;this._samplers.has(e)&&(i=this._samplers.get(e)[2]),this._samplers.set(e,[t._target,t.handle,i]),this.gl.uniform1i(n,i)}}}set_uniform(e,t,i){var n;if(!this._linked)throw new Error("Cannot set uniform when program has no code");const o=null!=(n=this._locations.get(e))?n:-1;if(o<0)return void(this._known_invalid.has(e)||(this._known_invalid.add(e),console.log(`Variable ${e} is not an active uniform`)));this._unset_variables.has(e)&&this._unset_variables.delete(e);let r=1;if(!t.startsWith("mat")){const e="int"==t||"bool"==t?"float":t.replace(/^ib/,"");r=Math.floor(i.length/this.ATYPEINFO[e][0])}if(r>1)for(let a=0;a<r;a+=1)if(this._unset_variables.has(`${e}[${a}]`)){const t=`${e}[${a}]`;this._unset_variables.has(t)&&this._unset_variables.delete(t)}const s=this.UTYPEMAP[t];this.activate(),t.startsWith("mat")?this.gl[s](o,!1,i):this.gl[s](o,i)}set_attribute(e,t,i,n=0,o=0,r=!1){var s;if(!this._linked)throw new Error("Cannot set attribute when program has no code");const a=null!=(s=this._locations.get(e))?s:-1;if(a<0)this._known_invalid.has(e)||(this._known_invalid.add(e),i instanceof VertexBuffer&&o>0||console.log(`Variable ${e} is not an active attribute`));else if(this._unset_variables.has(e)&&this._unset_variables.delete(e),this.activate(),i instanceof VertexBuffer){const[s,l]=this.ATYPEINFO[t],c="vertexAttribPointer",d=[s,l,r,n,o];this._attributes.set(e,[i.handle,a,c,d])}else{const n=this.ATYPEMAP[t];this._attributes.set(e,[null,a,n,i])}}_pre_draw(){this.activate();for(const[e,t,i]of this._samplers.values())this.gl.activeTexture(this.gl.TEXTURE0+i),this.gl.bindTexture(e,t);for(const[e,t,i,n]of this._attributes.values())null!=e?(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.enableVertexAttribArray(t),this.gl[i].apply(this.gl,[t,...n])):(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(t),this.gl[i].apply(this.gl,[t,...n]));this._validated||(this._validated=!0,this._validate())}_validate(){if(this._unset_variables.size&&console.log(`Program has unset variables: ${this._unset_variables}`),this.gl.validateProgram(this.handle),!this.gl.getProgramParameter(this.handle,this.gl.VALIDATE_STATUS))throw console.log(this.gl.getProgramInfoLog(this.handle)),new Error("Program validation error")}draw(e,t){if(!this._linked)throw new Error("Cannot draw program if code has not been set");if(t instanceof IndexBuffer){this._pre_draw(),t.activate();const i=t.buffer_size/2,n=this.gl.UNSIGNED_SHORT;this.gl.drawElements(e,i,n,0),t.deactivate()}else{const[i,n]=t;0!=n&&(this._pre_draw(),this.gl.drawArrays(e,i,n))}}}Program.__name__="Program";class Texture2d{constructor(e){this.gl=e,this._target=3553,this._types={Int8Array:5120,Uint8Array:5121,Int16Array:5122,Uint16Array:5123,Int32Array:5124,Uint32Array:5125,Float32Array:5126},this.handle=this.gl.createTexture()}delete(){this.gl.deleteTexture(this.handle)}activate(){this.gl.bindTexture(this._target,this.handle)}deactivate(){this.gl.bindTexture(this._target,0)}_get_alignment(e){const t=[4,8,2,1];for(const i of t)if(e%i==0)return i;unreachable()}set_wrapping(e,t){this.activate(),this.gl.texParameterf(this._target,this.gl.TEXTURE_WRAP_S,e),this.gl.texParameterf(this._target,this.gl.TEXTURE_WRAP_T,t)}set_interpolation(e,t){this.activate(),this.gl.texParameterf(this._target,this.gl.TEXTURE_MIN_FILTER,e),this.gl.texParameterf(this._target,this.gl.TEXTURE_MAG_FILTER,t)}set_size([e,t],i){var n,o,r;e==(null==(n=this._shape_format)?void 0:n.width)&&t==(null==(o=this._shape_format)?void 0:o.height)&&i==(null==(r=this._shape_format)?void 0:r.format)||(this._shape_format={width:e,height:t,format:i},this.activate(),this.gl.texImage2D(this._target,0,i,e,t,0,i,this.gl.UNSIGNED_BYTE,null))}set_data(e,[t,i],n){this.activate();const{format:o}=this._shape_format,[r,s]=e,a=this._types[n.constructor.name];if(null==a)throw new Error(`Type ${n.constructor.name} not allowed for texture`);const l=this._get_alignment(t);4!=l&&this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,l),this.gl.texSubImage2D(this._target,0,r,s,t,i,o,a,n),4!=l&&this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,4)}}Texture2d.__name__="Texture2d";class BaseGLGlyph{constructor(e,t){this.gl=e,this.glyph=t,this.nvertices=0,this.size_changed=!1,this.data_changed=!1,this.visuals_changed=!1}set_data_changed(){const{data_size:e}=this.glyph;e!=this.nvertices&&(this.nvertices=e,this.size_changed=!0),this.data_changed=!0}set_visuals_changed(){this.visuals_changed=!0}render(e,t,i){if(0==t.length)return!0;const{width:n,height:o}=this.glyph.renderer.plot_view.canvas_view.webgl.canvas,r={pixel_ratio:this.glyph.renderer.plot_view.canvas_view.pixel_ratio,width:n,height:o};return this.draw(t,i,r),!0}}BaseGLGlyph.__name__="BaseGLGlyph";const shader$3="\nprecision mediump float;\n\nconst float PI = 3.14159265358979323846264;\nconst float THETA = 15.0 * 3.14159265358979323846264/180.0;\n\nuniform float u_pixel_ratio;\nuniform vec2 u_canvas_size, u_offset;\nuniform vec2 u_scale_aspect;\nuniform float u_scale_length;\n\nuniform vec4 u_color;\nuniform float u_antialias;\nuniform float u_length;\nuniform float u_linewidth;\nuniform float u_dash_index;\nuniform float u_closed;\n\nattribute vec2 a_position;\nattribute vec4 a_tangents;\nattribute vec2 a_segment;\nattribute vec2 a_angles;\nattribute vec2 a_texcoord;\n\nvarying vec4  v_color;\nvarying vec2  v_segment;\nvarying vec2  v_angles;\nvarying vec2  v_texcoord;\nvarying vec2  v_miter;\nvarying float v_length;\nvarying float v_linewidth;\n\nfloat cross(in vec2 v1, in vec2 v2)\n{\n    return v1.x*v2.y - v1.y*v2.x;\n}\n\nfloat signed_distance(in vec2 v1, in vec2 v2, in vec2 v3)\n{\n    return cross(v2-v1,v1-v3) / length(v2-v1);\n}\n\nvoid rotate( in vec2 v, in float alpha, out vec2 result )\n{\n    float c = cos(alpha);\n    float s = sin(alpha);\n    result = vec2( c*v.x - s*v.y,\n                   s*v.x + c*v.y );\n}\n\nvoid main()\n{\n    bool closed = (u_closed > 0.0);\n\n    // Attributes and uniforms to varyings\n    v_color = u_color;\n    v_linewidth = u_linewidth;\n    v_segment = a_segment * u_scale_length;\n    v_length = u_length * u_scale_length;\n\n    // Scale to map to pixel coordinates. The original algorithm from the paper\n    // assumed isotropic scale. We obviously do not have this.\n    vec2 abs_scale_aspect = abs(u_scale_aspect);\n    vec2 abs_scale = u_scale_length * abs_scale_aspect;\n\n    // Correct angles for aspect ratio\n    vec2 av;\n    av = vec2(1.0, tan(a_angles.x)) / abs_scale_aspect;\n    v_angles.x = atan(av.y, av.x);\n    av = vec2(1.0, tan(a_angles.y)) / abs_scale_aspect;\n    v_angles.y = atan(av.y, av.x);\n\n    // Thickness below 1 pixel are represented using a 1 pixel thickness\n    // and a modified alpha\n    v_color.a = min(v_linewidth, v_color.a);\n    v_linewidth = max(v_linewidth, 1.0);\n\n    // If color is fully transparent we just will discard the fragment anyway\n    if( v_color.a <= 0.0 ) {\n        gl_Position = vec4(0.0,0.0,0.0,1.0);\n        return;\n    }\n\n    // This is the actual half width of the line\n    float w = ceil(u_antialias+v_linewidth)/2.0;\n\n    vec2 position = a_position;\n\n    vec2 t1 = normalize(a_tangents.xy * abs_scale_aspect);  // note the scaling for aspect ratio here\n    vec2 t2 = normalize(a_tangents.zw * abs_scale_aspect);\n    float u = a_texcoord.x;\n    float v = a_texcoord.y;\n    vec2 o1 = vec2( +t1.y, -t1.x);\n    vec2 o2 = vec2( +t2.y, -t2.x);\n\n    // This is a join\n    // ----------------------------------------------------------------\n    if( t1 != t2 ) {\n        float angle = atan (t1.x*t2.y-t1.y*t2.x, t1.x*t2.x+t1.y*t2.y);  // Angle needs recalculation for some reason\n        vec2 t  = normalize(t1+t2);\n        vec2 o  = vec2( + t.y, - t.x);\n\n        if ( u_dash_index > 0.0 )\n        {\n            // Broken angle\n            // ----------------------------------------------------------------\n            if( (abs(angle) > THETA) ) {\n                position += v * w * o / cos(angle/2.0);\n                float s = sign(angle);\n                if( angle < 0.0 ) {\n                    if( u == +1.0 ) {\n                        u = v_segment.y + v * w * tan(angle/2.0);\n                        if( v == 1.0 ) {\n                            position -= 2.0 * w * t1 / sin(angle);\n                            u -= 2.0 * w / sin(angle);\n                        }\n                    } else {\n                        u = v_segment.x - v * w * tan(angle/2.0);\n                        if( v == 1.0 ) {\n                            position += 2.0 * w * t2 / sin(angle);\n                            u += 2.0*w / sin(angle);\n                        }\n                    }\n                } else {\n                    if( u == +1.0 ) {\n                        u = v_segment.y + v * w * tan(angle/2.0);\n                        if( v == -1.0 ) {\n                            position += 2.0 * w * t1 / sin(angle);\n                            u += 2.0 * w / sin(angle);\n                        }\n                    } else {\n                        u = v_segment.x - v * w * tan(angle/2.0);\n                        if( v == -1.0 ) {\n                            position -= 2.0 * w * t2 / sin(angle);\n                            u -= 2.0*w / sin(angle);\n                        }\n                    }\n                }\n                // Continuous angle\n                // ------------------------------------------------------------\n            } else {\n                position += v * w * o / cos(angle/2.0);\n                if( u == +1.0 ) u = v_segment.y;\n                else            u = v_segment.x;\n            }\n        }\n\n        // Solid line\n        // --------------------------------------------------------------------\n        else\n        {\n            position.xy += v * w * o / cos(angle/2.0);\n            if( angle < 0.0 ) {\n                if( u == +1.0 ) {\n                    u = v_segment.y + v * w * tan(angle/2.0);\n                } else {\n                    u = v_segment.x - v * w * tan(angle/2.0);\n                }\n            } else {\n                if( u == +1.0 ) {\n                    u = v_segment.y + v * w * tan(angle/2.0);\n                } else {\n                    u = v_segment.x - v * w * tan(angle/2.0);\n                }\n            }\n        }\n\n    // This is a line start or end (t1 == t2)\n    // ------------------------------------------------------------------------\n    } else {\n        position += v * w * o1;\n        if( u == -1.0 ) {\n            u = v_segment.x - w;\n            position -= w * t1;\n        } else {\n            u = v_segment.y + w;\n            position += w * t2;\n        }\n    }\n\n    // Miter distance\n    // ------------------------------------------------------------------------\n    vec2 t;\n    vec2 curr = a_position * abs_scale;\n    if( a_texcoord.x < 0.0 ) {\n        vec2 next = curr + t2*(v_segment.y-v_segment.x);\n\n        rotate( t1, +v_angles.x/2.0, t);\n        v_miter.x = signed_distance(curr, curr+t, position);\n\n        rotate( t2, +v_angles.y/2.0, t);\n        v_miter.y = signed_distance(next, next+t, position);\n    } else {\n        vec2 prev = curr - t1*(v_segment.y-v_segment.x);\n\n        rotate( t1, -v_angles.x/2.0,t);\n        v_miter.x = signed_distance(prev, prev+t, position);\n\n        rotate( t2, -v_angles.y/2.0,t);\n        v_miter.y = signed_distance(curr, curr+t, position);\n    }\n\n    if (!closed && v_segment.x <= 0.0) {\n        v_miter.x = 1e10;\n    }\n    if (!closed && v_segment.y >= v_length)\n    {\n        v_miter.y = 1e10;\n    }\n\n    v_texcoord = vec2( u, v*w );\n\n    // Calculate position in device coordinates. Note that we\n    // already scaled with abs scale above.\n    vec2 normpos = position * sign(u_scale_aspect);\n    normpos += 0.5;  // make up for Bokeh's offset\n    normpos /= u_canvas_size / u_pixel_ratio;  // in 0..1\n    gl_Position = vec4(normpos*2.0-1.0, 0.0, 1.0);\n    gl_Position.y *= -1.0;\n}\n",shader$2="\nprecision mediump float;\n\nconst float PI = 3.14159265358979323846264;\nconst float THETA = 15.0 * 3.14159265358979323846264/180.0;\n\nuniform sampler2D u_dash_atlas;\n\nuniform vec2 u_linecaps;\nuniform float u_miter_limit;\nuniform float u_linejoin;\nuniform float u_antialias;\nuniform float u_dash_phase;\nuniform float u_dash_period;\nuniform float u_dash_index;\nuniform vec2 u_dash_caps;\nuniform float u_closed;\n\nvarying vec4  v_color;\nvarying vec2  v_segment;\nvarying vec2  v_angles;\nvarying vec2  v_texcoord;\nvarying vec2  v_miter;\nvarying float v_length;\nvarying float v_linewidth;\n\n// Compute distance to cap ----------------------------------------------------\nfloat cap( int type, float dx, float dy, float t, float linewidth )\n{\n    float d = 0.0;\n    dx = abs(dx);\n    dy = abs(dy);\n    if      (type == 0)  discard;  // None\n    else if (type == 1)  d = sqrt(dx*dx+dy*dy);  // Round\n    else if (type == 3)  d = (dx+abs(dy));  // Triangle in\n    else if (type == 2)  d = max(abs(dy),(t+dx-abs(dy)));  // Triangle out\n    else if (type == 4)  d = max(dx,dy);  // Square\n    else if (type == 5)  d = max(dx+t,dy);  // Butt\n    return d;\n}\n\n// Compute distance to join -------------------------------------------------\nfloat join( in int type, in float d, in vec2 segment, in vec2 texcoord, in vec2 miter,\n           in float linewidth )\n{\n    // texcoord.x is distance from start\n    // texcoord.y is distance from centerline\n    // segment.x and y indicate the limits (as for texcoord.x) for this segment\n\n    float dx = texcoord.x;\n\n    // Round join\n    if( type == 1 ) {\n        if (dx < segment.x) {\n            d = max(d,length( texcoord - vec2(segment.x,0.0)));\n            //d = length( texcoord - vec2(segment.x,0.0));\n        } else if (dx > segment.y) {\n            d = max(d,length( texcoord - vec2(segment.y,0.0)));\n            //d = length( texcoord - vec2(segment.y,0.0));\n        }\n    }\n    // Bevel join\n    else if ( type == 2 ) {\n        if (dx < segment.x) {\n            vec2 x = texcoord - vec2(segment.x,0.0);\n            d = max(d, max(abs(x.x), abs(x.y)));\n\n        } else if (dx > segment.y) {\n            vec2 x = texcoord - vec2(segment.y,0.0);\n            d = max(d, max(abs(x.x), abs(x.y)));\n        }\n        /*  Original code for bevel which does not work for us\n        if( (dx < segment.x) ||  (dx > segment.y) )\n            d = max(d, min(abs(x.x),abs(x.y)));\n        */\n    }\n\n    return d;\n}\n\nvoid main()\n{\n    // If color is fully transparent we just discard the fragment\n    if( v_color.a <= 0.0 ) {\n        discard;\n    }\n\n    // Test if dash pattern is the solid one (0)\n    bool solid =  (u_dash_index == 0.0);\n\n    // Test if path is closed\n    bool closed = (u_closed > 0.0);\n\n    vec4 color = v_color;\n    float dx = v_texcoord.x;\n    float dy = v_texcoord.y;\n    float t = v_linewidth/2.0-u_antialias;\n    float width = 1.0;  //v_linewidth; original code had dashes scale with line width, we do not\n    float d = 0.0;\n\n    vec2 linecaps = u_linecaps;\n    vec2 dash_caps = u_dash_caps;\n    float line_start = 0.0;\n    float line_stop = v_length;\n\n    // Apply miter limit; fragments too far into the miter are simply discarded\n    if( (dx < v_segment.x) || (dx > v_segment.y) ) {\n        float into_miter = max(v_segment.x - dx, dx - v_segment.y);\n        if (into_miter > u_miter_limit*v_linewidth/2.0)\n          discard;\n    }\n\n    // Solid line --------------------------------------------------------------\n    if( solid ) {\n        d = abs(dy);\n        if( (!closed) && (dx < line_start) ) {\n            d = cap( int(u_linecaps.x), abs(dx), abs(dy), t, v_linewidth );\n        }\n        else if( (!closed) &&  (dx > line_stop) ) {\n            d = cap( int(u_linecaps.y), abs(dx)-line_stop, abs(dy), t, v_linewidth );\n        }\n        else {\n            d = join( int(u_linejoin), abs(dy), v_segment, v_texcoord, v_miter, v_linewidth );\n        }\n\n    // Dash line --------------------------------------------------------------\n    } else {\n        float segment_start = v_segment.x;\n        float segment_stop  = v_segment.y;\n        float segment_center= (segment_start+segment_stop)/2.0;\n        float freq          = u_dash_period*width;\n        float u = mod( dx + u_dash_phase*width, freq);\n        vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0;  // conversion to int-like\n        float dash_center= tex.x * width;\n        float dash_type  = tex.y;\n        float _start = tex.z * width;\n        float _stop  = tex.a * width;\n        float dash_start = dx - u + _start;\n        float dash_stop  = dx - u + _stop;\n\n        // Compute extents of the first dash (the one relative to v_segment.x)\n        // Note: this could be computed in the vertex shader\n        if( (dash_stop < segment_start) && (dash_caps.x != 5.0) ) {\n            float u = mod(segment_start + u_dash_phase*width, freq);\n            vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0;  // conversion to int-like\n            dash_center= tex.x * width;\n            //dash_type  = tex.y;\n            float _start = tex.z * width;\n            float _stop  = tex.a * width;\n            dash_start = segment_start - u + _start;\n            dash_stop = segment_start - u + _stop;\n        }\n\n        // Compute extents of the last dash (the one relatives to v_segment.y)\n        // Note: This could be computed in the vertex shader\n        else if( (dash_start > segment_stop)  && (dash_caps.y != 5.0) ) {\n            float u = mod(segment_stop + u_dash_phase*width, freq);\n            vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0;  // conversion to int-like\n            dash_center= tex.x * width;\n            //dash_type  = tex.y;\n            float _start = tex.z * width;\n            float _stop  = tex.a * width;\n            dash_start = segment_stop - u + _start;\n            dash_stop  = segment_stop - u + _stop;\n        }\n\n        // This test if the we are dealing with a discontinuous angle\n        bool discontinuous = ((dx <  segment_center) && abs(v_angles.x) > THETA) ||\n                             ((dx >= segment_center) && abs(v_angles.y) > THETA);\n        //if( dx < line_start) discontinuous = false;\n        //if( dx > line_stop)  discontinuous = false;\n\n        float d_join = join( int(u_linejoin), abs(dy),\n                            v_segment, v_texcoord, v_miter, v_linewidth );\n\n        // When path is closed, we do not have room for linecaps, so we make room\n        // by shortening the total length\n        if (closed) {\n             line_start += v_linewidth/2.0;\n             line_stop  -= v_linewidth/2.0;\n        }\n\n        // We also need to take antialias area into account\n        //line_start += u_antialias;\n        //line_stop  -= u_antialias;\n\n        // Check is dash stop is before line start\n        if( dash_stop <= line_start ) {\n            discard;\n        }\n        // Check is dash start is beyond line stop\n        if( dash_start >= line_stop ) {\n            discard;\n        }\n\n        // Check if current dash start is beyond segment stop\n        if( discontinuous ) {\n            // Dash start is beyond segment, we discard\n            if( (dash_start > segment_stop) ) {\n                discard;\n                //gl_FragColor = vec4(1.0,0.0,0.0,.25); return;\n            }\n\n            // Dash stop is before segment, we discard\n            if( (dash_stop < segment_start) ) {\n                discard;  //gl_FragColor = vec4(0.0,1.0,0.0,.25); return;\n            }\n\n            // Special case for round caps (nicer with this)\n            if( dash_caps.x == 1.0 ) {\n                if( (u > _stop) && (dash_stop > segment_stop )  && (abs(v_angles.y) < PI/2.0)) {\n                    discard;\n                }\n            }\n\n            // Special case for round caps  (nicer with this)\n            if( dash_caps.y == 1.0 ) {\n                if( (u < _start) && (dash_start < segment_start )  && (abs(v_angles.x) < PI/2.0)) {\n                    discard;\n                }\n            }\n\n            // Special case for triangle caps (in & out) and square\n            // We make sure the cap stop at crossing frontier\n            if( (dash_caps.x != 1.0) && (dash_caps.x != 5.0) ) {\n                if( (dash_start < segment_start )  && (abs(v_angles.x) < PI/2.0) ) {\n                    float a = v_angles.x/2.0;\n                    float x = (segment_start-dx)*cos(a) - dy*sin(a);\n                    float y = (segment_start-dx)*sin(a) + dy*cos(a);\n                    if( x > 0.0 ) discard;\n                    // We transform the cap into square to avoid holes\n                    dash_caps.x = 4.0;\n                }\n            }\n\n            // Special case for triangle caps (in & out) and square\n            // We make sure the cap stop at crossing frontier\n            if( (dash_caps.y != 1.0) && (dash_caps.y != 5.0) ) {\n                if( (dash_stop > segment_stop )  && (abs(v_angles.y) < PI/2.0) ) {\n                    float a = v_angles.y/2.0;\n                    float x = (dx-segment_stop)*cos(a) - dy*sin(a);\n                    float y = (dx-segment_stop)*sin(a) + dy*cos(a);\n                    if( x > 0.0 ) discard;\n                    // We transform the caps into square to avoid holes\n                    dash_caps.y = 4.0;\n                }\n            }\n        }\n\n        // Line cap at start\n        if( (dx < line_start) && (dash_start < line_start) && (dash_stop > line_start) ) {\n            d = cap( int(linecaps.x), dx-line_start, dy, t, v_linewidth);\n        }\n        // Line cap at stop\n        else if( (dx > line_stop) && (dash_stop > line_stop) && (dash_start < line_stop) ) {\n            d = cap( int(linecaps.y), dx-line_stop, dy, t, v_linewidth);\n        }\n        // Dash cap left - dash_type = -1, 0 or 1, but there may be roundoff errors\n        else if( dash_type < -0.5 ) {\n            d = cap( int(dash_caps.y), abs(u-dash_center), dy, t, v_linewidth);\n            if( (dx > line_start) && (dx < line_stop) )\n                d = max(d,d_join);\n        }\n        // Dash cap right\n        else if( dash_type > 0.5 ) {\n            d = cap( int(dash_caps.x), abs(dash_center-u), dy, t, v_linewidth);\n            if( (dx > line_start) && (dx < line_stop) )\n                d = max(d,d_join);\n        }\n        // Dash body (plain)\n        else {// if( dash_type > -0.5 &&  dash_type < 0.5) {\n            d = abs(dy);\n        }\n\n        // Line join\n        if( (dx > line_start) && (dx < line_stop)) {\n            if( (dx <= segment_start) && (dash_start <= segment_start)\n                && (dash_stop >= segment_start) ) {\n                d = d_join;\n                // Antialias at outer border\n                float angle = PI/2.+v_angles.x;\n                float f = abs( (segment_start - dx)*cos(angle) - dy*sin(angle));\n                d = max(f,d);\n            }\n            else if( (dx > segment_stop) && (dash_start <= segment_stop)\n                     && (dash_stop >= segment_stop) ) {\n                d = d_join;\n                // Antialias at outer border\n                float angle = PI/2.+v_angles.y;\n                float f = abs((dx - segment_stop)*cos(angle) - dy*sin(angle));\n                d = max(f,d);\n            }\n            else if( dx < (segment_start - v_linewidth/2.)) {\n                discard;\n            }\n            else if( dx > (segment_stop + v_linewidth/2.)) {\n                discard;\n            }\n        }\n        else if( dx < (segment_start - v_linewidth/2.)) {\n            discard;\n        }\n        else if( dx > (segment_stop + v_linewidth/2.)) {\n            discard;\n        }\n    }\n\n    // Distance to border ------------------------------------------------------\n    d = d - t;\n    if( d < 0.0 ) {\n        gl_FragColor = color;\n    } else {\n        d /= u_antialias;\n        gl_FragColor = vec4(color.rgb, exp(-d*d)*color.a);\n    }\n}\n";class DashAtlas{constructor(e){this._atlas=new Map,this._width=256,this._height=256,this.tex=new Texture2d(e),this.tex.set_wrapping(e.REPEAT,e.REPEAT),this.tex.set_interpolation(e.NEAREST,e.NEAREST),this.tex.set_size([this._width,this._height],e.RGBA),this.tex.set_data([0,0],[this._width,this._height],new Uint8Array(4*this._width*this._height)),this.get_atlas_data([1])}get_atlas_data(e){const t=e.join("-");let i=this._atlas.get(t);if(null==i){const[n,o]=this.make_pattern(e),r=this._atlas.size;this.tex.set_data([0,r],[this._width,1],new Uint8Array(n.map((e=>e+10)))),i=[r/this._height,o],this._atlas.set(t,i)}return i}make_pattern(e){e.length>1&&e.length%2&&(e=e.concat(e));let t=0;for(const s of e)t+=s;const i=[];let n=0;for(let s=0,a=e.length+2;s<a;s+=2){const t=Math.max(1e-4,e[s%e.length]),o=Math.max(1e-4,e[(s+1)%e.length]);i.push(n,n+t),n+=t+o}const o=this._width,r=new Float32Array(4*o);for(let s=0,a=o;s<a;s++){let e,n,a;const l=t*s/(o-1);let c=0,d=1e16;for(let t=0,o=i.length;t<o;t++){const e=Math.abs(i[t]-l);e<d&&(c=t,d=e)}c%2==0?(a=l<=i[c]?1:0,n=i[c],e=i[c+1]):(a=l>i[c]?-1:0,n=i[c-1],e=i[c]),r[4*s+0]=i[c],r[4*s+1]=a,r[4*s+2]=n,r[4*s+3]=e}return[r,t]}}DashAtlas.__name__="DashAtlas";const joins={miter:0,round:1,bevel:2},caps={"":0,none:0,".":0,round:1,")":1,"(":1,o:1,"triangle in":2,"<":2,"triangle out":3,">":3,square:4,"[":4,"]":4,"=":4,butt:5,"|":5};class LineGL extends BaseGLGlyph{constructor(e,t){super(e,t),this.glyph=t,this._scale_aspect=0;const i=shader$3,n=shader$2;this.prog=new Program(e),this.prog.set_shaders(i,n),this.index_buffer=new IndexBuffer(e),this.vbo_position=new VertexBuffer(e),this.vbo_tangents=new VertexBuffer(e),this.vbo_segment=new VertexBuffer(e),this.vbo_angles=new VertexBuffer(e),this.vbo_texcoord=new VertexBuffer(e),this.dash_atlas=new DashAtlas(e)}draw(e,t,i){const n=t.glglyph;if(n.data_changed&&(n._set_data(),n.data_changed=!1),this.visuals_changed&&(this._set_visuals(),this.visuals_changed=!1),n._update_scale(1,1),this._scale_aspect=1,this.prog.set_attribute("a_position","vec2",n.vbo_position),this.prog.set_attribute("a_tangents","vec4",n.vbo_tangents),this.prog.set_attribute("a_segment","vec2",n.vbo_segment),this.prog.set_attribute("a_angles","vec2",n.vbo_angles),this.prog.set_attribute("a_texcoord","vec2",n.vbo_texcoord),this.prog.set_uniform("u_length","float",[n.cumsum]),this.prog.set_texture("u_dash_atlas",this.dash_atlas.tex),this.prog.set_uniform("u_pixel_ratio","float",[i.pixel_ratio]),this.prog.set_uniform("u_canvas_size","vec2",[i.width,i.height]),this.prog.set_uniform("u_scale_aspect","vec2",[1,1]),this.prog.set_uniform("u_scale_length","float",[Math.sqrt(2)]),this.I_triangles=n.I_triangles,this.I_triangles.length<65535)this.index_buffer.set_size(2*this.I_triangles.length),this.index_buffer.set_data(0,new Uint16Array(this.I_triangles)),this.prog.draw(this.gl.TRIANGLES,this.index_buffer);else{e=Array.from(this.I_triangles);const t=this.I_triangles.length,i=64008,o=[];for(let e=0,n=Math.ceil(t/i);e<n;e++)o.push([]);for(let n=0,r=e.length;n<r;n++){const t=e[n]%i;o[Math.floor(e[n]/i)].push(t)}for(let e=0,r=o.length;e<r;e++){const t=new Uint16Array(o[e]),r=e*i*4;0!==t.length&&(this.prog.set_attribute("a_position","vec2",n.vbo_position,0,2*r),this.prog.set_attribute("a_tangents","vec4",n.vbo_tangents,0,4*r),this.prog.set_attribute("a_segment","vec2",n.vbo_segment,0,2*r),this.prog.set_attribute("a_angles","vec2",n.vbo_angles,0,2*r),this.prog.set_attribute("a_texcoord","vec2",n.vbo_texcoord,0,2*r),this.index_buffer.set_size(2*t.length),this.index_buffer.set_data(0,t),this.prog.draw(this.gl.TRIANGLES,this.index_buffer))}}}_set_data(){this._bake(),this.vbo_position.set_size(4*this.V_position.length),this.vbo_position.set_data(0,this.V_position),this.vbo_tangents.set_size(4*this.V_tangents.length),this.vbo_tangents.set_data(0,this.V_tangents),this.vbo_angles.set_size(4*this.V_angles.length),this.vbo_angles.set_data(0,this.V_angles),this.vbo_texcoord.set_size(4*this.V_texcoord.length),this.vbo_texcoord.set_data(0,this.V_texcoord)}_set_visuals(){const{line_color:e,line_alpha:t,line_width:i,line_cap:n,line_join:o,line_dash:r,line_dash_offset:s}=this.glyph.visuals.line,[a,l,c,d]=color2rgba(e.value,t.value),h=i.value,u=caps[n.value],p=joins[o.value];this.prog.set_uniform("u_color","vec4",[a/255,l/255,c/255,d/255]),this.prog.set_uniform("u_linewidth","float",[h]),this.prog.set_uniform("u_antialias","float",[.9]),this.prog.set_uniform("u_linecaps","vec2",[u,u]),this.prog.set_uniform("u_linejoin","float",[p]),this.prog.set_uniform("u_miter_limit","float",[10]);const _=resolve_line_dash(r.value);let f=0,g=1;_.length&&([f,g]=this.dash_atlas.get_atlas_data(_)),this.prog.set_uniform("u_dash_index","float",[f]),this.prog.set_uniform("u_dash_phase","float",[s.value]),this.prog.set_uniform("u_dash_period","float",[g]),this.prog.set_uniform("u_dash_caps","vec2",[u,u]),this.prog.set_uniform("u_closed","float",[0])}_bake(){let e,t,i,n,o,r,s,a;const l=this.nvertices,c=this.glyph.sx,d=this.glyph.sy,h=s=new Float32Array(2*l),u=new Float32Array(2*l),p=a=new Float32Array(4*l);for(let m=0,v=l;m<v;m++)h[2*m+0]=isFinite(c[m])?c[m]:0,h[2*m+1]=isFinite(d[m])?d[m]:0;this.tangents=t=new Float32Array(2*l-2);for(let m=0,v=l-1;m<v;m++)t[2*m+0]=s[2*(m+1)+0]-s[2*m+0],t[2*m+1]=s[2*(m+1)+1]-s[2*m+1];for(let m=0,v=l-1;m<v;m++)p[4*(m+1)+0]=t[2*m+0],p[4*(m+1)+1]=t[2*m+1],p[4*m+2]=t[2*m+0],p[4*m+3]=t[2*m+1];p[0]=t[0],p[1]=t[1],p[4*(l-1)+2]=t[2*(l-2)+0],p[4*(l-1)+3]=t[2*(l-2)+1];const _=new Float32Array(l);for(let m=0,v=l;m<v;m++)_[m]=Math.atan2(a[4*m+0]*a[4*m+3]-a[4*m+1]*a[4*m+2],a[4*m+0]*a[4*m+2]+a[4*m+1]*a[4*m+3]);for(let m=0,v=l-1;m<v;m++)u[2*m+0]=_[m],u[2*m+1]=_[m+1];for(let m=0,v=l;m<v;m++)isFinite(c[m])||(h[2*m+0]=c[m]),isFinite(d[m])||(h[2*m+1]=d[m]);const f=4*l-4;this.V_position=n=new Float32Array(2*f),this.V_angles=i=new Float32Array(2*f),this.V_tangents=o=new Float32Array(4*f),this.V_texcoord=r=new Float32Array(2*f);for(let m=0,v=l;m<v;m++)for(let e=0;e<4;e++){for(let t=0;t<2;t++)n[2*(4*m+e-2)+t]=h[2*m+t],i[2*(4*m+e)+t]=u[2*m+t];for(let t=0;t<4;t++)o[4*(4*m+e-2)+t]=p[4*m+t]}for(let m=0,v=l;m<v;m++)r[2*(4*m+0)+0]=-1,r[2*(4*m+1)+0]=-1,r[2*(4*m+2)+0]=1,r[2*(4*m+3)+0]=1,r[2*(4*m+0)+1]=-1,r[2*(4*m+1)+1]=1,r[2*(4*m+2)+1]=-1,r[2*(4*m+3)+1]=1;const g=6*(l-1);this.I_triangles=e=new Uint32Array(g);for(let m=0,v=l;m<v;m++)e[6*m+0]=0+4*m,e[6*m+1]=1+4*m,e[6*m+2]=3+4*m,e[6*m+3]=2+4*m,e[6*m+4]=0+4*m,e[6*m+5]=3+4*m}_update_scale(e,t){let i;const n=this.nvertices,o=4*n-4,r=this.tangents,s=new Float32Array(n-1),a=new Float32Array(2*n);this.V_segment=i=new Float32Array(2*o);for(let c=0,d=n-1;c<d;c++)s[c]=Math.sqrt((r[2*c+0]*e)**2+(r[2*c+1]*t)**2);let l=0;for(let c=0,d=n-1;c<d;c++)l+=s[c],a[2*(c+1)+0]=l,a[2*c+1]=l;for(let c=0,d=n;c<d;c++)for(let e=0;e<4;e++)for(let t=0;t<2;t++)i[2*(4*c+e)+t]=a[2*c+t];this.cumsum=l,this.vbo_segment.set_size(4*this.V_segment.length),this.vbo_segment.set_data(0,this.V_segment)}}LineGL.__name__="LineGL";class LineView extends XYGlyphView{initialize(){super.initialize();const{webgl:e}=this.renderer.plot_view.canvas_view;null!=e&&(this.glglyph=new LineGL(e.gl,this))}_render(e,t,i){const{sx:n,sy:o}=null!=i?i:this;let r=!0;e.beginPath();for(const s of t){const t=n[s],i=o[s];isFinite(t+i)?r?(e.moveTo(t,i),r=!1):e.lineTo(t,i):r=!0}this.visuals.line.set_value(e),e.stroke()}_hit_point(e){const t=new Selection,i={x:e.sx,y:e.sy};let n=9999;const o=Math.max(2,this.line_width.value/2);for(let r=0,s=this.sx.length-1;r<s;r++){const e=dist_to_segment(i,{x:this.sx[r],y:this.sy[r]},{x:this.sx[r+1],y:this.sy[r+1]});e<o&&e<n&&(n=e,t.add_to_selected_glyphs(this.model),t.view=this,t.line_indices=[r])}return t}_hit_span(e){const{sx:t,sy:i}=e,n=new Selection;let o,r;"v"==e.direction?(o=this.renderer.yscale.invert(i),r=this._y):(o=this.renderer.xscale.invert(t),r=this._x);for(let s=0,a=r.length-1;s<a;s++)(r[s]<=o&&o<=r[s+1]||r[s+1]<=o&&o<=r[s])&&(n.add_to_selected_glyphs(this.model),n.view=this,n.line_indices.push(s));return n}get_interpolation_hit(e,t){const[i,n,o,r]=[this._x[e],this._y[e],this._x[e+1],this._y[e+1]];return line_interpolation(this.renderer,t,i,n,o,r)}draw_legend_for_index(e,t,i){generic_line_scalar_legend(this.visuals,e,t)}}LineView.__name__="LineView";class Line extends XYGlyph{constructor(e){super(e)}static init_Line(){this.prototype.default_view=LineView,this.mixins(LineScalar$1)}}Line.__name__="Line",Line.init_Line();class PatchView extends XYGlyphView{_inner_loop(e,t,i,n,o){for(const r of t){const t=i[r],s=n[r];0!=r?isNaN(t+s)?(e.closePath(),o.apply(e),e.beginPath()):e.lineTo(t,s):(e.beginPath(),e.moveTo(t,s))}e.closePath(),o.call(e)}_render(e,t,i){const{sx:n,sy:o}=null!=i?i:this;this.visuals.fill.doit&&(this.visuals.fill.set_value(e),this._inner_loop(e,t,n,o,e.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(e),this._inner_loop(e,t,n,o,e.fill)),this.visuals.line.doit&&(this.visuals.line.set_value(e),this._inner_loop(e,t,n,o,e.stroke))}draw_legend_for_index(e,t,i){generic_area_scalar_legend(this.visuals,e,t)}_hit_point(e){const t=new Selection;return point_in_poly(e.sx,e.sy,this.sx,this.sy)&&(t.add_to_selected_glyphs(this.model),t.view=this),t}}PatchView.__name__="PatchView";class Patch extends XYGlyph{constructor(e){super(e)}static init_Patch(){this.prototype.default_view=PatchView,this.mixins([LineScalar$1,FillScalar$1,HatchScalar$1])}}Patch.__name__="Patch",Patch.init_Patch();class AreaView extends GlyphView{draw_legend_for_index(e,t,i){generic_area_scalar_legend(this.visuals,e,t)}}AreaView.__name__="AreaView";class Area extends Glyph{constructor(e){super(e)}static init_Area(){this.mixins([FillScalar$1,HatchScalar$1])}}Area.__name__="Area",Area.init_Area();class HAreaView extends AreaView{_index_data(e){const{min:t,max:i}=Math,{data_size:n}=this;for(let o=0;o<n;o++){const n=this._x1[o],r=this._x2[o],s=this._y[o];isNaN(n+r+s)||!isFinite(n+r+s)?e.add_empty():e.add(t(n,r),s,i(n,r),s)}}_inner(e,t,i,n,o){e.beginPath();for(let r=0,s=t.length;r<s;r++)e.lineTo(t[r],n[r]);for(let r=i.length-1;r>=0;r--)e.lineTo(i[r],n[r]);e.closePath(),o.call(e)}_render(e,t,i){const{sx1:n,sx2:o,sy:r}=null!=i?i:this;this.visuals.fill.doit&&(this.visuals.fill.set_value(e),this._inner(e,n,o,r,e.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(e),this._inner(e,n,o,r,e.fill))}_hit_point(e){const t=this.sy.length,i=new ScreenArray(2*t),n=new ScreenArray(2*t);for(let r=0,s=t;r<s;r++)i[r]=this.sx1[r],n[r]=this.sy[r],i[t+r]=this.sx2[t-r-1],n[t+r]=this.sy[t-r-1];const o=new Selection;return point_in_poly(e.sx,e.sy,i,n)&&(o.add_to_selected_glyphs(this.model),o.view=this),o}scenterxy(e){return[(this.sx1[e]+this.sx2[e])/2,this.sy[e]]}_map_data(){this.sx1=this.renderer.xscale.v_compute(this._x1),this.sx2=this.renderer.xscale.v_compute(this._x2),this.sy=this.renderer.yscale.v_compute(this._y)}}HAreaView.__name__="HAreaView";class HArea extends Area{constructor(e){super(e)}static init_HArea(){this.prototype.default_view=HAreaView,this.define((({})=>({x1:[XCoordinateSpec,{field:"x1"}],x2:[XCoordinateSpec,{field:"x2"}],y:[YCoordinateSpec,{field:"y"}]})))}}HArea.__name__="HArea",HArea.init_HArea();class VAreaView extends AreaView{_index_data(e){const{min:t,max:i}=Math,{data_size:n}=this;for(let o=0;o<n;o++){const n=this._x[o],r=this._y1[o],s=this._y2[o];isNaN(n+r+s)||!isFinite(n+r+s)?e.add_empty():e.add(n,t(r,s),n,i(r,s))}}_inner(e,t,i,n,o){e.beginPath();for(let r=0,s=i.length;r<s;r++)e.lineTo(t[r],i[r]);for(let r=n.length-1;r>=0;r--)e.lineTo(t[r],n[r]);e.closePath(),o.call(e)}_render(e,t,i){const{sx:n,sy1:o,sy2:r}=null!=i?i:this;this.visuals.fill.doit&&(this.visuals.fill.set_value(e),this._inner(e,n,o,r,e.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(e),this._inner(e,n,o,r,e.fill))}scenterxy(e){return[this.sx[e],(this.sy1[e]+this.sy2[e])/2]}_hit_point(e){const t=this.sx.length,i=new ScreenArray(2*t),n=new ScreenArray(2*t);for(let r=0,s=t;r<s;r++)i[r]=this.sx[r],n[r]=this.sy1[r],i[t+r]=this.sx[t-r-1],n[t+r]=this.sy2[t-r-1];const o=new Selection;return point_in_poly(e.sx,e.sy,i,n)&&(o.add_to_selected_glyphs(this.model),o.view=this),o}_map_data(){this.sx=this.renderer.xscale.v_compute(this._x),this.sy1=this.renderer.yscale.v_compute(this._y1),this.sy2=this.renderer.yscale.v_compute(this._y2)}}VAreaView.__name__="VAreaView";class VArea extends Area{constructor(e){super(e)}static init_VArea(){this.prototype.default_view=VAreaView,this.define((({})=>({x:[XCoordinateSpec,{field:"x"}],y1:[YCoordinateSpec,{field:"y1"}],y2:[YCoordinateSpec,{field:"y2"}]})))}}VArea.__name__="VArea",VArea.init_VArea();class Filter extends Model{constructor(e){super(e)}}Filter.__name__="Filter";class CDSView extends Model{constructor(e){super(e)}static init_CDSView(){this.define((({Array:e,Ref:t})=>({filters:[e(t(Filter)),[]],source:[t(ColumnarDataSource)]}))),this.internal((({Int:e,Dict:t,Ref:i,Nullable:n})=>({indices:[i(BitSet)],indices_map:[t(e),{}],masked:[n(i(BitSet)),null]})))}initialize(){super.initialize(),this.compute_indices()}connect_signals(){super.connect_signals(),this.connect(this.properties.filters.change,(()=>this.compute_indices()));const e=()=>{const e=()=>this.compute_indices();null!=this.source&&(this.connect(this.source.change,e),this.source instanceof ColumnarDataSource&&(this.connect(this.source.streaming,e),this.connect(this.source.patching,e)))};let t=null!=this.source;t?e():this.connect(this.properties.source.change,(()=>{t||(e(),t=!0)}))}compute_indices(){var e;const{source:t}=this;if(null==t)return;const i=null!=(e=t.get_length())?e:1,n=BitSet.all_set(i);for(const o of this.filters)n.intersect(o.compute_indices(t));this.indices=n,this._indices=[...n],this.indices_map_to_subset()}indices_map_to_subset(){this.indices_map={};for(let e=0;e<this._indices.length;e++)this.indices_map[this._indices[e]]=e}convert_selection_from_subset(e){const t=e.indices.map((e=>this._indices[e]));return new Selection(__spreadProps(__spreadValues({},e.attributes),{indices:t}))}convert_selection_to_subset(e){const t=e.indices.map((e=>this.indices_map[e]));return new Selection(__spreadProps(__spreadValues({},e.attributes),{indices:t}))}convert_indices_from_subset(e){return e.map((e=>this._indices[e]))}}async function _build_view(e,t,i){const n=new e(__spreadProps(__spreadValues({},i),{model:t}));return n.initialize(),await n.lazy_initialize(),n}async function build_view(e,t={parent:null},i=(e=>e.default_view)){const n=await _build_view(i(e),e,t);return n.connect_signals(),n}async function build_views(e,t,i={parent:null},n=(e=>e.default_view)){const o=difference$1([...e.keys()],t);for(const a of o)e.get(a).remove(),e.delete(a);const r=[],s=t.filter((t=>!e.has(t)));for(const a of s){const t=await _build_view(n(a),a,i);e.set(a,t),r.push(t)}for(const a of r)a.connect_signals();return r}function remove_views(e){for(const[t,i]of e)i.remove(),e.delete(t)}CDSView.__name__="CDSView",CDSView.init_CDSView();const selection_defaults={fill:{},line:{}},decimated_defaults={fill:{fill_alpha:.3,fill_color:"grey"},line:{line_alpha:.3,line_color:"grey"}},nonselection_defaults={fill:{fill_alpha:.2},line:{}};class GlyphRendererView extends DataRendererView{get glyph_view(){return this.glyph}async lazy_initialize(){var e,t;await super.lazy_initialize();const i=this.model.glyph;this.glyph=await this.build_glyph_view(i);const n="fill"in this.glyph.visuals,o="line"in this.glyph.visuals,r=__spreadValues({},i.attributes);function s(e){const t=clone$1(r);return n&&extend$1(t,e.fill),o&&extend$1(t,e.line),new i.constructor(t)}delete r.id;let{selection_glyph:a}=this.model;null==a?a=s({fill:{},line:{}}):"auto"==a&&(a=s(selection_defaults)),this.selection_glyph=await this.build_glyph_view(a);let{nonselection_glyph:l}=this.model;null==l?l=s({fill:{},line:{}}):"auto"==l&&(l=s(nonselection_defaults)),this.nonselection_glyph=await this.build_glyph_view(l);const{hover_glyph:c}=this.model;null!=c&&(this.hover_glyph=await this.build_glyph_view(c));const{muted_glyph:d}=this.model;null!=d&&(this.muted_glyph=await this.build_glyph_view(d));const h=s(decimated_defaults);this.decimated_glyph=await this.build_glyph_view(h),this.selection_glyph.set_base(this.glyph),this.nonselection_glyph.set_base(this.glyph),null==(e=this.hover_glyph)||e.set_base(this.glyph),null==(t=this.muted_glyph)||t.set_base(this.glyph),this.decimated_glyph.set_base(this.glyph),this.set_data()}async build_glyph_view(e){return build_view(e,{parent:this})}remove(){var e,t;this.glyph.remove(),this.selection_glyph.remove(),this.nonselection_glyph.remove(),null==(e=this.hover_glyph)||e.remove(),null==(t=this.muted_glyph)||t.remove(),this.decimated_glyph.remove(),super.remove()}connect_signals(){super.connect_signals();const e=()=>this.request_render(),t=()=>this.update_data();this.connect(this.model.change,e),this.connect(this.glyph.model.change,t),this.connect(this.selection_glyph.model.change,t),this.connect(this.nonselection_glyph.model.change,t),null!=this.hover_glyph&&this.connect(this.hover_glyph.model.change,t),null!=this.muted_glyph&&this.connect(this.muted_glyph.model.change,t),this.connect(this.decimated_glyph.model.change,t),this.connect(this.model.data_source.change,t),this.connect(this.model.data_source.streaming,t),this.connect(this.model.data_source.patching,(e=>this.update_data(e))),this.connect(this.model.data_source.selected.change,e),this.connect(this.model.data_source._select,e),null!=this.hover_glyph&&this.connect(this.model.data_source.inspect,e),this.connect(this.model.properties.view.change,t),this.connect(this.model.view.properties.indices.change,t),this.connect(this.model.view.properties.masked.change,(()=>this.set_visuals())),this.connect(this.model.properties.visible.change,(()=>this.plot_view.invalidate_dataranges=!0));const{x_ranges:i,y_ranges:n}=this.plot_view.frame;for(const[,s]of i)s instanceof FactorRange&&this.connect(s.change,t);for(const[,s]of n)s instanceof FactorRange&&this.connect(s.change,t);const{transformchange:o,exprchange:r}=this.model.glyph;this.connect(o,t),this.connect(r,t)}_update_masked_indices(){const e=this.glyph.mask_data();return this.model.view.masked=e,e}update_data(e){this.set_data(e),this.request_render()}set_data(e){const t=this.model.data_source;this.all_indices=this.model.view.indices;const{all_indices:i}=this;this.glyph.set_data(t,i,e),this.set_visuals(),this._update_masked_indices();const{lod_factor:n}=this.plot_model,o=this.all_indices.count;this.decimated=new BitSet(o);for(let r=0;r<o;r+=n)this.decimated.set(r);this.plot_view.invalidate_dataranges=!0}set_visuals(){var e,t,i,n;const o=this.model.data_source,{all_indices:r}=this;this.glyph.set_visuals(o,r),this.decimated_glyph.set_visuals(o,r),null==(e=this.selection_glyph)||e.set_visuals(o,r),null==(t=this.nonselection_glyph)||t.set_visuals(o,r),null==(i=this.hover_glyph)||i.set_visuals(o,r),null==(n=this.muted_glyph)||n.set_visuals(o,r)}get has_webgl(){return this.glyph.has_webgl}_render(){const e=this.has_webgl;this.glyph.map_data();const t=[...this.all_indices];let i=[...this._update_masked_indices()];const{ctx:n}=this.layer;n.save();const{selected:o}=this.model.data_source;let r;r=!o||o.is_empty()?[]:this.glyph instanceof LineView&&o.selected_glyph===this.glyph.model?this.model.view.convert_indices_from_subset(i):o.indices;const{inspected:s}=this.model.data_source,a=new Set((()=>!s||s.is_empty()?[]:s.selected_glyph?this.model.view.convert_indices_from_subset(i):s.indices.length>0?s.indices:Object.keys(s.multiline_indices).map((e=>parseInt(e))))()),l=filter(i,(e=>a.has(t[e]))),{lod_threshold:c}=this.plot_model;let d,h,u;if(null!=this.model.document&&this.model.document.interactive_duration()>0&&!e&&null!=c&&t.length>c?(i=[...this.decimated],d=this.decimated_glyph,h=this.decimated_glyph,u=this.selection_glyph):(d=this.model.muted&&null!=this.muted_glyph?this.muted_glyph:this.glyph,h=this.nonselection_glyph,u=this.selection_glyph),null!=this.hover_glyph&&l.length&&(i=difference$1(i,l)),r.length){const e={};for(const t of r)e[t]=!0;const o=new Array,s=new Array;if(this.glyph instanceof LineView)for(const i of t)null!=e[i]?o.push(i):s.push(i);else for(const n of i)null!=e[t[n]]?o.push(n):s.push(n);h.render(n,s),u.render(n,o),null!=this.hover_glyph&&(this.glyph instanceof LineView?this.hover_glyph.render(n,this.model.view.convert_indices_from_subset(l)):this.hover_glyph.render(n,l))}else if(this.glyph instanceof LineView)this.hover_glyph&&l.length?this.hover_glyph.render(n,this.model.view.convert_indices_from_subset(l)):d.render(n,t);else if(this.glyph instanceof PatchView||this.glyph instanceof HAreaView||this.glyph instanceof VAreaView)if(0==s.selected_glyphs.length||null==this.hover_glyph)d.render(n,t);else for(const p of s.selected_glyphs)p==this.glyph.model&&this.hover_glyph.render(n,t);else d.render(n,i),this.hover_glyph&&l.length&&this.hover_glyph.render(n,l);n.restore()}draw_legend(e,t,i,n,o,r,s,a){0!=this.glyph.data_size&&(null==a&&(a=this.model.get_reference_point(r,s)),this.glyph.draw_legend_for_index(e,{x0:t,x1:i,y0:n,y1:o},a))}hit_test(e){if(!this.model.visible)return null;const t=this.glyph.hit_test(e);return null==t?null:this.model.view.convert_selection_from_subset(t)}}GlyphRendererView.__name__="GlyphRendererView";class GlyphRenderer extends DataRenderer{constructor(e){super(e)}static init_GlyphRenderer(){this.prototype.default_view=GlyphRendererView,this.define((({Boolean:e,Auto:t,Or:i,Ref:n,Null:o,Nullable:r})=>({data_source:[n(ColumnarDataSource)],view:[n(CDSView),e=>new CDSView({source:e.data_source})],glyph:[n(Glyph)],hover_glyph:[r(n(Glyph)),null],nonselection_glyph:[i(n(Glyph),t,o),"auto"],selection_glyph:[i(n(Glyph),t,o),"auto"],muted_glyph:[r(n(Glyph)),null],muted:[e,!1]})))}initialize(){super.initialize(),this.view.source!=this.data_source&&(this.view.source=this.data_source,this.view.compute_indices())}get_reference_point(e,t){if(null!=e){const i=this.data_source.get_column(e);if(null!=i)for(const[e,n]of Object.entries(this.view.indices_map))if(i[parseInt(e)]==t)return n}return 0}get_selection_manager(){return this.data_source.selection_manager}}GlyphRenderer.__name__="GlyphRenderer",GlyphRenderer.init_GlyphRenderer();class Expression extends Model{constructor(e){super(e)}initialize(){super.initialize(),this._connected=new Set,this._result=new Map}v_compute(e){this._connected.has(e)||(this.connect(e.change,(()=>this._result.delete(e))),this.connect(e.patching,(()=>this._result.delete(e))),this.connect(e.streaming,(()=>this._result.delete(e))),this._connected.add(e));let t=this._result.get(e);return null==t&&(t=this._v_compute(e),this._result.set(e,t)),t}}Expression.__name__="Expression";class ScalarExpression extends Model{constructor(e){super(e)}initialize(){super.initialize(),this._connected=new Set,this._result=new Map}compute(e){this._connected.has(e)||(this.connect(e.change,(()=>this._result.delete(e))),this.connect(e.patching,(()=>this._result.delete(e))),this.connect(e.streaming,(()=>this._result.delete(e))),this._connected.add(e));let t=this._result.get(e);return null==t&&(t=this._compute(e),this._result.set(e,t)),t}}ScalarExpression.__name__="ScalarExpression";class LayoutProvider extends Model{constructor(e){super(e)}}LayoutProvider.__name__="LayoutProvider";class GraphHitTestPolicy extends Model{constructor(e){super(e)}_hit_test(e,t,i){if(!t.model.visible)return null;const n=i.glyph.hit_test(e);return null==n?null:i.model.view.convert_selection_from_subset(n)}}GraphHitTestPolicy.__name__="GraphHitTestPolicy";class EdgesOnly extends GraphHitTestPolicy{constructor(e){super(e)}hit_test(e,t){return this._hit_test(e,t,t.edge_view)}do_selection(e,t,i,n){if(null==e)return!1;const o=t.edge_renderer.data_source.selected;return o.update(e,i,n),t.edge_renderer.data_source._select.emit(),!o.is_empty()}do_inspection(e,t,i,n,o){if(null==e)return!1;const{edge_renderer:r}=i.model,s=r.get_selection_manager().get_or_create_inspector(i.edge_view.model);return s.update(e,n,o),i.edge_view.model.data_source.setv({inspected:s},{silent:!0}),i.edge_view.model.data_source.inspect.emit([i.edge_view.model,{geometry:t}]),!s.is_empty()}}EdgesOnly.__name__="EdgesOnly";class NodesOnly extends GraphHitTestPolicy{constructor(e){super(e)}hit_test(e,t){return this._hit_test(e,t,t.node_view)}do_selection(e,t,i,n){if(null==e)return!1;const o=t.node_renderer.data_source.selected;return o.update(e,i,n),t.node_renderer.data_source._select.emit(),!o.is_empty()}do_inspection(e,t,i,n,o){if(null==e)return!1;const{node_renderer:r}=i.model,s=r.get_selection_manager().get_or_create_inspector(i.node_view.model);return s.update(e,n,o),i.node_view.model.data_source.setv({inspected:s},{silent:!0}),i.node_view.model.data_source.inspect.emit([i.node_view.model,{geometry:t}]),!s.is_empty()}}NodesOnly.__name__="NodesOnly";class NodesAndLinkedEdges extends GraphHitTestPolicy{constructor(e){super(e)}hit_test(e,t){return this._hit_test(e,t,t.node_view)}get_linked_edges(e,t,i){let n=[];"selection"==i?n=e.selected.indices.map((t=>e.data.index[t])):"inspection"==i&&(n=e.inspected.indices.map((t=>e.data.index[t])));const o=[];for(let s=0;s<t.data.start.length;s++)(contains(n,t.data.start[s])||contains(n,t.data.end[s]))&&o.push(s);const r=new Selection;for(const s of o)r.multiline_indices[s]=[0];return r.indices=o,r}do_selection(e,t,i,n){if(null==e)return!1;const o=t.node_renderer.data_source.selected;o.update(e,i,n);const r=t.edge_renderer.data_source.selected,s=this.get_linked_edges(t.node_renderer.data_source,t.edge_renderer.data_source,"selection");return r.update(s,i,n),t.node_renderer.data_source._select.emit(),!o.is_empty()}do_inspection(e,t,i,n,o){if(null==e)return!1;const r=i.node_view.model.data_source.selection_manager.get_or_create_inspector(i.node_view.model);r.update(e,n,o),i.node_view.model.data_source.setv({inspected:r},{silent:!0});const s=i.edge_view.model.data_source.selection_manager.get_or_create_inspector(i.edge_view.model),a=this.get_linked_edges(i.node_view.model.data_source,i.edge_view.model.data_source,"inspection");return s.update(a,n,o),i.edge_view.model.data_source.setv({inspected:s},{silent:!0}),i.node_view.model.data_source.inspect.emit([i.node_view.model,{geometry:t}]),!r.is_empty()}}NodesAndLinkedEdges.__name__="NodesAndLinkedEdges";class EdgesAndLinkedNodes extends GraphHitTestPolicy{constructor(e){super(e)}hit_test(e,t){return this._hit_test(e,t,t.edge_view)}get_linked_nodes(e,t,i){let n=[];"selection"==i?n=t.selected.indices:"inspection"==i&&(n=t.inspected.indices);const o=[];for(const s of n)o.push(t.data.start[s]),o.push(t.data.end[s]);const r=uniq(o).map((t=>indexOf(e.data.index,t)));return new Selection({indices:r})}do_selection(e,t,i,n){if(null==e)return!1;const o=t.edge_renderer.data_source.selected;o.update(e,i,n);const r=t.node_renderer.data_source.selected,s=this.get_linked_nodes(t.node_renderer.data_source,t.edge_renderer.data_source,"selection");return r.update(s,i,n),t.edge_renderer.data_source._select.emit(),!o.is_empty()}do_inspection(e,t,i,n,o){if(null==e)return!1;const r=i.edge_view.model.data_source.selection_manager.get_or_create_inspector(i.edge_view.model);r.update(e,n,o),i.edge_view.model.data_source.setv({inspected:r},{silent:!0});const s=i.node_view.model.data_source.selection_manager.get_or_create_inspector(i.node_view.model),a=this.get_linked_nodes(i.node_view.model.data_source,i.edge_view.model.data_source,"inspection");return s.update(a,n,o),i.node_view.model.data_source.setv({inspected:s},{silent:!0}),i.edge_view.model.data_source.inspect.emit([i.edge_view.model,{geometry:t}]),!r.is_empty()}}EdgesAndLinkedNodes.__name__="EdgesAndLinkedNodes";class MultiLineView extends GlyphView{_project_data(){inplace.project_xy(this._xs.array,this._ys.array)}_index_data(e){const{data_size:t}=this;for(let i=0;i<t;i++){const t=this._xs.get(i);if(0==t.length){e.add_empty();continue}const n=this._ys.get(i);if(0==n.length){e.add_empty();continue}const[o,r]=minmax(t),[s,a]=minmax(n);e.add(o,s,r,a)}}_render(e,t,i){const{sxs:n,sys:o}=null!=i?i:this;for(const r of t){const t=n.get(r),i=o.get(r),s=Math.min(t.length,i.length);let a=!0;e.beginPath();for(let n=0;n<s;n++){const o=t[n],r=i[n];isFinite(o+r)?a?(e.moveTo(o,r),a=!1):e.lineTo(o,r):a=!0}this.visuals.line.set_vectorize(e,r),e.stroke()}}_hit_point(e){const t={x:e.sx,y:e.sy};let i=9999;const n=new Map;for(let o=0,r=this.sxs.length;o<r;o++){const e=Math.max(2,this.line_width.get(o)/2),r=this.sxs.get(o),s=this.sys.get(o);let a=null;for(let n=0,o=r.length-1;n<o;n++){const o=dist_to_segment(t,{x:r[n],y:s[n]},{x:r[n+1],y:s[n+1]});o<e&&o<i&&(i=o,a=[n])}null!=a&&n.set(o,a)}return new Selection({indices:[...n.keys()],multiline_indices:to_object(n)})}_hit_span(e){const{sx:t,sy:i}=e;let n,o;"v"==e.direction?(n=this.renderer.yscale.invert(i),o=this._ys):(n=this.renderer.xscale.invert(t),o=this._xs);const r=new Map;for(let s=0,a=o.length;s<a;s++){const e=o.get(s),t=[];for(let i=0,o=e.length-1;i<o;i++)e[i]<=n&&n<=e[i+1]&&t.push(i);t.length>0&&r.set(s,t)}return new Selection({indices:[...r.keys()],multiline_indices:to_object(r)})}get_interpolation_hit(e,t,i){const n=this._xs.get(e),o=this._ys.get(e),r=n[t],s=o[t],a=n[t+1],l=o[t+1];return line_interpolation(this.renderer,i,r,s,a,l)}draw_legend_for_index(e,t,i){generic_line_vector_legend(this.visuals,e,t,i)}scenterxy(){throw new Error(`${this}.scenterxy() is not implemented`)}}MultiLineView.__name__="MultiLineView";class MultiLine extends Glyph{constructor(e){super(e)}static init_MultiLine(){this.prototype.default_view=MultiLineView,this.define((({})=>({xs:[XCoordinateSeqSpec,{field:"xs"}],ys:[YCoordinateSeqSpec,{field:"ys"}]}))),this.mixins(LineVector$1)}}MultiLine.__name__="MultiLine",MultiLine.init_MultiLine();class PatchesView extends GlyphView{_project_data(){inplace.project_xy(this._xs.array,this._ys.array)}_index_data(e){const{data_size:t}=this;for(let i=0;i<t;i++){const t=this._xs.get(i),n=this._ys.get(i);if(0==t.length)e.add_empty();else{const[i,o]=minmax(t),[r,s]=minmax(n);e.add(i,r,o,s)}}}_mask_data(){const{x_range:e,y_range:t}=this.renderer.plot_view.frame;return this.index.indices({x0:e.min,x1:e.max,y0:t.min,y1:t.max})}_inner_loop(e,t,i,n){for(let o=0,r=t.length;o<r;o++)0!=o?isNaN(t[o]+i[o])?(e.closePath(),n.apply(e),e.beginPath()):e.lineTo(t[o],i[o]):(e.beginPath(),e.moveTo(t[o],i[o]));e.closePath(),n.call(e)}_render(e,t,i){const{sxs:n,sys:o}=null!=i?i:this;for(const r of t){const t=n.get(r),i=o.get(r);this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,r),this._inner_loop(e,t,i,e.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,r),this._inner_loop(e,t,i,e.fill)),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,r),this._inner_loop(e,t,i,e.stroke))}}_hit_rect(e){const{sx0:t,sx1:i,sy0:n,sy1:o}=e,r=[t,i,i,t],s=[n,n,o,o],[a,l]=this.renderer.xscale.r_invert(t,i),[c,d]=this.renderer.yscale.r_invert(n,o),h=this.index.indices({x0:a,x1:l,y0:c,y1:d}),u=[];for(const p of h){const e=this.sxs.get(p),t=this.sys.get(p);let i=!0;for(let n=0,o=e.length;n<o;n++){if(!point_in_poly(e[n],t[n],r,s)){i=!1;break}}i&&u.push(p)}return new Selection({indices:u})}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i),r=this.index.indices({x0:n,y0:o,x1:n,y1:o}),s=[];for(const a of r){const e=this.sxs.get(a),n=this.sys.get(a),o=e.length;for(let r=0,l=0;;l++){if(isNaN(e[l])||l==o){if(point_in_poly(t,i,e.subarray(r,l),n.subarray(r,l))){s.push(a);break}r=l+1}if(l==o)break}}return new Selection({indices:s})}_get_snap_coord(e){return sum$1(e)/e.length}scenterxy(e,t,i){const n=this.sxs.get(e),o=this.sys.get(e),r=n.length;let s=!1;for(let a=0,l=0;;l++){const e=isNaN(n[l]);if(s=s||e,l==r&&!s){return[this._get_snap_coord(n),this._get_snap_coord(o)]}if(e||l==r){const e=n.subarray(a,l),r=o.subarray(a,l);if(point_in_poly(t,i,e,r)){return[this._get_snap_coord(e),this._get_snap_coord(r)]}a=l+1}if(l==r)break}unreachable()}draw_legend_for_index(e,t,i){generic_area_vector_legend(this.visuals,e,t,i)}}PatchesView.__name__="PatchesView";class Patches extends Glyph{constructor(e){super(e)}static init_Patches(){this.prototype.default_view=PatchesView,this.define((({})=>({xs:[XCoordinateSeqSpec,{field:"xs"}],ys:[YCoordinateSeqSpec,{field:"ys"}]}))),this.mixins([LineVector$1,FillVector$1,HatchVector$1])}}Patches.__name__="Patches",Patches.init_Patches();class GraphRendererView extends DataRendererView{get glyph_view(){return this.node_view.glyph}async lazy_initialize(){await super.lazy_initialize();const e=this.model;let t=null,i=null;const n=new class extends Expression{_v_compute(i){assert(null==t);const[n]=t=e.layout_provider.get_edge_coordinates(i);return n}},o=new class extends Expression{_v_compute(e){assert(null!=t);const[,i]=t;return t=null,i}},r=new class extends Expression{_v_compute(t){assert(null==i);const[n]=i=e.layout_provider.get_node_coordinates(t);return n}},s=new class extends Expression{_v_compute(e){assert(null!=i);const[,t]=i;return i=null,t}},{edge_renderer:a,node_renderer:l}=this.model;if(!(a.glyph instanceof MultiLine||a.glyph instanceof Patches))throw new Error(`${this}.edge_renderer.glyph must be a MultiLine glyph`);if(!(l.glyph instanceof XYGlyph))throw new Error(`${this}.node_renderer.glyph must be a XYGlyph glyph`);a.glyph.properties.xs.internal=!0,a.glyph.properties.ys.internal=!0,l.glyph.properties.x.internal=!0,l.glyph.properties.y.internal=!0,a.glyph.xs={expr:n},a.glyph.ys={expr:o},l.glyph.x={expr:r},l.glyph.y={expr:s};const{parent:c}=this;this.edge_view=await build_view(a,{parent:c}),this.node_view=await build_view(l,{parent:c})}connect_signals(){super.connect_signals(),this.connect(this.model.layout_provider.change,(()=>{this.edge_view.set_data(),this.node_view.set_data(),this.request_render()}))}remove(){this.edge_view.remove(),this.node_view.remove(),super.remove()}_render(){this.edge_view.render(),this.node_view.render()}renderer_view(e){if(e instanceof GlyphRenderer){if(e==this.edge_view.model)return this.edge_view;if(e==this.node_view.model)return this.node_view}return super.renderer_view(e)}}GraphRendererView.__name__="GraphRendererView";class GraphRenderer extends DataRenderer{constructor(e){super(e)}static init_GraphRenderer(){this.prototype.default_view=GraphRendererView,this.define((({Ref:e})=>({layout_provider:[e(LayoutProvider)],node_renderer:[e(GlyphRenderer)],edge_renderer:[e(GlyphRenderer)],selection_policy:[e(GraphHitTestPolicy),()=>new NodesOnly],inspection_policy:[e(GraphHitTestPolicy),()=>new NodesOnly]})))}get_selection_manager(){return this.node_renderer.data_source.selection_manager}}GraphRenderer.__name__="GraphRenderer",GraphRenderer.init_GraphRenderer();class SelectionManager extends HasProps{constructor(e){super(e),this.inspectors=new Map}static init_SelectionManager(){this.internal((({AnyRef:e})=>({source:[e()]})))}select(e,t,i,n="replace"){const o=[],r=[];for(const a of e)a instanceof GlyphRendererView?o.push(a):a instanceof GraphRendererView&&r.push(a);let s=!1;for(const a of r){const e=a.model.selection_policy.hit_test(t,a);s=s||a.model.selection_policy.do_selection(e,a.model,i,n)}if(o.length>0){const e=this.source.selection_policy.hit_test(t,o);s=s||this.source.selection_policy.do_selection(e,this.source,i,n)}return s}inspect(e,t){let i=!1;if(e instanceof GlyphRendererView){const n=e.hit_test(t);if(null!=n){i=!n.is_empty();const o=this.get_or_create_inspector(e.model);o.update(n,!0,"replace"),this.source.setv({inspected:o},{silent:!0}),this.source.inspect.emit([e.model,{geometry:t}])}}else if(e instanceof GraphRendererView){const n=e.model.inspection_policy.hit_test(t,e);i=i||e.model.inspection_policy.do_inspection(n,t,e,!1,"replace")}return i}clear(e){this.source.selected.clear(),null!=e&&this.get_or_create_inspector(e.model).clear()}get_or_create_inspector(e){let t=this.inspectors.get(e);return null==t&&(t=new Selection,this.inspectors.set(e,t)),t}}SelectionManager.__name__="SelectionManager",SelectionManager.init_SelectionManager();class SelectionPolicy extends Model{do_selection(e,t,i,n){return null!=e&&(t.selected.update(e,i,n),t._select.emit(),!t.selected.is_empty())}}SelectionPolicy.__name__="SelectionPolicy";class IntersectRenderers extends SelectionPolicy{hit_test(e,t){const i=[];for(const n of t){const t=n.hit_test(e);null!=t&&i.push(t)}if(i.length>0){const e=i[0];for(const t of i)e.update_through_intersection(t);return e}return null}}IntersectRenderers.__name__="IntersectRenderers";class UnionRenderers extends SelectionPolicy{hit_test(e,t){const i=[];for(const n of t){const t=n.hit_test(e);null!=t&&i.push(t)}if(i.length>0){const e=i[0];for(const t of i)e.update_through_union(t);return e}return null}}UnionRenderers.__name__="UnionRenderers";class ColumnarDataSource extends DataSource{constructor(e){super(e)}get_array(e){let t=this.data[e];return null==t?this.data[e]=t=[]:isArray(t)||(this.data[e]=t=Array.from(t)),t}static init_ColumnarDataSource(){this.define((({Ref:e})=>({selection_policy:[e(SelectionPolicy),()=>new UnionRenderers]}))),this.internal((({AnyRef:e})=>({selection_manager:[e(),e=>new SelectionManager({source:e})],inspected:[e(),()=>new Selection]})))}initialize(){super.initialize(),this._select=new Signal0(this,"select"),this.inspect=new Signal(this,"inspect"),this.streaming=new Signal0(this,"streaming"),this.patching=new Signal(this,"patching")}get_column(e){const t=this.data[e];return null!=t?t:null}columns(){return keys(this.data)}get_length(e=!0){const t=uniq(values(this.data).map((e=>is_NDArray(e)?e.shape[0]:e.length)));switch(t.length){case 0:return null;case 1:return t[0];default:{const i="data source has columns of inconsistent lengths";if(e)return logger.warn(i),t.sort()[0];throw new Error(i)}}}get length(){var e;return null!=(e=this.get_length())?e:0}clear(){const e={};for(const t of this.columns())e[t]=new this.data[t].constructor(0);this.data=e}}function concat(e,...t){let i=e.length;for(const r of t)i+=r.length;const n=new e.constructor(i);n.set(e,0);let o=e.length;for(const r of t)n.set(r,o),o+=r.length;return n}function union(...e){const t=new Set;for(const i of e)for(const e of i)t.add(e);return t}function difference(e,...t){const i=new Set(e);for(const n of union(...t))i.delete(n);return i}function stream_to_column(e,t,i){if(isArray(e)){const n=e.concat(t);return null!=i&&n.length>i?n.slice(-i):n}if(isTypedArray(e)){const n=e.length+t.length;if(null!=i&&n>i){const o=n-i,r=e.length;let s;e.length<i?(s=new e.constructor(i),s.set(e,0)):s=e;for(let e=o,t=r;e<t;e++)s[e-o]=s[e];for(let e=0,i=t.length;e<i;e++)s[e+(r-o)]=t[e];return s}{const i=new e.constructor(t);return concat(e,i)}}throw new Error("unsupported array types")}function slice$1(e,t){let i,n,o;return isNumber(e)?(i=e,o=e+1,n=1):(i=null!=e.start?e.start:0,o=null!=e.stop?e.stop:t,n=null!=e.step?e.step:1),[i,o,n]}function patch_to_column(e,t){const i=new Set;let n=!1;for(const[o,r]of t){let t,s,a,l;if(isArray(o)){const[n]=o;i.add(n),t=e[n].shape,s=e[n],l=r,2===o.length?(t=[1,t[0]],a=[o[0],0,o[1]]):a=o}else isNumber(o)?(l=[r],i.add(o)):(l=r,n=!0),a=[0,0,o],t=[1,e.length],s=e;let c=0;const[d,h,u]=slice$1(a[1],t[0]),[p,_,f]=slice$1(a[2],t[1]);for(let e=d;e<h;e+=u)for(let o=p;o<_;o+=f)n&&i.add(o),s[e*t[1]+o]=l[c],c++}return i}ColumnarDataSource.__name__="ColumnarDataSource",ColumnarDataSource.init_ColumnarDataSource();class ColumnDataSource extends ColumnarDataSource{constructor(e){super(e)}static init_ColumnDataSource(){this.define((({Dict:e,Any:t})=>({data:[e(t),{}]})))}stream(e,t,i){const{data:n}=this;for(const[o,r]of entries(e))n[o]=stream_to_column(n[o],r,t);if(this.setv({data:n},{silent:!0}),this.streaming.emit(),null!=this.document){const n=new ColumnsStreamedEvent(this.document,this.ref(),e,t);this.document._notify_change(this,"data",null,null,{setter_id:i,hint:n})}}patch(e,t){const{data:i}=this;let n=new Set;for(const[o,r]of entries(e))n=union(n,patch_to_column(i[o],r));if(this.setv({data:i},{silent:!0}),this.patching.emit([...n]),null!=this.document){const i=new ColumnsPatchedEvent(this.document,this.ref(),e);this.document._notify_change(this,"data",null,null,{setter_id:t,hint:i})}}}ColumnDataSource.__name__="ColumnDataSource",ColumnDataSource.init_ColumnDataSource();class DataAnnotationView extends AnnotationView{constructor(){super(...arguments),this._initial_set_data=!1}connect_signals(){super.connect_signals();const e=()=>{this.set_data(this.model.source),this.request_render()};this.connect(this.model.change,e),this.connect(this.model.source.streaming,e),this.connect(this.model.source.patching,e),this.connect(this.model.source.change,e)}set_data(e){const t=this;for(const i of this.model)if(i instanceof VectorSpec||i instanceof ScalarSpec)if(i instanceof BaseCoordinateSpec){const n=i.array(e);t[`_${i.attr}`]=n}else{const n=i.uniform(e);t[`${i.attr}`]=n}this.plot_model.use_map&&(null!=t._x&&inplace.project_xy(t._x,t._y),null!=t._xs&&inplace.project_xsys(t._xs,t._ys));for(const i of this.visuals)i.update()}_render(){this._initial_set_data||(this.set_data(this.model.source),this._initial_set_data=!0),this.map_data(),this.paint(this.layer.ctx)}}DataAnnotationView.__name__="DataAnnotationView";class DataAnnotation extends Annotation{constructor(e){super(e)}static init_DataAnnotation(){this.define((({Ref:e})=>({source:[e(ColumnarDataSource),()=>new ColumnDataSource]})))}}DataAnnotation.__name__="DataAnnotation",DataAnnotation.init_DataAnnotation();class ArrowHeadView extends View{initialize(){super.initialize(),this.visuals=new Visuals(this)}request_render(){this.parent.request_render()}get canvas(){return this.parent.canvas}set_data(e){const t=this;for(const i of this.model){if(!(i instanceof VectorSpec||i instanceof ScalarSpec))continue;const n=i.uniform(e);t[`${i.attr}`]=n}}}ArrowHeadView.__name__="ArrowHeadView";class ArrowHead extends Model{constructor(e){super(e)}static init_ArrowHead(){this.define((()=>({size:[NumberSpec,25]})))}}ArrowHead.__name__="ArrowHead",ArrowHead.init_ArrowHead();class OpenHeadView extends ArrowHeadView{clip(e,t){this.visuals.line.set_vectorize(e,t);const i=this.size.get(t);e.moveTo(.5*i,i),e.lineTo(.5*i,-2),e.lineTo(-.5*i,-2),e.lineTo(-.5*i,i),e.lineTo(0,0),e.lineTo(.5*i,i)}render(e,t){if(this.visuals.line.doit){this.visuals.line.set_vectorize(e,t);const i=this.size.get(t);e.beginPath(),e.moveTo(.5*i,i),e.lineTo(0,0),e.lineTo(-.5*i,i),e.stroke()}}}OpenHeadView.__name__="OpenHeadView";class OpenHead extends ArrowHead{constructor(e){super(e)}static init_OpenHead(){this.prototype.default_view=OpenHeadView,this.mixins(LineVector$1)}}OpenHead.__name__="OpenHead",OpenHead.init_OpenHead();class NormalHeadView extends ArrowHeadView{clip(e,t){this.visuals.line.set_vectorize(e,t);const i=this.size.get(t);e.moveTo(.5*i,i),e.lineTo(.5*i,-2),e.lineTo(-.5*i,-2),e.lineTo(-.5*i,i),e.lineTo(.5*i,i)}render(e,t){this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,t),this._normal(e,t),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,t),this._normal(e,t),e.stroke())}_normal(e,t){const i=this.size.get(t);e.beginPath(),e.moveTo(.5*i,i),e.lineTo(0,0),e.lineTo(-.5*i,i),e.closePath()}}NormalHeadView.__name__="NormalHeadView";class NormalHead extends ArrowHead{constructor(e){super(e)}static init_NormalHead(){this.prototype.default_view=NormalHeadView,this.mixins([LineVector$1,FillVector$1]),this.override({fill_color:"black"})}}NormalHead.__name__="NormalHead",NormalHead.init_NormalHead();class VeeHeadView extends ArrowHeadView{clip(e,t){this.visuals.line.set_vectorize(e,t);const i=this.size.get(t);e.moveTo(.5*i,i),e.lineTo(.5*i,-2),e.lineTo(-.5*i,-2),e.lineTo(-.5*i,i),e.lineTo(0,.5*i),e.lineTo(.5*i,i)}render(e,t){this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,t),this._vee(e,t),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,t),this._vee(e,t),e.stroke())}_vee(e,t){const i=this.size.get(t);e.beginPath(),e.moveTo(.5*i,i),e.lineTo(0,0),e.lineTo(-.5*i,i),e.lineTo(0,.5*i),e.closePath()}}VeeHeadView.__name__="VeeHeadView";class VeeHead extends ArrowHead{constructor(e){super(e)}static init_VeeHead(){this.prototype.default_view=VeeHeadView,this.mixins([LineVector$1,FillVector$1]),this.override({fill_color:"black"})}}VeeHead.__name__="VeeHead",VeeHead.init_VeeHead();class TeeHeadView extends ArrowHeadView{render(e,t){if(this.visuals.line.doit){this.visuals.line.set_vectorize(e,t);const i=this.size.get(t);e.beginPath(),e.moveTo(.5*i,0),e.lineTo(-.5*i,0),e.stroke()}}clip(e,t){}}TeeHeadView.__name__="TeeHeadView";class TeeHead extends ArrowHead{constructor(e){super(e)}static init_TeeHead(){this.prototype.default_view=TeeHeadView,this.mixins(LineVector$1)}}TeeHead.__name__="TeeHead",TeeHead.init_TeeHead();class ArrowView extends DataAnnotationView{async lazy_initialize(){await super.lazy_initialize();const{start:e,end:t}=this.model;null!=e&&(this.start=await build_view(e,{parent:this})),null!=t&&(this.end=await build_view(t,{parent:this}))}set_data(e){var t,i;super.set_data(e),null==(t=this.start)||t.set_data(e),null==(i=this.end)||i.set_data(e)}remove(){var e,t;null==(e=this.start)||e.remove(),null==(t=this.end)||t.remove(),super.remove()}map_data(){const{frame:e}=this.plot_view;"data"==this.model.start_units?(this._sx_start=this.coordinates.x_scale.v_compute(this._x_start),this._sy_start=this.coordinates.y_scale.v_compute(this._y_start)):(this._sx_start=e.bbox.xview.v_compute(this._x_start),this._sy_start=e.bbox.yview.v_compute(this._y_start)),"data"==this.model.end_units?(this._sx_end=this.coordinates.x_scale.v_compute(this._x_end),this._sy_end=this.coordinates.y_scale.v_compute(this._y_end)):(this._sx_end=e.bbox.xview.v_compute(this._x_end),this._sy_end=e.bbox.yview.v_compute(this._y_end));const{_sx_start:t,_sy_start:i,_sx_end:n,_sy_end:o}=this,r=t.length,s=this._angles=new ScreenArray(r);for(let a=0;a<r;a++)s[a]=Math.PI/2+atan2([t[a],i[a]],[n[a],o[a]])}paint(e){const{start:t,end:i}=this,{_sx_start:n,_sy_start:o,_sx_end:r,_sy_end:s,_angles:a}=this,{x:l,y:c,width:d,height:h}=this.plot_view.frame.bbox;for(let u=0,p=n.length;u<p;u++)null!=i&&(e.save(),e.translate(r[u],s[u]),e.rotate(a[u]),i.render(e,u),e.restore()),null!=t&&(e.save(),e.translate(n[u],o[u]),e.rotate(a[u]+Math.PI),t.render(e,u),e.restore()),this.visuals.line.doit&&(e.save(),null==t&&null==i||(e.beginPath(),e.rect(l,c,d,h),null!=i&&(e.save(),e.translate(r[u],s[u]),e.rotate(a[u]),i.clip(e,u),e.restore()),null!=t&&(e.save(),e.translate(n[u],o[u]),e.rotate(a[u]+Math.PI),t.clip(e,u),e.restore()),e.closePath(),e.clip()),this.visuals.line.set_vectorize(e,u),e.beginPath(),e.moveTo(n[u],o[u]),e.lineTo(r[u],s[u]),e.stroke(),e.restore())}}ArrowView.__name__="ArrowView";class Arrow extends DataAnnotation{constructor(e){super(e)}static init_Arrow(){this.prototype.default_view=ArrowView,this.mixins(LineVector$1),this.define((({Ref:e,Nullable:t})=>({x_start:[XCoordinateSpec,{field:"x_start"}],y_start:[YCoordinateSpec,{field:"y_start"}],start_units:[SpatialUnits,"data"],start:[t(e(ArrowHead)),null],x_end:[XCoordinateSpec,{field:"x_end"}],y_end:[YCoordinateSpec,{field:"y_end"}],end_units:[SpatialUnits,"data"],end:[t(e(ArrowHead)),()=>new OpenHead]})))}}Arrow.__name__="Arrow",Arrow.init_Arrow();class UpperLowerView extends DataAnnotationView{map_data(){const{frame:e}=this.plot_view,t=this.model.dimension,i=this.coordinates.x_scale,n=this.coordinates.y_scale,o="height"==t?n:i,r="height"==t?i:n,s="height"==t?e.bbox.yview:e.bbox.xview,a="height"==t?e.bbox.xview:e.bbox.yview;let l,c,d;l="data"==this.model.properties.lower.units?o.v_compute(this._lower):s.v_compute(this._lower),c="data"==this.model.properties.upper.units?o.v_compute(this._upper):s.v_compute(this._upper),d="data"==this.model.properties.base.units?r.v_compute(this._base):a.v_compute(this._base);const[h,u]="height"==t?[1,0]:[0,1],p=[l,d],_=[c,d];this._lower_sx=p[h],this._lower_sy=p[u],this._upper_sx=_[h],this._upper_sy=_[u]}}UpperLowerView.__name__="UpperLowerView";class XOrYCoordinateSpec extends CoordinateSpec{get dimension(){return"width"==this.obj.dimension?"x":"y"}get units(){var e;return null!=(e=this.spec.units)?e:"data"}}XOrYCoordinateSpec.__name__="XOrYCoordinateSpec";class UpperLower extends DataAnnotation{constructor(e){super(e)}static init_UpperLower(){this.define((()=>({dimension:[Dimension,"height"],lower:[XOrYCoordinateSpec,{field:"lower"}],upper:[XOrYCoordinateSpec,{field:"upper"}],base:[XOrYCoordinateSpec,{field:"base"}]})))}}UpperLower.__name__="UpperLower",UpperLower.init_UpperLower();class BandView extends UpperLowerView{paint(e){e.beginPath(),e.moveTo(this._lower_sx[0],this._lower_sy[0]);for(let t=0,i=this._lower_sx.length;t<i;t++)e.lineTo(this._lower_sx[t],this._lower_sy[t]);for(let t=this._upper_sx.length-1;t>=0;t--)e.lineTo(this._upper_sx[t],this._upper_sy[t]);e.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_value(e),e.fill()),e.beginPath(),e.moveTo(this._lower_sx[0],this._lower_sy[0]);for(let t=0,i=this._lower_sx.length;t<i;t++)e.lineTo(this._lower_sx[t],this._lower_sy[t]);this.visuals.line.doit&&(this.visuals.line.set_value(e),e.stroke()),e.beginPath(),e.moveTo(this._upper_sx[0],this._upper_sy[0]);for(let t=0,i=this._upper_sx.length;t<i;t++)e.lineTo(this._upper_sx[t],this._upper_sy[t]);this.visuals.line.doit&&(this.visuals.line.set_value(e),e.stroke())}}BandView.__name__="BandView";class Band extends UpperLower{constructor(e){super(e)}static init_Band(){this.prototype.default_view=BandView,this.mixins([Line$2,Fill$1]),this.override({fill_color:"#fff9ba",fill_alpha:.4,line_color:"#cccccc",line_alpha:.3})}}Band.__name__="Band",Band.init_Band();const EDGE_TOLERANCE=2.5;class BoxAnnotationView extends AnnotationView{constructor(){super(...arguments),this.bbox=new BBox}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_render(){const{left:e,right:t,top:i,bottom:n}=this.model;if(null==e&&null==t&&null==i&&null==n)return;const{frame:o}=this.plot_view,r=this.coordinates.x_scale,s=this.coordinates.y_scale,a=(e,t,i,n,o)=>{let r;return r=null!=e?this.model.screen?e:"data"==t?i.compute(e):n.compute(e):o,r};this.bbox=BBox.from_rect({left:a(e,this.model.left_units,r,o.bbox.xview,o.bbox.left),right:a(t,this.model.right_units,r,o.bbox.xview,o.bbox.right),top:a(i,this.model.top_units,s,o.bbox.yview,o.bbox.top),bottom:a(n,this.model.bottom_units,s,o.bbox.yview,o.bbox.bottom)}),this._paint_box()}_paint_box(){const{ctx:e}=this.layer;e.save();const{left:t,top:i,width:n,height:o}=this.bbox;e.beginPath(),e.rect(t,i,n,o),this.visuals.fill.doit&&(this.visuals.fill.set_value(e),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(e),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_value(e),e.stroke()),e.restore()}interactive_bbox(){const e=this.model.line_width+EDGE_TOLERANCE;return this.bbox.grow_by(e)}interactive_hit(e,t){if(null==this.model.in_cursor)return!1;return this.interactive_bbox().contains(e,t)}cursor(e,t){const{left:i,right:n,bottom:o,top:r}=this.bbox;return Math.abs(e-i)<3||Math.abs(e-n)<3?this.model.ew_cursor:Math.abs(t-o)<3||Math.abs(t-r)<3?this.model.ns_cursor:this.bbox.contains(e,t)?this.model.in_cursor:null}}BoxAnnotationView.__name__="BoxAnnotationView";class BoxAnnotation extends Annotation{constructor(e){super(e)}static init_BoxAnnotation(){this.prototype.default_view=BoxAnnotationView,this.mixins([Line$2,Fill$1,Hatch$1]),this.define((({Number:e,Nullable:t})=>({top:[t(e),null],top_units:[SpatialUnits,"data"],bottom:[t(e),null],bottom_units:[SpatialUnits,"data"],left:[t(e),null],left_units:[SpatialUnits,"data"],right:[t(e),null],right_units:[SpatialUnits,"data"],render_mode:[RenderMode,"canvas"]}))),this.internal((({Boolean:e,String:t,Nullable:i})=>({screen:[e,!1],ew_cursor:[i(t),null],ns_cursor:[i(t),null],in_cursor:[i(t),null]}))),this.override({fill_color:"#fff9ba",fill_alpha:.4,line_color:"#cccccc",line_alpha:.3})}update({left:e,right:t,top:i,bottom:n}){this.setv({left:e,right:t,top:i,bottom:n,screen:!0})}}BoxAnnotation.__name__="BoxAnnotation",BoxAnnotation.init_BoxAnnotation();const{min:min$3,max:max$4}=Math;class Sizeable{constructor(e={}){this.width=null!=e.width?e.width:0,this.height=null!=e.height?e.height:0}bounded_to({width:e,height:t}){return new Sizeable({width:this.width==1/0&&null!=e?e:this.width,height:this.height==1/0&&null!=t?t:this.height})}expanded_to({width:e,height:t}){return new Sizeable({width:e!=1/0?max$4(this.width,e):this.width,height:t!=1/0?max$4(this.height,t):this.height})}expand_to({width:e,height:t}){this.width=max$4(this.width,e),this.height=max$4(this.height,t)}narrowed_to({width:e,height:t}){return new Sizeable({width:min$3(this.width,e),height:min$3(this.height,t)})}narrow_to({width:e,height:t}){this.width=min$3(this.width,e),this.height=min$3(this.height,t)}grow_by({left:e,right:t,top:i,bottom:n}){const o=this.width+e+t,r=this.height+i+n;return new Sizeable({width:o,height:r})}shrink_by({left:e,right:t,top:i,bottom:n}){const o=max$4(this.width-e-t,0),r=max$4(this.height-i-n,0);return new Sizeable({width:o,height:r})}map(e,t){return new Sizeable({width:e(this.width),height:(null!=t?t:e)(this.height)})}}Sizeable.__name__="Sizeable";const SizingPolicy=Enum("fixed","fit","min","max"),{min:min$2,max:max$3,round:round$2}=Math;class Layoutable{constructor(){this.absolute=!1,this._bbox=new BBox,this._inner_bbox=new BBox,this._dirty=!1,this._handlers=[]}*[Symbol.iterator](){}get bbox(){return this._bbox}get inner_bbox(){return this._inner_bbox}get sizing(){return this._sizing}set visible(e){this._sizing.visible=e,this._dirty=!0}set_sizing(e){var t,i,n,o,r;const s=null!=(t=e.width_policy)?t:"fit",a=e.width,l=e.min_width,c=e.max_width,d=null!=(i=e.height_policy)?i:"fit",h=e.height,u=e.min_height,p=e.max_height,_=e.aspect,f=null!=(n=e.margin)?n:{top:0,right:0,bottom:0,left:0},g=!1!==e.visible,m=null!=(o=e.halign)?o:"start",v=null!=(r=e.valign)?r:"start";this._sizing={width_policy:s,min_width:l,width:a,max_width:c,height_policy:d,min_height:u,height:h,max_height:p,aspect:_,margin:f,visible:g,halign:m,valign:v,size:{width:a,height:h}},this._init()}_init(){}_set_geometry(e,t){this._bbox=e,this._inner_bbox=t}set_geometry(e,t){const{fixup_geometry:i}=this;null!=i&&([e,t]=i(e,t)),this._set_geometry(e,null!=t?t:e);for(const n of this._handlers)n(this._bbox,this._inner_bbox)}on_resize(e){this._handlers.push(e)}is_width_expanding(){return"max"==this.sizing.width_policy}is_height_expanding(){return"max"==this.sizing.height_policy}apply_aspect(e,{width:t,height:i}){const{aspect:n}=this.sizing;if(null!=n){const{width_policy:o,height_policy:r}=this.sizing,s=(e,t)=>{const i={max:4,fit:3,min:2,fixed:1};return i[e]>i[t]};if("fixed"!=o&&"fixed"!=r)if(o==r){const o=t,r=round$2(t/n),s=round$2(i*n),a=i;Math.abs(e.width-o)+Math.abs(e.height-r)<=Math.abs(e.width-s)+Math.abs(e.height-a)?(t=o,i=r):(t=s,i=a)}else s(o,r)?i=round$2(t/n):t=round$2(i*n);else"fixed"==o?i=round$2(t/n):"fixed"==r&&(t=round$2(i*n))}return{width:t,height:i}}measure(e){if(!this.sizing.visible)return{width:0,height:0};const t=e=>"fixed"==this.sizing.width_policy&&null!=this.sizing.width?this.sizing.width:e,i=e=>"fixed"==this.sizing.height_policy&&null!=this.sizing.height?this.sizing.height:e,n=new Sizeable(e).shrink_by(this.sizing.margin).map(t,i),o=this._measure(n),r=this.clip_size(o,n),s=t(r.width),a=i(r.height),l=this.apply_aspect(n,{width:s,height:a});return __spreadValues(__spreadValues({},o),l)}compute(e={}){const t=this.measure({width:null!=e.width&&this.is_width_expanding()?e.width:1/0,height:null!=e.height&&this.is_height_expanding()?e.height:1/0}),{width:i,height:n}=t,o=new BBox({left:0,top:0,width:i,height:n});let r;if(null!=t.inner){const{left:e,top:o,right:s,bottom:a}=t.inner;r=new BBox({left:e,top:o,right:i-s,bottom:n-a})}this.set_geometry(o,r)}get xview(){return this.bbox.xview}get yview(){return this.bbox.yview}clip_size(e,t){function i(e,t,i,n){return null==i?i=0:isNumber(i)||(i=Math.round(i.percent*t)),null==n?n=1/0:isNumber(n)||(n=Math.round(n.percent*t)),max$3(i,min$2(e,n))}return{width:i(e.width,t.width,this.sizing.min_width,this.sizing.max_width),height:i(e.height,t.height,this.sizing.min_height,this.sizing.max_height)}}has_size_changed(){const{_dirty:e}=this;return this._dirty=!1,e}}Layoutable.__name__="Layoutable";class LayoutItem extends Layoutable{_measure(e){const{width_policy:t,height_policy:i}=this.sizing;return{width:(()=>{const{width:i}=this.sizing;if(e.width==1/0)return null!=i?i:0;switch(t){case"fixed":return null!=i?i:0;case"min":return null!=i?min$2(e.width,i):0;case"fit":return null!=i?min$2(e.width,i):e.width;case"max":return null!=i?max$3(e.width,i):e.width}})(),height:(()=>{const{height:t}=this.sizing;if(e.height==1/0)return null!=t?t:0;switch(i){case"fixed":return null!=t?t:0;case"min":return null!=t?min$2(e.height,t):0;case"fit":return null!=t?min$2(e.height,t):e.height;case"max":return null!=t?max$3(e.height,t):e.height}})()}}}LayoutItem.__name__="LayoutItem";class ContentLayoutable extends Layoutable{_measure(e){const t=this._content_size(),i=e.bounded_to(this.sizing.size).bounded_to(t);return{width:(()=>{switch(this.sizing.width_policy){case"fixed":return null!=this.sizing.width?this.sizing.width:t.width;case"min":return t.width;case"fit":return i.width;case"max":return Math.max(t.width,i.width)}})(),height:(()=>{switch(this.sizing.height_policy){case"fixed":return null!=this.sizing.height?this.sizing.height:t.height;case"min":return t.height;case"fit":return i.height;case"max":return Math.max(t.height,i.height)}})()}}}ContentLayoutable.__name__="ContentLayoutable";const pi2=Math.PI/2,_angle_lookup={above:{parallel:0,normal:-pi2,horizontal:0,vertical:-pi2},below:{parallel:0,normal:pi2,horizontal:0,vertical:pi2},left:{parallel:-pi2,normal:0,horizontal:0,vertical:-pi2},right:{parallel:pi2,normal:0,horizontal:0,vertical:pi2}},_vertical_align_lookup={above:{parallel:"bottom",normal:"center",horizontal:"bottom",vertical:"center"},below:{parallel:"top",normal:"center",horizontal:"top",vertical:"center"},left:{parallel:"bottom",normal:"center",horizontal:"center",vertical:"bottom"},right:{parallel:"bottom",normal:"center",horizontal:"center",vertical:"bottom"}},_align_lookup={above:{parallel:"center",normal:"left",horizontal:"center",vertical:"left"},below:{parallel:"center",normal:"left",horizontal:"center",vertical:"left"},left:{parallel:"center",normal:"right",horizontal:"right",vertical:"center"},right:{parallel:"center",normal:"left",horizontal:"left",vertical:"center"}},_align_lookup_negative={above:"right",below:"left",left:"right",right:"left"},_align_lookup_positive={above:"left",below:"right",left:"right",right:"left"};class Panel$1{constructor(e){this.side=e}get dimension(){return"above"==this.side||"below"==this.side?0:1}get normals(){switch(this.side){case"above":return[0,-1];case"below":return[0,1];case"left":return[-1,0];case"right":return[1,0]}}get orientation(){return this.is_horizontal?"horizontal":"vertical"}get is_horizontal(){return 0==this.dimension}get is_vertical(){return 1==this.dimension}get_label_text_heuristics(e){const{side:t}=this;return isString(e)?{vertical_align:_vertical_align_lookup[t][e],align:_align_lookup[t][e]}:{vertical_align:"center",align:(e<0?_align_lookup_negative:_align_lookup_positive)[t]}}get_label_angle_heuristic(e){return isString(e)?_angle_lookup[this.side][e]:-e}}Panel$1.__name__="Panel";class SideLayout extends ContentLayoutable{constructor(e,t,i=!1){super(),this.panel=e,this.get_size=t,this.rotate=i,this.panel.is_horizontal?this.set_sizing({width_policy:"max",height_policy:"fixed"}):this.set_sizing({width_policy:"fixed",height_policy:"max"})}_content_size(){const{width:e,height:t}=this.get_size();return!this.rotate||this.panel.is_horizontal?new Sizeable({width:e,height:t}):new Sizeable({width:t,height:e})}has_size_changed(){const{width:e,height:t}=this._content_size();return this.panel.is_horizontal?this.bbox.height!=t:this.bbox.width!=e}}SideLayout.__name__="SideLayout";const has_OffscreenCanvas=(()=>{try{return"undefined"!=typeof OffscreenCanvas&&null!=new OffscreenCanvas(0,0).getContext("2d")}catch{return!1}})(),_offscreen_canvas=has_OffscreenCanvas?(e,t)=>new OffscreenCanvas(e,t):(e,t)=>{const i=document.createElement("canvas");return i.width=e,i.height=t,i},_native_font_metrics=(()=>{const e=_offscreen_canvas(0,0).getContext("2d");return t=>{e.font=t;const i=e.measureText("M"),n=e.measureText("x"),o=e.measureText("g|"),r=o.fontBoundingBoxAscent,s=o.fontBoundingBoxDescent;if(null!=r&&null!=s)return{height:r+s,ascent:r,descent:s,cap_height:i.actualBoundingBoxAscent,x_height:n.actualBoundingBoxAscent};const a=o.actualBoundingBoxAscent,l=o.actualBoundingBoxDescent;if(null!=a&&null!=l)return{height:a+l,ascent:a,descent:l,cap_height:i.actualBoundingBoxAscent,x_height:n.actualBoundingBoxAscent};unreachable()}})(),_native_glyph_metrics=(()=>{const e=_offscreen_canvas(0,0).getContext("2d");return(t,i)=>{e.font=i;const n=e.measureText(t),o=n.actualBoundingBoxAscent,r=n.actualBoundingBoxDescent;if(null!=o&&null!=r)return{width:n.width,height:o+r,ascent:o,descent:r};unreachable()}})(),_internal_font_metrics=(()=>{const e=document.createElement("canvas"),t=e.getContext("2d");let i=-1,n=-1;return(o,r=1)=>{t.font=o;const{width:s}=t.measureText("M"),a=s*r,l=Math.ceil(a),c=Math.ceil(2*a),d=Math.ceil(1.5*a);i<l&&(i=l,e.width=l),n<c&&(n=c,e.height=c),t.save(),t.scale(r,r),t.fillStyle="#f00",t.fillRect(0,0,l,c);const h=e=>{let t=0;for(let i=0;i<=d;i++)for(let n=0;n<l;n++,t+=4)if(255!=e[t])return d-i;return 0};t.font=o,t.fillStyle="#000";for(const e of"xa")t.fillText(e,0,d/r);const{data:u}=t.getImageData(0,0,l,c),p=h(u)/r;for(const e of"ASQ")t.fillText(e,0,d/r);const{data:_}=t.getImageData(0,0,l,c),f=h(_)/r;for(const e of"gy")t.fillText(e,0,d/r);const{data:g}=t.getImageData(0,0,l,c),m=h(g)/r,v=(e=>{let t=e.length-4;for(let i=c;i>=d;i--)for(let n=0;n<l;n++,t-=4)if(255!=e[t])return i-d;return 0})(g)/r;return t.restore(),{height:m+v,ascent:m,cap_height:f,x_height:p,descent:v}}})(),_internal_glyph_metrics=(()=>{const e=document.createElement("canvas"),t=e.getContext("2d");let i=-1,n=-1;return(o,r,s=1)=>{t.font=r;const{width:a}=t.measureText("M"),l=a*s,c=Math.ceil(l),d=Math.ceil(2*l),h=Math.ceil(1.5*l);(i<c||n<d)&&(i=c,e.width=c,n=d,e.height=d),t.save(),t.scale(s,s),t.fillStyle="#f00",t.fillRect(0,0,c,d);t.font=r,t.fillStyle="#000",t.fillText(o,0,h/s);const u=t.measureText(o),{data:p}=t.getImageData(0,0,c,d),_=(e=>{let t=0;for(let i=0;i<=h;i++)for(let n=0;n<c;n++,t+=4)if(255!=e[t])return h-i;return 0})(p)/s,f=(e=>{let t=e.length-4;for(let i=d;i>=h;i--)for(let n=0;n<c;n++,t-=4)if(255!=e[t])return i-h;return 0})(p)/s;return t.restore(),{width:u.width,height:_+f,ascent:_,descent:f}}})(),_font_metrics=(()=>{try{return _native_font_metrics("normal 10px sans-serif"),_native_font_metrics}catch{return _internal_font_metrics}})();(()=>{try{_native_glyph_metrics("A","normal 10px sans-serif")}catch{return _internal_glyph_metrics}})();const _metrics_cache=new Map;function font_metrics(e){let t=_metrics_cache.get(e);return null==t&&(t={font:_font_metrics(e),glyphs:new Map},_metrics_cache.set(e,t)),t.font}function parse_css_font_size(e){const t=e.match(/^\s*(\d+(\.\d+)?)(\w+)\s*$/);if(null!=t){const[,e,,i]=t,n=Number(e);if(isFinite(n))return{value:n,unit:i}}return null}class TextAnnotationView extends AnnotationView{update_layout(){const{panel:e}=this;this.layout=null!=e?new SideLayout(e,(()=>this.get_size()),!0):void 0}initialize(){super.initialize(),"css"==this.model.render_mode&&(this.el=div(),this.plot_view.canvas_view.add_overlay(this.el))}remove(){null!=this.el&&remove(this.el),super.remove()}connect_signals(){super.connect_signals(),"css"==this.model.render_mode?this.connect(this.model.change,(()=>this.render())):this.connect(this.model.change,(()=>this.request_render()))}render(){this.model.visible||"css"!=this.model.render_mode||undisplay(this.el),super.render()}_calculate_text_dimensions(e,t){const{width:i}=e.measureText(t),{height:n}=font_metrics(this.visuals.text.font_value());return[i,n]}_calculate_bounding_box_dimensions(e,t){const[i,n]=this._calculate_text_dimensions(e,t);let o,r;switch(e.textAlign){case"left":o=0;break;case"center":o=-i/2;break;case"right":o=-i;break;default:unreachable()}switch(e.textBaseline){case"top":r=0;break;case"middle":r=-.5*n;break;case"bottom":r=-1*n;break;case"alphabetic":r=-.8*n;break;case"hanging":r=-.17*n;break;case"ideographic":r=-.83*n;break;default:unreachable()}return[o,r,i,n]}_canvas_text(e,t,i,n,o){this.visuals.text.set_value(e);const r=this._calculate_bounding_box_dimensions(e,t);e.save(),e.beginPath(),e.translate(i,n),o&&e.rotate(o),e.rect(r[0],r[1],r[2],r[3]),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(e),e.fill()),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(e),e.stroke()),this.visuals.text.doit&&(this.visuals.text.set_value(e),e.fillText(t,0,0)),e.restore()}_css_text(e,t,i,n,o){const{el:r}=this;assert(null!=r),undisplay(r),this.visuals.text.set_value(e);const[s,a]=this._calculate_bounding_box_dimensions(e,t);r.style.position="absolute",r.style.left=`${i+s}px`,r.style.top=`${n+a}px`,r.style.color=e.fillStyle,r.style.font=e.font,r.style.lineHeight="normal",o&&(r.style.transform=`rotate(${o}rad)`),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(e),r.style.backgroundColor=e.fillStyle),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(e),r.style.borderStyle=e.lineDash.length<2?"solid":"dashed",r.style.borderWidth=`${e.lineWidth}px`,r.style.borderColor=e.strokeStyle),r.textContent=t,display(r)}}TextAnnotationView.__name__="TextAnnotationView";class TextAnnotation extends Annotation{constructor(e){super(e)}static init_TextAnnotation(){this.define((()=>({render_mode:[RenderMode,"canvas"]})))}}TextAnnotation.__name__="TextAnnotation",TextAnnotation.init_TextAnnotation();class TitleView extends TextAnnotationView{_get_location(){const e=this.model.offset,t=this.model.standoff/2;let i,n;const{bbox:o}=this.layout;switch(this.panel.side){case"above":case"below":switch(this.model.vertical_align){case"top":n=o.top+t;break;case"middle":n=o.vcenter;break;case"bottom":n=o.bottom-t}switch(this.model.align){case"left":i=o.left+e;break;case"center":i=o.hcenter;break;case"right":i=o.right-e}break;case"left":switch(this.model.vertical_align){case"top":i=o.left+t;break;case"middle":i=o.hcenter;break;case"bottom":i=o.right-t}switch(this.model.align){case"left":n=o.bottom-e;break;case"center":n=o.vcenter;break;case"right":n=o.top+e}break;case"right":switch(this.model.vertical_align){case"top":i=o.right-t;break;case"middle":i=o.hcenter;break;case"bottom":i=o.left+t}switch(this.model.align){case"left":n=o.top+e;break;case"center":n=o.vcenter;break;case"right":n=o.bottom-e}}return[i,n]}_render(){const{text:e}=this.model;if(null==e||0==e.length)return;this.model.text_baseline=this.model.vertical_align,this.model.text_align=this.model.align;const[t,i]=this._get_location(),n=this.panel.get_label_angle_heuristic("parallel");("canvas"==this.model.render_mode?this._canvas_text.bind(this):this._css_text.bind(this))(this.layer.ctx,e,t,i,n)}_get_size(){const{text:e}=this.model;if(null==e||0==e.length)return{width:0,height:0};{const{ctx:t}=this.layer;this.visuals.text.set_value(t);const{width:i}=this.layer.ctx.measureText(e),{height:n}=font_metrics(t.font);return{width:i,height:2+n*this.model.text_line_height+this.model.standoff}}}}TitleView.__name__="TitleView";class Title extends TextAnnotation{constructor(e){super(e)}static init_Title(){this.prototype.default_view=TitleView,this.mixins([Text$2,["border_",Line$2],["background_",Fill$1]]),this.define((({Number:e,String:t})=>({text:[t,""],vertical_align:[VerticalAlign,"bottom"],align:[TextAlign,"left"],offset:[e,0],standoff:[e,10]}))),this.prototype._props.text_align.options.internal=!0,this.prototype._props.text_baseline.options.internal=!0,this.override({text_font_size:"13px",text_font_style:"bold",text_line_height:1,background_fill_color:null,border_line_color:null})}}Title.__name__="Title",Title.init_Title();class Transform extends Model{constructor(e){super(e)}}Transform.__name__="Transform";class CustomJSTransform extends Transform{constructor(e){super(e)}static init_CustomJSTransform(){this.define((({Unknown:e,String:t,Dict:i})=>({args:[i(e),{}],func:[t,""],v_func:[t,""]})))}get names(){return keys(this.args)}get values(){return values(this.args)}_make_transform(e,t){return new Function(...this.names,e,use_strict(t))}get scalar_transform(){return this._make_transform("x",this.func)}get vector_transform(){return this._make_transform("xs",this.v_func)}compute(e){return this.scalar_transform(...this.values,e)}v_compute(e){return this.vector_transform(...this.values,e)}}CustomJSTransform.__name__="CustomJSTransform",CustomJSTransform.init_CustomJSTransform();class RangeTransform extends Transform{constructor(e){super(e)}static init_RangeTransform(){this.define((({Ref:e,Nullable:t})=>({range:[t(e(Range$1)),null]})))}v_compute(e){let t;if(this.range instanceof FactorRange)t=this.range.v_synthetic(e);else{if(!isArrayableOf(e,isNumber))throw new Error("unexpected");t=e}const i=new(infer_type(t))(t.length);for(let n=0;n<t.length;n++){const e=t[n];i[n]=this._compute(e)}return i}compute(e){if(this.range instanceof FactorRange)return this._compute(this.range.synthetic(e));if(isNumber(e))return this._compute(e);throw new Error("unexpected")}}RangeTransform.__name__="RangeTransform",RangeTransform.init_RangeTransform();class Dodge extends RangeTransform{constructor(e){super(e)}static init_Dodge(){this.define((({Number:e})=>({value:[e,0]})))}_compute(e){return e+this.value}}Dodge.__name__="Dodge",Dodge.init_Dodge();class Interpolator extends Transform{constructor(e){super(e),this._sorted_dirty=!0}static init_Interpolator(){this.define((({Boolean:e,Number:t,String:i,Ref:n,Array:o,Or:r,Nullable:s})=>({x:[r(i,o(t))],y:[r(i,o(t))],data:[s(n(ColumnarDataSource)),null],clip:[e,!0]})))}connect_signals(){super.connect_signals(),this.connect(this.change,(()=>this._sorted_dirty=!0))}v_compute(e){const t=new(infer_type(e))(e.length);for(let i=0;i<e.length;i++){const n=e[i];t[i]=this.compute(n)}return t}sort(e=!1){if(!this._sorted_dirty)return;let t,i;if(isString(this.x)&&isString(this.y)&&null!=this.data){const e=this.data.columns();if(!includes(e,this.x))throw new Error("The x parameter does not correspond to a valid column name defined in the data parameter");if(!includes(e,this.y))throw new Error("The y parameter does not correspond to a valid column name defined in the data parameter");t=this.data.get_column(this.x),i=this.data.get_column(this.y)}else{if(!isArray(this.x)||!isArray(this.y))throw new Error("parameters 'x' and 'y' must be both either string fields or arrays");t=this.x,i=this.y}if(t.length!==i.length)throw new Error("The length for x and y do not match");if(t.length<2)throw new Error("x and y must have at least two elements to support interpolation");const n=t.length,o=new Uint32Array(n);for(let s=0;s<n;s++)o[s]=s;const r=e?-1:1;o.sort(((e,i)=>r*(t[e]-t[i]))),this._x_sorted=new(infer_type(t))(n),this._y_sorted=new(infer_type(i))(n);for(let s=0;s<n;s++)this._x_sorted[s]=t[o[s]],this._y_sorted[s]=i[o[s]];this._sorted_dirty=!1}}Interpolator.__name__="Interpolator",Interpolator.init_Interpolator();class Jitter extends RangeTransform{constructor(e){super(e)}static init_Jitter(){this.define((({Number:e})=>({mean:[e,0],width:[e,1],distribution:[Distribution,"uniform"]})))}v_compute(e){return null!=this.previous_values&&this.previous_values.length==e.length||(this.previous_values=super.v_compute(e)),this.previous_values}_compute(e){switch(this.distribution){case"uniform":return e+this.mean+(random$1()-.5)*this.width;case"normal":return e+rnorm(this.mean,this.width)}}}Jitter.__name__="Jitter",Jitter.init_Jitter();class LinearInterpolator extends Interpolator{constructor(e){super(e)}compute(e){if(this.sort(!1),this.clip){if(e<this._x_sorted[0]||e>this._x_sorted[this._x_sorted.length-1])return NaN}else{if(e<this._x_sorted[0])return this._y_sorted[0];if(e>this._x_sorted[this._x_sorted.length-1])return this._y_sorted[this._y_sorted.length-1]}if(e==this._x_sorted[0])return this._y_sorted[0];const t=find_last_index(this._x_sorted,(t=>t<e)),i=this._x_sorted[t],n=this._x_sorted[t+1],o=this._y_sorted[t],r=this._y_sorted[t+1];return o+(e-i)/(n-i)*(r-o)}}LinearInterpolator.__name__="LinearInterpolator";class StepInterpolator extends Interpolator{constructor(e){super(e)}static init_StepInterpolator(){this.define((()=>({mode:[StepMode,"after"]})))}compute(e){if(this.sort(!1),this.clip){if(e<this._x_sorted[0]||e>this._x_sorted[this._x_sorted.length-1])return NaN}else{if(e<this._x_sorted[0])return this._y_sorted[0];if(e>this._x_sorted[this._x_sorted.length-1])return this._y_sorted[this._y_sorted.length-1]}let t;switch(this.mode){case"after":t=find_last_index(this._x_sorted,(t=>e>=t));break;case"before":t=find_index(this._x_sorted,(t=>e<=t));break;case"center":{const i=map(this._x_sorted,(t=>Math.abs(t-e))),n=min$6(i);t=find_index(i,(e=>n===e));break}default:throw new Error(`unknown mode: ${this.mode}`)}return-1!=t?this._y_sorted[t]:NaN}}StepInterpolator.__name__="StepInterpolator",StepInterpolator.init_StepInterpolator();class Range1d extends Range$1{constructor(e){super(e)}static init_Range1d(){this.define((({Number:e,Nullable:t})=>({start:[e,0],end:[e,1],reset_start:[t(e),null,{on_update(e,t){t._reset_start=null!=e?e:t.start}}],reset_end:[t(e),null,{on_update(e,t){t._reset_end=null!=e?e:t.end}}]})))}_set_auto_bounds(){if("auto"==this.bounds){const e=Math.min(this._reset_start,this._reset_end),t=Math.max(this._reset_start,this._reset_end);this.setv({bounds:[e,t]},{silent:!0})}}initialize(){super.initialize(),this._set_auto_bounds()}get min(){return Math.min(this.start,this.end)}get max(){return Math.max(this.start,this.end)}reset(){this._set_auto_bounds();const{_reset_start:e,_reset_end:t}=this;this.start!=e||this.end!=t?this.setv({start:e,end:t}):this.change.emit()}map(e){return new Range1d({start:e(this.start),end:e(this.end)})}widen(e){let{start:t,end:i}=this;return this.is_reversed?(t+=e,i-=e):(t-=e,i+=e),new Range1d({start:t,end:i})}}Range1d.__name__="Range1d",Range1d.init_Range1d();class Scale extends Transform{constructor(e){super(e)}static init_Scale(){this.internal((({Ref:e})=>({source_range:[e(Range$1)],target_range:[e(Range1d)]})))}r_compute(e,t){return this.target_range.is_reversed?[this.compute(t),this.compute(e)]:[this.compute(e),this.compute(t)]}r_invert(e,t){return this.target_range.is_reversed?[this.invert(t),this.invert(e)]:[this.invert(e),this.invert(t)]}_linear_compute(e){const[t,i]=this._linear_compute_state();return t*e+i}_linear_v_compute(e){const[t,i]=this._linear_compute_state(),n=new ScreenArray(e.length);for(let o=0;o<e.length;o++)n[o]=t*e[o]+i;return n}_linear_invert(e){const[t,i]=this._linear_compute_state();return(e-i)/t}_linear_v_invert(e){const[t,i]=this._linear_compute_state(),n=new Float64Array(e.length);for(let o=0;o<e.length;o++)n[o]=(e[o]-i)/t;return n}_linear_compute_state(){const e=this.source_range.start,t=this.source_range.end,i=this.target_range.start,n=(this.target_range.end-i)/(t-e);return[n,-n*e+i]}}Scale.__name__="Scale",Scale.init_Scale();class CategoricalScale extends Scale{constructor(e){super(e)}get s_compute(){const[e,t]=this._linear_compute_state(),i=this.source_range;return n=>e*i.synthetic(n)+t}compute(e){return super._linear_compute(this.source_range.synthetic(e))}v_compute(e){return super._linear_v_compute(this.source_range.v_synthetic(e))}invert(e){return this._linear_invert(e)}v_invert(e){return this._linear_v_invert(e)}}CategoricalScale.__name__="CategoricalScale";class ContinuousScale extends Scale{constructor(e){super(e)}}ContinuousScale.__name__="ContinuousScale";class LogScale extends ContinuousScale{constructor(e){super(e)}get s_compute(){const[e,t,i,n]=this._compute_state();return o=>{if(0==i)return 0;{const r=(Math.log(o)-n)/i;return isFinite(r)?r*e+t:NaN}}}compute(e){const[t,i,n,o]=this._compute_state();let r;if(0==n)r=0;else{const s=(Math.log(e)-o)/n;r=isFinite(s)?s*t+i:NaN}return r}v_compute(e){const[t,i,n,o]=this._compute_state(),r=new ScreenArray(e.length);if(0==n)for(let s=0;s<e.length;s++)r[s]=0;else for(let s=0;s<e.length;s++){const a=(Math.log(e[s])-o)/n;let l;l=isFinite(a)?a*t+i:NaN,r[s]=l}return r}invert(e){const[t,i,n,o]=this._compute_state(),r=(e-i)/t;return Math.exp(n*r+o)}v_invert(e){const[t,i,n,o]=this._compute_state(),r=new Float64Array(e.length);for(let s=0;s<e.length;s++){const a=(e[s]-i)/t;r[s]=Math.exp(n*a+o)}return r}_get_safe_factor(e,t){let i=e<0?0:e,n=t<0?0:t;if(i==n)if(0==i)[i,n]=[1,10];else{const e=Math.log(i)/Math.log(10);i=10**Math.floor(e),n=Math.ceil(e)!=Math.floor(e)?10**Math.ceil(e):10**(Math.ceil(e)+1)}return[i,n]}_compute_state(){const e=this.source_range.start,t=this.source_range.end,i=this.target_range.start,n=this.target_range.end-i,[o,r]=this._get_safe_factor(e,t);let s,a;0==o?(s=Math.log(r),a=0):(s=Math.log(r)-Math.log(o),a=Math.log(o));return[n,i,s,a]}}LogScale.__name__="LogScale";class DataRange extends Range$1{constructor(e){super(e)}static init_DataRange(){this.define((({String:e,Array:t,Ref:i})=>({names:[t(e),[]],renderers:[t(i(DataRenderer)),[]]})))}}function compute_renderers(e,t,i){if(null==e)return[];let n="auto"==e?t:e;return i.length>0&&(n=n.filter((e=>includes(i,e.name)))),n}DataRange.__name__="DataRange",DataRange.init_DataRange();class DataRange1d extends DataRange{constructor(e){super(e),this.have_updated_interactively=!1}static init_DataRange1d(){this.define((({Boolean:e,Number:t,Nullable:i})=>({start:[t],end:[t],range_padding:[t,.1],range_padding_units:[PaddingUnits,"percent"],flipped:[e,!1],follow:[i(StartEnd),null],follow_interval:[i(t),null],default_span:[t,2],only_visible:[e,!1]}))),this.internal((({Enum:e})=>({scale_hint:[e("log","auto"),"auto"]})))}initialize(){super.initialize(),this._initial_start=this.start,this._initial_end=this.end,this._initial_range_padding=this.range_padding,this._initial_range_padding_units=this.range_padding_units,this._initial_follow=this.follow,this._initial_follow_interval=this.follow_interval,this._initial_default_span=this.default_span,this._plot_bounds=new Map}get min(){return Math.min(this.start,this.end)}get max(){return Math.max(this.start,this.end)}computed_renderers(){const{renderers:e,names:t}=this,i=concat$1(this.plots.map((e=>e.data_renderers)));return compute_renderers(0==e.length?"auto":e,i,t)}_compute_plot_bounds(e,t){let i=empty();for(const n of e){const e=t.get(n);null==e||!n.visible&&this.only_visible||(i=union$1(i,e))}return i}adjust_bounds_for_aspect(e,t){const i=empty();let n=e.x1-e.x0;n<=0&&(n=1);let o=e.y1-e.y0;o<=0&&(o=1);const r=.5*(e.x1+e.x0),s=.5*(e.y1+e.y0);return n<t*o?n=t*o:o=n/t,i.x1=r+.5*n,i.x0=r-.5*n,i.y1=s+.5*o,i.y0=s-.5*o,i}_compute_min_max(e,t){let i,n,o=empty();for(const r of e)o=union$1(o,r);return[i,n]=0==t?[o.x0,o.x1]:[o.y0,o.y1],[i,n]}_compute_range(e,t){const i=this.range_padding;let n,o;if(null!=this._initial_start&&(e=this._initial_start),null!=this._initial_end&&(t=this._initial_end),"log"==this.scale_hint){let r,s;if((isNaN(e)||!isFinite(e)||e<=0)&&(e=isNaN(t)||!isFinite(t)||t<=0?.1:t/100,logger.warn(`could not determine minimum data value for log axis, DataRange1d using value ${e}`)),(isNaN(t)||!isFinite(t)||t<=0)&&(t=isNaN(e)||!isFinite(e)||e<=0?10:100*e,logger.warn(`could not determine maximum data value for log axis, DataRange1d using value ${t}`)),t==e)s=this.default_span+.001,r=Math.log(e)/Math.log(10);else{let n,o;"percent"==this.range_padding_units?(n=Math.log(e)/Math.log(10),o=Math.log(t)/Math.log(10),s=(o-n)*(1+i)):(n=Math.log(e-i)/Math.log(10),o=Math.log(t+i)/Math.log(10),s=o-n),r=(n+o)/2}n=10**(r-s/2),o=10**(r+s/2)}else{let r;r=t==e?this.default_span:"percent"==this.range_padding_units?(t-e)*(1+i):t-e+2*i;const s=(t+e)/2;n=s-r/2,o=s+r/2}let r=1;this.flipped&&([n,o]=[o,n],r=-1);const s=this.follow_interval;return null!=s&&Math.abs(n-o)>s&&("start"==this.follow?o=n+r*s:"end"==this.follow&&(n=o-r*s)),[n,o]}update(e,t,i,n){if(this.have_updated_interactively)return;const o=this.computed_renderers();let r=this._compute_plot_bounds(o,e);null!=n&&(r=this.adjust_bounds_for_aspect(r,n)),this._plot_bounds.set(i,r);const[s,a]=this._compute_min_max(this._plot_bounds.values(),t);let[l,c]=this._compute_range(s,a);null!=this._initial_start&&("log"==this.scale_hint?this._initial_start>0&&(l=this._initial_start):l=this._initial_start),null!=this._initial_end&&("log"==this.scale_hint?this._initial_end>0&&(c=this._initial_end):c=this._initial_end);let d=!1;"auto"==this.bounds&&(this.setv({bounds:[l,c]},{silent:!0}),d=!0);const[h,u]=[this.start,this.end];if(l!=h||c!=u){const e={};l!=h&&(e.start=l),c!=u&&(e.end=c),this.setv(e),d=!1}d&&this.change.emit()}reset(){this.have_updated_interactively=!1,this.setv({range_padding:this._initial_range_padding,range_padding_units:this._initial_range_padding_units,follow:this._initial_follow,follow_interval:this._initial_follow_interval,default_span:this._initial_default_span},{silent:!0}),this.change.emit()}}DataRange1d.__name__="DataRange1d",DataRange1d.init_DataRange1d();class CartesianFrame{constructor(e,t,i,n,o={},r={}){this.in_x_scale=e,this.in_y_scale=t,this.x_range=i,this.y_range=n,this.extra_x_ranges=o,this.extra_y_ranges=r,this._bbox=new BBox,assert(null==e.source_range&&null==e.target_range),assert(null==t.source_range&&null==t.target_range),this._configure_scales()}get bbox(){return this._bbox}_get_ranges(e,t){return new Map(entries(__spreadProps(__spreadValues({},t),{default:e})))}_get_scales(e,t,i){const n=new Map;for(const[o,r]of t){if(r instanceof FactorRange!=e instanceof CategoricalScale)throw new Error(`Range ${r.type} is incompatible is Scale ${e.type}`);e instanceof LogScale&&r instanceof DataRange1d&&(r.scale_hint="log");const t=e.clone();t.setv({source_range:r,target_range:i}),n.set(o,t)}return n}_configure_frame_ranges(){const{bbox:e}=this;this._x_target=new Range1d({start:e.left,end:e.right}),this._y_target=new Range1d({start:e.bottom,end:e.top})}_configure_scales(){this._configure_frame_ranges(),this._x_ranges=this._get_ranges(this.x_range,this.extra_x_ranges),this._y_ranges=this._get_ranges(this.y_range,this.extra_y_ranges),this._x_scales=this._get_scales(this.in_x_scale,this._x_ranges,this._x_target),this._y_scales=this._get_scales(this.in_y_scale,this._y_ranges,this._y_target)}_update_scales(){this._configure_frame_ranges();for(const[,e]of this._x_scales)e.target_range=this._x_target;for(const[,e]of this._y_scales)e.target_range=this._y_target}set_geometry(e){this._bbox=e,this._update_scales()}get x_target(){return this._x_target}get y_target(){return this._y_target}get x_ranges(){return this._x_ranges}get y_ranges(){return this._y_ranges}get x_scales(){return this._x_scales}get y_scales(){return this._y_scales}get x_scale(){return this._x_scales.get("default")}get y_scale(){return this._y_scales.get("default")}get xscales(){return to_object(this.x_scales)}get yscales(){return to_object(this.y_scales)}}CartesianFrame.__name__="CartesianFrame";class GuideRendererView extends RendererView{}GuideRendererView.__name__="GuideRendererView";class GuideRenderer extends Renderer{constructor(e){super(e)}static init_GuideRenderer(){this.override({level:"guide"})}}GuideRenderer.__name__="GuideRenderer",GuideRenderer.init_GuideRenderer();class Ticker extends Model{constructor(e){super(e)}}Ticker.__name__="Ticker";const{sin:sin,cos:cos}=Math;class AffineTransform{constructor(e=1,t=0,i=0,n=1,o=0,r=0){this.a=e,this.b=t,this.c=i,this.d=n,this.e=o,this.f=r}toString(){const{a:e,b:t,c:i,d:n,e:o,f:r}=this;return`matrix(${e}, ${t}, ${i}, ${n}, ${o}, ${r})`}clone(){const{a:e,b:t,c:i,d:n,e:o,f:r}=this;return new AffineTransform(e,t,i,n,o,r)}get is_identity(){const{a:e,b:t,c:i,d:n,e:o,f:r}=this;return 1==e&&0==t&&0==i&&1==n&&0==o&&0==r}apply_point(e){const[t,i]=this.apply(e.x,e.y);return{x:t,y:i}}apply_rect(e){return{p0:this.apply_point(e.p0),p1:this.apply_point(e.p1),p2:this.apply_point(e.p2),p3:this.apply_point(e.p3)}}apply(e,t){const{a:i,b:n,c:o,d:r,e:s,f:a}=this;return[i*e+o*t+s,n*e+r*t+a]}iv_apply(e,t){const{a:i,b:n,c:o,d:r,e:s,f:a}=this,l=e.length;for(let c=0;c<l;c++){const l=e[c],d=t[c];e[c]=i*l+o*d+s,t[c]=n*l+r*d+a}}transform(e,t,i,n,o,r){const{a:s,b:a,c:l,d:c,e:d,f:h}=this;return this.a=s*e+l*t,this.c=s*i+l*n,this.e=s*o+l*r+d,this.b=a*e+c*t,this.d=a*i+c*n,this.f=a*o+c*r+h,this}translate(e,t){return this.transform(1,0,0,1,e,t)}scale(e,t){return this.transform(e,0,0,t,0,0)}skew(e,t){return this.transform(1,t,e,1,0,0)}rotate(e){const t=sin(e),i=cos(e);return this.transform(i,t,-t,i,0,0)}rotate_ccw(e){return this.rotate(-e)}translate_x(e){return this.translate(e,0)}translate_y(e){return this.translate(0,e)}flip(){return this.scale(-1,-1)}flip_x(){return this.scale(1,-1)}flip_y(){return this.scale(-1,1)}}AffineTransform.__name__="AffineTransform";const text_width=(()=>{const e=document.createElement("canvas").getContext("2d");let t="";return(i,n)=>(n!=t&&(t=n,e.font=n),e.measureText(i).width)})();class GraphicsBox{constructor(){this._position={sx:0,sy:0},this.font_size_scale=1,this._base_font_size=13}set base_font_size(e){this._base_font_size=e}get base_font_size(){return this._base_font_size}set position(e){this._position=e}get position(){return this._position}infer_text_height(){return"ascent_descent"}bbox(){const{p0:e,p1:t,p2:i,p3:n}=this.rect(),o=Math.min(e.x,t.x,i.x,n.x),r=Math.min(e.y,t.y,i.y,n.y),s=Math.max(e.x,t.x,i.x,n.x),a=Math.max(e.y,t.y,i.y,n.y);return new BBox({left:o,right:s,top:r,bottom:a})}size(){const{width:e,height:t}=this._size(),{angle:i}=this;if(i){const n=Math.cos(Math.abs(i)),o=Math.sin(Math.abs(i));return{width:Math.abs(e*n+t*o),height:Math.abs(e*o+t*n)}}return{width:e,height:t}}rect(){const e=this._rect(),{angle:t}=this;if(t){const{sx:i,sy:n}=this.position,o=new AffineTransform;return o.translate(i,n),o.rotate(t),o.translate(-i,-n),o.apply_rect(e)}return e}paint_rect(e){const{p0:t,p1:i,p2:n,p3:o}=this.rect();e.save(),e.strokeStyle="red",e.lineWidth=1,e.beginPath();const{round:r}=Math;e.moveTo(r(t.x),r(t.y)),e.lineTo(r(i.x),r(i.y)),e.lineTo(r(n.x),r(n.y)),e.lineTo(r(o.x),r(o.y)),e.closePath(),e.stroke(),e.restore()}paint_bbox(e){const{x:t,y:i,width:n,height:o}=this.bbox();e.save(),e.strokeStyle="blue",e.lineWidth=1,e.beginPath();const{round:r}=Math;e.moveTo(r(t),r(i)),e.lineTo(r(t),r(i+o)),e.lineTo(r(t+n),r(i+o)),e.lineTo(r(t+n),r(i)),e.closePath(),e.stroke(),e.restore()}}GraphicsBox.__name__="GraphicsBox";class TextBox extends GraphicsBox{constructor({text:e}){super(),this.align="left",this.text=e}set visuals(e){const t=e.text_color.get_value(),i=e.text_alpha.get_value(),n=e.text_font_style.get_value();let o=e.text_font_size.get_value();const r=e.text_font.get_value(),{font_size_scale:s,base_font_size:a}=this,l=parse_css_font_size(o);if(null!=l){let{value:e,unit:t}=l;e*=s,"em"==t&&a&&(e*=a,t="px"),o=`${e}${t}`}const c=`${n} ${o} ${r}`;this.font=c,this.color=color2css(t,i),this.line_height=e.text_line_height.get_value()}infer_text_height(){if(this.text.includes("\n"))return"ascent_descent";return function(e){for(const t of new Set(e))if(!("0"<=t&&t<="9"))switch(t){case",":case".":case"+":case"-":case"":case"e":continue;default:return!1}return!0}(this.text)?"cap":"ascent_descent"}_text_line(e){var t;const i=null!=(t=this.text_height_metric)?t:this.infer_text_height(),n=(()=>{switch(i){case"x":case"x_descent":return e.x_height;case"cap":case"cap_descent":return e.cap_height;case"ascent":case"ascent_descent":return e.ascent}})(),o=(()=>{switch(i){case"x":case"cap":case"ascent":return 0;case"x_descent":case"cap_descent":case"ascent_descent":return e.descent}})();return{height:n+o,ascent:n,descent:o}}get nlines(){return this.text.split("\n").length}_size(){var e,t;const{font:i}=this,n=font_metrics(i),o=(this.line_height-1)*n.height,r=""==this.text,s=this.text.split("\n"),a=s.length,l=s.map((e=>text_width(e,i))),c=this._text_line(n).height*a,d="%"==(null==(e=this.width)?void 0:e.unit)?this.width.value:1,h="%"==(null==(t=this.height)?void 0:t.unit)?this.height.value:1;return{width:max$7(l)*d,height:r?0:(c+o*(a-1))*h,metrics:n}}_computed_position(e,t,i){const{width:n,height:o}=e,{sx:r,sy:s,x_anchor:a="left",y_anchor:l="center"}=this.position;return{x:r-(()=>{if(isNumber(a))return a*n;switch(a){case"left":return 0;case"center":return.5*n;case"right":return n}})(),y:s-(()=>{var e;if(isNumber(l))return l*o;switch(l){case"top":return 0;case"center":return.5*o;case"bottom":return o;case"baseline":if(1!=i)return.5*o;switch(null!=(e=this.text_height_metric)?e:this.infer_text_height()){case"x":case"x_descent":return t.x_height;case"cap":case"cap_descent":return t.cap_height;case"ascent":case"ascent_descent":return t.ascent}}})()}}_rect(){const{width:e,height:t,metrics:i}=this._size(),n=this.text.split("\n").length,{x:o,y:r}=this._computed_position({width:e,height:t},i,n);return new BBox({x:o,y:r,width:e,height:t}).rect}paint(e){var t,i;const{font:n}=this,o=font_metrics(n),r=(this.line_height-1)*o.height,s=this.text.split("\n"),a=s.length,l=s.map((e=>text_width(e,n))),c=this._text_line(o),d=c.height*a,h="%"==(null==(t=this.width)?void 0:t.unit)?this.width.value:1,u="%"==(null==(i=this.height)?void 0:i.unit)?this.height.value:1,p=max$7(l)*h,_=(d+r*(a-1))*u;e.save(),e.fillStyle=this.color,e.font=this.font,e.textAlign="left",e.textBaseline="alphabetic";const{sx:f,sy:g}=this.position,{align:m}=this,{angle:v}=this;v&&(e.translate(f,g),e.rotate(v),e.translate(-f,-g));let{x:b,y:y}=this._computed_position({width:p,height:_},o,a);if("justify"==m)for(let w=0;w<a;w++){let t=b;const i=s[w].split(" "),o=i.length,a=i.map((e=>text_width(e,n))),l=(p-sum$1(a))/(o-1);for(let n=0;n<o;n++)e.fillText(i[n],t,y),t+=a[n]+l;y+=c.height+r}else for(let w=0;w<a;w++){const t=b+(()=>{switch(m){case"left":return 0;case"center":return.5*(p-l[w]);case"right":return p-l[w]}})();e.fillStyle=this.color,e.fillText(s[w],t,y+c.ascent),y+=c.height+r}e.restore()}}TextBox.__name__="TextBox";class BaseExpo extends GraphicsBox{constructor(e,t){super(),this.base=e,this.expo=t}get children(){return[this.base,this.expo]}set base_font_size(e){super.base_font_size=e,this.base.base_font_size=e,this.expo.base_font_size=e}set position(e){this._position=e;const t=this.base.size(),i=this.expo.size(),n=this._shift_scale()*t.height,o=Math.max(t.height,n+i.height);this.base.position={sx:0,x_anchor:"left",sy:o,y_anchor:"bottom"},this.expo.position={sx:t.width,x_anchor:"left",sy:n,y_anchor:"bottom"}}get position(){return this._position}set visuals(e){this.expo.font_size_scale=.7,this.base.visuals=e,this.expo.visuals=e}_shift_scale(){if(this.base instanceof TextBox&&1==this.base.nlines){const{x_height:e,cap_height:t}=font_metrics(this.base.font);return e/t}return 2/3}infer_text_height(){return this.base.infer_text_height()}_rect(){const e=this.base.bbox(),t=this.expo.bbox(),i=e.union(t),{x:n,y:o}=this._computed_position();return i.translate(n,o).rect}_size(){const e=this.base.size(),t=this.expo.size();return{width:e.width+t.width,height:Math.max(e.height,this._shift_scale()*e.height+t.height)}}paint(e){e.save();const{angle:t}=this;if(t){const{sx:i,sy:n}=this.position;e.translate(i,n),e.rotate(t),e.translate(-i,-n)}const{x:i,y:n}=this._computed_position();e.translate(i,n),this.base.paint(e),this.expo.paint(e),e.restore()}paint_bbox(e){super.paint_bbox(e);const{x:t,y:i}=this._computed_position();e.save(),e.translate(t,i);for(const n of this.children)n.paint_bbox(e);e.restore()}_computed_position(){const{width:e,height:t}=this._size(),{sx:i,sy:n,x_anchor:o="left",y_anchor:r="center"}=this.position;return{x:i-(()=>{if(isNumber(o))return o*e;switch(o){case"left":return 0;case"center":return.5*e;case"right":return e}})(),y:n-(()=>{if(isNumber(r))return r*t;switch(r){case"top":return 0;case"center":return.5*t;case"bottom":return t;case"baseline":return.5*t}})()}}}BaseExpo.__name__="BaseExpo";class GraphicsBoxes{constructor(e){this.items=e}set base_font_size(e){for(const t of this.items)t.base_font_size=e}get length(){return this.items.length}set visuals(e){for(const n of this.items)n.visuals=e;const t={x:0,cap:1,ascent:2,x_descent:3,cap_descent:4,ascent_descent:5},i=max_by(this.items.map((e=>e.infer_text_height())),(e=>t[e]));for(const n of this.items)n.text_height_metric=i}set angle(e){for(const t of this.items)t.angle=e}max_size(){let e=0,t=0;for(const i of this.items){const n=i.size();e=Math.max(e,n.width),t=Math.max(t,n.height)}return{width:e,height:t}}}GraphicsBoxes.__name__="GraphicsBoxes";class TickFormatter extends Model{constructor(e){super(e)}format_graphics(e,t){return this.doFormat(e,t).map((e=>new TextBox({text:e})))}compute(e,t){return this.doFormat([e],null!=t?t:{loc:0})[0]}v_compute(e,t){return this.doFormat(e,null!=t?t:{loc:0})}}TickFormatter.__name__="TickFormatter";class LabelingPolicy extends Model{constructor(e){super(e)}}LabelingPolicy.__name__="LabelingPolicy";class AllLabels extends LabelingPolicy{constructor(e){super(e)}filter(e,t,i){return e}}AllLabels.__name__="AllLabels";class NoOverlap extends LabelingPolicy{constructor(e){super(e)}static init_NoOverlap(){this.define((({Number:e})=>({min_distance:[e,5]})))}filter(e,t,i){const{min_distance:n}=this;let o=null;for(const r of e)null!=o&&i(o,r)<n?e.unset(r):o=r;return e}}NoOverlap.__name__="NoOverlap",NoOverlap.init_NoOverlap();class CustomLabelingPolicy extends LabelingPolicy{constructor(e){super(e)}static init_CustomLabelingPolicy(){this.define((({Unknown:e,String:t,Dict:i})=>({args:[i(e),{}],code:[t,""]})))}get names(){return keys(this.args)}get values(){return values(this.args)}get func(){const e=use_strict(this.code);return new GeneratorFunction("indices","bboxes","distance",...this.names,e)}filter(e,t,i){const n=Object.create(null),o=this.func.call(n,e,t,i,...this.values);let r=o.next();if(r.done&&void 0!==r.value){const{value:t}=r;return t instanceof BitSet?t:void 0===t?e:isIterable(t)?BitSet.from_indices(e.size,t):BitSet.all_unset(e.size)}{const t=[];do{t.push(r.value),r=o.next()}while(!r.done);return BitSet.from_indices(e.size,t)}}}CustomLabelingPolicy.__name__="CustomLabelingPolicy",CustomLabelingPolicy.init_CustomLabelingPolicy();const{abs:abs$1}=Math;class AxisView extends GuideRendererView{update_layout(){this.layout=new SideLayout(this.panel,(()=>this.get_size()),!0),this.layout.on_resize((()=>this._coordinates=void 0))}get_size(){const{visible:e,fixed_location:t}=this.model;if(e&&null==t&&this.is_renderable){const{extents:e}=this;return{width:0,height:Math.round(e.tick+e.tick_label+e.axis_label)}}return{width:0,height:0}}get is_renderable(){const[e,t]=this.ranges;return e.is_valid&&t.is_valid}_render(){var e;if(!this.is_renderable)return;const{tick_coords:t,extents:i}=this,n=this.layer.ctx;n.save(),this._draw_rule(n,i),this._draw_major_ticks(n,i,t),this._draw_minor_ticks(n,i,t),this._draw_major_labels(n,i,t),this._draw_axis_label(n,i,t),null==(e=this._paint)||e.call(this,n,i,t),n.restore()}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.plot_view.request_layout()))}get needs_clip(){return null!=this.model.fixed_location}_draw_rule(e,t){if(!this.visuals.axis_line.doit)return;const[i,n]=this.rule_coords,[o,r]=this.coordinates.map_to_screen(i,n),[s,a]=this.normals,[l,c]=this.offsets;this.visuals.axis_line.set_value(e),e.beginPath();for(let d=0;d<o.length;d++){const t=Math.round(o[d]+s*l),i=Math.round(r[d]+a*c);e.lineTo(t,i)}e.stroke()}_draw_major_ticks(e,t,i){const n=this.model.major_tick_in,o=this.model.major_tick_out,r=this.visuals.major_tick_line;this._draw_ticks(e,i.major,n,o,r)}_draw_minor_ticks(e,t,i){const n=this.model.minor_tick_in,o=this.model.minor_tick_out,r=this.visuals.minor_tick_line;this._draw_ticks(e,i.minor,n,o,r)}_draw_major_labels(e,t,i){const n=i.major,o=this.compute_labels(n[this.dimension]),r=this.model.major_label_orientation,s=t.tick+this.model.major_label_standoff,a=this.visuals.major_label_text;this._draw_oriented_labels(e,o,n,r,this.panel.side,s,a)}_axis_label_extent(){const e=this.model.axis_label;if(!e)return 0;const t=new TextBox({text:e});t.visuals=this.visuals.axis_label_text,t.angle=this.panel.get_label_angle_heuristic("parallel"),t.base_font_size=this.plot_view.base_font_size;const i=t.size(),n=0==this.dimension?i.height:i.width,o=this.model.axis_label_standoff;return n>0?o+n+3:0}_draw_axis_label(e,t,i){const n=this.model.axis_label;if(!n||null!=this.model.fixed_location)return;const o=new TextBox({text:n});o.visuals=this.visuals.axis_label_text,o.angle=this.panel.get_label_angle_heuristic("parallel"),o.base_font_size=this.plot_view.base_font_size;const[r,s]=(()=>{const{bbox:e}=this.layout;switch(this.panel.side){case"above":return[e.hcenter,e.bottom];case"below":return[e.hcenter,e.top];case"left":return[e.right,e.vcenter];case"right":return[e.left,e.vcenter]}})(),[a,l]=this.normals,c=t.tick+t.tick_label+this.model.axis_label_standoff,{vertical_align:d,align:h}=this.panel.get_label_text_heuristics("parallel");o.position={sx:r+a*c,sy:s+l*c,x_anchor:h,y_anchor:d},o.align=h,o.paint(e)}_draw_ticks(e,t,i,n,o){if(!o.doit)return;const[r,s]=t,[a,l]=this.coordinates.map_to_screen(r,s),[c,d]=this.normals,[h,u]=this.offsets,[p,_]=[c*(h-i),d*(u-i)],[f,g]=[c*(h+n),d*(u+n)];o.set_value(e),e.beginPath();for(let m=0;m<a.length;m++){const t=Math.round(a[m]+f),i=Math.round(l[m]+g),n=Math.round(a[m]+p),o=Math.round(l[m]+_);e.moveTo(t,i),e.lineTo(n,o)}e.stroke()}_draw_oriented_labels(e,t,i,n,o,r,s){if(!s.doit||0==t.length)return;const[a,l]=i,[c,d]=this.coordinates.map_to_screen(a,l),[h,u]=this.offsets,[p,_]=this.normals,f=p*(h+r),g=_*(u+r),{vertical_align:m,align:v}=this.panel.get_label_text_heuristics(n),b=this.panel.get_label_angle_heuristic(n);t.visuals=s,t.angle=b,t.base_font_size=this.plot_view.base_font_size;for(let R=0;R<t.length;R++){const e=t.items[R];e.position={sx:c[R]+f,sy:d[R]+g,x_anchor:v,y_anchor:m},e instanceof TextBox&&(e.align=v)}const y=t.length,w=BitSet.all_set(y),{items:A}=t,x=A.map((e=>e.bbox())),k=(()=>{const[e]=this.ranges;return e.is_reversed?0==this.dimension?(e,t)=>x[e].left-x[t].right:(e,t)=>x[t].top-x[e].bottom:0==this.dimension?(e,t)=>x[t].left-x[e].right:(e,t)=>x[e].top-x[t].bottom})(),{major_label_policy:C}=this.model,S=C.filter(w,x,k),T=[...S.ones()];if(0!=T.length){const e=this.parent.canvas_view.bbox,t=t=>{const i=x[t];if(i.left<0){const e=-i.left,{position:n}=A[t];A[t].position=__spreadProps(__spreadValues({},n),{sx:n.sx+e})}else if(i.right>e.width){const n=i.right-e.width,{position:o}=A[t];A[t].position=__spreadProps(__spreadValues({},o),{sx:o.sx-n})}},i=t=>{const i=x[t];if(i.top<0){const e=-i.top,{position:n}=A[t];A[t].position=__spreadProps(__spreadValues({},n),{sy:n.sy+e})}else if(i.bottom>e.height){const n=i.bottom-e.height,{position:o}=A[t];A[t].position=__spreadProps(__spreadValues({},o),{sy:o.sy-n})}},n=T[0],o=T[T.length-1];0==this.dimension?(t(n),t(o)):(i(n),i(o))}for(const R of S){A[R].paint(e)}}_tick_extent(){return this.model.major_tick_out}_tick_label_extents(){const e=this.tick_coords.major,t=this.compute_labels(e[this.dimension]),i=this.model.major_label_orientation,n=this.model.major_label_standoff,o=this.visuals.major_label_text;return[this._oriented_labels_extent(t,i,n,o)]}get extents(){const e=this._tick_label_extents();return{tick:this._tick_extent(),tick_labels:e,tick_label:sum$1(e),axis_label:this._axis_label_extent()}}_oriented_labels_extent(e,t,i,n){if(0==e.length)return 0;const o=this.panel.get_label_angle_heuristic(t);e.visuals=n,e.angle=o,e.base_font_size=this.plot_view.base_font_size;const r=e.max_size(),s=0==this.dimension?r.height:r.width;return s>0?i+s+3:0}get normals(){return this.panel.normals}get dimension(){return this.panel.dimension}compute_labels(e){const t=this.model.formatter.format_graphics(e,this),{major_label_overrides:i}=this.model;for(let n=0;n<e.length;n++){const o=i[e[n]];null!=o&&(t[n]=new TextBox({text:o}))}return new GraphicsBoxes(t)}get offsets(){if(null!=this.model.fixed_location)return[0,0];const{frame:e}=this.plot_view;let[t,i]=[0,0];switch(this.panel.side){case"below":i=abs$1(this.layout.bbox.top-e.bbox.bottom);break;case"above":i=abs$1(this.layout.bbox.bottom-e.bbox.top);break;case"right":t=abs$1(this.layout.bbox.left-e.bbox.right);break;case"left":t=abs$1(this.layout.bbox.right-e.bbox.left)}return[t,i]}get ranges(){const e=this.dimension,t=(e+1)%2,{ranges:i}=this.coordinates;return[i[e],i[t]]}get computed_bounds(){const[e]=this.ranges,t=this.model.bounds,i=[e.min,e.max];if("auto"==t)return[e.min,e.max];{let e,n;const[o,r]=t,[s,a]=i,{min:l,max:c}=Math;return abs$1(o-r)>abs$1(s-a)?(e=c(l(o,r),s),n=l(c(o,r),a)):(e=l(o,r),n=c(o,r)),[e,n]}}get rule_coords(){const e=this.dimension,t=(e+1)%2,[i]=this.ranges,[n,o]=this.computed_bounds,r=[new Array(2),new Array(2)];return r[e][0]=Math.max(n,i.min),r[e][1]=Math.min(o,i.max),r[e][0]>r[e][1]&&(r[e][0]=r[e][1]=NaN),r[t][0]=this.loc,r[t][1]=this.loc,r}get tick_coords(){const e=this.dimension,t=(e+1)%2,[i]=this.ranges,[n,o]=this.computed_bounds,r=this.model.ticker.get_ticks(n,o,i,this.loc),s=r.major,a=r.minor,l=[[],[]],c=[[],[]],[d,h]=[i.min,i.max];for(let u=0;u<s.length;u++)s[u]<d||s[u]>h||(l[e].push(s[u]),l[t].push(this.loc));for(let u=0;u<a.length;u++)a[u]<d||a[u]>h||(c[e].push(a[u]),c[t].push(this.loc));return{major:l,minor:c}}get loc(){const{fixed_location:e}=this.model;if(null!=e){if(isNumber(e))return e;const[,t]=this.ranges;if(t instanceof FactorRange)return t.synthetic(e);throw new Error("unexpected")}const[,t]=this.ranges;switch(this.panel.side){case"left":case"below":return t.start;case"right":case"above":return t.end}}serializable_state(){return __spreadProps(__spreadValues({},super.serializable_state()),{bbox:this.layout.bbox.box})}}AxisView.__name__="AxisView";class Axis extends GuideRenderer{constructor(e){super(e)}static init_Axis(){this.prototype.default_view=AxisView,this.mixins([["axis_",Line$2],["major_tick_",Line$2],["minor_tick_",Line$2],["major_label_",Text$2],["axis_label_",Text$2]]),this.define((({Any:e,Int:t,Number:i,String:n,Ref:o,Dict:r,Tuple:s,Or:a,Nullable:l,Auto:c})=>({bounds:[a(s(i,i),c),"auto"],ticker:[o(Ticker)],formatter:[o(TickFormatter)],axis_label:[l(n),""],axis_label_standoff:[t,5],major_label_standoff:[t,5],major_label_orientation:[a(TickLabelOrientation,i),"horizontal"],major_label_overrides:[r(n),{}],major_label_policy:[o(LabelingPolicy),()=>new AllLabels],major_tick_in:[i,2],major_tick_out:[i,6],minor_tick_in:[i,0],minor_tick_out:[i,4],fixed_location:[l(a(i,e)),null]}))),this.override({axis_line_color:"black",major_tick_line_color:"black",minor_tick_line_color:"black",major_label_text_font_size:"11px",major_label_text_align:"center",major_label_text_baseline:"alphabetic",axis_label_text_font_size:"13px",axis_label_text_font_style:"italic"})}}Axis.__name__="Axis",Axis.init_Axis();class CategoricalTicker extends Ticker{constructor(e){super(e)}get_ticks(e,t,i,n){var o,r;return{major:this._collect(i.factors,i,e,t),minor:[],tops:this._collect(null!=(o=i.tops)?o:[],i,e,t),mids:this._collect(null!=(r=i.mids)?r:[],i,e,t)}}_collect(e,t,i,n){const o=[];for(const r of e){const e=t.synthetic(r);e>i&&e<n&&o.push(r)}return o}}CategoricalTicker.__name__="CategoricalTicker";class CategoricalTickFormatter extends TickFormatter{constructor(e){super(e)}doFormat(e,t){return copy(e)}}CategoricalTickFormatter.__name__="CategoricalTickFormatter";class CategoricalAxisView extends AxisView{_paint(e,t,i){this._draw_group_separators(e,t,i)}_draw_group_separators(e,t,i){const[n]=this.ranges,[o,r]=this.computed_bounds;if(!n.tops||n.tops.length<2||!this.visuals.separator_line.doit)return;const s=this.dimension,a=(s+1)%2,l=[[],[]];let c=0;for(let h=0;h<n.tops.length-1;h++){let e,t;for(let o=c;o<n.factors.length;o++)if(n.factors[o][0]==n.tops[h+1]){[e,t]=[n.factors[o-1],n.factors[o]],c=o;break}const i=(n.synthetic(e)+n.synthetic(t))/2;i>o&&i<r&&(l[s].push(i),l[a].push(this.loc))}const d=this.extents.tick_label;this._draw_ticks(e,l,-3,d-6,this.visuals.separator_line)}_draw_major_labels(e,t,i){const n=this._get_factor_info();let o=t.tick+this.model.major_label_standoff;for(let r=0;r<n.length;r++){const[i,s,a,l]=n[r];this._draw_oriented_labels(e,i,s,a,this.panel.side,o,l),o+=t.tick_labels[r]}}_tick_label_extents(){const e=this._get_factor_info(),t=[];for(const[i,,n,o]of e){const e=this._oriented_labels_extent(i,n,this.model.major_label_standoff,o);t.push(e)}return t}_get_factor_info(){const[e]=this.ranges,[t,i]=this.computed_bounds,n=this.loc,o=this.model.ticker.get_ticks(t,i,e,n),r=this.tick_coords,s=[],a=e=>new GraphicsBoxes(e.map((e=>isString(e)?new TextBox({text:e}):e))),l=e=>a(this.model.formatter.doFormat(e,this));if(1==e.levels){const e=l(o.major);s.push([e,r.major,this.model.major_label_orientation,this.visuals.major_label_text])}else if(2==e.levels){const e=l(o.major.map((e=>e[1])));s.push([e,r.major,this.model.major_label_orientation,this.visuals.major_label_text]),s.push([a(o.tops),r.tops,this.model.group_label_orientation,this.visuals.group_text])}else if(3==e.levels){const e=l(o.major.map((e=>e[2]))),t=o.mids.map((e=>e[1]));s.push([e,r.major,this.model.major_label_orientation,this.visuals.major_label_text]),s.push([a(t),r.mids,this.model.subgroup_label_orientation,this.visuals.subgroup_text]),s.push([a(o.tops),r.tops,this.model.group_label_orientation,this.visuals.group_text])}return s}get tick_coords(){const e=this.dimension,t=(e+1)%2,[i]=this.ranges,[n,o]=this.computed_bounds,r=this.model.ticker.get_ticks(n,o,i,this.loc),s={major:[[],[]],mids:[[],[]],tops:[[],[]],minor:[[],[]]};return s.major[e]=r.major,s.major[t]=r.major.map((()=>this.loc)),3==i.levels&&(s.mids[e]=r.mids,s.mids[t]=r.mids.map((()=>this.loc))),i.levels>1&&(s.tops[e]=r.tops,s.tops[t]=r.tops.map((()=>this.loc))),s}}CategoricalAxisView.__name__="CategoricalAxisView";class CategoricalAxis extends Axis{constructor(e){super(e)}static init_CategoricalAxis(){this.prototype.default_view=CategoricalAxisView,this.mixins([["separator_",Line$2],["group_",Text$2],["subgroup_",Text$2]]),this.define((({Number:e,Or:t})=>({group_label_orientation:[t(TickLabelOrientation,e),"parallel"],subgroup_label_orientation:[t(TickLabelOrientation,e),"parallel"]}))),this.override({ticker:()=>new CategoricalTicker,formatter:()=>new CategoricalTickFormatter,separator_line_color:"lightgrey",separator_line_width:2,group_text_font_style:"bold",group_text_font_size:"11px",group_text_color:"grey",subgroup_text_font_style:"bold",subgroup_text_font_size:"11px"})}}CategoricalAxis.__name__="CategoricalAxis",CategoricalAxis.init_CategoricalAxis();class ContinuousAxisView extends AxisView{}ContinuousAxisView.__name__="ContinuousAxisView";class ContinuousAxis extends Axis{constructor(e){super(e)}}function unicode_replace(e){let t="";for(const i of e)t+="-"==i?"":i;return t}ContinuousAxis.__name__="ContinuousAxis";class BasicTickFormatter extends TickFormatter{constructor(e){super(e),this.last_precision=3}static init_BasicTickFormatter(){this.define((({Boolean:e,Int:t,Auto:i,Or:n})=>({precision:[n(t,i),"auto"],use_scientific:[e,!0],power_limit_high:[t,5],power_limit_low:[t,-3]})))}get scientific_limit_low(){return 10**this.power_limit_low}get scientific_limit_high(){return 10**this.power_limit_high}_need_sci(e){if(!this.use_scientific)return!1;const{scientific_limit_high:t}=this,{scientific_limit_low:i}=this,n=e.length<2?0:Math.abs(e[1]-e[0])/1e4;for(const o of e){const e=Math.abs(o);if(!(e<=n)&&(e>=t||e<=i))return!0}return!1}_format_with_precision(e,t,i){return t?e.map((e=>unicode_replace(e.toExponential(i)))):e.map((e=>unicode_replace(to_fixed(e,i))))}_auto_precision(e,t){const i=new Array(e.length),n=this.last_precision<=15;e:for(let o=this.last_precision;n?o<=15:o>=1;n?o++:o--){if(t){i[0]=e[0].toExponential(o);for(let t=1;t<e.length;t++)if(i[t]==i[t-1])continue e;this.last_precision=o;break}i[0]=to_fixed(e[0],o);for(let t=1;t<e.length;t++)if(i[t]=to_fixed(e[t],o),i[t]==i[t-1])continue e;this.last_precision=o;break}return this.last_precision}doFormat(e,t){if(0==e.length)return[];const i=this._need_sci(e),n="auto"==this.precision?this._auto_precision(e,i):this.precision;return this._format_with_precision(e,i,n)}}BasicTickFormatter.__name__="BasicTickFormatter",BasicTickFormatter.init_BasicTickFormatter();class ContinuousTicker extends Ticker{constructor(e){super(e)}static init_ContinuousTicker(){this.define((({Int:e})=>({num_minor_ticks:[e,5],desired_num_ticks:[e,6]})))}get_ticks(e,t,i,n){return this.get_ticks_no_defaults(e,t,n,this.desired_num_ticks)}get_ticks_no_defaults(e,t,i,n){const o=this.get_interval(e,t,n),r=Math.floor(e/o),s=Math.ceil(t/o);let a;a=isFinite(r)&&isFinite(s)?range(r,s+1):[];const l=a.map((e=>e*o)).filter((i=>e<=i&&i<=t)),c=this.num_minor_ticks,d=[];if(c>0&&l.length>0){const i=o/c,n=range(0,c).map((e=>e*i));for(const o of n.slice(1)){const i=l[0]-o;e<=i&&i<=t&&d.push(i)}for(const o of l)for(const i of n){const n=o+i;e<=n&&n<=t&&d.push(n)}}return{major:l,minor:d}}get_ideal_interval(e,t,i){return(t-e)/i}}ContinuousTicker.__name__="ContinuousTicker",ContinuousTicker.init_ContinuousTicker();class AdaptiveTicker extends ContinuousTicker{constructor(e){super(e)}static init_AdaptiveTicker(){this.define((({Number:e,Array:t,Nullable:i})=>({base:[e,10],mantissas:[t(e),[1,2,5]],min_interval:[e,0],max_interval:[i(e),null]})))}get_min_interval(){return this.min_interval}get_max_interval(){var e;return null!=(e=this.max_interval)?e:1/0}initialize(){super.initialize();const e=nth(this.mantissas,-1)/this.base,t=nth(this.mantissas,0)*this.base;this.extended_mantissas=[e,...this.mantissas,t],this.base_factor=0===this.get_min_interval()?1:this.get_min_interval()}get_interval(e,t,i){const n=t-e,o=this.get_ideal_interval(e,t,i),r=Math.floor(log$1(o/this.base_factor,this.base)),s=this.base**r*this.base_factor,a=this.extended_mantissas,l=a.map((e=>Math.abs(i-n/(e*s))));return clamp(a[argmin(l)]*s,this.get_min_interval(),this.get_max_interval())}}AdaptiveTicker.__name__="AdaptiveTicker",AdaptiveTicker.init_AdaptiveTicker();class BasicTicker extends AdaptiveTicker{constructor(e){super(e)}}BasicTicker.__name__="BasicTicker";class LinearAxisView extends ContinuousAxisView{}LinearAxisView.__name__="LinearAxisView";class LinearAxis extends ContinuousAxis{constructor(e){super(e)}static init_LinearAxis(){this.prototype.default_view=LinearAxisView,this.override({ticker:()=>new BasicTicker,formatter:()=>new BasicTickFormatter})}}LinearAxis.__name__="LinearAxis",LinearAxis.init_LinearAxis();var timezone={exports:{}},module;module=timezone,function(e){module.exports?module.exports=e():this.tz=e()}((function(){function e(e,t,i){var n,o=t.day[1];do{n=new Date(Date.UTC(i,t.month,Math.abs(o++)))}while(t.day[0]<7&&n.getUTCDay()!=t.day[0]);return(n={clock:t.clock,sort:n.getTime(),rule:t,save:6e4*t.save,offset:e.offset})[n.clock]=n.sort+6e4*t.time,n.posix?n.wallclock=n[n.clock]+(e.offset+t.saved):n.posix=n[n.clock]-(e.offset+t.saved),n}function t(t,i,n){var o,r,s,a,l,c,d,h=t[t.zone],u=[],p=new Date(n).getUTCFullYear(),_=1;for(o=1,r=h.length;o<r&&!(h[o][i]<=n);o++);if((s=h[o]).rules){for(c=t[s.rules],d=p+1;d>=p-_;--d)for(o=0,r=c.length;o<r;o++)c[o].from<=d&&d<=c[o].to?u.push(e(s,c[o],d)):c[o].to<d&&1==_&&(_=d-c[o].to);for(u.sort((function(e,t){return e.sort-t.sort})),o=0,r=u.length;o<r;o++)n>=u[o][i]&&u[o][u[o].clock]>s[u[o].clock]&&(a=u[o])}return a&&((l=/^(.*)\/(.*)$/.exec(s.format))?a.abbrev=l[a.save?2:1]:a.abbrev=s.format.replace(/%s/,a.rule.letter)),a||s}function i(e,i){return"UTC"==e.zone?i:(e.entry=t(e,"posix",i),i+e.entry.offset+e.entry.save)}function n(e,i){return"UTC"==e.zone?i:(e.entry=n=t(e,"wallclock",i),0<(o=i-n.wallclock)&&o<n.save?null:i-n.offset-n.save);var n,o}function o(e,t,o){var r,a=+(o[1]+1),c=o[2]*a,d=s.indexOf(o[3].toLowerCase());if(d>9)t+=c*l[d-10];else{if(r=new Date(i(e,t)),d<7)for(;c;)r.setUTCDate(r.getUTCDate()+a),r.getUTCDay()==d&&(c-=a);else 7==d?r.setUTCFullYear(r.getUTCFullYear()+c):8==d?r.setUTCMonth(r.getUTCMonth()+c):r.setUTCDate(r.getUTCDate()+c);null==(t=n(e,r.getTime()))&&(t=n(e,r.getTime()+864e5*a)-864e5*a)}return t}var r={clock:function(){return+new Date},zone:"UTC",entry:{abbrev:"UTC",offset:0,save:0},UTC:1,z:function(e,t,i,n){var o,r,s=this.entry.offset+this.entry.save,a=Math.abs(s/1e3),l=[],c=3600;for(o=0;o<3;o++)l.push(("0"+Math.floor(a/c)).slice(-2)),a%=c,c/=60;return"^"!=i||s?("^"==i&&(n=3),3==n?(r=(r=l.join(":")).replace(/:00$/,""),"^"!=i&&(r=r.replace(/:00$/,""))):n?(r=l.slice(0,n+1).join(":"),"^"==i&&(r=r.replace(/:00$/,""))):r=l.slice(0,2).join(""),r=(r=(s<0?"-":"+")+r).replace(/([-+])(0)/,{_:" $1","-":"$1"}[i]||"$1$2")):"Z"},"%":function(e){return"%"},n:function(e){return"\n"},t:function(e){return"\t"},U:function(e){return c(e,0)},W:function(e){return c(e,1)},V:function(e){return d(e)[0]},G:function(e){return d(e)[1]},g:function(e){return d(e)[1]%100},j:function(e){return Math.floor((e.getTime()-Date.UTC(e.getUTCFullYear(),0))/864e5)+1},s:function(e){return Math.floor(e.getTime()/1e3)},C:function(e){return Math.floor(e.getUTCFullYear()/100)},N:function(e){return e.getTime()%1e3*1e6},m:function(e){return e.getUTCMonth()+1},Y:function(e){return e.getUTCFullYear()},y:function(e){return e.getUTCFullYear()%100},H:function(e){return e.getUTCHours()},M:function(e){return e.getUTCMinutes()},S:function(e){return e.getUTCSeconds()},e:function(e){return e.getUTCDate()},d:function(e){return e.getUTCDate()},u:function(e){return e.getUTCDay()||7},w:function(e){return e.getUTCDay()},l:function(e){return e.getUTCHours()%12||12},I:function(e){return e.getUTCHours()%12||12},k:function(e){return e.getUTCHours()},Z:function(e){return this.entry.abbrev},a:function(e){return this[this.locale].day.abbrev[e.getUTCDay()]},A:function(e){return this[this.locale].day.full[e.getUTCDay()]},h:function(e){return this[this.locale].month.abbrev[e.getUTCMonth()]},b:function(e){return this[this.locale].month.abbrev[e.getUTCMonth()]},B:function(e){return this[this.locale].month.full[e.getUTCMonth()]},P:function(e){return this[this.locale].meridiem[Math.floor(e.getUTCHours()/12)].toLowerCase()},p:function(e){return this[this.locale].meridiem[Math.floor(e.getUTCHours()/12)]},R:function(e,t){return this.convert([t,"%H:%M"])},T:function(e,t){return this.convert([t,"%H:%M:%S"])},D:function(e,t){return this.convert([t,"%m/%d/%y"])},F:function(e,t){return this.convert([t,"%Y-%m-%d"])},x:function(e,t){return this.convert([t,this[this.locale].date])},r:function(e,t){return this.convert([t,this[this.locale].time12||"%I:%M:%S"])},X:function(e,t){return this.convert([t,this[this.locale].time24])},c:function(e,t){return this.convert([t,this[this.locale].dateTime])},convert:function(e){if(!e.length)return"1.0.23";var t,r,s,l,c,d=Object.create(this),h=[];for(t=0;t<e.length;t++)if(l=e[t],Array.isArray(l))t||isNaN(l[1])?l.splice.apply(e,[t--,1].concat(l)):c=l;else if(isNaN(l)){if("string"==(s=typeof l))~l.indexOf("%")?d.format=l:t||"*"!=l?!t&&(s=/^(\d{4})-(\d{2})-(\d{2})(?:[T\s](\d{2}):(\d{2})(?::(\d{2})(?:\.(\d+))?)?(Z|(([+-])(\d{2}(:\d{2}){0,2})))?)?$/.exec(l))?((c=[]).push.apply(c,s.slice(1,8)),s[9]?(c.push(s[10]+1),c.push.apply(c,s[11].split(/:/))):s[8]&&c.push(1)):/^\w{2,3}_\w{2}$/.test(l)?d.locale=l:(s=a.exec(l))?h.push(s):d.zone=l:c=l;else if("function"==s){if(s=l.call(d))return s}else if(/^\w{2,3}_\w{2}$/.test(l.name))d[l.name]=l;else if(l.zones){for(s in l.zones)d[s]=l.zones[s];for(s in l.rules)d[s]=l.rules[s]}}else t||(c=l);if(d[d.locale]||delete d.locale,d[d.zone]||delete d.zone,null!=c){if("*"==c)c=d.clock();else if(Array.isArray(c)){for(s=[],r=!c[7],t=0;t<11;t++)s[t]=+(c[t]||0);--s[1],c=Date.UTC.apply(Date.UTC,s)+-s[7]*(36e5*s[8]+6e4*s[9]+1e3*s[10])}else c=Math.floor(c);if(!isNaN(c)){if(r&&(c=n(d,c)),null==c)return c;for(t=0,r=h.length;t<r;t++)c=o(d,c,h[t]);return d.format?(s=new Date(i(d,c)),d.format.replace(/%([-0_^]?)(:{0,3})(\d*)(.)/g,(function(e,t,i,n,o){var r,a,l="0";if(r=d[o]){for(e=String(r.call(d,s,c,t,i.length)),"_"==(t||r.style)&&(l=" "),a="-"==t?0:r.pad||0;e.length<a;)e=l+e;for(a="-"==t?0:n||r.pad;e.length<a;)e=l+e;"N"==o&&a<e.length&&(e=e.slice(0,a)),"^"==t&&(e=e.toUpperCase())}return e}))):c}}return function(){return d.convert(arguments)}},locale:"en_US",en_US:{date:"%m/%d/%Y",time24:"%I:%M:%S %p",time12:"%I:%M:%S %p",dateTime:"%a %d %b %Y %I:%M:%S %p %Z",meridiem:["AM","PM"],month:{abbrev:"Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec".split("|"),full:"January|February|March|April|May|June|July|August|September|October|November|December".split("|")},day:{abbrev:"Sun|Mon|Tue|Wed|Thu|Fri|Sat".split("|"),full:"Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday".split("|")}}},s="Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|year|month|day|hour|minute|second|millisecond",a=new RegExp("^\\s*([+-])(\\d+)\\s+("+s+")s?\\s*$","i"),l=[36e5,6e4,1e3,1];function c(e,t){var i,n,o;return n=new Date(Date.UTC(e.getUTCFullYear(),0)),i=Math.floor((e.getTime()-n.getTime())/864e5),n.getUTCDay()==t?o=0:8==(o=7-n.getUTCDay()+t)&&(o=1),i>=o?Math.floor((i-o)/7)+1:0}function d(e){var t,i,n;return i=e.getUTCFullYear(),t=new Date(Date.UTC(i,0)).getUTCDay(),(n=c(e,1)+(t>1&&t<=4?1:0))?53!=n||4==t||3==t&&29==new Date(i,1,29).getDate()?[n,e.getUTCFullYear()]:[1,e.getUTCFullYear()+1]:(i=e.getUTCFullYear()-1,[n=4==(t=new Date(Date.UTC(i,0)).getUTCDay())||3==t&&29==new Date(i,1,29).getDate()?53:52,e.getUTCFullYear()-1])}return s=s.toLowerCase().split("|"),"delmHMSUWVgCIky".replace(/./g,(function(e){r[e].pad=2})),r.N.pad=9,r.j.pad=3,r.k.style="_",r.l.style="_",r.e.style="_",function(){return r.convert(arguments)}}));var tz=timezone.exports,numbro={exports:{}};
/*!
 * numbro.js
 * version : 1.6.2
 * author : Fretagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
!function(e){var t,i={},n=i,o="en-US",r=null,s="0,0";e.exports;function a(e){this._value=e}function l(e){var t,i="";for(t=0;t<e;t++)i+="0";return i}function c(e,t,i,n){var o,r,s=Math.pow(10,t);return r=e.toFixed(0).search("e")>-1?function(e,t){var i,n,o,r;return i=(r=e.toString()).split("e")[0],o=r.split("e")[1],r=i.split(".")[0]+(n=i.split(".")[1]||"")+l(o-n.length),t>0&&(r+="."+l(t)),r}(e,t):(i(e*s)/s).toFixed(t),n&&(o=new RegExp("0{1,"+n+"}$"),r=r.replace(o,"")),r}function d(e,t,n){return t.indexOf("$")>-1?function(e,t,n){var r,s,a=t,l=a.indexOf("$"),c=a.indexOf("("),d=a.indexOf("+"),u=a.indexOf("-"),p="",_="";-1===a.indexOf("$")?"infix"===i[o].currency.position?(_=i[o].currency.symbol,i[o].currency.spaceSeparated&&(_=" "+_+" ")):i[o].currency.spaceSeparated&&(p=" "):a.indexOf(" $")>-1?(p=" ",a=a.replace(" $","")):a.indexOf("$ ")>-1?(p=" ",a=a.replace("$ ","")):a=a.replace("$","");if(s=h(e,a,n,_),-1===t.indexOf("$"))switch(i[o].currency.position){case"postfix":s.indexOf(")")>-1?((s=s.split("")).splice(-1,0,p+i[o].currency.symbol),s=s.join("")):s=s+p+i[o].currency.symbol;break;case"infix":break;case"prefix":s.indexOf("(")>-1||s.indexOf("-")>-1?(s=s.split(""),r=Math.max(c,u)+1,s.splice(r,0,i[o].currency.symbol+p),s=s.join("")):s=i[o].currency.symbol+p+s;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else l<=1?s.indexOf("(")>-1||s.indexOf("+")>-1||s.indexOf("-")>-1?(r=1,(l<c||l<d||l<u)&&(r=0),(s=s.split("")).splice(r,0,i[o].currency.symbol+p),s=s.join("")):s=i[o].currency.symbol+p+s:s.indexOf(")")>-1?((s=s.split("")).splice(-1,0,p+i[o].currency.symbol),s=s.join("")):s=s+p+i[o].currency.symbol;return s}(e,t,n):t.indexOf("%")>-1?function(e,t,i){var n,o="";e*=100,t.indexOf(" %")>-1?(o=" ",t=t.replace(" %","")):t=t.replace("%","");(n=h(e,t,i)).indexOf(")")>-1?((n=n.split("")).splice(-1,0,o+"%"),n=n.join("")):n=n+o+"%";return n}(e,t,n):t.indexOf(":")>-1?function(e){var t=Math.floor(e/60/60),i=Math.floor((e-60*t*60)/60),n=Math.round(e-60*t*60-60*i);return t+":"+(i<10?"0"+i:i)+":"+(n<10?"0"+n:n)}(e):h(e,t,n)}function h(e,t,n,s){var a,l,d,h,u,p,_,f,g,m,v,b,y,w,A,x,k,C=!1,S=!1,T=!1,R="",E=!1,P=!1,M=!1,D=!1,I=!1,B="",z="",L=Math.abs(e),N=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],$=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],V="",O=!1,F=!1;if(0===e&&null!==r)return r;if(!isFinite(e))return""+e;if(0===t.indexOf("{")){var G=t.indexOf("}");if(-1===G)throw Error('Format should also contain a "}"');b=t.slice(1,G),t=t.slice(G+1)}else b="";if(t.indexOf("}")===t.length-1){var H=t.indexOf("{");if(-1===H)throw Error('Format should also contain a "{"');y=t.slice(H+1,-1),t=t.slice(0,H+1)}else y="";if(x=null===(k=-1===t.indexOf(".")?t.match(/([0-9]+).*/):t.match(/([0-9]+)\..*/))?-1:k[1].length,-1!==t.indexOf("-")&&(O=!0),t.indexOf("(")>-1?(C=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(S=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1){if(m=t.split(".")[0].match(/[0-9]+/g)||["0"],m=parseInt(m[0],10),E=t.indexOf("aK")>=0,P=t.indexOf("aM")>=0,M=t.indexOf("aB")>=0,D=t.indexOf("aT")>=0,I=E||P||M||D,t.indexOf(" a")>-1?(R=" ",t=t.replace(" a","")):t=t.replace("a",""),_=0===(_=(u=Math.floor(Math.log(L)/Math.LN10)+1)%3)?3:_,m&&0!==L&&(p=Math.floor(Math.log(L)/Math.LN10)+1-m,f=3*~~((Math.min(m,u)-_)/3),L/=Math.pow(10,f),-1===t.indexOf(".")&&m>3))for(t+="[.]",A=(A=0===p?0:3*~~(p/3)-p)<0?A+3:A,a=0;a<A;a++)t+="0";Math.floor(Math.log(Math.abs(e))/Math.LN10)+1!==m&&(L>=Math.pow(10,12)&&!I||D?(R+=i[o].abbreviations.trillion,e/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!I||M?(R+=i[o].abbreviations.billion,e/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!I||P?(R+=i[o].abbreviations.million,e/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!I||E)&&(R+=i[o].abbreviations.thousand,e/=Math.pow(10,3)))}if(t.indexOf("b")>-1)for(t.indexOf(" b")>-1?(B=" ",t=t.replace(" b","")):t=t.replace("b",""),h=0;h<=N.length;h++)if(l=Math.pow(1024,h),d=Math.pow(1024,h+1),e>=l&&e<d){B+=N[h],l>0&&(e/=l);break}if(t.indexOf("d")>-1)for(t.indexOf(" d")>-1?(B=" ",t=t.replace(" d","")):t=t.replace("d",""),h=0;h<=$.length;h++)if(l=Math.pow(1e3,h),d=Math.pow(1e3,h+1),e>=l&&e<d){B+=$[h],l>0&&(e/=l);break}if(t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(z=" ",t=t.replace(" o","")):t=t.replace("o",""),i[o].ordinal&&(z+=i[o].ordinal(e))),t.indexOf("[.]")>-1&&(T=!0,t=t.replace("[.]",".")),g=e.toString().split(".")[0],v=t.split(".")[1],w=t.indexOf(","),v){if(g=(V=-1!==v.indexOf("*")?c(e,e.toString().split(".")[1].length,n):v.indexOf("[")>-1?c(e,(v=(v=v.replace("]","")).split("["))[0].length+v[1].length,n,v[1].length):c(e,v.length,n)).split(".")[0],V.split(".")[1].length)V=(s?R+s:i[o].delimiters.decimal)+V.split(".")[1];else V="";T&&0===Number(V.slice(1))&&(V="")}else g=c(e,null,n);return g.indexOf("-")>-1&&(g=g.slice(1),F=!0),g.length<x&&(g=new Array(x-g.length+1).join("0")+g),w>-1&&(g=g.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+i[o].delimiters.thousands)),0===t.indexOf(".")&&(g=""),b+(t.indexOf("(")<t.indexOf("-")?(C&&F?"(":"")+(O&&F||!C&&F?"-":""):(O&&F||!C&&F?"-":"")+(C&&F?"(":""))+(!F&&S&&0!==e?"+":"")+g+V+(z||"")+(R&&!s?R:"")+(B||"")+(C&&F?")":"")+y}function u(e,t){i[e]=t}function p(e){o=e;var n=i[e].defaults;n&&n.format&&t.defaultFormat(n.format),n&&n.currencyFormat&&t.defaultCurrencyFormat(n.currencyFormat)}(t=function(e){return t.isNumbro(e)?e=e.value():0===e||void 0===e?e=0:Number(e)||(e=t.fn.unformat(e)),new a(Number(e))}).version="1.6.2",t.isNumbro=function(e){return e instanceof a},t.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var i=e,o=e.split("-")[0],r=null;n[i]||(Object.keys(n).forEach((function(e){r||e.split("-")[0]!==o||(r=e)})),i=r||t||"en-US"),p(i)},t.setCulture=function(e,t){var n=e,o=e.split("-")[1],r=null;i[n]||(o&&Object.keys(i).forEach((function(e){r||e.split("-")[1]!==o||(r=e)})),n=r||t||"en-US"),p(n)},t.language=function(e,i){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!e)return o;if(e&&!i){if(!n[e])throw new Error("Unknown language : "+e);p(e)}return!i&&n[e]||u(e,i),t},t.culture=function(e,n){if(!e)return o;if(e&&!n){if(!i[e])throw new Error("Unknown culture : "+e);p(e)}return!n&&i[e]||u(e,n),t},t.languageData=function(e){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!e)return n[o];if(!n[e])throw new Error("Unknown language : "+e);return n[e]},t.cultureData=function(e){if(!e)return i[o];if(!i[e])throw new Error("Unknown culture : "+e);return i[e]},t.culture("en-US",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}}),t.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),n},t.cultures=function(){return i},t.zeroFormat=function(e){r="string"==typeof e?e:null},t.defaultFormat=function(e){s="string"==typeof e?e:"0.0"},t.defaultCurrencyFormat=function(e){},t.validate=function(e,i){var n,o,r,s,a,l,c,d;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)),(e=e.trim()).match(/^\d+$/))return!0;if(""===e)return!1;try{c=t.cultureData(i)}catch(h){c=t.cultureData(t.culture())}return r=c.currency.symbol,a=c.abbreviations,n=c.delimiters.decimal,o="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,(null===(d=e.match(/^[^\d]+/))||(e=e.substr(1),d[0]===r))&&((null===(d=e.match(/[^\d]+$/))||(e=e.slice(0,-1),d[0]===a.thousand||d[0]===a.million||d[0]===a.billion||d[0]===a.trillion))&&(l=new RegExp(o+"{2}"),!e.match(/[^\d.,]/g)&&(!((s=e.split(n)).length>2)&&(s.length<2?!!s[0].match(/^\d+.*\d$/)&&!s[0].match(l):1===s[0].length?!!s[0].match(/^\d+$/)&&!s[0].match(l)&&!!s[1].match(/^\d+$/):!!s[0].match(/^\d+.*\d$/)&&!s[0].match(l)&&!!s[1].match(/^\d+$/)))))},e.exports={format:function(e,i,n,o){return null!=n&&n!==t.culture()&&t.setCulture(n),d(Number(e),null!=i?i:s,null==o?Math.round:o)}}}(numbro);var sprintf$1={},exports2;exports2=sprintf$1,function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(e){return n(r(e),arguments)}function i(e,i){return t.apply(null,[e].concat(i||[]))}function n(i,n){var o,r,s,a,l,c,d,h,u,p=1,_=i.length,f="";for(r=0;r<_;r++)if("string"==typeof i[r])f+=i[r];else if("object"==typeof i[r]){if((a=i[r]).keys)for(o=n[p],s=0;s<a.keys.length;s++){if(null==o)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[s],a.keys[s-1]));o=o[a.keys[s]]}else o=a.param_no?n[a.param_no]:n[p++];if(e.not_type.test(a.type)&&e.not_primitive.test(a.type)&&o instanceof Function&&(o=o()),e.numeric_arg.test(a.type)&&"number"!=typeof o&&isNaN(o))throw new TypeError(t("[sprintf] expecting number but found %T",o));switch(e.number.test(a.type)&&(h=o>=0),a.type){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,a.width?parseInt(a.width):0);break;case"e":o=a.precision?parseFloat(o).toExponential(a.precision):parseFloat(o).toExponential();break;case"f":o=a.precision?parseFloat(o).toFixed(a.precision):parseFloat(o);break;case"g":o=a.precision?String(Number(o.toPrecision(a.precision))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o),o=a.precision?o.substring(0,a.precision):o;break;case"t":o=String(!!o),o=a.precision?o.substring(0,a.precision):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase(),o=a.precision?o.substring(0,a.precision):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf(),o=a.precision?o.substring(0,a.precision):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase()}e.json.test(a.type)?f+=o:(!e.number.test(a.type)||h&&!a.sign?u="":(u=h?"+":"-",o=o.toString().replace(e.sign,"")),c=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",d=a.width-(u+o).length,l=a.width&&d>0?c.repeat(d):"",f+=a.align?u+o+l:"0"===c?u+l+o:l+u+o)}return f}var o=Object.create(null);function r(t){if(o[t])return o[t];for(var i,n=t,r=[],s=0;n;){if(null!==(i=e.text.exec(n)))r.push(i[0]);else if(null!==(i=e.modulo.exec(n)))r.push("%");else{if(null===(i=e.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){s|=1;var a=[],l=i[2],c=[];if(null===(c=e.key.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(c[1]);""!==(l=l.substring(c[0].length));)if(null!==(c=e.key_access.exec(l)))a.push(c[1]);else{if(null===(c=e.index_access.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(c[1])}i[2]=a}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}n=n.substring(i[0].length)}return o[t]=r}exports2.sprintf=t,exports2.vsprintf=i,"undefined"!=typeof window&&(window.sprintf=t,window.vsprintf=i)}();const FormatterType=Enum("numeral","printf","datetime"),DEFAULT_FORMATTERS={numeral:(e,t,i)=>numbro.exports.format(e,t),datetime:(e,t,i)=>tz(e,t),printf:(e,t,i)=>sprintf(t,e)};function sprintf(e,...t){return sprintf$1.sprintf(e,...t)}function basic_formatter(e,t,i){if(isNumber(e)){return sprintf((()=>{switch(!1){case Math.floor(e)!=e:return"%d";case!(Math.abs(e)>.1&&Math.abs(e)<1e3):return"%0.3f";default:return"%0.3e"}})(),e)}return`${e}`}function get_formatter(e,t,i){if(null==t)return basic_formatter;if(null!=i&&e in i){const t=i[e];if(isString(t)){if(t in DEFAULT_FORMATTERS)return DEFAULT_FORMATTERS[t];throw new Error(`Unknown tooltip field formatter type '${t}'`)}return function(e,i,n){return t.format(e,i,n)}}return DEFAULT_FORMATTERS.numeral}function _get_special_value(e,t){if(e in t)return t[e];throw new Error(`Unknown special variable '$${e}'`)}function _get_column_value(e,t,i){const n=t.get_column(e);if(null==n)return null;if(isNumber(i))return n[i];const o=n[i.index];if(isTypedArray(o)||isArray(o)){if(isArray(o[0])){return o[i.dim2][i.dim1]}return o[i.flat_index]}return o}function get_value(e,t,i,n){if("$"==e[0]){return _get_special_value(e.substring(1),n)}return _get_column_value(e.substring(1).replace(/[{}]/g,""),t,i)}function replace_placeholders(e,t,i,n,o={},r){let s,a;if(isString(e)?(s=e,a=!1):(s=e.html,a=!0),s=s.replace(/@\$name/g,(e=>`@{${o.name}}`)),s=s.replace(/((?:\$\w+)|(?:@\w+)|(?:@{(?:[^{}]+)}))(?:{([^{}]+)})?/g,((e,s,l)=>{const c=get_value(s,t,i,o);if(null==c)return r?r("???"):"???";if("safe"==l)return a=!0,`${c}`;const d=`${get_formatter(s,l,n)(c,l,o)}`;return r?r(d):d})),a){return[...(new DOMParser).parseFromString(s,"text/html").body.childNodes]}return s}function _us(e){return Math.round(e/1e3%1*1e6)}function _array(e){return tz(e,"%Y %m %d %H %M %S").split(/\s+/).map((e=>parseInt(e,10)))}function _strftime(e,t){if(isFunction(t))return t(e);{const i=sprintf("$1%06d",_us(e));return-1==(t=t.replace(/((^|[^%])(%%)*)%f/,i)).indexOf("%")?t:tz(e,t)}}const format_order=["microseconds","milliseconds","seconds","minsec","minutes","hourmin","hours","days","months","years"];class DatetimeTickFormatter extends TickFormatter{constructor(e){super(e),this.strip_leading_zeros=!0}static init_DatetimeTickFormatter(){this.define((({String:e,Array:t})=>({microseconds:[t(e),["%fus"]],milliseconds:[t(e),["%3Nms","%S.%3Ns"]],seconds:[t(e),["%Ss"]],minsec:[t(e),[":%M:%S"]],minutes:[t(e),[":%M","%Mm"]],hourmin:[t(e),["%H:%M"]],hours:[t(e),["%Hh","%H:%M"]],days:[t(e),["%m/%d","%a%d"]],months:[t(e),["%m/%Y","%b %Y"]],years:[t(e),["%Y"]]})))}initialize(){super.initialize(),this._update_width_formats()}_update_width_formats(){const e=+tz(new Date),t=function(t){return unzip(sort_by(zip(t.map((t=>_strftime(e,t).length)),t),(([e])=>e)))};this._width_formats={microseconds:t(this.microseconds),milliseconds:t(this.milliseconds),seconds:t(this.seconds),minsec:t(this.minsec),minutes:t(this.minutes),hourmin:t(this.hourmin),hours:t(this.hours),days:t(this.days),months:t(this.months),years:t(this.years)}}_get_resolution_str(e,t){const i=1.1*e;switch(!1){case!(i<.001):return"microseconds";case!(i<1):return"milliseconds";case!(i<60):return t>=60?"minsec":"seconds";case!(i<3600):return t>=3600?"hourmin":"minutes";case!(i<86400):return"hours";case!(i<2678400):return"days";case!(i<31536e3):return"months";default:return"years"}}doFormat(e,t){if(0==e.length)return[];const i=Math.abs(e[e.length-1]-e[0])/1e3,n=i/(e.length-1),o=this._get_resolution_str(n,i),[,[r]]=this._width_formats[o],s=[],a=format_order.indexOf(o),l={};for(const d of format_order)l[d]=0;l.seconds=5,l.minsec=4,l.minutes=4,l.hourmin=3,l.hours=3;for(const d of e){let e,t;try{t=_array(d),e=_strftime(d,r)}catch(c){logger.warn(`unable to format tick for timestamp value ${d}`),logger.warn(` - ${c}`),s.push("ERR");continue}let i=!1,n=a;for(;0==t[l[format_order[n]]];){let r;if(n+=1,n==format_order.length)break;if(("minsec"==o||"hourmin"==o)&&!i){if("minsec"==o&&0==t[4]&&0!=t[5]||"hourmin"==o&&0==t[3]&&0!=t[4]){r=this._width_formats[format_order[a-1]][1][0],e=_strftime(d,r);break}i=!0}r=this._width_formats[format_order[n]][1][0],e=_strftime(d,r)}if(this.strip_leading_zeros){let t=e.replace(/^0+/g,"");t!=e&&isNaN(parseInt(t))&&(t=`0${t}`),s.push(t)}else s.push(e)}return s}}DatetimeTickFormatter.__name__="DatetimeTickFormatter",DatetimeTickFormatter.init_DatetimeTickFormatter();class CompositeTicker extends ContinuousTicker{constructor(e){super(e)}static init_CompositeTicker(){this.define((({Array:e,Ref:t})=>({tickers:[e(t(ContinuousTicker)),[]]})))}get min_intervals(){return this.tickers.map((e=>e.get_min_interval()))}get max_intervals(){return this.tickers.map((e=>e.get_max_interval()))}get_min_interval(){return this.min_intervals[0]}get_max_interval(){return this.max_intervals[0]}get_best_ticker(e,t,i){const n=t-e,o=this.get_ideal_interval(e,t,i),r=[sorted_index(this.min_intervals,o)-1,sorted_index(this.max_intervals,o)],s=[this.min_intervals[r[0]],this.max_intervals[r[1]]].map((e=>Math.abs(i-n/e)));let a;if(is_empty(s.filter((e=>!isNaN(e)))))a=this.tickers[0];else{const e=r[argmin(s)];a=this.tickers[e]}return a}get_interval(e,t,i){return this.get_best_ticker(e,t,i).get_interval(e,t,i)}get_ticks_no_defaults(e,t,i,n){return this.get_best_ticker(e,t,n).get_ticks_no_defaults(e,t,i,n)}}CompositeTicker.__name__="CompositeTicker",CompositeTicker.init_CompositeTicker();class SingleIntervalTicker extends ContinuousTicker{constructor(e){super(e)}static init_SingleIntervalTicker(){this.define((({Number:e})=>({interval:[e]})))}get_interval(e,t,i){return this.interval}get_min_interval(){return this.interval}get_max_interval(){return this.interval}}SingleIntervalTicker.__name__="SingleIntervalTicker",SingleIntervalTicker.init_SingleIntervalTicker();const ONE_MILLI=1,ONE_SECOND=1e3,ONE_MINUTE=60*ONE_SECOND,ONE_HOUR=60*ONE_MINUTE,ONE_DAY=24*ONE_HOUR,ONE_MONTH=30*ONE_DAY,ONE_YEAR=365*ONE_DAY;function copy_date(e){return new Date(e.getTime())}function last_month_no_later_than(e){const t=copy_date(e);return t.setUTCDate(1),t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCSeconds(0),t.setUTCMilliseconds(0),t}function last_year_no_later_than(e){const t=last_month_no_later_than(e);return t.setUTCMonth(0),t}function date_range_by_month(e,t){const i=last_month_no_later_than(new Date(e)),n=last_month_no_later_than(new Date(t));n.setUTCMonth(n.getUTCMonth()+1);const o=[],r=i;for(;o.push(copy_date(r)),r.setUTCMonth(r.getUTCMonth()+1),!(r>n););return o}class DaysTicker extends SingleIntervalTicker{constructor(e){super(e)}static init_DaysTicker(){this.define((({Int:e,Array:t})=>({days:[t(e),[]]}))),this.override({num_minor_ticks:0})}initialize(){super.initialize();const e=this.days;e.length>1?this.interval=(e[1]-e[0])*ONE_DAY:this.interval=31*ONE_DAY}get_ticks_no_defaults(e,t,i,n){const o=date_range_by_month(e,t),r=this.days,s=this.interval;return{major:concat$1(o.map((e=>((e,t)=>{const i=e.getUTCMonth(),n=[];for(const o of r){const r=copy_date(e);r.setUTCDate(o),new Date(r.getTime()+t/2).getUTCMonth()==i&&n.push(r)}return n})(e,s)))).map((e=>e.getTime())).filter((i=>e<=i&&i<=t)),minor:[]}}}function date_range_by_year(e,t){const i=last_year_no_later_than(new Date(e)),n=last_year_no_later_than(new Date(t));n.setUTCFullYear(n.getUTCFullYear()+1);const o=[],r=i;for(;o.push(copy_date(r)),r.setUTCFullYear(r.getUTCFullYear()+1),!(r>n););return o}DaysTicker.__name__="DaysTicker",DaysTicker.init_DaysTicker();class MonthsTicker extends SingleIntervalTicker{constructor(e){super(e)}static init_MonthsTicker(){this.define((({Int:e,Array:t})=>({months:[t(e),[]]})))}initialize(){super.initialize();const e=this.months;e.length>1?this.interval=(e[1]-e[0])*ONE_MONTH:this.interval=12*ONE_MONTH}get_ticks_no_defaults(e,t,i,n){const o=date_range_by_year(e,t),r=this.months;return{major:concat$1(o.map((e=>r.map((t=>{const i=copy_date(e);return i.setUTCMonth(t),i}))))).map((e=>e.getTime())).filter((i=>e<=i&&i<=t)),minor:[]}}}MonthsTicker.__name__="MonthsTicker",MonthsTicker.init_MonthsTicker();class YearsTicker extends SingleIntervalTicker{constructor(e){super(e)}initialize(){super.initialize(),this.interval=ONE_YEAR,this.basic_ticker=new BasicTicker({num_minor_ticks:0})}get_ticks_no_defaults(e,t,i,n){const o=last_year_no_later_than(new Date(e)).getUTCFullYear(),r=last_year_no_later_than(new Date(t)).getUTCFullYear();return{major:this.basic_ticker.get_ticks_no_defaults(o,r,i,n).major.map((e=>Date.UTC(e,0,1))).filter((i=>e<=i&&i<=t)),minor:[]}}}YearsTicker.__name__="YearsTicker";class DatetimeTicker extends CompositeTicker{constructor(e){super(e)}static init_DatetimeTicker(){this.override({num_minor_ticks:0,tickers:()=>[new AdaptiveTicker({mantissas:[1,2,5],base:10,min_interval:0,max_interval:500*ONE_MILLI,num_minor_ticks:0}),new AdaptiveTicker({mantissas:[1,2,5,10,15,20,30],base:60,min_interval:ONE_SECOND,max_interval:30*ONE_MINUTE,num_minor_ticks:0}),new AdaptiveTicker({mantissas:[1,2,4,6,8,12],base:24,min_interval:ONE_HOUR,max_interval:12*ONE_HOUR,num_minor_ticks:0}),new DaysTicker({days:range(1,32)}),new DaysTicker({days:range(1,31,3)}),new DaysTicker({days:[1,8,15,22]}),new DaysTicker({days:[1,15]}),new MonthsTicker({months:range(0,12,1)}),new MonthsTicker({months:range(0,12,2)}),new MonthsTicker({months:range(0,12,4)}),new MonthsTicker({months:range(0,12,6)}),new YearsTicker({})]})}}DatetimeTicker.__name__="DatetimeTicker",DatetimeTicker.init_DatetimeTicker();class DatetimeAxisView extends LinearAxisView{}DatetimeAxisView.__name__="DatetimeAxisView";class DatetimeAxis extends LinearAxis{constructor(e){super(e)}static init_DatetimeAxis(){this.prototype.default_view=DatetimeAxisView,this.override({ticker:()=>new DatetimeTicker,formatter:()=>new DatetimeTickFormatter})}}DatetimeAxis.__name__="DatetimeAxis",DatetimeAxis.init_DatetimeAxis();class LogTicker extends AdaptiveTicker{constructor(e){super(e)}static init_LogTicker(){this.override({mantissas:[1,5]})}get_ticks_no_defaults(e,t,i,n){const o=this.num_minor_ticks,r=[],s=this.base,a=Math.log(e)/Math.log(s),l=Math.log(t)/Math.log(s),c=l-a;let d;if(isFinite(c))if(c<2){const i=this.get_interval(e,t,n);if(d=range(Math.floor(e/i),Math.ceil(t/i)+1).filter((e=>0!=e)).map((e=>e*i)).filter((i=>e<=i&&i<=t)),o>0&&d.length>0){const e=i/o,t=range(0,o).map((t=>t*e));for(const i of t.slice(1))r.push(d[0]-i);for(const i of d)for(const e of t)r.push(i+e)}}else{const e=Math.ceil(.999999*a),t=Math.floor(1.000001*l),i=Math.ceil((t-e)/9);if(d=range(e-1,t+1,i).map((e=>s**e)),o>0&&d.length>0){const e=s**i/o,t=range(1,o+1).map((t=>t*e));for(const i of t)r.push(d[0]/i);r.push(d[0]);for(const i of d)for(const e of t)r.push(i*e)}}else d=[];return{major:d.filter((i=>e<=i&&i<=t)),minor:r.filter((i=>e<=i&&i<=t))}}}LogTicker.__name__="LogTicker",LogTicker.init_LogTicker();const{log:log,round:round$1}=Math;class LogTickFormatter extends TickFormatter{constructor(e){super(e)}static init_LogTickFormatter(){this.define((({Ref:e,Nullable:t})=>({ticker:[t(e(LogTicker)),null]})))}initialize(){super.initialize(),this.basic_formatter=new BasicTickFormatter}format_graphics(e,t){var i,n;if(0==e.length)return[];const o=null!=(n=null==(i=this.ticker)?void 0:i.base)?n:10,r=this._exponents(e,o);return null==r?this.basic_formatter.format_graphics(e,t):r.map((e=>{const t=new TextBox({text:unicode_replace(`${o}`)}),i=new TextBox({text:unicode_replace(`${e}`)});return new BaseExpo(t,i)}))}_exponents(e,t){let i=null;const n=[];for(const o of e){const e=round$1(log(o)/log(t));if(i==e)return null;i=e,n.push(e)}return n}doFormat(e,t){var i,n;if(0==e.length)return[];const o=null!=(n=null==(i=this.ticker)?void 0:i.base)?n:10,r=this._exponents(e,o);return null==r?this.basic_formatter.doFormat(e,t):r.map((e=>unicode_replace(`${o}^${e}`)))}}LogTickFormatter.__name__="LogTickFormatter",LogTickFormatter.init_LogTickFormatter();class LogAxisView extends ContinuousAxisView{}LogAxisView.__name__="LogAxisView";class LogAxis extends ContinuousAxis{constructor(e){super(e)}static init_LogAxis(){this.prototype.default_view=LogAxisView,this.override({ticker:()=>new LogTicker,formatter:()=>new LogTickFormatter})}}LogAxis.__name__="LogAxis",LogAxis.init_LogAxis();class MercatorTickFormatter extends BasicTickFormatter{constructor(e){super(e)}static init_MercatorTickFormatter(){this.define((({Nullable:e})=>({dimension:[e(LatLon),null]})))}doFormat(e,t){if(null==this.dimension)throw new Error("MercatorTickFormatter.dimension not configured");if(0==e.length)return[];const i=e.length,n=new Array(i);if("lon"==this.dimension)for(let o=0;o<i;o++){const[i]=wgs84_mercator.invert(e[o],t.loc);n[o]=i}else for(let o=0;o<i;o++){const[,i]=wgs84_mercator.invert(t.loc,e[o]);n[o]=i}return super.doFormat(n,t)}}MercatorTickFormatter.__name__="MercatorTickFormatter",MercatorTickFormatter.init_MercatorTickFormatter();class MercatorTicker extends BasicTicker{constructor(e){super(e)}static init_MercatorTicker(){this.define((({Nullable:e})=>({dimension:[e(LatLon),null]})))}get_ticks_no_defaults(e,t,i,n){if(null==this.dimension)throw new Error(`${this}.dimension wasn't configured`);return[e,t]=clip_mercator(e,t,this.dimension),"lon"==this.dimension?this._get_ticks_lon(e,t,i,n):this._get_ticks_lat(e,t,i,n)}_get_ticks_lon(e,t,i,n){const[o]=wgs84_mercator.invert(e,i),[r,s]=wgs84_mercator.invert(t,i),a=super.get_ticks_no_defaults(o,r,i,n),l=[];for(const d of a.major)if(in_bounds(d,"lon")){const[e]=wgs84_mercator.compute(d,s);l.push(e)}const c=[];for(const d of a.minor)if(in_bounds(d,"lon")){const[e]=wgs84_mercator.compute(d,s);c.push(e)}return{major:l,minor:c}}_get_ticks_lat(e,t,i,n){const[,o]=wgs84_mercator.invert(i,e),[r,s]=wgs84_mercator.invert(i,t),a=super.get_ticks_no_defaults(o,s,i,n),l=[];for(const d of a.major)if(in_bounds(d,"lat")){const[,e]=wgs84_mercator.compute(r,d);l.push(e)}const c=[];for(const d of a.minor)if(in_bounds(d,"lat")){const[,e]=wgs84_mercator.compute(r,d);c.push(e)}return{major:l,minor:c}}}MercatorTicker.__name__="MercatorTicker",MercatorTicker.init_MercatorTicker();class MercatorAxisView extends AxisView{}MercatorAxisView.__name__="MercatorAxisView";class MercatorAxis extends LinearAxis{constructor(e){super(e)}static init_MercatorAxis(){this.prototype.default_view=MercatorAxisView,this.override({ticker:()=>new MercatorTicker({dimension:"lat"}),formatter:()=>new MercatorTickFormatter({dimension:"lat"})})}}MercatorAxis.__name__="MercatorAxis",MercatorAxis.init_MercatorAxis();class FixedTicker extends ContinuousTicker{constructor(e){super(e)}static init_FixedTicker(){this.define((({Number:e,Array:t})=>({ticks:[t(e),[]],minor_ticks:[t(e),[]]})))}get_ticks_no_defaults(e,t,i,n){return{major:this.ticks,minor:this.minor_ticks}}get_interval(e,t,i){return 0}get_min_interval(){return 0}get_max_interval(){return 0}}FixedTicker.__name__="FixedTicker",FixedTicker.init_FixedTicker();class Mapper extends Transform{constructor(e){super(e)}compute(e){throw new Error("mapping single values is not supported")}}function _convert_color(e){return encode_rgba(color2rgba(e))}function _convert_palette(e){const t=new Uint32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=_convert_color(e[i]);return t}Mapper.__name__="Mapper";class ColorMapper extends Mapper{constructor(e){super(e)}initialize(){super.initialize(),this.metrics_change=new Signal0(this,"metrics_change")}static init_ColorMapper(){this.define((({Color:e,Array:t})=>({palette:[t(e)],nan_color:[e,"gray"]})))}v_compute(e){const t=new Array(e.length);return this._v_compute(e,t,this.palette,this._colors((e=>e))),t}get rgba_mapper(){const e=this,t=_convert_palette(this.palette),i=this._colors(_convert_color);return{v_compute(n){const o=new ColorArray(n.length);return e._v_compute(n,o,t,i),new Uint8ClampedArray(to_big_endian(o).buffer)}}}_colors(e){return{nan_color:e(this.nan_color)}}}ColorMapper.__name__="ColorMapper",ColorMapper.init_ColorMapper();class ContinuousColorMapper extends ColorMapper{constructor(e){super(e),this._scan_data=null}static init_ContinuousColorMapper(){this.define((({Number:e,String:t,Ref:i,Color:n,Or:o,Tuple:r,Array:s,Nullable:a})=>({high:[a(e),null],low:[a(e),null],high_color:[a(n),null],low_color:[a(n),null],domain:[s(r(i(GlyphRenderer),o(t,s(t)))),[]]})))}connect_signals(){super.connect_signals();const e=()=>{for(const[e]of this.domain)this.connect(e.view.change,(()=>this.update_data())),this.connect(e.data_source.selected.change,(()=>this.update_data()))};this.connect(this.properties.domain.change,(()=>e())),e()}update_data(){const{domain:e,palette:t}=this,i=[...this._collect(e)];this._scan_data=this.scan(i,t.length),this.metrics_change.emit(),this.change.emit()}get metrics(){return null==this._scan_data&&this.update_data(),this._scan_data}*_collect(e){for(const[t,i]of e)for(const e of isArray(i)?i:[i]){let i=t.data_source.get_column(e);i=t.view.indices.select(i);const n=t.view.masked,o=t.data_source.selected.indices;let r;if(null!=n&&o.length>0?r=intersection([...n],o):null!=n?r=[...n]:o.length>0&&(r=o),null!=r&&(i=map(r,(e=>i[e]))),i.length>0&&!isNumber(i[0]))for(const e of i)yield*e;else yield*i}}_v_compute(e,t,i,n){const{nan_color:o}=n;let{low_color:r,high_color:s}=n;null==r&&(r=i[0]),null==s&&(s=i[i.length-1]);const{domain:a}=this,l=is_empty(a)?e:[...this._collect(a)];this._scan_data=this.scan(l,i.length),this.metrics_change.emit();for(let c=0,d=e.length;c<d;c++){const n=e[c];isNaN(n)?t[c]=o:t[c]=this.cmap(n,i,r,s,this._scan_data)}}_colors(e){return __spreadProps(__spreadValues({},super._colors(e)),{low_color:null!=this.low_color?e(this.low_color):void 0,high_color:null!=this.high_color?e(this.high_color):void 0})}}ContinuousColorMapper.__name__="ContinuousColorMapper",ContinuousColorMapper.init_ContinuousColorMapper();class ScanningColorMapper extends ContinuousColorMapper{constructor(e){super(e)}cmap(e,t,i,n,o){if(e<o.binning[0])return i;if(e>o.binning[o.binning.length-1])return n;return t[left_edge_index(e,o.binning)]}}ScanningColorMapper.__name__="ScanningColorMapper";class BinnedTicker extends Ticker{constructor(e){super(e)}static init_BinnedTicker(){this.define((({Number:e,Ref:t,Or:i,Auto:n})=>({mapper:[t(ScanningColorMapper)],num_major_ticks:[i(e,n),8]})))}get_ticks(e,t,i,n){const{binning:o}=this.mapper.metrics,r=Math.max(0,left_edge_index(e,o)),s=Math.min(left_edge_index(t,o)+1,o.length-1),a=[];for(let u=r;u<=s;u++)a.push(o[u]);const{num_major_ticks:l}=this,c=[],d="auto"==l?a.length:l,h=Math.max(1,Math.floor(a.length/d));for(let u=0;u<a.length;u+=h)c.push(a[u]);return{major:c,minor:[]}}}BinnedTicker.__name__="BinnedTicker",BinnedTicker.init_BinnedTicker();class FuncTickFormatter extends TickFormatter{constructor(e){super(e)}static init_FuncTickFormatter(){this.define((({Unknown:e,String:t,Dict:i})=>({args:[i(e),{}],code:[t,""]})))}get names(){return keys(this.args)}get values(){return values(this.args)}_make_func(){const e=use_strict(this.code);return new Function("tick","index","ticks",...this.names,e)}doFormat(e,t){const i=this._make_func().bind({});return e.map(((e,t,n)=>`${i(e,t,n,...this.values)}`))}}FuncTickFormatter.__name__="FuncTickFormatter",FuncTickFormatter.init_FuncTickFormatter();class NumeralTickFormatter extends TickFormatter{constructor(e){super(e)}static init_NumeralTickFormatter(){this.define((({String:e})=>({format:[e,"0,0"],language:[e,"en"],rounding:[RoundingFunction,"round"]})))}get _rounding_fn(){switch(this.rounding){case"round":case"nearest":return Math.round;case"floor":case"rounddown":return Math.floor;case"ceil":case"roundup":return Math.ceil}}doFormat(e,t){const{format:i,language:n,_rounding_fn:o}=this;return e.map((e=>numbro.exports.format(e,i,n,o)))}}NumeralTickFormatter.__name__="NumeralTickFormatter",NumeralTickFormatter.init_NumeralTickFormatter();class PrintfTickFormatter extends TickFormatter{constructor(e){super(e)}static init_PrintfTickFormatter(){this.define((({String:e})=>({format:[e,"%s"]})))}doFormat(e,t){return e.map((e=>sprintf(this.format,e)))}}function _cat_equals(e,t){if(e.length!=t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function cat_v_compute(e,t,i,n,o,r,s){const a=e.length;for(let l=0;l<a;l++){let a,c,d=e[l];isString(d)?a=index_of(t,d):(null!=o?d=null!=r?d.slice(o,r):d.slice(o):null!=r&&(d=d.slice(0,r)),a=1==d.length?index_of(t,d[0]):find_index(t,(e=>_cat_equals(e,d)))),c=a<0||a>=i.length?s:i[a],n[l]=c}}PrintfTickFormatter.__name__="PrintfTickFormatter",PrintfTickFormatter.init_PrintfTickFormatter();class CategoricalColorMapper extends ColorMapper{constructor(e){super(e)}static init_CategoricalColorMapper(){this.define((({Number:e,Nullable:t})=>({factors:[FactorSeq],start:[e,0],end:[t(e),null]})))}_v_compute(e,t,i,{nan_color:n}){cat_v_compute(e,this.factors,i,t,this.start,this.end,n)}}CategoricalColorMapper.__name__="CategoricalColorMapper",CategoricalColorMapper.init_CategoricalColorMapper();class CategoricalMarkerMapper extends Mapper{constructor(e){super(e)}static init_CategoricalMarkerMapper(){this.define((({Number:e,Array:t,Nullable:i})=>({factors:[FactorSeq],markers:[t(MarkerType)],start:[e,0],end:[i(e),null],default_value:[MarkerType,"circle"]})))}v_compute(e){const t=new Array(e.length);return cat_v_compute(e,this.factors,this.markers,t,this.start,this.end,this.default_value),t}}CategoricalMarkerMapper.__name__="CategoricalMarkerMapper",CategoricalMarkerMapper.init_CategoricalMarkerMapper();class CategoricalPatternMapper extends Mapper{constructor(e){super(e)}static init_CategoricalPatternMapper(){this.define((({Number:e,Array:t,Nullable:i})=>({factors:[FactorSeq],patterns:[t(HatchPatternType)],start:[e,0],end:[i(e),null],default_value:[HatchPatternType," "]})))}v_compute(e){const t=new Array(e.length);return cat_v_compute(e,this.factors,this.patterns,t,this.start,this.end,this.default_value),t}}CategoricalPatternMapper.__name__="CategoricalPatternMapper",CategoricalPatternMapper.init_CategoricalPatternMapper();class LinearColorMapper extends ContinuousColorMapper{constructor(e){super(e)}scan(e,t){const i=null!=this.low?this.low:min$6(e),n=null!=this.high?this.high:max$7(e);return{max:n,min:i,norm_factor:1/(n-i),normed_interval:1/t}}cmap(e,t,i,n,o){const r=t.length-1;if(e==o.max)return t[r];const s=(e-o.min)*o.norm_factor,a=Math.floor(s/o.normed_interval);return a<0?i:a>r?n:t[a]}}LinearColorMapper.__name__="LinearColorMapper";class LogColorMapper extends ContinuousColorMapper{constructor(e){super(e)}scan(e,t){const i=null!=this.low?this.low:min$6(e),n=null!=this.high?this.high:max$7(e);return{max:n,min:i,scale:t/(Math.log(n)-Math.log(i))}}cmap(e,t,i,n,o){const r=t.length-1;if(e>o.max)return n;if(e==o.max)return t[r];if(e<o.min)return i;const s=Math.log(e)-Math.log(o.min);let a=Math.floor(s*o.scale);return a>r&&(a=r),t[a]}}LogColorMapper.__name__="LogColorMapper";class EqHistColorMapper extends ScanningColorMapper{constructor(e){super(e)}static init_EqHistColorMapper(){this.define((({Int:e})=>({bins:[e,65536]})))}scan(e,t){const i=null!=this.low?this.low:min$6(e),n=null!=this.high?this.high:max$7(e),o=this.bins,r=linspace(i,n,o+1),s=bin_counts(e,r),a=new Array(o);for(let f=0,g=r.length;f<g-1;f++){const e=r[f],t=r[f+1];a[f]=(e+t)/2}const l=cumsum(s),c=l[l.length-1],d=map(l,(e=>e/c));let h=t-1,u=[],p=0,_=2*t;for(;h!=t&&p<4&&0!=h;){const e=_/h;if(e>1e3)break;_=Math.round(Math.max(t*e,t));u=interpolate(range(0,_),map(d,(e=>e*(_-1))),a);h=uniq(u).length-1,p++}if(0==h){u=[i,n];for(let e=0;e<t-1;e++)u.push(n)}else u=u.slice(u.length-t-1),h!=t&&logger.warn("EqHistColorMapper warning: Histogram equalization did not converge.");return u[0]=i,u[u.length-1]=n,{min:i,max:n,binning:u}}}EqHistColorMapper.__name__="EqHistColorMapper",EqHistColorMapper.init_EqHistColorMapper();class LinearScale extends ContinuousScale{constructor(e){super(e)}get s_compute(){const[e,t]=this._linear_compute_state();return i=>e*i+t}compute(e){return this._linear_compute(e)}v_compute(e){return this._linear_v_compute(e)}invert(e){return this._linear_invert(e)}v_invert(e){return this._linear_v_invert(e)}}LinearScale.__name__="LinearScale";class LinearInterpolationScale extends Scale{constructor(e){super(e)}static init_LinearInterpolationScale(){this.internal((({Arrayable:e})=>({binning:[e]})))}get s_compute(){throw new Error("not implemented")}compute(e){return e}v_compute(e){const{binning:t}=this,{start:i,end:n}=this.source_range,o=i,r=n,s=t.length,a=(n-i)/(s-1),l=new Float64Array(s);for(let d=0;d<s;d++)l[d]=i+d*a;const c=map(e,(e=>{if(e<o)return o;if(e>r)return r;const i=left_edge_index(e,t);if(-1==i)return o;if(i>=s-1)return r;const n=t[i],a=(e-n)/(t[i+1]-n),c=l[i];return c+a*(l[i+1]-c)}));return this._linear_v_compute(c)}invert(e){return e}v_invert(e){return new Float64Array(e)}}LinearInterpolationScale.__name__="LinearInterpolationScale",LinearInterpolationScale.init_LinearInterpolationScale();class Stack$1 extends Layoutable{constructor(){super(...arguments),this.children=[]}*[Symbol.iterator](){yield*this.children}}Stack$1.__name__="Stack";class HStack extends Stack$1{_measure(e){let t=0,i=0;for(const n of this.children){const e=n.measure({width:0,height:0});t+=e.width,i=Math.max(i,e.height)}return{width:t,height:i}}_set_geometry(e,t){super._set_geometry(e,t);const i=this.absolute?e.top:0;let n=this.absolute?e.left:0;const{height:o}=e;for(const r of this.children){const{width:e}=r.measure({width:0,height:0});r.set_geometry(new BBox({left:n,width:e,top:i,height:o})),n+=e}}}HStack.__name__="HStack";class VStack extends Stack$1{_measure(e){let t=0,i=0;for(const n of this.children){const e=n.measure({width:0,height:0});t=Math.max(t,e.width),i+=e.height}return{width:t,height:i}}_set_geometry(e,t){super._set_geometry(e,t);const i=this.absolute?e.left:0;let n=this.absolute?e.top:0;const{width:o}=e;for(const r of this.children){const{height:e}=r.measure({width:0,height:0});r.set_geometry(new BBox({top:n,height:e,left:i,width:o})),n+=e}}}VStack.__name__="VStack";class NodeLayout extends Layoutable{constructor(){super(...arguments),this.children=[]}*[Symbol.iterator](){yield*this.children}_measure(e){const{width_policy:t,height_policy:i}=this.sizing,{min:n,max:o}=Math;let r=0,s=0;for(const a of this.children){const{width:t,height:i}=a.measure(e);r=o(r,t),s=o(s,i)}return{width:(()=>{const{width:i}=this.sizing;if(e.width==1/0)return"fixed"==t&&null!=i?i:r;switch(t){case"fixed":return null!=i?i:r;case"min":return r;case"fit":return null!=i?n(e.width,i):e.width;case"max":return null!=i?o(e.width,i):e.width}})(),height:(()=>{const{height:t}=this.sizing;if(e.height==1/0)return"fixed"==i&&null!=t?t:s;switch(i){case"fixed":return null!=t?t:s;case"min":return s;case"fit":return null!=t?n(e.height,t):e.height;case"max":return null!=t?o(e.height,t):e.height}})()}}_set_geometry(e,t){super._set_geometry(e,t);const i=this.absolute?e:e.relative(),{left:n,right:o,top:r,bottom:s}=i,a=Math.round(i.vcenter),l=Math.round(i.hcenter);for(const c of this.children){const{margin:t,halign:i,valign:d}=c.sizing,{width:h,height:u,inner:p}=c.measure(e),_=(()=>{switch(`${d}_${i}`){case"start_start":return new BBox({left:n+t.left,top:r+t.top,width:h,height:u});case"start_center":return new BBox({hcenter:l,top:r+t.top,width:h,height:u});case"start_end":return new BBox({right:o-t.right,top:r+t.top,width:h,height:u});case"center_start":return new BBox({left:n+t.left,vcenter:a,width:h,height:u});case"center_center":return new BBox({hcenter:l,vcenter:a,width:h,height:u});case"center_end":return new BBox({right:o-t.right,vcenter:a,width:h,height:u});case"end_start":return new BBox({left:n+t.left,bottom:s-t.bottom,width:h,height:u});case"end_center":return new BBox({hcenter:l,bottom:s-t.bottom,width:h,height:u});case"end_end":return new BBox({right:o-t.right,bottom:s-t.bottom,width:h,height:u})}})(),f=null==p?_:new BBox({left:_.left+p.left,top:_.top+p.top,right:_.right-p.right,bottom:_.bottom-p.bottom});c.set_geometry(_,f)}}}NodeLayout.__name__="NodeLayout";const{max:max$2,round:round}=Math;class DefaultMap{constructor(e){this.def=e,this._map=new Map}get(e){let t=this._map.get(e);return void 0===t&&(t=this.def(),this._map.set(e,t)),t}apply(e,t){const i=this.get(e);this._map.set(e,t(i))}}DefaultMap.__name__="DefaultMap";class Container{constructor(){this._items=[],this._nrows=0,this._ncols=0}get nrows(){return this._nrows}get ncols(){return this._ncols}add(e,t){const{r1:i,c1:n}=e;this._nrows=max$2(this._nrows,i+1),this._ncols=max$2(this._ncols,n+1),this._items.push({span:e,data:t})}at(e,t){return this._items.filter((({span:i})=>i.r0<=e&&e<=i.r1&&i.c0<=t&&t<=i.c1)).map((({data:e})=>e))}row(e){return this._items.filter((({span:t})=>t.r0<=e&&e<=t.r1)).map((({data:e})=>e))}col(e){return this._items.filter((({span:t})=>t.c0<=e&&e<=t.c1)).map((({data:e})=>e))}foreach(e){for(const{span:t,data:i}of this._items)e(t,i)}map(e){const t=new Container;for(const{span:i,data:n}of this._items)t.add(i,e(i,n));return t}}Container.__name__="Container";class Grid$1 extends Layoutable{constructor(e=[]){super(),this.items=e,this.rows="auto",this.cols="auto",this.spacing=0}*[Symbol.iterator](){for(const{layout:e}of this.items)yield e}is_width_expanding(){if(super.is_width_expanding())return!0;if("fixed"==this.sizing.width_policy)return!1;const{cols:e}=this._state;return some(e,(e=>"max"==e.policy))}is_height_expanding(){if(super.is_height_expanding())return!0;if("fixed"==this.sizing.height_policy)return!1;const{rows:e}=this._state;return some(e,(e=>"max"==e.policy))}_init(){var e,t,i,n;super._init();const o=new Container;for(const{layout:h,row:u,col:p,row_span:_,col_span:f}of this.items)if(h.sizing.visible){const e=u,t=p,i=u+(null!=_?_:1)-1,n=p+(null!=f?f:1)-1;o.add({r0:e,c0:t,r1:i,c1:n},h)}const{nrows:r,ncols:s}=o,a=new Array(r);for(let h=0;h<r;h++){const i=(()=>{var e;const t=isPlainObject(this.rows)?null!=(e=this.rows[h])?e:this.rows["*"]:this.rows;return null==t?{policy:"auto"}:isNumber(t)?{policy:"fixed",height:t}:isString(t)?{policy:t}:t})(),n=null!=(e=i.align)?e:"auto";if("fixed"==i.policy)a[h]={policy:"fixed",height:i.height,align:n};else if("min"==i.policy)a[h]={policy:"min",align:n};else if("fit"==i.policy||"max"==i.policy)a[h]={policy:i.policy,flex:null!=(t=i.flex)?t:1,align:n};else{if("auto"!=i.policy)throw new Error("unrechable");some(o.row(h),(e=>e.is_height_expanding()))?a[h]={policy:"max",flex:1,align:n}:a[h]={policy:"min",align:n}}}const l=new Array(s);for(let h=0;h<s;h++){const e=(()=>{var e;const t=isPlainObject(this.cols)?null!=(e=this.cols[h])?e:this.cols["*"]:this.cols;return null==t?{policy:"auto"}:isNumber(t)?{policy:"fixed",width:t}:isString(t)?{policy:t}:t})(),t=null!=(i=e.align)?i:"auto";if("fixed"==e.policy)l[h]={policy:"fixed",width:e.width,align:t};else if("min"==e.policy)l[h]={policy:"min",align:t};else if("fit"==e.policy||"max"==e.policy)l[h]={policy:e.policy,flex:null!=(n=e.flex)?n:1,align:t};else{if("auto"!=e.policy)throw new Error("unrechable");some(o.col(h),(e=>e.is_width_expanding()))?l[h]={policy:"max",flex:1,align:t}:l[h]={policy:"min",align:t}}}const[c,d]=isNumber(this.spacing)?[this.spacing,this.spacing]:this.spacing;this._state={items:o,nrows:r,ncols:s,rows:a,cols:l,rspacing:c,cspacing:d}}_measure_totals(e,t){const{nrows:i,ncols:n,rspacing:o,cspacing:r}=this._state;return{height:sum$1(e)+(i-1)*o,width:sum$1(t)+(n-1)*r}}_measure_cells(e){const{items:t,nrows:i,ncols:n,rows:o,cols:r,rspacing:s,cspacing:a}=this._state,l=new Array(i);for(let h=0;h<i;h++){const e=o[h];l[h]="fixed"==e.policy?e.height:0}const c=new Array(n);for(let h=0;h<n;h++){const e=r[h];c[h]="fixed"==e.policy?e.width:0}const d=new Container;t.foreach(((t,i)=>{const{r0:n,c0:h,r1:u,c1:p}=t,_=(u-n)*s,f=(p-h)*a;let g=0;for(let o=n;o<=u;o++)g+=e(o,h).height;g+=_;let m=0;for(let o=h;o<=p;o++)m+=e(n,o).width;m+=f;const v=i.measure({width:m,height:g});d.add(t,{layout:i,size_hint:v});const b=new Sizeable(v).grow_by(i.sizing.margin);b.height-=_,b.width-=f;const y=[];for(let e=n;e<=u;e++){const t=o[e];"fixed"==t.policy?b.height-=t.height:y.push(e)}if(b.height>0){const e=round(b.height/y.length);for(const t of y)l[t]=max$2(l[t],e)}const w=[];for(let e=h;e<=p;e++){const t=r[e];"fixed"==t.policy?b.width-=t.width:w.push(e)}if(b.width>0){const e=round(b.width/w.length);for(const t of w)c[t]=max$2(c[t],e)}}));return{size:this._measure_totals(l,c),row_heights:l,col_widths:c,size_hints:d}}_measure_grid(e){const{nrows:t,ncols:i,rows:n,cols:o,rspacing:r,cspacing:s}=this._state,a=this._measure_cells(((e,t)=>{const i=n[e],r=o[t];return{width:"fixed"==r.policy?r.width:1/0,height:"fixed"==i.policy?i.height:1/0}}));let l;l="fixed"==this.sizing.height_policy&&null!=this.sizing.height?this.sizing.height:e.height!=1/0&&this.is_height_expanding()?e.height:a.size.height;let c,d=0;for(let f=0;f<t;f++){const e=n[f];"fit"==e.policy||"max"==e.policy?d+=e.flex:l-=a.row_heights[f]}if(l-=(t-1)*r,0!=d&&l>0)for(let f=0;f<t;f++){const e=n[f];if("fit"==e.policy||"max"==e.policy){const t=round(l*(e.flex/d));l-=t,a.row_heights[f]=t,d-=e.flex}}else if(l<0){let e=0;for(let o=0;o<t;o++){"fixed"!=n[o].policy&&e++}let i=-l;for(let o=0;o<t;o++){if("fixed"!=n[o].policy){const t=a.row_heights[o],n=round(i/e);a.row_heights[o]=max$2(t-n,0),i-=n>t?t:n,e--}}}c="fixed"==this.sizing.width_policy&&null!=this.sizing.width?this.sizing.width:e.width!=1/0&&this.is_width_expanding()?e.width:a.size.width;let h=0;for(let f=0;f<i;f++){const e=o[f];"fit"==e.policy||"max"==e.policy?h+=e.flex:c-=a.col_widths[f]}if(c-=(i-1)*s,0!=h&&c>0)for(let f=0;f<i;f++){const e=o[f];if("fit"==e.policy||"max"==e.policy){const t=round(c*(e.flex/h));c-=t,a.col_widths[f]=t,h-=e.flex}}else if(c<0){let e=0;for(let n=0;n<i;n++){"fixed"!=o[n].policy&&e++}let t=-c;for(let n=0;n<i;n++){if("fixed"!=o[n].policy){const i=a.col_widths[n],o=round(t/e);a.col_widths[n]=max$2(i-o,0),t-=o>i?i:o,e--}}}const{row_heights:u,col_widths:p,size_hints:_}=this._measure_cells(((e,t)=>({width:a.col_widths[t],height:a.row_heights[e]})));return{size:this._measure_totals(u,p),row_heights:u,col_widths:p,size_hints:_}}_measure(e){const{size:t}=this._measure_grid(e);return t}_set_geometry(e,t){super._set_geometry(e,t);const{nrows:i,ncols:n,rspacing:o,cspacing:r}=this._state,{row_heights:s,col_widths:a,size_hints:l}=this._measure_grid(e),c=this._state.rows.map(((e,t)=>__spreadProps(__spreadValues({},e),{top:0,height:s[t],get bottom(){return this.top+this.height}}))),d=this._state.cols.map(((e,t)=>__spreadProps(__spreadValues({},e),{left:0,width:a[t],get right(){return this.left+this.width}}))),h=l.map(((e,t)=>__spreadProps(__spreadValues({},t),{outer:new BBox,inner:new BBox})));for(let _=0,f=this.absolute?e.top:0;_<i;_++){const e=c[_];e.top=f,f+=e.height+o}for(let _=0,f=this.absolute?e.left:0;_<n;_++){const e=d[_];e.left=f,f+=e.width+r}h.foreach((({r0:e,c0:t,r1:i,c1:n},s)=>{const{layout:a,size_hint:l}=s,{sizing:h}=a,{width:u,height:p}=l,_=function(e,t){let i=(t-e)*r;for(let n=e;n<=t;n++)i+=d[n].width;return i}(t,n),f=function(e,t){let i=(t-e)*o;for(let n=e;n<=t;n++)i+=c[n].height;return i}(e,i),g=t==n&&"auto"!=d[t].align?d[t].align:h.halign,m=e==i&&"auto"!=c[e].align?c[e].align:h.valign;let v=d[t].left;"start"==g?v+=h.margin.left:"center"==g?v+=round((_-u)/2):"end"==g&&(v+=_-h.margin.right-u);let b=c[e].top;"start"==m?b+=h.margin.top:"center"==m?b+=round((f-p)/2):"end"==m&&(b+=f-h.margin.bottom-p),s.outer=new BBox({left:v,top:b,width:u,height:p})}));const u=c.map((()=>({start:new DefaultMap((()=>0)),end:new DefaultMap((()=>0))}))),p=d.map((()=>({start:new DefaultMap((()=>0)),end:new DefaultMap((()=>0))})));h.foreach((({r0:e,c0:t,r1:i,c1:n},{size_hint:o,outer:r})=>{const{inner:s}=o;null!=s&&(u[e].start.apply(r.top,(e=>max$2(e,s.top))),u[i].end.apply(c[i].bottom-r.bottom,(e=>max$2(e,s.bottom))),p[t].start.apply(r.left,(e=>max$2(e,s.left))),p[n].end.apply(d[n].right-r.right,(e=>max$2(e,s.right))))})),h.foreach((({r0:e,c0:t,r1:i,c1:n},o)=>{const{size_hint:r,outer:s}=o,a=e=>{const t=this.absolute?s:s.relative(),i=t.left+e.left,n=t.top+e.top,o=t.right-e.right,r=t.bottom-e.bottom;return new BBox({left:i,top:n,right:o,bottom:r})};if(null!=r.inner){let l=a(r.inner);if(!1!==r.align){const o=u[e].start.get(s.top),r=u[i].end.get(c[i].bottom-s.bottom),h=p[t].start.get(s.left),_=p[n].end.get(d[n].right-s.right);try{l=a({top:o,bottom:r,left:h,right:_})}catch{}}o.inner=l}else o.inner=s})),h.foreach(((e,{layout:t,outer:i,inner:n})=>{t.set_geometry(i,n)}))}}Grid$1.__name__="Grid";class Row$1 extends Grid$1{constructor(e){super(),this.items=e.map(((e,t)=>({layout:e,row:0,col:t}))),this.rows="fit"}}Row$1.__name__="Row";class Column$1 extends Grid$1{constructor(e){super(),this.items=e.map(((e,t)=>({layout:e,row:t,col:0}))),this.cols="fit"}}Column$1.__name__="Column";class ContentBox extends ContentLayoutable{constructor(e){super(),this.content_size=unsized(e,(()=>new Sizeable(size(e))))}_content_size(){return this.content_size}}ContentBox.__name__="ContentBox";class VariadicBox extends Layoutable{constructor(e){super(),this.el=e}_measure(e){const t=new Sizeable(e).bounded_to(this.sizing.size);return sized(this.el,t,(()=>{const e=new Sizeable(content_size(this.el)),{border:t,padding:i}=extents(this.el);return e.grow_by(t).grow_by(i).map(Math.ceil)}))}}VariadicBox.__name__="VariadicBox";class CachedVariadicBox extends VariadicBox{constructor(e){super(e),this._cache=new Map}_measure(e){const{width:t,height:i}=e,n=`${t},${i}`;let o=this._cache.get(n);return null==o&&(o=super._measure(e),this._cache.set(n,o)),o}invalidate_cache(){this._cache.clear()}}CachedVariadicBox.__name__="CachedVariadicBox";class BorderLayout extends Layoutable{constructor(){super(...arguments),this.min_border={left:0,top:0,right:0,bottom:0},this.padding={left:0,top:0,right:0,bottom:0}}*[Symbol.iterator](){yield this.top_panel,yield this.bottom_panel,yield this.left_panel,yield this.right_panel,yield this.center_panel}_measure(e){e=new Sizeable({width:"fixed"==this.sizing.width_policy||e.width==1/0?this.sizing.width:e.width,height:"fixed"==this.sizing.height_policy||e.height==1/0?this.sizing.height:e.height});const t=this.left_panel.measure({width:0,height:e.height}),i=Math.max(t.width,this.min_border.left)+this.padding.left,n=this.right_panel.measure({width:0,height:e.height}),o=Math.max(n.width,this.min_border.right)+this.padding.right,r=this.top_panel.measure({width:e.width,height:0}),s=Math.max(r.height,this.min_border.top)+this.padding.top,a=this.bottom_panel.measure({width:e.width,height:0}),l=Math.max(a.height,this.min_border.bottom)+this.padding.bottom,c=new Sizeable(e).shrink_by({left:i,right:o,top:s,bottom:l}),d=this.center_panel.measure(c);return{width:i+d.width+o,height:s+d.height+l,inner:{left:i,right:o,top:s,bottom:l},align:(()=>{const{width_policy:e,height_policy:t}=this.center_panel.sizing;return"fixed"!=e&&"fixed"!=t})()}}_set_geometry(e,t){super._set_geometry(e,t),this.center_panel.set_geometry(t);const i=this.left_panel.measure({width:0,height:e.height}),n=this.right_panel.measure({width:0,height:e.height}),o=this.top_panel.measure({width:e.width,height:0}),r=this.bottom_panel.measure({width:e.width,height:0}),{left:s,top:a,right:l,bottom:c}=t;this.top_panel.set_geometry(new BBox({left:s,right:l,bottom:a,height:o.height})),this.bottom_panel.set_geometry(new BBox({left:s,right:l,top:c,height:r.height})),this.left_panel.set_geometry(new BBox({top:a,bottom:c,right:s,width:i.width})),this.right_panel.set_geometry(new BBox({top:a,bottom:c,left:l,width:n.width}))}}BorderLayout.__name__="BorderLayout";const MINOR_DIM=25,MAJOR_DIM_MIN_SCALAR=.3,MAJOR_DIM_MAX_SCALAR=.8;class ColorBarView extends AnnotationView{get orientation(){return this._orientation}initialize(){super.initialize();const{ticker:e,formatter:t,color_mapper:i}=this.model;this._ticker="auto"!=e?e:(()=>{switch(!0){case i instanceof LogColorMapper:return new LogTicker;case i instanceof ScanningColorMapper:return new BinnedTicker({mapper:i});case i instanceof CategoricalColorMapper:return new CategoricalTicker;default:return new BasicTicker}})(),this._formatter="auto"!=t?t:(()=>{switch(!0){case this._ticker instanceof LogTicker:return new LogTickFormatter;case i instanceof CategoricalColorMapper:return new CategoricalTickFormatter;default:return new BasicTickFormatter}})(),this._major_range=(()=>{if(i instanceof CategoricalColorMapper){const{factors:e}=i;return new FactorRange({factors:e})}if(i instanceof ContinuousColorMapper){const{min:e,max:t}=i.metrics;return new Range1d({start:e,end:t})}unreachable()})(),this._major_scale=(()=>{if(i instanceof LinearColorMapper)return new LinearScale;if(i instanceof LogColorMapper)return new LogScale;if(i instanceof ScanningColorMapper){const{binning:e}=i.metrics;return new LinearInterpolationScale({binning:e})}if(i instanceof CategoricalColorMapper)return new CategoricalScale;unreachable()})(),this._minor_range=new Range1d({start:0,end:1}),this._minor_scale=new LinearScale;const n=attrs_of(this.model,"major_label_",Text$2,!0),o=attrs_of(this.model,"major_tick_",Line$2,!0),r=attrs_of(this.model,"minor_tick_",Line$2,!0),s=attrs_of(this.model,"title_",Text$2),a=i instanceof CategoricalColorMapper?CategoricalAxis:i instanceof LogColorMapper?LogAxis:LinearAxis;this._axis=new a(__spreadValues(__spreadValues(__spreadValues({ticker:this._ticker,formatter:this._formatter,major_tick_in:this.model.major_tick_in,major_tick_out:this.model.major_tick_out,minor_tick_in:this.model.minor_tick_in,minor_tick_out:this.model.minor_tick_out,major_label_standoff:this.model.label_standoff,major_label_overrides:this.model.major_label_overrides,major_label_policy:this.model.major_label_policy,axis_line_color:null},n),o),r));const{title:l}=this.model;l&&(this._title=new Title(__spreadValues({text:l,standoff:this.model.title_standoff},s)))}async lazy_initialize(){await super.lazy_initialize();const e=this,t={get parent(){return e.parent},get root(){return e.root},get frame(){return e._frame},get canvas_view(){return e.parent.canvas_view},request_layout(){e.parent.request_layout()}};this._axis_view=await build_view(this._axis,{parent:t}),null!=this._title&&(this._title_view=await build_view(this._title,{parent:t}))}remove(){var e;null==(e=this._title_view)||e.remove(),this._axis_view.remove(),super.remove()}connect_signals(){super.connect_signals(),this.connect(this._ticker.change,(()=>this.request_render())),this.connect(this._formatter.change,(()=>this.request_render())),this.connect(this.model.color_mapper.metrics_change,(()=>{const e=this._major_range,t=this._major_scale,{color_mapper:i}=this.model;if(i instanceof ContinuousColorMapper&&e instanceof Range1d){const{min:t,max:n}=i.metrics;e.setv({start:t,end:n})}if(i instanceof ScanningColorMapper&&t instanceof LinearInterpolationScale){const{binning:e}=i.metrics;t.binning=e}this._set_canvas_image(),this.plot_view.request_layout()}))}_set_canvas_image(){const{orientation:e}=this,t=(()=>{const{palette:t}=this.model.color_mapper;return"vertical"==e?reversed(t):t})(),[i,n]="vertical"==e?[1,t.length]:[t.length,1],o=this._image=document.createElement("canvas");o.width=i,o.height=n;const r=o.getContext("2d"),s=r.getImageData(0,0,i,n),a=new LinearColorMapper({palette:t}).rgba_mapper.v_compute(range(0,t.length));s.data.set(a),r.putImageData(s,0,0)}update_layout(){const{location:e,width:t,height:i,padding:n,margin:o}=this.model,[r,s]=(()=>{if(!isString(e))return["end","start"];switch(e){case"top_left":return["start","start"];case"top":case"top_center":return["start","center"];case"top_right":return["start","end"];case"bottom_left":return["end","start"];case"bottom":case"bottom_center":return["end","center"];case"bottom_right":return["end","end"];case"left":case"center_left":return["center","start"];case"center":case"center_center":return["center","center"];case"right":case"center_right":return["center","end"]}})(),a=this._orientation=(()=>{const{orientation:e}=this.model;return"auto"==e?null!=this.panel?this.panel.is_horizontal?"horizontal":"vertical":"start"==s||"end"==s||"center"==s&&"center"==r?"vertical":"horizontal":e})(),l=new NodeLayout,c=new VStack,d=new VStack,h=new HStack,u=new HStack;l.absolute=!0,c.absolute=!0,d.absolute=!0,h.absolute=!0,u.absolute=!0;const[p,_,f,g]=(()=>"horizontal"==a?[this._major_scale,this._minor_scale,this._major_range,this._minor_range]:[this._minor_scale,this._major_scale,this._minor_range,this._major_range])();this._frame=new CartesianFrame(p,_,f,g),l.on_resize((e=>this._frame.set_geometry(e)));const m=new BorderLayout;this._inner_layout=m,m.absolute=!0,m.center_panel=l,m.top_panel=c,m.bottom_panel=d,m.left_panel=h,m.right_panel=u;const v={left:n,right:n,top:n,bottom:n},b=(()=>{if(null==this.panel){if(isString(e))return{left:o,right:o,top:o,bottom:o};{const[t,i]=e;return{left:t,right:o,top:o,bottom:i}}}if(!isString(e)){const[t,i]=e;return m.fixup_geometry=(e,n)=>{const o=e,r=this.layout.bbox,{width:s,height:a}=e;if(e=new BBox({left:r.left+t,bottom:r.bottom-i,width:s,height:a}),null!=n){const t=e.left-o.left,i=e.top-o.top,{left:r,top:s,width:a,height:l}=n;n=new BBox({left:r+t,top:s+i,width:a,height:l})}return[e,n]},{left:t,right:0,top:0,bottom:i}}m.fixup_geometry=(e,t)=>{const i=e;if("horizontal"==a){const{top:t,width:i,height:n}=e;if("end"==s){const{right:o}=this.layout.bbox;e=new BBox({right:o,top:t,width:i,height:n})}else if("center"==s){const{hcenter:o}=this.layout.bbox;e=new BBox({hcenter:Math.round(o),top:t,width:i,height:n})}}else{const{left:t,width:i,height:n}=e;if("end"==r){const{bottom:o}=this.layout.bbox;e=new BBox({left:t,bottom:o,width:i,height:n})}else if("center"==r){const{vcenter:o}=this.layout.bbox;e=new BBox({left:t,vcenter:Math.round(o),width:i,height:n})}}if(null!=t){const n=e.left-i.left,o=e.top-i.top,{left:r,top:s,width:a,height:l}=t;t=new BBox({left:r+n,top:s+o,width:a,height:l})}return[e,t]}})();let y,w,A,x;if(m.padding=v,null!=this.panel?(y="max",w=void 0,A=void 0,x=void 0):"auto"==("horizontal"==a?t:i)?(y="fixed",w=this.model.color_mapper.palette.length*MINOR_DIM,A={percent:MAJOR_DIM_MIN_SCALAR},x={percent:MAJOR_DIM_MAX_SCALAR}):(y="fit",w=void 0),"horizontal"==a){const e="auto"==t?void 0:t,n="auto"==i?MINOR_DIM:i;m.set_sizing({width_policy:y,height_policy:"min",width:w,min_width:A,max_width:x,halign:s,valign:r,margin:b}),m.center_panel.set_sizing({width_policy:"auto"==t?"fit":"fixed",height_policy:"fixed",width:e,height:n})}else{const e="auto"==t?MINOR_DIM:t,n="auto"==i?void 0:i;m.set_sizing({width_policy:"min",height_policy:y,height:w,min_height:A,max_height:x,halign:s,valign:r,margin:b}),m.center_panel.set_sizing({width_policy:"fixed",height_policy:"auto"==i?"fit":"fixed",width:e,height:n})}c.set_sizing({width_policy:"fit",height_policy:"min"}),d.set_sizing({width_policy:"fit",height_policy:"min"}),h.set_sizing({width_policy:"min",height_policy:"fit"}),u.set_sizing({width_policy:"min",height_policy:"fit"});const{_title_view:k}=this;null!=k&&("horizontal"==a?(k.panel=new Panel$1("above"),k.update_layout(),c.children.push(k.layout)):(k.panel=new Panel$1("left"),k.update_layout(),h.children.push(k.layout)));const{panel:C}=this,S=null!=C&&a==C.orientation?C.side:"horizontal"==a?"below":"right",T=(()=>{switch(S){case"above":return c;case"below":return d;case"left":return h;case"right":return u}})(),{_axis_view:R}=this;if(R.panel=new Panel$1(S),R.update_layout(),T.children.push(R.layout),null!=this.panel){const e=new Grid$1([{layout:m,row:0,col:0}]);e.absolute=!0,"horizontal"==a?e.set_sizing({width_policy:"max",height_policy:"min"}):e.set_sizing({width_policy:"min",height_policy:"max"}),this.layout=e}else this.layout=this._inner_layout;const{visible:E}=this.model;this.layout.sizing.visible=E,this._set_canvas_image()}_render(){var e;const{ctx:t}=this.layer;t.save(),this._paint_bbox(t,this._inner_layout.bbox),this._paint_image(t,this._inner_layout.center_panel.bbox),null==(e=this._title_view)||e.render(),this._axis_view.render(),t.restore()}_paint_bbox(e,t){const{x:i,y:n}=t;let{width:o,height:r}=t;i+o>=this.parent.canvas_view.bbox.width&&(o-=1),n+r>=this.parent.canvas_view.bbox.height&&(r-=1),e.save(),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(e),e.fillRect(i,n,o,r)),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(e),e.strokeRect(i,n,o,r)),e.restore()}_paint_image(e,t){const{x:i,y:n,width:o,height:r}=t;e.save(),e.setImageSmoothingEnabled(!1),e.globalAlpha=this.model.scale_alpha,e.drawImage(this._image,i,n,o,r),this.visuals.bar_line.doit&&(this.visuals.bar_line.set_value(e),e.strokeRect(i,n,o,r)),e.restore()}serializable_state(){const e=super.serializable_state(),{children:t=[]}=e,i=__objRest(e,["children"]);return null!=this._title_view&&t.push(this._title_view.serializable_state()),t.push(this._axis_view.serializable_state()),__spreadProps(__spreadValues({},i),{children:t})}}ColorBarView.__name__="ColorBarView";class ColorBar extends Annotation{constructor(e){super(e)}static init_ColorBar(){this.prototype.default_view=ColorBarView,this.mixins([["major_label_",Text$2],["title_",Text$2],["major_tick_",Line$2],["minor_tick_",Line$2],["border_",Line$2],["bar_",Line$2],["background_",Fill$1]]),this.define((({Alpha:e,Number:t,String:i,Tuple:n,Dict:o,Or:r,Ref:s,Auto:a,Nullable:l})=>({location:[r(Anchor,n(t,t)),"top_right"],orientation:[r(Orientation,a),"auto"],title:[l(i),null],title_standoff:[t,2],width:[r(t,a),"auto"],height:[r(t,a),"auto"],scale_alpha:[e,1],ticker:[r(s(Ticker),a),"auto"],formatter:[r(s(TickFormatter),a),"auto"],major_label_overrides:[o(i),{}],major_label_policy:[s(LabelingPolicy),()=>new NoOverlap],color_mapper:[s(ColorMapper)],label_standoff:[t,5],margin:[t,30],padding:[t,10],major_tick_in:[t,5],major_tick_out:[t,0],minor_tick_in:[t,0],minor_tick_out:[t,0]}))),this.override({background_fill_color:"#ffffff",background_fill_alpha:.95,bar_line_color:null,border_line_color:null,major_label_text_font_size:"11px",major_tick_line_color:"#ffffff",minor_tick_line_color:null,title_text_font_size:"13px",title_text_font_style:"italic"})}}ColorBar.__name__="ColorBar",ColorBar.init_ColorBar();class LabelView extends TextAnnotationView{_get_size(){const{ctx:e}=this.layer;this.visuals.text.set_value(e);const{width:t}=e.measureText(this.model.text),{height:i}=font_metrics(e.font);return{width:t,height:i}}_render(){const{angle:e,angle_units:t}=this.model,i=resolve_angle(e,t),n=null!=this.layout?this.layout:this.plot_view.frame,o=this.coordinates.x_scale,r=this.coordinates.y_scale;let s="data"==this.model.x_units?o.compute(this.model.x):n.bbox.xview.compute(this.model.x),a="data"==this.model.y_units?r.compute(this.model.y):n.bbox.yview.compute(this.model.y);s+=this.model.x_offset,a-=this.model.y_offset;("canvas"==this.model.render_mode?this._canvas_text.bind(this):this._css_text.bind(this))(this.layer.ctx,this.model.text,s,a,i)}}LabelView.__name__="LabelView";class Label extends TextAnnotation{constructor(e){super(e)}static init_Label(){this.prototype.default_view=LabelView,this.mixins([Text$2,["border_",Line$2],["background_",Fill$1]]),this.define((({Number:e,String:t,Angle:i})=>({x:[e],x_units:[SpatialUnits,"data"],y:[e],y_units:[SpatialUnits,"data"],text:[t,""],angle:[i,0],angle_units:[AngleUnits,"rad"],x_offset:[e,0],y_offset:[e,0]}))),this.override({background_fill_color:null,border_line_color:null})}}Label.__name__="Label",Label.init_Label();class LabelSetView extends TextAnnotationView{set_data(e){DataAnnotationView.prototype.set_data.call(this,e)}initialize(){if(super.initialize(),this.set_data(this.model.source),"css"==this.model.render_mode)for(let e=0,t=this.text.length;e<t;e++){const e=div({style:{display:"none"}});this.el.appendChild(e)}}connect_signals(){super.connect_signals();const e=()=>{this.set_data(this.model.source),"css"==this.model.render_mode?this.render():this.request_render()};this.connect(this.model.change,e),this.connect(this.model.source.streaming,e),this.connect(this.model.source.patching,e),this.connect(this.model.source.change,e)}_calculate_text_dimensions(e,t){const{width:i}=e.measureText(t),{height:n}=font_metrics(this.visuals.text.font_value(0));return[i,n]}_map_data(){const e=this.coordinates.x_scale,t=this.coordinates.y_scale,i=null!=this.layout?this.layout:this.plot_view.frame;return["data"==this.model.x_units?e.v_compute(this._x):i.bbox.xview.v_compute(this._x),"data"==this.model.y_units?t.v_compute(this._y):i.bbox.yview.v_compute(this._y)]}_render(){const e="canvas"==this.model.render_mode?this._v_canvas_text.bind(this):this._v_css_text.bind(this),{ctx:t}=this.layer,[i,n]=this._map_data();for(let o=0,r=this.text.length;o<r;o++)e(t,o,this.text.get(o),i[o]+this.x_offset.get(o),n[o]-this.y_offset.get(o),this.angle.get(o))}_get_size(){const{ctx:e}=this.layer;this.visuals.text.set_vectorize(e,0);const{width:t}=e.measureText(this.text.get(0)),{height:i}=font_metrics(e.font);return{width:t,height:i}}_v_canvas_text(e,t,i,n,o,r){this.visuals.text.set_vectorize(e,t);const s=this._calculate_bounding_box_dimensions(e,i);e.save(),e.beginPath(),e.translate(n,o),e.rotate(r),e.rect(s[0],s[1],s[2],s[3]),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_vectorize(e,t),e.fill()),this.visuals.border_line.doit&&(this.visuals.border_line.set_vectorize(e,t),e.stroke()),this.visuals.text.doit&&(this.visuals.text.set_vectorize(e,t),e.fillText(i,0,0)),e.restore()}_v_css_text(e,t,i,n,o,r){const s=this.el.children[t];s.textContent=i,this.visuals.text.set_vectorize(e,t);const[a,l]=this._calculate_bounding_box_dimensions(e,i);s.style.position="absolute",s.style.left=`${n+a}px`,s.style.top=`${o+l}px`,s.style.color=e.fillStyle,s.style.font=e.font,s.style.lineHeight="normal",r&&(s.style.transform=`rotate(${r}rad)`),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_vectorize(e,t),s.style.backgroundColor=e.fillStyle),this.visuals.border_line.doit&&(this.visuals.border_line.set_vectorize(e,t),s.style.borderStyle=e.lineDash.length<2?"solid":"dashed",s.style.borderWidth=`${e.lineWidth}px`,s.style.borderColor=e.strokeStyle),display(s)}}LabelSetView.__name__="LabelSetView";class LabelSet extends TextAnnotation{constructor(e){super(e)}static init_LabelSet(){this.prototype.default_view=LabelSetView,this.mixins([TextVector$1,["border_",LineVector$1],["background_",FillVector$1]]),this.define((({Ref:e})=>({x:[XCoordinateSpec,{field:"x"}],y:[YCoordinateSpec,{field:"y"}],x_units:[SpatialUnits,"data"],y_units:[SpatialUnits,"data"],text:[StringSpec,{field:"text"}],angle:[AngleSpec,0],x_offset:[NumberSpec,{value:0}],y_offset:[NumberSpec,{value:0}],source:[e(ColumnDataSource),()=>new ColumnDataSource]}))),this.override({background_fill_color:null,border_line_color:null})}}function isValue(e){return isPlainObject(e)&&"value"in e}function isField(e){return isPlainObject(e)&&"field"in e}LabelSet.__name__="LabelSet",LabelSet.init_LabelSet();class LegendItem extends Model{constructor(e){super(e)}static init_LegendItem(){this.define((({Int:e,Array:t,Ref:i,Nullable:n})=>({label:[NullStringSpec,null],renderers:[t(i(GlyphRenderer)),[]],index:[n(e),null]})))}_check_data_sources_on_renderers(){if(null!=this.get_field_from_label_prop()){if(this.renderers.length<1)return!1;const e=this.renderers[0].data_source;if(null!=e)for(const t of this.renderers)if(t.data_source!=e)return!1}return!0}_check_field_label_on_data_source(){const e=this.get_field_from_label_prop();if(null!=e){if(this.renderers.length<1)return!1;const t=this.renderers[0].data_source;if(null!=t&&!includes(t.columns(),e))return!1}return!0}initialize(){super.initialize(),this.legend=null,this.connect(this.change,(()=>{var e;return null==(e=this.legend)?void 0:e.item_change.emit()}));this._check_data_sources_on_renderers()||logger.error("Non matching data sources on legend item renderers");this._check_field_label_on_data_source()||logger.error(`Bad column name on label: ${this.label}`)}get_field_from_label_prop(){const{label:e}=this;return isField(e)?e.field:null}get_labels_list_from_label_prop(){if(isValue(this.label)){const{value:e}=this.label;return null!=e?[e]:[]}const e=this.get_field_from_label_prop();if(null!=e){let t;if(!this.renderers[0]||null==this.renderers[0].data_source)return["No source found"];if(t=this.renderers[0].data_source,t instanceof ColumnarDataSource){const i=t.get_column(e);return null!=i?uniq(Array.from(i)):["Invalid field"]}}return[]}}LegendItem.__name__="LegendItem",LegendItem.init_LegendItem();class LegendView extends AnnotationView{update_layout(){const{panel:e}=this;this.layout=null!=e?new SideLayout(e,(()=>this.get_size())):void 0}cursor(e,t){return"none"==this.model.click_policy?null:"pointer"}get legend_padding(){return null!=this.model.border_line_color?this.model.padding:0}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render())),this.connect(this.model.item_change,(()=>this.request_render()))}compute_legend_bbox(){const e=this.model.get_legend_names(),{glyph_height:t,glyph_width:i}=this.model,{label_height:n,label_width:o}=this.model;this.max_label_height=max$7([font_metrics(this.visuals.label_text.font_value()).height,n,t]);const{ctx:r}=this.layer;r.save(),this.visuals.label_text.set_value(r),this.text_widths=new Map;for(const b of e)this.text_widths.set(b,max$7([r.measureText(b).width,o]));this.visuals.title_text.set_value(r),this.title_height=this.model.title?font_metrics(this.visuals.title_text.font_value()).height+this.model.title_standoff:0,this.title_width=this.model.title?r.measureText(this.model.title).width:0,r.restore();const s=Math.max(max$7([...this.text_widths.values()]),0),a=this.model.margin,{legend_padding:l}=this,c=this.model.spacing,{label_standoff:d}=this.model;let h,u;if("vertical"==this.model.orientation)h=e.length*this.max_label_height+Math.max(e.length-1,0)*c+2*l+this.title_height,u=max$7([s+i+d+2*l,this.title_width+2*l]);else{let t=2*l+Math.max(e.length-1,0)*c;for(const[,e]of this.text_widths)t+=max$7([e,o])+i+d;u=max$7([this.title_width+2*l,t]),h=this.max_label_height+this.title_height+2*l}const p=null!=this.layout?this.layout:this.plot_view.frame,[_,f]=p.bbox.ranges,{location:g}=this.model;let m,v;if(isString(g))switch(g){case"top_left":m=_.start+a,v=f.start+a;break;case"top":case"top_center":m=(_.end+_.start)/2-u/2,v=f.start+a;break;case"top_right":m=_.end-a-u,v=f.start+a;break;case"bottom_right":m=_.end-a-u,v=f.end-a-h;break;case"bottom":case"bottom_center":m=(_.end+_.start)/2-u/2,v=f.end-a-h;break;case"bottom_left":m=_.start+a,v=f.end-a-h;break;case"left":case"center_left":m=_.start+a,v=(f.end+f.start)/2-h/2;break;case"center":case"center_center":m=(_.end+_.start)/2-u/2,v=(f.end+f.start)/2-h/2;break;case"right":case"center_right":m=_.end-a-u,v=(f.end+f.start)/2-h/2}else if(isArray(g)&&2==g.length){const[e,t]=g;m=p.bbox.xview.compute(e),v=p.bbox.yview.compute(t)-h}else unreachable();return new BBox({left:m,top:v,width:u,height:h})}interactive_bbox(){return this.compute_legend_bbox()}interactive_hit(e,t){return this.interactive_bbox().contains(e,t)}on_hit(e,t){let i;const{glyph_width:n}=this.model,{legend_padding:o}=this,r=this.model.spacing,{label_standoff:s}=this.model;let a=i=o;const l=this.compute_legend_bbox(),c="vertical"==this.model.orientation;for(const d of this.model.items){const h=d.get_labels_list_from_label_prop();for(const u of h){const h=l.x+a,p=l.y+i+this.title_height;let _,f;[_,f]=c?[l.width-2*o,this.max_label_height]:[this.text_widths.get(u)+n+s,this.max_label_height];if(new BBox({left:h,top:p,width:_,height:f}).contains(e,t)){switch(this.model.click_policy){case"hide":for(const e of d.renderers)e.visible=!e.visible;break;case"mute":for(const e of d.renderers)e.muted=!e.muted}return!0}c?i+=this.max_label_height+r:a+=this.text_widths.get(u)+n+s+r}}return!1}_render(){if(0==this.model.items.length)return;for(const i of this.model.items)i.legend=this.model;const{ctx:e}=this.layer,t=this.compute_legend_bbox();e.save(),this._draw_legend_box(e,t),this._draw_legend_items(e,t),this._draw_title(e,t),e.restore()}_draw_legend_box(e,t){e.beginPath(),e.rect(t.x,t.y,t.width,t.height),this.visuals.background_fill.set_value(e),e.fill(),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(e),e.stroke())}_draw_legend_items(e,t){const{glyph_width:i,glyph_height:n}=this.model,{legend_padding:o}=this,r=this.model.spacing,{label_standoff:s}=this.model;let a=o,l=o;const c="vertical"==this.model.orientation;for(const d of this.model.items){const h=d.get_labels_list_from_label_prop(),u=d.get_field_from_label_prop();if(0==h.length)continue;const p=(()=>{switch(this.model.click_policy){case"none":return!0;case"hide":return every(d.renderers,(e=>e.visible));case"mute":return every(d.renderers,(e=>!e.muted))}})();for(const _ of h){const h=t.x+a,f=t.y+l+this.title_height,g=h+i,m=f+n;c?l+=this.max_label_height+r:a+=this.text_widths.get(_)+i+s+r,this.visuals.label_text.set_value(e),e.fillText(_,g+s,f+this.max_label_height/2);for(const t of d.renderers){const i=this.plot_view.renderer_view(t);null==i||i.draw_legend(e,h,g,f,m,u,_,d.index)}if(!p){let n,r;[n,r]=c?[t.width-2*o,this.max_label_height]:[this.text_widths.get(_)+i+s,this.max_label_height],e.beginPath(),e.rect(h,f,n,r),this.visuals.inactive_fill.set_value(e),e.fill()}}}}_draw_title(e,t){const{title:i}=this.model;i&&this.visuals.title_text.doit&&(e.save(),e.translate(t.x0,t.y0+this.title_height),this.visuals.title_text.set_value(e),e.fillText(i,this.legend_padding,this.legend_padding-this.model.title_standoff),e.restore())}_get_size(){const{width:e,height:t}=this.compute_legend_bbox();return{width:e+2*this.model.margin,height:t+2*this.model.margin}}}LegendView.__name__="LegendView";class Legend extends Annotation{constructor(e){super(e)}initialize(){super.initialize(),this.item_change=new Signal0(this,"item_change")}static init_Legend(){this.prototype.default_view=LegendView,this.mixins([["label_",Text$2],["title_",Text$2],["inactive_",Fill$1],["border_",Line$2],["background_",Fill$1]]),this.define((({Number:e,String:t,Array:i,Tuple:n,Or:o,Ref:r,Nullable:s})=>({orientation:[Orientation,"vertical"],location:[o(LegendLocation,n(e,e)),"top_right"],title:[s(t),null],title_standoff:[e,5],label_standoff:[e,5],glyph_height:[e,20],glyph_width:[e,20],label_height:[e,20],label_width:[e,20],margin:[e,10],padding:[e,10],spacing:[e,3],items:[i(r(LegendItem)),[]],click_policy:[LegendClickPolicy,"none"]}))),this.override({border_line_color:"#e5e5e5",border_line_alpha:.5,border_line_width:1,background_fill_color:"#ffffff",background_fill_alpha:.95,inactive_fill_color:"white",inactive_fill_alpha:.7,label_text_font_size:"13px",label_text_baseline:"middle",title_text_font_size:"13px",title_text_font_style:"italic"})}get_legend_names(){const e=[];for(const t of this.items){const i=t.get_labels_list_from_label_prop();e.push(...i)}return e}}Legend.__name__="Legend",Legend.init_Legend();class PolyAnnotationView extends AnnotationView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_render(){const{xs:e,ys:t}=this.model;if(e.length!=t.length)return;const i=e.length;if(i<3)return;const{frame:n}=this.plot_view,{ctx:o}=this.layer,r=this.coordinates.x_scale,s=this.coordinates.y_scale,{screen:a}=this.model;function l(e,t,i,n){return a?e:"data"==t?i.v_compute(e):n.v_compute(e)}const c=l(e,this.model.xs_units,r,n.bbox.xview),d=l(t,this.model.ys_units,s,n.bbox.yview);o.beginPath();for(let h=0;h<i;h++)o.lineTo(c[h],d[h]);o.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_value(o),o.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(o),o.fill()),this.visuals.line.doit&&(this.visuals.line.set_value(o),o.stroke())}}PolyAnnotationView.__name__="PolyAnnotationView";class PolyAnnotation extends Annotation{constructor(e){super(e)}static init_PolyAnnotation(){this.prototype.default_view=PolyAnnotationView,this.mixins([Line$2,Fill$1,Hatch$1]),this.define((({Number:e,Array:t})=>({xs:[t(e),[]],xs_units:[SpatialUnits,"data"],ys:[t(e),[]],ys_units:[SpatialUnits,"data"]}))),this.internal((({Boolean:e})=>({screen:[e,!1]}))),this.override({fill_color:"#fff9ba",fill_alpha:.4,line_color:"#cccccc",line_alpha:.3})}update({xs:e,ys:t}){this.setv({xs:e,ys:t,screen:!0},{check_eq:!1})}}PolyAnnotation.__name__="PolyAnnotation",PolyAnnotation.init_PolyAnnotation();class SlopeView extends AnnotationView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_render(){const{gradient:e,y_intercept:t}=this.model;if(null==e||null==t)return;const{frame:i}=this.plot_view,n=this.coordinates.x_scale,o=this.coordinates.y_scale;let r,s,a,l;if(0==e)r=o.compute(t),s=r,a=i.bbox.left,l=a+i.bbox.width;else{r=i.bbox.top,s=r+i.bbox.height;const c=(o.invert(r)-t)/e,d=(o.invert(s)-t)/e;a=n.compute(c),l=n.compute(d)}const{ctx:c}=this.layer;c.save(),c.beginPath(),this.visuals.line.set_value(c),c.moveTo(a,r),c.lineTo(l,s),c.stroke(),c.restore()}}SlopeView.__name__="SlopeView";class Slope extends Annotation{constructor(e){super(e)}static init_Slope(){this.prototype.default_view=SlopeView,this.mixins(Line$2),this.define((({Number:e,Nullable:t})=>({gradient:[t(e),null],y_intercept:[t(e),null]}))),this.override({line_color:"black"})}}Slope.__name__="Slope",Slope.init_Slope();class SpanView extends AnnotationView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.plot_view.request_paint(this)))}_render(){const{location:e}=this.model;if(null==e)return;const{frame:t}=this.plot_view,i=this.coordinates.x_scale,n=this.coordinates.y_scale,o=(t,i)=>"data"==this.model.location_units?t.compute(e):this.model.for_hover?e:i.compute(e);let r,s,a,l;"width"==this.model.dimension?(a=o(n,t.bbox.yview),s=t.bbox.left,l=t.bbox.width,r=this.model.line_width):(a=t.bbox.top,s=o(i,t.bbox.xview),l=this.model.line_width,r=t.bbox.height);const{ctx:c}=this.layer;c.save(),c.beginPath(),this.visuals.line.set_value(c),c.moveTo(s,a),"width"==this.model.dimension?c.lineTo(s+l,a):c.lineTo(s,a+r),c.stroke(),c.restore()}}SpanView.__name__="SpanView";class Span extends Annotation{constructor(e){super(e)}static init_Span(){this.prototype.default_view=SpanView,this.mixins(Line$2),this.define((({Number:e,Nullable:t})=>({render_mode:[RenderMode,"canvas"],location:[t(e),null],location_units:[SpatialUnits,"data"],dimension:[Dimension,"width"]}))),this.internal((({Boolean:e})=>({for_hover:[e,!1]}))),this.override({line_color:"black"})}}Span.__name__="Span",Span.init_Span();class ToolView extends View{get plot_view(){return this.parent}get plot_model(){return this.parent.model}connect_signals(){super.connect_signals(),this.connect(this.model.properties.active.change,(()=>{this.model.active?this.activate():this.deactivate()}))}activate(){}deactivate(){}}ToolView.__name__="ToolView";class Tool extends Model{constructor(e){super(e)}static init_Tool(){this.prototype._known_aliases=new Map,this.define((({String:e,Nullable:t})=>({description:[t(e),null]}))),this.internal((({Boolean:e})=>({active:[e,!1]})))}get synthetic_renderers(){return[]}_get_dim_limits([e,t],[i,n],o,r){const s=o.bbox.h_range;let a;"width"==r||"both"==r?(a=[min$6([e,i]),max$7([e,i])],a=[max$7([a[0],s.start]),min$6([a[1],s.end])]):a=[s.start,s.end];const l=o.bbox.v_range;let c;return"height"==r||"both"==r?(c=[min$6([t,n]),max$7([t,n])],c=[max$7([c[0],l.start]),min$6([c[1],l.end])]):c=[l.start,l.end],[a,c]}static register_alias(e,t){this.prototype._known_aliases.set(e,t)}static from_string(e){const t=this.prototype._known_aliases.get(e);if(null!=t)return t();{const t=[...this.prototype._known_aliases.keys()];throw new Error(`unexpected tool name '${e}', possible tools are ${t.join(", ")}`)}}}Tool.__name__="Tool",Tool.init_Tool();var hammer={exports:{}};
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(e){!function(t,i,n,o){var r,s=["","webkit","Moz","MS","ms","o"],a=i.createElement("div"),l=Math.round,c=Math.abs,d=Date.now;function h(e,t,i){return setTimeout(v(e,i),t)}function u(e,t,i){return!!Array.isArray(e)&&(p(e,i[t],i),!0)}function p(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==o)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function _(e,i,n){var o="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=t.console&&(t.console.warn||t.console.log);return r&&r.call(t.console,o,n),e.apply(this,arguments)}}r="function"!=typeof Object.assign?function(e){if(e===o||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==o&&null!==n)for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}:Object.assign;var f=_((function(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;)(!i||i&&e[n[r]]===o)&&(e[n[r]]=t[n[r]]),r++;return e}),"extend","Use `assign`."),g=_((function(e,t){return f(e,t,!0)}),"merge","Use `assign`.");function m(e,t,i){var n,o=t.prototype;(n=e.prototype=Object.create(o)).constructor=e,n._super=o,i&&r(n,i)}function v(e,t){return function(){return e.apply(t,arguments)}}function b(e,t){return"function"==typeof e?e.apply(t&&t[0]||o,t):e}function y(e,t){return e===o?t:e}function w(e,t,i){p(C(t),(function(t){e.addEventListener(t,i,!1)}))}function A(e,t,i){p(C(t),(function(t){e.removeEventListener(t,i,!1)}))}function x(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function k(e,t){return e.indexOf(t)>-1}function C(e){return e.trim().split(/\s+/g)}function S(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function T(e){return Array.prototype.slice.call(e,0)}function R(e,t,i){for(var n=[],o=[],r=0;r<e.length;){var s=t?e[r][t]:e[r];S(o,s)<0&&n.push(e[r]),o[r]=s,r++}return i&&(n=t?n.sort((function(e,i){return e[t]>i[t]})):n.sort()),n}function E(e,t){for(var i,n,r=t[0].toUpperCase()+t.slice(1),a=0;a<s.length;){if((n=(i=s[a])?i+r:t)in e)return n;a++}return o}var P=1;function M(e){var i=e.ownerDocument||e;return i.defaultView||i.parentWindow||t}var D="ontouchstart"in t,I=E(t,"PointerEvent")!==o,B=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z="touch",L="mouse",N=24,$=["x","y"],V=["clientX","clientY"];function O(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){b(e.options.enable,[e])&&i.handler(t)},this.init()}function F(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,s=1&t&&n-r==0,a=12&t&&n-r==0;i.isFirst=!!s,i.isFinal=!!a,s&&(e.session={}),i.eventType=t,function(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=G(t));r>1&&!i.firstMultiple?i.firstMultiple=G(t):1===r&&(i.firstMultiple=!1);var s=i.firstInput,a=i.firstMultiple,l=a?a.center:s.center,h=t.center=H(n);t.timeStamp=d(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=Y(l,h),t.distance=W(l,h),function(e,t){var i=t.center,n=e.offsetDelta||{},o=e.prevDelta||{},r=e.prevInput||{};1!==t.eventType&&4!==r.eventType||(o=e.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y});t.deltaX=o.x+(i.x-n.x),t.deltaY=o.y+(i.y-n.y)}(i,t),t.offsetDirection=U(t.deltaX,t.deltaY);var u=j(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=c(u.x)>c(u.y)?u.x:u.y,t.scale=a?(p=a.pointers,_=n,W(_[0],_[1],V)/W(p[0],p[1],V)):1,t.rotation=a?function(e,t){return Y(t[1],t[0],V)+Y(e[1],e[0],V)}(a.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,function(e,t){var i,n,r,s,a=e.lastInterval||t,l=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(l>25||a.velocity===o)){var d=t.deltaX-a.deltaX,h=t.deltaY-a.deltaY,u=j(l,d,h);n=u.x,r=u.y,i=c(u.x)>c(u.y)?u.x:u.y,s=U(d,h),e.lastInterval=t}else i=a.velocity,n=a.velocityX,r=a.velocityY,s=a.direction;t.velocity=i,t.velocityX=n,t.velocityY=r,t.direction=s}(i,t);var p,_;var f=e.element;x(t.srcEvent.target,f)&&(f=t.srcEvent.target);t.target=f}(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function G(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:l(e.pointers[i].clientX),clientY:l(e.pointers[i].clientY)},i++;return{timeStamp:d(),pointers:t,center:H(t),deltaX:e.deltaX,deltaY:e.deltaY}}function H(e){var t=e.length;if(1===t)return{x:l(e[0].clientX),y:l(e[0].clientY)};for(var i=0,n=0,o=0;o<t;)i+=e[o].clientX,n+=e[o].clientY,o++;return{x:l(i/t),y:l(n/t)}}function j(e,t,i){return{x:t/e||0,y:i/e||0}}function U(e,t){return e===t?1:c(e)>=c(t)?e<0?2:4:t<0?8:16}function W(e,t,i){i||(i=$);var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]];return Math.sqrt(n*n+o*o)}function Y(e,t,i){i||(i=$);var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]];return 180*Math.atan2(o,n)/Math.PI}O.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(M(this.element),this.evWin,this.domHandler)}};var q={mousedown:1,mousemove:2,mouseup:4},X="mousedown",K="mousemove mouseup";function J(){this.evEl=X,this.evWin=K,this.pressed=!1,O.apply(this,arguments)}m(J,O,{handler:function(e){var t=q[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:L,srcEvent:e}))}});var Q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Z={2:z,3:"pen",4:L,5:"kinect"},ee="pointerdown",te="pointermove pointerup pointercancel";function ie(){this.evEl=ee,this.evWin=te,O.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}t.MSPointerEvent&&!t.PointerEvent&&(ee="MSPointerDown",te="MSPointerMove MSPointerUp MSPointerCancel"),m(ie,O,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),o=Q[n],r=Z[e.pointerType]||e.pointerType,s=r==z,a=S(t,e.pointerId,"pointerId");1&o&&(0===e.button||s)?a<0&&(t.push(e),a=t.length-1):12&o&&(i=!0),a<0||(t[a]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),i&&t.splice(a,1))}});var ne={touchstart:1,touchmove:2,touchend:4,touchcancel:8},oe="touchstart",re="touchstart touchmove touchend touchcancel";function se(){this.evTarget=oe,this.evWin=re,this.started=!1,O.apply(this,arguments)}function ae(e,t){var i=T(e.touches),n=T(e.changedTouches);return 12&t&&(i=R(i.concat(n),"identifier",!0)),[i,n]}m(se,O,{handler:function(e){var t=ne[e.type];if(1===t&&(this.started=!0),this.started){var i=ae.call(this,e,t);12&t&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:z,srcEvent:e})}}});var le={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ce="touchstart touchmove touchend touchcancel";function de(){this.evTarget=ce,this.targetIds={},O.apply(this,arguments)}function he(e,t){var i=T(e.touches),n=this.targetIds;if(3&t&&1===i.length)return n[i[0].identifier]=!0,[i,i];var o,r,s=T(e.changedTouches),a=[],l=this.target;if(r=i.filter((function(e){return x(e.target,l)})),1===t)for(o=0;o<r.length;)n[r[o].identifier]=!0,o++;for(o=0;o<s.length;)n[s[o].identifier]&&a.push(s[o]),12&t&&delete n[s[o].identifier],o++;return a.length?[R(r.concat(a),"identifier",!0),a]:void 0}m(de,O,{handler:function(e){var t=le[e.type],i=he.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:z,srcEvent:e})}});function ue(){O.apply(this,arguments);var e=v(this.handler,this);this.touch=new de(this.manager,e),this.mouse=new J(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function pe(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,_e.call(this,t)):12&e&&_e.call(this,t)}function _e(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout((function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)}),2500)}}function fe(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(t-o.x),s=Math.abs(i-o.y);if(r<=25&&s<=25)return!0}return!1}m(ue,O,{handler:function(e,t,i){var n=i.pointerType==z,o=i.pointerType==L;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)pe.call(this,t,i);else if(o&&fe.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ge=E(a.style,"touchAction"),me=ge!==o,ve="compute",be="auto",ye="manipulation",we="none",Ae="pan-x",xe="pan-y",ke=function(){if(!me)return!1;var e={},i=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!i||t.CSS.supports("touch-action",n)})),e}();function Ce(e,t){this.manager=e,this.set(t)}Ce.prototype={set:function(e){e==ve&&(e=this.compute()),me&&this.manager.element.style&&ke[e]&&(this.manager.element.style[ge]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return p(this.manager.recognizers,(function(t){b(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(k(e,we))return we;var t=k(e,Ae),i=k(e,xe);if(t&&i)return we;if(t||i)return t?Ae:xe;if(k(e,ye))return ye;return be}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,o=k(n,we)&&!ke.none,r=k(n,xe)&&!ke["pan-y"],s=k(n,Ae)&&!ke["pan-x"];if(o){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}if(!s||!r)return o||r&&6&i||s&&i&N?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Se=32;function Te(e){this.options=r({},this.defaults,e||{}),this.id=P++,this.manager=null,this.options.enable=y(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Re(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ee(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Pe(e,t){var i=t.manager;return i?i.get(e):e}function Me(){Te.apply(this,arguments)}function De(){Me.apply(this,arguments),this.pX=null,this.pY=null}function Ie(){Me.apply(this,arguments)}function Be(){Te.apply(this,arguments),this._timer=null,this._input=null}function ze(){Me.apply(this,arguments)}function Le(){Me.apply(this,arguments)}function Ne(){Te.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function $e(e,t){return(t=t||{}).recognizers=y(t.recognizers,$e.defaults.preset),new Ve(e,t)}Te.prototype={defaults:{},set:function(e){return r(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(u(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Pe(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return u(e,"dropRecognizeWith",this)||(e=Pe(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(u(e,"requireFailure",this))return this;var t=this.requireFail;return-1===S(t,e=Pe(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(u(e,"dropRequireFailure",this))return this;e=Pe(e,this);var t=S(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,i=this.state;function n(i){t.manager.emit(i,e)}i<8&&n(t.options.event+Re(i)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),i>=8&&n(t.options.event+Re(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Se},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=r({},e);if(!b(this.options.enable,[this,t]))return this.reset(),void(this.state=Se);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},m(Me,Te,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=6&t,o=this.attrTest(e);return n&&(8&i||!o)?16|t:n||o?4&i?8|t:2&t?4|t:2:Se}}),m(De,Me,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(xe),e&N&&t.push(Ae),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,o=e.direction,r=e.deltaX,s=e.deltaY;return o&t.direction||(6&t.direction?(o=0===r?1:r<0?2:4,i=r!=this.pX,n=Math.abs(e.deltaX)):(o=0===s?1:s<0?8:16,i=s!=this.pY,n=Math.abs(e.deltaY))),e.direction=o,i&&n>t.threshold&&o&t.direction},attrTest:function(e){return Me.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ee(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),m(Ie,Me,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),m(Be,Te,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[be]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!n||!i||12&e.eventType&&!o)this.reset();else if(1&e.eventType)this.reset(),this._timer=h((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Se},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),m(ze,Me,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),m(Le,Me,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return De.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return 30&i?t=e.overallVelocity:6&i?t=e.overallVelocityX:i&N&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&c(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Ee(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),m(Ne,Te,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ye]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(n&&o&&i){if(4!=e.eventType)return this.failTimeout();var r=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||W(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&r?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=h((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Se},failTimeout:function(){return this._timer=h((function(){this.state=Se}),this.options.interval,this),Se},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),$e.VERSION="2.0.7",$e.defaults={domEvents:!1,touchAction:ve,enable:!0,inputTarget:null,inputClass:null,preset:[[ze,{enable:!1}],[Ie,{enable:!1},["rotate"]],[Le,{direction:6}],[De,{direction:6},["swipe"]],[Ne],[Ne,{event:"doubletap",taps:2},["tap"]],[Be]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ve(e,t){var i;this.options=r({},$e.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((i=this).options.inputClass||(I?ie:B?de:D?ue:J))(i,F),this.touchAction=new Ce(this,this.options.touchAction),Oe(this,!0),p(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Oe(e,t){var i,n=e.element;n.style&&(p(e.options.cssProps,(function(o,r){i=E(n.style,r),t?(e.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=e.oldCssProps[i]||""})),t||(e.oldCssProps={}))}Ve.prototype={set:function(e){return r(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var i;this.touchAction.preventDefaults(e);var n=this.recognizers,o=t.curRecognizer;(!o||o&&8&o.state)&&(o=t.curRecognizer=null);for(var r=0;r<n.length;)i=n[r],2===t.stopped||o&&i!=o&&!i.canRecognizeWith(o)?i.reset():i.recognize(e),!o&&14&i.state&&(o=t.curRecognizer=i),r++}},get:function(e){if(e instanceof Te)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(u(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(u(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=S(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==o&&t!==o){var i=this.handlers;return p(C(e),(function(e){i[e]=i[e]||[],i[e].push(t)})),this}},off:function(e,t){if(e!==o){var i=this.handlers;return p(C(e),(function(e){t?i[e]&&i[e].splice(S(i[e],t),1):delete i[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=i.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var o=0;o<n.length;)n[o](t),o++}},destroy:function(){this.element&&Oe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},r($e,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Se,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:N,DIRECTION_ALL:30,Manager:Ve,Input:O,TouchAction:Ce,TouchInput:de,MouseInput:J,PointerEventInput:ie,TouchMouseInput:ue,SingleTouchInput:se,Recognizer:Te,AttrRecognizer:Me,Tap:Ne,Pan:De,Swipe:Le,Pinch:Ie,Rotate:ze,Press:Be,on:w,off:A,each:p,merge:g,extend:f,assign:r,inherit:m,bindFn:v,prefixed:E}),(void 0!==t?t:"undefined"!=typeof self?self:{}).Hammer=$e,e.exports?e.exports=$e:t.Hammer=$e}(window,document)}(hammer);var Hammer=hammer.exports;class DOMView extends View{initialize(){super.initialize(),this.el=this._createElement()}remove(){remove(this.el),super.remove()}css_classes(){return[]}render(){}renderTo(e){e.appendChild(this.el),this.render()}_createElement(){return createElement$1(this.tagName,{class:this.css_classes()})}}DOMView.__name__="DOMView",DOMView.prototype.tagName="div";const root$2="bk-root",toolbar_hidden="bk-toolbar-hidden",toolbar="bk-toolbar",button_bar="bk-button-bar",logo$1="bk-logo",above$2="bk-above",below$3="bk-below",left$2="bk-left",right$2="bk-right",toolbar_button="bk-toolbar-button",active$3="bk-active";var toolbars_css='.bk-root .bk-toolbar-hidden{visibility:hidden;opacity:0;transition:visibility 0.3s linear, opacity 0.3s linear;}.bk-root .bk-toolbar,.bk-root .bk-button-bar{display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;}.bk-root .bk-toolbar .bk-logo{flex-shrink:0;-webkit-flex-shrink:0;}.bk-root .bk-toolbar.bk-above,.bk-root .bk-toolbar.bk-below{flex-direction:row;-webkit-flex-direction:row;justify-content:flex-end;-webkit-justify-content:flex-end;}.bk-root .bk-toolbar.bk-above .bk-button-bar,.bk-root .bk-toolbar.bk-below .bk-button-bar{display:flex;display:-webkit-flex;flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-toolbar.bk-above .bk-logo,.bk-root .bk-toolbar.bk-below .bk-logo{order:1;-webkit-order:1;margin-left:5px;margin-right:0px;}.bk-root .bk-toolbar.bk-left,.bk-root .bk-toolbar.bk-right{flex-direction:column;-webkit-flex-direction:column;justify-content:flex-start;-webkit-justify-content:flex-start;}.bk-root .bk-toolbar.bk-left .bk-button-bar,.bk-root .bk-toolbar.bk-right .bk-button-bar{display:flex;display:-webkit-flex;flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-toolbar.bk-left .bk-logo,.bk-root .bk-toolbar.bk-right .bk-logo{order:0;-webkit-order:0;margin-bottom:5px;margin-top:0px;}.bk-root .bk-toolbar-button{width:30px;height:30px;cursor:pointer;background-size:60% 60%;background-origin:border-box;background-color:transparent;background-repeat:no-repeat;background-position:center center;}.bk-root .bk-toolbar-button:hover{background-color:rgba(192, 192, 192, 0.15);}.bk-root .bk-toolbar-button:focus{outline:none;}.bk-root .bk-toolbar-button::-moz-focus-inner{border:0;}.bk-root .bk-toolbar.bk-above .bk-toolbar-button{border-bottom:2px solid transparent;}.bk-root .bk-toolbar.bk-above .bk-toolbar-button.bk-active{border-bottom-color:#26aae1;}.bk-root .bk-toolbar.bk-below .bk-toolbar-button{border-top:2px solid transparent;}.bk-root .bk-toolbar.bk-below .bk-toolbar-button.bk-active{border-top-color:#26aae1;}.bk-root .bk-toolbar.bk-right .bk-toolbar-button{border-left:2px solid transparent;}.bk-root .bk-toolbar.bk-right .bk-toolbar-button.bk-active{border-left-color:#26aae1;}.bk-root .bk-toolbar.bk-left .bk-toolbar-button{border-right:2px solid transparent;}.bk-root .bk-toolbar.bk-left .bk-toolbar-button.bk-active{border-right-color:#26aae1;}.bk-root .bk-button-bar + .bk-button-bar:before{content:" ";display:inline-block;background-color:lightgray;}.bk-root .bk-toolbar.bk-above .bk-button-bar + .bk-button-bar:before,.bk-root .bk-toolbar.bk-below .bk-button-bar + .bk-button-bar:before{height:10px;width:1px;}.bk-root .bk-toolbar.bk-left .bk-button-bar + .bk-button-bar:before,.bk-root .bk-toolbar.bk-right .bk-button-bar + .bk-button-bar:before{height:1px;width:10px;}',toolbars=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",root:root$2,toolbar_hidden:toolbar_hidden,toolbar:toolbar,button_bar:button_bar,logo:logo$1,above:above$2,below:below$3,left:left$2,right:right$2,toolbar_button:toolbar_button,active:active$3,default:toolbars_css});const tool_icon_box_select="bk-tool-icon-box-select",tool_icon_box_zoom="bk-tool-icon-box-zoom",tool_icon_zoom_in="bk-tool-icon-zoom-in",tool_icon_zoom_out="bk-tool-icon-zoom-out",tool_icon_help="bk-tool-icon-help",tool_icon_hover="bk-tool-icon-hover",tool_icon_crosshair="bk-tool-icon-crosshair",tool_icon_lasso_select="bk-tool-icon-lasso-select",tool_icon_pan="bk-tool-icon-pan",tool_icon_xpan="bk-tool-icon-xpan",tool_icon_ypan="bk-tool-icon-ypan",tool_icon_range="bk-tool-icon-range",tool_icon_polygon_select="bk-tool-icon-polygon-select",tool_icon_redo="bk-tool-icon-redo",tool_icon_reset="bk-tool-icon-reset",tool_icon_save="bk-tool-icon-save",tool_icon_tap_select="bk-tool-icon-tap-select",tool_icon_undo="bk-tool-icon-undo",tool_icon_wheel_pan="bk-tool-icon-wheel-pan",tool_icon_wheel_zoom="bk-tool-icon-wheel-zoom",tool_icon_box_edit="bk-tool-icon-box-edit",tool_icon_freehand_draw="bk-tool-icon-freehand-draw",tool_icon_poly_draw="bk-tool-icon-poly-draw",tool_icon_point_draw="bk-tool-icon-point-draw",tool_icon_poly_edit="bk-tool-icon-poly-edit",tool_icon_line_edit="bk-tool-icon-line-edit";var icons_css='.bk-root .bk-tool-icon-copy-to-clipboard{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUSDBoBvcHQeQAAAG9JREFUWMNjXLhsJcNAAiaGAQYwB/xHwh/Q+ITEkfHQCwEWND4jmeb8H/JpgBwfI6cNBhLSEkqaGXRpgFRAcZoZsmlg1AGjDhh1wKgDRh0w6gCaVcf/R2wIkNqw+D9s0wADvUNiyIYA47BJAwPuAAAj/Cjd0TCN6wAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-replace-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxokK3gniQAAAHpJREFUWMNjXLhsJcNAAiaGAQajDhhwB7DgEP+PxmeksvjgDwFcLmYkUh2hkBj8IcBIZXsYh1w2/I8v3sgAOM0bLYhGc8GgrwuICgldfQO88pcvXvg/aOuCUQeM5oLRuoCFCJcTbOMh5XOiW0JDNhdQS3y0IBp1ABwAAF8KGrhC1Eg6AAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-append-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxkZWD04WwAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAoUlEQVRYw+1WQQ6AIAwrhO8Y/bIXEz9jIMSDr8ETCUEPQzA4pMeFLKNbu4l5WR0CDOMEALBGIzMuQIBEZQjPgP9JLjwTfBjY9sO9lZsFA9IafZng3BlIyVefgd8XQFZBAWe8jfNxwsDhir6rzoCiPiy1K+J8/FRQemv2XfAdFcQ9znU4Viqg9ta1qYJ+D1BnAIBrkgGVOrXNqUA9rbyZm/AEzFh4jEeY/soAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-intersect-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxkrkOpp2wAAAPhJREFUWMPtV1EKwjAMTUavI3oawR/vtn5srJdREfzwMvHHQlcT2mpdMzFfWxiP5r2+JMN+mAiCOB72CABgR1cln4oOGocJnuMTSxWk8jMm7OggYkYXA9gPE3uyd8NXHONJ+eYMdE/NqCJmEZ5ZqlJJ4sUksKN7cYSaPoCZFWR1QI+Xm1fBACU63Cw22x0AAJxudwrffVwvZ+JmQdAHZkw0d4EpAMCw8k87pMdbnwtizQumJYv3nwV6XOA1qbUT/oQLUJgFRbsiNwFVucBIlyR3p0tdMp+XmFjfLKi1LatyAXtCRjPWBdL3Ke3VuACJKFfDr/xFN2fgAR/Go0qaLlmEAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-subtract-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxgsF5XNOQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABFUlEQVRYw9VWUQqDMAxNpWfxQxD1MoP97G7zQ5mH2RTZYLtM9lWoMbXtxLXNX4OG9r28l4hrd0PQoqxqAACYpxH25C/nkwCHyCBwSPoS09k1T5Fo+4EiExcC4v584xGFmyIXHBLRISAVZyZufUPVa4rcrwmPDgr93ylo+2GliLRUYHK6th/o/6r7nfLpqaCsagEA8Hh9FmcNKeRmgeYDC+SCq0B6FFi8/BcV6BdR9cL3gCv3ijPKOacsn3rBEcjmaVxpfGcg4wHxzgJJnc6241Hn23DERFRAu1bNcWa3Q0uXi62XR6sCaWoSejbtdLYmU3kTEunNgj0bUbQqYG/IcMaqwPS9jftoVCAQ0ZVDJwf0zQdH4AsyW6fpQu4YegAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-clear-selection{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUGEhcuan3d3wAAAoRJREFUWMPtlzFP3EAQhd+b3TNSzg0N5TWXLkJQUUaKhIQ4fgP/g5ArrriE/I3opEgRrZtIVJR0FJQ010SioUmEZHtnUpwN9gWHGA5BJCy58MraffvmfZ41v3z9hqe8BE98vQh4cgG+Ydzmnrng8efvQJNi/uN7dznx/B3ggtfhf4ehNdUttRzBDIm/2VTiiWCG1HK0nc+3UWtq8BQIiEEakEQOADBIA4QCQmBqoHBhFNR27ikQSmGdYCdTqCpEHMDZmEKRWUBEv1gBDg5SzRJnpopILWICgWuRYflLamuzxB2BmtYqSRIka5VWU8QduXO+1hRc5YZu5GAwmP2ZJzND0IBu5HCV2+NQcAhAVRsnC2IbPzPdSjzd6to6VtfWkXi6YLaVWr7xoAwkfpb8MnC3SH7rKSMBe4M0jA/OTicFIbtCGRIyNbURhcf3ErCd6YwA1m0HgAxhw1NGQnlXBHG4kylVlSJuH0RfIP2CkL2I/qS1gIAAQiBl1QwFggIHtyxgrxK5PgyfC0JWKoT0HLh8LwoietB4TYKaIl7yeNURxB05UtMxDOcVQlZIrlRKdK6m47gjR/fuBRQihyLArtNeJD50Izcx2Eczu7iFkIug4VM3cpOr3MKDekFED0fWUHv9Zq0kpLnridjhY3XDg7NTN0jDrhO3X7O9Wg7wwyANu4mnayNg3gmbu0tCNoUyBNGv2l4rB9EXynA7082FOxAQLhU6rQVO9T2AvWowFToNCJcPORGxIRcnpjZSKATSU9NxvOQnAPArDSaQoUKnNI4iufkGtD4P3EHIcWZhz4HLceSOyrR3Izf5memPAL2cX3yhAkonysZVaWLBkd9dw1Ivv2a/AYPkK+ty1U1DAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-box-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg0kduFrowAAAIdJREFUWMPtVtEKwCAI9KL//4e9DPZ3+wP3KgOjNZouFYI4C8q7s7DtB1lGIeMoRMRinCLXg/ML3EcFqpjjloOyZxRntxpwQ8HsgHYARKFAtSFrCg3TCdMFCE1BuuALEXJLjC4qENsFVXCESZw38/kWLOkC/K4PcOc/Hj03WkoDT3EaWW9egQul6CUbq90JTwAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-box-zoom{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg82t254aQAAAkBJREFUWMPN11+E1FEUB/DPTFn2qaeIpcSwr5NlUyJiKWVXWUqvlUh/iE3RY9mUekkPPURtLKNRrFJEeuphGfUUaVliiX1aVjGs6aG7+XX9ZnZ+d2fTl2vmnHvPPfeee/79Sk+may2/UQq/q7Qu+bAJoxjHIKqB/wlfUMcMVqI9bLZ+DGIKwzlzQ2GcxCx2xwvKOUKlaHTiX8bHNspjDONHkOmJBW5jIof/FvPh/06MZOb6cRc7cGn1AKUE5cdzlM/gAr5F/O24H3xkFRfxAbVygvK+cIsspjGWo1zgjeFpxL+BvnLw7laBA4xjIFJwrgu52DoVjKdY4HBEX8dSF3JLYe1fe6UcYCii3xWQjdfuSTnAtoheKCC7GNED5Zx4L4qt61jbTLHA94geKSC7P7ZeShQ0Inoi1IJuEOeORooFXkV0FZNdZs5qvFfKAeqYy7nZ6yg//HG0MBfffh71lFrQDCW2EvEP4mt4okZUDftz9rmGZkotmMxJRtlisy+MTniAWrty3AlXw0hFM2TD89l+oNsoOJXjbIs4EpqNtTCLXbiZ0g+M4mFObj8U3vsNjoZCVcmk60ZwthpepLZkB/AsivWfOJZxtpUQHfWib7KWDwzjeegBZJSdKFiE2qJTFFTwElsi/unQ/awXrU4WGMD7nOJxBY/1EO2iYConq93CHT1GOwucjdqnRyFz+VcHmMNefMY9nNkA3SWUOoXhQviSWQ4huLIRFlirFixnQq/XaKXUgg2xQNGv4V7x/RcW+AXPB3h7H1PaiQAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-zoom-in{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgsUBmL8iQAAA2JJREFUWMO9l12IlFUYx3//MzPrLpSjkm5oN4FFIWVEl66IQlFYwtLOzozsjHdGRSCRF0sfBEXRVV0FQuQiLm5CZNBFgRRaRLVFhbJ2EdiN5gbK7toObTPn6eYdPTvNzPvOBz5Xh/ec5/n/n89zXtEHmZqeSXSuXBz/3zfdKvBWJHQrwZuRcP0El+QkbQXeBX6WZEgm6TtJk5lM5o4Lc+cV6qpf4Ga20Tm338zeATItVK9Ker6yvPzp4NDQ3+XieGsCU9MzTYumGbhz7m4ze9/MHgvBgItACrgfGAj2jgAvAYs3wlEujjc13kii8YyZrXXOfWhmo9GnFUlvOOemarVapVqtkslksmb2KjARqL62ecuWN9NxbRInzrldAXhV0uFSIfdew7G/gNLU9MwS8CwSmE3Oz88fcXG5blfpqVRq0Ix8VIAAX0XgrVL7HDCHGcCaWrV60LUBN8Dae58aQIxEqcA592I9M610JL0cpG/U9TIHJNKY3RV5z0R+7Nd4HZ0P1g/2RMBuegLAsRMnb4vT8d5vqKfMzOgtAlADrkmqGywmiMBTwfr3dC9j1Xv/r6Tvg/5/5ejxE6cO7M9faVbQZrYNOFSPmqQvVo9FKexvi5uWX58943aM7DwAfBDY+FbSCxP5sdkGx55GeguzrUEXPaSo2pFkAbiSZQCAzZJOmdkjwd6SpB/M7KykQTPbA2wDhoIzRzcNDx9MJwGNIXdJ0mEzmwbujL7dbma7gd03A7lKfnTOvf74nl0r6bonTUbujRSUCrm2d4L3/kvn3JPe+8+BDW2i9o+kT7z3kxP5sYsA6W47oE64TsR7P9tQL4vA2mh9WdIscKxUyJ0M7aR7acOGzikD65EQLEjaa2ZXzMwDFeB6qZBbbLTRE4EGeSaozNOZgYFf8qP7lmIvs354n0qlHpB0T7B9Ogl4IgJJrmjv/SiQjbrkD+BMUkfSbYATPdckrTOzkciWAXOlQu5cYgLdPEIapud9wMOR9zVJH3ViKx333mtHMJvNuoWFhZ3A+ojMcja77njXBEKwJJfTcqUyCIQ34Mf7nnh0paMnXacFuGoC1mr3AtuDfLzd8Zuyl+rfuGn4HLAD+Az4qZQf+61TAj0Noj8vX6oC35SL43u7teG6rf5+iXppwW7/JUL5D03qaFRvvUe+AAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-zoom-out{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgsHgty9VwAAA0FJREFUWMO9l09oXFUUxn/fmXlpItppi22k7UJBRSlVkCytSAuKUloIdjKT0El3FXVXdVFKRVAQV7qQohsNwdA0UFvBhYtqUVyIVlRaogtFQVq7qSTVjA3z3nHzBq/jvPmTN/Ss7rv3nvN99/y794kByMzcfE/7picn/jenmwWeRUI3E7wdCRskuCSTdDfwBvCtJEdySV9KOhpF0e0/LF5SqKtBgbv7ZjObcvfXgShD9Zqk5+orKx8Oj4z8NT05kU1gZm6+bdK0Azezu9z9hLs/HoIBvwAF4H5gKFh7B3gBWFY3460kWve4+3oze9fdx9OpVUmvmNlMHMf1RqNBFEUldz8OHAxUX9q6bduryut+Sfvc/Wz62ZD0fK1afjND9y3gGSRwv1GMojstTxUUCoVhdyopEYDzKXjWwZ4FFnEHWBc3Goet00m7lZlZYQixKw0FZnakGZksHUnHgvCN5/KARBH37enpOVg58H13HV0Kxg/kIuD/ngSA2ZMLt3bTSZJkUzNk7k4+D0AM/CGpaXCyBw/sC8Y/qZd2GpZiuL9YLN4Sx/HpoP5/c/exQ1OVq+1yyt13SLoArEsJnMjlgfOffvK3u58Kprab2QezJxfG2iTzUzI70wRPG9jbmpmb95SNB9mpzp7/j2yVdNbdx4K565K+cvfPJQ27+x5gBzAS7Hlvy+jo4WIvoC3kWpcvS3rR3eeAO9K529x9N7C7zX6AC2b28hN7Hl1Vt44niVq13LUjmtlYkiQfA5s6eO+GpDNJkhw9NFX5ueNt2ARodyF1IHIN2JiOl4H16fiKpK+B2Vq1vBAqFAf4IJkGNiIhWJK0192vunsC1IE/a9XycquNXARa5OnApeeioaHvKuP7r3dTGsiLqFAo7JR0T7B8rhfwXARa2us4UEqr5Ffgs151i/08oTNKdIO770ptObBYq5Yv5ibQq/sl3Qc8lJ4+lnSqH1vFfp9koZRKJVtaWnqkWXqSVkqlDe+vmUDWpZMlK/X6MBDegKf3P/nYaj8ErN9fqZBYEsf3Ag8G8Xit33BaniTcvGX0IvAw8BHwTa1y4Md+CeRqRL9fudwAvpienNi7Vhu21uwflOT+L+i1X2TJP57iUvUFtHWsAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-help{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABltpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+NTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDpBODVDNDBDMzIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDpBODVDNDBDNDIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkRlcml2ZWRGcm9tIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgPHN0UmVmOmluc3RhbmNlSUQ+eG1wLmlpZDpBODVDNDBDMTIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwvc3RSZWY6aW5zdGFuY2VJRD4KICAgICAgICAgICAgPHN0UmVmOmRvY3VtZW50SUQ+eG1wLmRpZDpBODVDNDBDMjIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwvc3RSZWY6ZG9jdW1lbnRJRD4KICAgICAgICAgPC94bXBNTTpEZXJpdmVkRnJvbT4KICAgICAgICAgPGRjOnN1YmplY3Q+CiAgICAgICAgICAgIDxyZGY6U2VxLz4KICAgICAgICAgPC9kYzpzdWJqZWN0PgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNjoxMToyOCAxMToxMTo4MjwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+UGl4ZWxtYXRvciAzLjY8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cphjt2AAAAT7SURBVFgJxRdbaFxFdGb2bhui227BWrsVKYgf2kJUbP9EUPuzEB803WTXJjH61Q/7Ya1+CMYKEVTsh4J/EpvY7BoabUiNiA8s1p+4KIhpoUUEselHqyS76TbZ3HuP58ydc3d2u4+IkQxczpz3mZkzZ86VYpXjvenpjZsLhUcliE4AuUuASAgptmt1EFdwPiclzIIUUwubNn17OJlcXo1p2UpodHRiux9xB1Eug1+slbzhFxGOKc851tu7/0oznYYBDA8Pt0U2tL8KQryIq2tvZqQhD0QJHRz3yqWhgYGBpXpydQMwqz6NCnurleCSADkJEfgKfOePqL80R/wV1ZaQyr1LenKfkPCkEPKeaj0xg7vxVL3duCmA0Vyuw/fl52hgBxsBED+h4Cv9z3R/zbRm8MTJTx7HQN7GQB6w5C4L4SX7M5lfLBpurjXMyvNIShiyi0l1pL8n9b7EDGPR8fHxzSsQ6XDB3618/xqo6Pk25V5MpVJllgHM1BO58RdQ612kOYZ+GXdij70TYQB05mpj+1kU5G2fB+l3PZtOf8NGx6ambnMXb3yAxg8wjSEG6OKKR9oicBQD+ZvpH2Wzj0lQpxCPG9qMv1x6hHNCsSAlHM7ZOa682vlI9tRDbvHGbD3nZAPpDoD/3JIrLpAs26UFkC3EMUA99hpfGtEBfJjNJnS2Gwnadnvl+Xw+iuc3DAJuNyIaSCHpilVldyDjjUxj3WDZIAhxhHHyRcdNuA7AAfUaXzVKODpzFiZ4/uLvh5G+m2no+C/pyIf7MqlEJB7bpqR6nXkEUfbeawuLaZsW2ISfNQ2vtaktQlGFQyIVGT0o2+2EC4iQNGwjBIN9qdQ5Qg4mk4X4rW3vCClLtowE2FOFUxKDfNmiZci3ovKKRFPh4FK9q4Zbdr+lKKJiA13TcHR2dmLBgdmQ0GAS2MZaEowY+XbAk09IvgtYZGp16SyvFhaHcIUh645t8T9DBCcnz5zZ4hZLu3DzK2QlL1QQa0Y+pHiJKPSuOGj3PmZTheM5w2TwqBxnvBZOTk7G5gvXJ5Aelms8wnJURL+olSWcfEhf6gDoUXPMq6ZlqbzWU2pE+3hi4s6F68tfIj9cBMlikr7Z0/P0b/X0yIcUXsDCF1WhtL4OROHaXk+xlkbV0Cu732Nmhc4peaWSg73pA8dq5RkvO37ldUTfXCKZv2q45MkhvG87WQEzpCCUSvV1d9GONBy3lMvgKSwrZig8gjAietWY0QriylO2jIo4yVbOSb7KB/qmI9BPKjHpSSXYauRyn92Nq9/Kcrj13x3s3v8D481glQ/0raiNYgX9njPSBOImbrHZePl+tfFmc9sH+Xaoh8NjOKSVdDMhjjYzQLy+dFceH5+IJQf9VYXX4tROg4ZFU8m31M3mfPEqUoJqCGJfvWpo2xnNfdrhC28n06SCeSzNZxlvBINGRXCtKS7EY1uV6V7HWAm38y1cXaXsMcOCvr9ySPj+af7A1U2HJXHzVNvUXVLIGyPf+jV0pf8GHoN+TLAyPkidTCi2RpPApmnR0Bd1zGRaB/B8Oj2HSw7LLbVR1MmskW8RdEWVXSJf3JbpAMgRtc4IZoxTh9qotQjCasm46M0YX9pV1VmbpvRH5OwwgdRtSg2vKaAz/1dNKVtb17Y8DCL4HVufHxMOYl1/zTgIgiYvBnFKfaNp3YjTdPz3n9Na8//X7/k/O1tdwopcZlcAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4oVHp0SwAAAQJJREFUWMPtlsENgzAMRb8RQ5VJItFDOgaZAMaAA0iZpN3KPZSoEEHSQBCViI/G8pfNt/KAFFcPshPdoAGgZkYVVYjQAFCyFLN8tlAbXRwAxp61nc9XCkGERpZCxRDvBl0zoxp7K98GAACxxH29srNNmPsK2l7zHoHHXZDr+/9vwDfB3kgeSB5IHkgeOH0DmesJjSXi6pUvkYt5u9teVy6aWREDM0D0BRvmGRV5N6DsQkMzI64FidtI5t3AOKWaFhuioY8dlYf9TO1PREUh/9HVeAqzIThHgWZ6MuNmC1jiL1mK4pAzlKUojEmNsxcmL0J60tazWjLZFpClPbd9BMJfL95145YajN5RHQAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-crosshair{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADEUlEQVRYR81XXVIaQRCeHqug8CXmBNETaE4gniDwIgpVspxAbxC9ATkBkCpQ8gKeQDiB5AQxNyAvUlrldr7eHxyGXZi1rMJ5opbp7m++7un+htSGF204vsoMoNXrlzSpfWa1oxQfhAegCZGaEtPorHo8znIoJwCt6+td8uk7ApUQCIHTF4BNAWzImq8ap6cP68CsBdDp9i9ZqXM7ML79g/EnCWD+jgMKENKqWT+tXK0CkQqgNRjs0OxpQIqKhoMxaG6/6JeRnK7T6yO2UvVqhYSlLX+ryORfgKn9ORDFIy7ky41yGcwsr0QAQfDH5zucOswx819fs4egI9OFCcD8DjBF7VNbEX0JzdWEt3NHSSASAcCxBDqMgt/623kvyTgNgNjJIfTjk4D4FqaJR1715MjmYAmA5Bx3AwUXQL+t105KaTlcBSC26XRvhjEIoLiq1yqXpr8FAGG16/ug4IT27fxBWu7EiQuAiImJpEMKE6nYM30uAIDDttSUOPfJP7JzbjPhAiBIh9QE67vIvoOi9WJfCwDavf40ulpjbCqmUf+W753ezURuh7Dg1SqflwAEHU6pgfyBq9Y4qx0LG++2fnZ/eUzcstmdM2AWH+jfc+liWdBJfSENf8Lifi3GVwC9mybOfi5dzatWVrbbLIHNva8p5h/16gkaFiLGGxbufkoE6XguwePiXLF3XmMfCUCUAqtKXU7sumd1CowOuJEi3Pg1FBpjitIGhyvVSfvmjci6ZR+rFQfDiPVE2jFYeICQ+PoewwjC5h7CZld6DBdyu6nDSKgzOyIMhmhK5TTqXYbRorZYM46TmpKAAOrGWwSJJekSB1yqJNOzp1Gs7YJ0EDeySDIMtJbQHh6Kf/uFfNFZkolJICRmz0P8DKWZuIG2g1hpok+Mk0Qphs0h9lzMtWRoNvYLuVImUWrmPJDlBKeRBDfATGOpHkhw670QSHWGLLckmF1PTsMlYqMJpyUbiO0weiMMceqLVTcotnMCYAYJJbcuQrVgZFP0NOOJYpr62pf3AmrHfWUG4O7abefGAfwH7EXSMJafOlYAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-lasso-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgwlGP1qdAAABMBJREFUWMO9V1uIVVUY/r61z57ZMx4DnbzgkbQXL5iCJphlWdpIGY4jpFBkEiU9ZNaDRRcITcIwMwgxoQtU2IMXdAZfMjFvpERXYiSbysyBEXFmyuHMnLP32uvrwT2xnY5nxvHQ93Jg7fWv71/r//7L4a59TRgqJk+Z6v3a+sv0OI5nk5wu6VaSVZImAThHsgjgrKTvM5nMUWvtmf5n8HodCIKgOgzDhc65pSTrJQWDsSNpJX1ljHnDOfdT37oZLLHv+8OMMasKhcIJ59xHAJYMlhwAJGUAzJfUTHLFuFzOG5QDU6dNMyQfs9Yedc5tBpAD4IYYNQGoBrDtQnt7/b0LFrJsCHzfn2itfQfAnZLiazytA3AaQAuAiwDaEgeNpGkkswAWSBqRONB38b88z5uTKePt6iiKXkk8jq+iJC5LOmiMaTLGHLPWhmWeHr7vV0dRtATAapAzIVmSo51zyzIlbm2stesFPA6pKk0r6Ryg93y/ek8YFvPOOTg3cDSiKCoC2OP7/rEoirYm4rUkF12lAWNM1lr7lqQn0+QA8gI2jBg5cj6Aj8OwmB+KAKIoukhyp6SRJAUgl0ndPLDWPi9pJQCbuviXvu+/GIZhW1dnJ24UJFuTjCCA2ADA8sYGWmsXS3qmL94kDYAtkh4Nw7ANlQJ5U6INT1KrAYC9zQdykl7nFSj5fXp5Y8NWVBhy7mUAjqShMYdMXV2dJ2klyRwAJ8lIeuGWCRMP7N7frEqSG2OmAFhKshNAp5wrmO7u7jEAngPQm1S2z2pqapr+OPt7XEly0oxwzq2RdFmSD2AMgKKJouhhAL4kA+Cs53l7e3t7uytJHgRBreTWkXwkKVJnJD0B4GAGwIJE9R6AFufc6UqSZ7PZbD6ff5dkA4CQZEHSqwAOISmXtwGIE+F1SeqqIP8d+Xz+C0mLJYWSAODteXffczjdDQNJ0BWMCoLg5gqIbRTJNwHsljQhUb0luWPM2LE7Thw/9m/5NCT/TByxAOYWi8X6/gdWV1dnfN8fNRBxJpMZTXKdc+6IpFVJWAEgkvSJpA0X2tvtVTaSjgOYBCAEEADYSHK87/sfhmEYA9gShuEDkgzJHyWtB/B1irQ2juP7ADxkrX0wOUOpzmdpzEY590HJ7Ni1r2kSyZOSiv2+hSRjSTXp/QAukzySNJOJkmalyNIl10hqMcasdc61XDNcQRD8BnITgNp+36r6kfcNFMMlLQGwTNLMEuQGQBfJl2bdPru+HDkAZAqFQux53jZHEsC6aw0eg2gylNRBcqcx5v04ji999+03AwsWAOI4Lsy9a94WkisAnE5a5WCJYwCfA1g7LJudI2lTHMeXBm1faiQzxkyRtF3S5CTupeAB+KG2tnZFT0/P30NO2VKLzrmfAbwGMipjG5Oc0dPTc0Md05SZ5U4Q2FxChErtEYD7jTGNQ3UgM8Asv90Yc9I5LSKRlXSI5CxJa0jWSALJjKRnAewfkniT+vwf7N7fXHK9rq7O7+jo+BTA/NRrdBpjnnLOnUrvXd7YMPQXSBunneno6IhIHgYwW1JtkgmBpBkATlVMAwOk3nFJ+VSoqgCMr6gIy2FcLtdKspAedyQN/98caDt/3kpyabUmf8WvG/8A1vODTBVE/0MAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-pan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4lKssI9gAAAOtJREFUWMPVll0KwyAMgNPgoc0JzDX2Mtgp3csKErSamGabIEUo/T6bHz0ezxdsjPJ5kvUDaROem7VJAp3gufkbtwtI+JYEOsHNEugIN0mgM1wtsVoF1MnyKtZHZBW4DVxoMh6jaAW0MTfnBAbALyUwCD6UwEB4VyJN4FXx4aqUAACgFLjzrsRP9AECAP4Cm88QtJeJrGivdeNdPpko+j1H7XzUB+6WYHmo4eDk4wj41XFMEfBZGXpK0F/eB+QhVcXslVo7i6eANjF5NYSojCN7wi05MJNgbfKiMaPZA75TBVKCrWWbnGrb3DPePZ9Bcbe/QecAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-xpan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4X4hxZdgAAAMpJREFUWMPtlsEKwjAMhr/pwOOedINJe/PobWXCfAIvgo/nA4heOiilZQqN2yE5lpD/I38SWt3uD9aMHSuHAiiAAmwaYCqoM/0KMABtQYDW11wEaHyiEei28bWb8LGOkk5C4iEEgE11YBQWDyHGuAMD0CeS30IQPfACbC3o+Vd2bOIOWMCtoO1mC+ap3CfmoCokFs/SZd6E0ILjnzrhvFbyEJ2FIZzXyB6iZ3AkjITn8WOdSbbAoaD4NSW+tIZdQYBOPyQKoAAKkIsPv0se4A/1UC0AAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-ypan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4anK0lywAAAMVJREFUWMPtlzEKwzAMRX/S7rlpIMXeOnaLaME36FLo8XqCdNFghGljyc4kgQi2Q/SUj0F/eL7eMMTKz6j9wNlYPGRrFcSoLH4XxQPvdQeYuPOlcLbw2dRTgqvoXEaolWM0aP4LYm0NkHYWzyFSSwlmzjw2sR6OvAXNwgEcwAEcwAEcwAEcoGYk20SiMCHlmVoCzACoojEqjHBmCeJOCOo1lgPA7Q8E8TvdjMmHuzsV3NFD4w+1t+Ai/gTx3qHuOFqdMQB8ASMwJX0IEHOeAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-range{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABCJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjU8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjMyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT4xPC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zMjwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDxkYzpzdWJqZWN0PgogICAgICAgICAgICA8cmRmOkJhZy8+CiAgICAgICAgIDwvZGM6c3ViamVjdD4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTgtMDQtMjhUMTQ6MDQ6NDk8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPlBpeGVsbWF0b3IgMy43PC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrsrWBhAAAD60lEQVRYCcVWv2scRxSemZ097SHbSeWkcYwwclDhzr1Q5T6QE1LghP6BGNIYJGRWNlaZItiFK1mr+JAu4HQu0kjpU8sgF3ITAsaFg0hOvt2Zyfvmdsa7a610Unx44Zgf773vvfneezPHNzrbhn3CT3xC3wPXYOC8LDzqdi8YY/gwh4BeknS/2th6dr2kf94AOp3OFyWgMyziOPbMDxV9FTtJnl1ut795Xd0/YQ0/vtYQwMT1KXWCfr2IjOWwtNehwN4xL9ykTrm6Pzl58yLn3J+mKh9mXbT3uRjGEDph+O8/TjfP5dBp7Ha7AX7O3o5nZeD/0E/OGyXntDgzA0X6qmCnrVutVlrUWV9f/3xo+pwhGDhvEPHOjoxnZjJggXmMHzBQ7NGNp9vxk61fr0HR7e/u7pZzCGHlc7qwBYYTT7tJYSx1AQzppyFPft5apta9w7SKcn0b7P7+/jCsDQ5mbc0dCmIJGDN0ehdcjsmkm6A6KUeKFOTE11PLxrC7Ukqh3ylL2fT0NAP9q6ur6rRCJJYsbKB0JsbCKMuy+xREePDyxQPCz+Crlw062QcA5wBOOt1l6vIl2WiI9F1fN6Q+BBqit6hEC4Hk08GQJMn4myjSP7RavVxgdaVUh/3U6HCMsPr9pYnJKRziHtWQ+un58+hGs6nsjQSjpuTyKGN3CX+FBwHXSiEVgjP+O8X6N12kIePES+GzTKAkGbNp8yJsGUMVzz8jPKReiyAQRimy5/cjye5RpF8utFp/+nwmT7d/NMzcFkS7yjJNGDaPURQxIQThEQy0SyF4l5WJYYhBa816vZ6dU7A6CAhbZVow/pDe0O9hVOoCi13r4BgBAvJHqMSQL2vE/iH6IAXEwgrRVUmBoRRwnwJQT98xEeVeSUyB4dJ5nwJBKdCFFGRmUCcu7rwIYypCTblaChuNBhWODrman5ub+4v0rMNBt8z6Ezh7GksJQpCbm79cMQE7QBFm/X6f0rjWnv8WRYg/QdbUpwDAEBy8vPyA8rNGzg3a8MiElwiM7dAtRqNoNptjGPM1laVxP9umWEMGLOKhKUOJDtBwDmzsw9fC/CzHr9SGuCTi2LbbKvVtmqXpCjMihBFa79Wrt5fGx9PDzc3fmu32Lf8qFliwU9emKhBSp+kRKn/hu9k1COEDbFdt/BoKWOAkuEbdVYyoIXv8+I/QK9dMHEb1Knb7MHOv8LFFOsjzCVHWOD7Ltn+MXCRF4729vWMDK+p8rLkvwjLg4N4v741m5YuwCI9CvHp1Ha8gFdBoPnQAkGsYYGxxcfEI7QQlFCTGUXwjAz4tWF+EpymOWu7fglE7qsOvrYE6g4+9/x/vhRbMdLOCFgAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-polygon-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEjc1OfiVKAAAAe1JREFUWMPt1r9rU1EUB/DPK0XbqphFHETo4OCiFhwF0V1KHbRSROLqon+AUMVRRFBwEbRFMBiV+mMW/wIxi5OD1kERRVKRJHUwLvfBTZrU5OWBGXLgQu7Jfe98z/ec7z0vKa88b2q1BDtRHdAPBaylm1NzsxsOjPnPNt6WSWprbft+/c3I3zOAjhT1Y4+fvcjEQJIXnVECSa+AhqIHqlHH5lWCZoe+Gk4GRgDG86j9SAUdlDBSQaZhlOkuHyoVdJmsw98D1S5fM4NYM1LCpqM+Lwa240oLgmZzpVZvzKT75VLZcqksSZKWlQeAy/iORVwIvh31xvotvK7VG3Px4aWHj3Jl4C2uYSvq+Bn8v6LLbaVWb9zsBiKLCvbiNG7gLm7jAYqbPHMJMziZ9lsKoh8GtqCEVVzHftwJn+TFHp4/hg8BSCYVfMOZoPEv2NZGdy9WCGUr9toDR3E2/H4V6nwRe/BmgN65H1ZhvMuB3XiKIyFoGefwO6ysVkUlrNUNsyAK/jli533Q+Y8cJFvAeXyMS1CI/jiMr/gUtD2LQwMGr4R3p7bY3oQHQ5b38CT4D2AXXg6YcQXHpyYnlqKsi5iOAVSwL9zd7zJ09r+Cpwq72omFMazjT9Dnibym0dTkRDUKrrgwH7MwXVyYB38BstaGDfLUTsgAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-redo{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4itK+dVQAAAaFJREFUWMPt1L1rFFEUBfDfJDaBBSslIFjbaSFp1FJQFMVCHkzhKIqdUYOCoBgErVz8rCwiTDMwBCIKipDWyip/gxAIWAmBgBC0eYFh2Gx2l9lFcA5M8e59782Zc84dWrT435Hs1siLchqn43MS0zgW22vYxjesYjVLw3YjBPKinMUTBOwf8J5fKLGYpWFjJAJ5Uc7gIW6jM6Kim3iNZ1katgYmEL/6I+YasvY7Lg6iRpIX5VF8wuEe/XV8wGf8jN6LWTiAc7iEQ7ucPZ+lYW0vAtfwvlbfwCKW9gpXDOv1mJvZHiSO91MiyYsyiQSuxtpXXM7SsDmM5nlRdrCMMz3sOJWl4Xevc/vwBzdwAl+yNNwZxfRI+GxelK9ikHcwh8d4NNR/YFRES1ZwoTYdR7I0rNf3TzVNIGbmSvR/Bx08mIgCFSVu4l2ltIWD9WxNGR+W8KOynqnZ0rwCeVG+wa0hjrxtWoF5dAfc28V8Mib/n+Nev5dnabg/zgw87aNEN/bHOwVRiRe4Wym9zNKwMKkpgIWKEt24njxiJlq0aPFv4i9ZWXMSPPhE/QAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-reset{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4gWqH8eQAABLdJREFUWMPtlktsVGUUx3/nfvfOlLQaY2IiRRMQIRpI0PjamJhoVASDvNpCpYw1vJQYSVwZwIVQF6wwRHmkAUof9ElrI6VqDAXcID4TF0IiYQMkSlTokNCZ+b7jove2t+NMH7rQBWd3v+989/zP+Z8X3Jb/WGQySvUNTQBJESkNguAVYIWqzhaRhwBU9WcR+QXoymazn6jqzUQiMQSQzWZRVdal1vwzAI2tHQBPOuc2AbWTdOyQ53n7nHNfRwee51GzqoIQMCLDpr3x/tLQ0oZzrk5Vj0/BOEBt+KYuOlBVGlrahr0Wob27t3gEjnZ2AyQzmUwHsDgP6J/AYRE553neDwDOuUdU9QngNeCumK4TkRMhZUORcYC1qysLA6iuSQHIwkWLD6lqapQsuSmwTVV3h99I7EcAR462A2xR2Ilq6ehTaejvO1774kuLNALR33eclsaGsQDe3fYegHl43vyNwEeqGl1963mm2jl7YZRTQ82qlWP4HM6ZToC5ztkW4LHQoALru7s6Di5dvlIj/e6ujrEAWoZDn8hmMjXATMACGaAVuBjXTVVXFc/AxhaA+4zvn1DV+eHxVWPMAmvtb5GeMWZyZVhI2rt7qVy2pOh9U1snwIPW2vMi4oWJuBPYHkVAVScPoKmtkzVVK6cEMsyJraHhiCqJqJUwj/JRz7TW1iSSyR2rVyylqa0Ta+24Ic8vXaAEmDFc/l5Z2A/80OibuVyuz/f9ElUdHCmvw82t5HK5h6y1PYhsz2YyGw43t2KtBZHIGwB6+j4rCkBVUdV7gXrggnPuu8h4eP+xMeZS2D0rJYZ6AdAMzAt1b4nI26p6IFZOY8pugijcKSIHVLUK0LyST4vnrVfnWr3mjmP4QTATaERkXkypRFX3isjmuHdRJEK6Ckqquopp06bdKCkp2Sgi7XnGLcg7gzeutwNIiPYc8HixqIrIOlU9ONVIhHPEd851icgSVXUiskVV94gIqoonIt0i8gfQCfwae38e6BWRXuBZz5jZ8VbaOE4EIqlZVUEQBLlkMplS1QER2RwkEnsSyaREDUzyeNsvIhvCMqkH1kdIJ2o+k8iJB1LVVRfjZ6nqqlEAIbdVQGto8Lrv+/dbawcjAL7vc+6bs+zetetfLSHxniIFGofGGsU2oC7eOCbDfZ7nQawBOSAX74SF9oEPImOq+r7nmVmxb5raukZa8UReGmNmhbMkAwwBH467EYVZe49z7kdgenj8k7V2oTHm8kgdWcvrNdVFjR8cHkYzjDH9wLjDaEwEzpwa4MypgWvAjtjxfGNMj4jMiT+M+kFsZI/Q6Pv+HGNMT8w4wI7TAyevxXVPD5z8+zD64tRXAMHVK1eaVLUyVvuDqroV2BOnJF4ZIedviUidqt4Re9s+vbx8zZXLl7PR2+nl5Tz/zNOFp2FzxzGAklw22wUsLLaSKXwf8vhosZUM6PeDYEUum70VHfpBwKsVyyfeikOP6oBNwN1TrLbfgX3A1kKLzKeff8nLLzw38T5wZDgxn1LnNk5lLRfP26/OnR2hwfNYW2Atn9RCsrf+EECyrKysDFimqhXhyjY3VLkAXBKRDqA7nU6nS0tLhyIj6XSaN9bVclv+l/IXAmkwvZc+jNUAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-save{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4UexUIzAAAAIRJREFUWMNjXLhs5X+GAQRMDAMMWJDYjGhyf7CoIQf8x2H+f0KGM9M7BBio5FNcITo408CoA0YdQM1cwEhtB/ylgqMkCJmFLwrOQguj/xTg50hmkeyARAYGhlNUCIXjDAwM0eREwTUGBgbz0Ww46oBRB4w6YNQBow4YdcCIahP+H5EhAAAH2R8hH3Rg0QAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-tap-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzIwRUFGMDYyMjE2ODExOTdBNUNBNjVEQTY5OTRDRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCOTJBQzE0RDQ0RDUxMUU0QTE0ODk2NTE1M0M0MkZENCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCOTJBQzE0QzQ0RDUxMUU0QTE0ODk2NTE1M0M0MkZENCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgTWFjaW50b3NoIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTQ0QzIwMUM1RjIxNjgxMUE3QkFFMzhGRjc2NTI3MjgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzcyMEVBRjA2MjIxNjgxMTk3QTVDQTY1REE2OTk0Q0UiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6eYZ88AAADLklEQVR42rSXf2TUYRzHv7tuGcfE6Vwb5zLSSjEj7Y9KWqfEmFZJP+yPMdKKmUrrn0iUfjhWlLFi6YfNrF+StBoTo39iYkTGco4xxxG59P7k/T2PT8/37nu3bx9ezvPj+zyf5/PreS78bGLS8SmrwE6yje3NHJsDBTALpknBz6JhH3NiYAB0gHqPOVv52wJ6QQ48BzdAttTioRJjdeA8mAHHS2xuk3p+M8M16ipVQE49Ds6CiFO9RLjGONf05QLx6wPQaBlbBlPgJVgkP0ETiIJ2sB/E1XfimjfgBOOlKDUqCGOcqBcQnw6BYW5YTo4wbvQhMmCfGRemC2rBiGXzWUb+kM/NRZ6CHWBM9ce5R61NgX6ayhSJ5EPlItlDRNkz4JbFHf06BkSzHjXxM+gDv1S/mPUo2AXWgt9UUHL/IVhS8yUV1/EbV3o4N+NaoE9Fu/i827K5pNYHnqAVJECShWmAaddpscYFFXwR7vnXBRGlnUN/L6kqKJlxnRUuDbaDBiL+vst5d4gpcpBrqk/2jIgCKVUolhntplzivHmwh4stGOPfwBWwl/2dpp8p7xjQZqFLiQJtauKkivYm+kzccpK57yXfOUe+P23JqAnVbhMFmlXntCWnxbT31am9ZJ4BJifsUmNTqt0cYhA5ypympPg7VkEKunPbVb8cIG+0kyHLJZNR7fUMooUKFHAPkfQo58VLK+RzwRDd4FdWG9mjpaAXzqkJa1R7kQttqEABWXMjOOxxVRfnhRm5URX1prk/0pQHwNcKlchZ+jdpC+hFdVqO0my9Hj5dkYgCn1Rfh/KdlNDHrJhPqlDih+IfBd6qwpOgEqYMsorJ2HtWxtagLJDn/W3KRfPOZhoeBJfZPgVeGKeKrkQBh5dLXl25Ny3pc4/1fkTdbvFqFQgbxWeYD0hXulhQ0pYiM1jG547fcbMQpVnHTZEn9W3ljsCzwHxCdVteNHIZvQa7/7cC7nV6zHIfyFP9EXjFa7YxKAVqPP4bxhhoLWW+z9JyCb6M/MREg59/RlmmXbmneIybB+YC/ay+yrffqEddDzwGvKxxDmzhc0tc80XVgblqFfgjwAAPubcGjAOl1wAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-undo{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4em8Dh0gAAAatJREFUWMPt1rFrFFEQBvDfGhACASshkL/ALpWVrSAKEQV5sIULWlgZNSgIFkGIVQ412gkBt1lYLERREFJqJRaW1oHAoZUQsDqwecWy7N3tbe6C4H2wxc682Zn3zTfvLXPM8b8j6RqYF+UCzsfnHBawGt3fMcAX7GEvS8NgKgXkRbmMxwg41TLsN0psZmnodyogL8pFPMIdLHUk7hA7eJKl4U/rAuKu3+HslFr/FZezNPSTFslX8QErDe4DvMVH/Iq9F7VwGpdwZUjsPtaSFjv/1vCBPjaxO0xcNbHejLpZrrlvJCMCT+JzA+2fcC1Lw+GE4l3CG1yIptfjCtiKoqtiJ0vD3aM0Py/K57iIMxgkQxat4EdN7e9xdRzlk+LEEPvDWvIDXJ928sYxjL36icWK+VaWhlezOIqbGFirJd/H7szugrwoX+D2BDEvszSsT5OBdfRaru/F9dPXQF6U27g/KnmWhgctxqyzBrZGMNGL/rHI0nDkKXiKexXTsywNGx0OnFbFNk3BRoWJXnw//j+ivCi32/S8CxPVNiWOAdUiJtXITIqYY45/Cn8B2D97FYW2H+IAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-wheel-pan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgswOmEYWAAABddJREFUWMO9l09oXNcVxn/n3vc0fzRjj2RHyIZ6ERuy6CarxJtS0pQSCsXNpqGFWK5tTHAwyqIGN7VdEts1LV04BEoxdlJnUbfNogtDCYWQRZOSxtAUCoFiJY0pWJVUjeTKM9LMe+9+Xcyb8ZMychuofeHCffeee7/vnXvOuefYlV/+mv932//tb91z/Y2rvxmMHQ+4FcEfOIGN4A+UwDDwoQScc7vM7AIwB8yZ2QXn3K77Ab6OgJnVgeOSbkqaBiaACUnTkm4Cx3OZzwf+qzcRQup1zNZ9RwDe+0YI4YKZTUn6zCGSMLOfAF/03r+QZdnyfwO+ePEiI6N1nPMgMDMkETLRbd2mXG8gCbd9YiIKIUxLKoLfBN7I+80+CUlTIYTp7RMT0b3Af37p8kh5y9gZcy4Fzt+5szqSaxkzUR7dwtrKMmaGW242d0t6vrD/He/90865o865o977p4F3Ctp4frnZ3L0Z+OryUrVSrZ0z8ZxhHjhcq1XPrS43q/0flDlK9XpPA2ma7gMeyvfPx3H8TJZlH4YQWiGEVpZlH8Zx/Awwn8s8lKbpvmq1ahvB641SXNk6dhLskNA2MIBtwKHK1vGTW8bKMRbAMgyPqWeETxUM8VSSJAv52JmZA0iSZMHMThWwnipXKp8hsLLcSaIR92oU8xjSayCQXotiHotG3Ku3m+0EOQwPQCDggMf7BzQajSs5eAk4B5zLx4O1vD2eJMmAQKliscgASJMw21pansFs1swQ/DNLmUmTMNuXX+taXHTDaj5OW612R1JZ0nFJJ/J+XFJ5aWmpA6S5bHV8fHsPHFU6q3pJCjtFxtrKMuXRLUUXXxdrRLazFOtUolZlsGhmACsgnHPTwJnCnjP5HMBKLotzxsTE9rgDL0t6LoriKsDIaB31ZEK+JxQJRHFUBR2NqLw8OTkZR0OC0ntm9k1JWU7OA4vD/mZ+YfElsANmNEKi75vztzB5M8uAr+bx48me88g757PQ1U5zNg52YH7hX8l6f+4Fi3c3BqHNmkI4YQOV2MGCNu9qHPYCewfzbrC+XSGcWEcgTRKA3wFfyzdDz5d+D3x9CIcfA4eBbQS9LscskgfLnHNPAnslvS/pbZDHLLPADpx9N9fqpSIBH8cxWZY9m6bpb4Ev5fN/iKLo2TRNgdx/eo8Wk5O7Ts/N/SOSdMjHdj4kmgkIEJLJzPZKetvMTkIvFLsR25Ml2gfuF5M7vnA66sdooJYkCSGERe/9VAjhzRxoKk3Tvg3U8nulVqvx8cyNpER2umM+SdOkbc5B8JhpqBdIgTRR24h+lpKen731aRIN7thscH9Zlv0d2F8YD2TIX7F2uw3A7ZWV1a0TYz9ca8cJZHRbuRuaDfUCw9/qJHamPOKToAwHtHN6lMvlSkH2o7wDMDo6WuGuQbbn5+YAKNcb3J5fSvrhtTY+vsOPuD1IOyRhMOkj9kSx29HfXB5RUnS964NT2+3vbGbxG9auO2cDNuV6A8NTb5TitBuOpQkfYD2vwOxgmvBB2g3Hto5X42EJyVsFlztbKpXGNgqVSqUxSWcLU2+tdToa9hasLjfPYlwGa+bTi8Dl1dvNsyvNtQQL9MO2w+HM7BqwlAtPdrvdq9773WAVsIr3fne3270KTOYyS2Z2bbXdHhogKmPj7YWF+VOSXs/v/9KdO+0fVBrjbRkgB/KIDBnYu9f/7D+ZmfmRxPd6qwB8YmZXcq1MAQ/nJhTM+OnDe/a8+PGNG9lm19V/D1Qw7HXZlcRa69+U6w38l5/4ipxzf5X0CPBILjcGPJH34pVcc8692FxcXLlXRnTwwH7+9P4f8aWe3fY59LIqo1NMyQBCCHNmdgx4BegUWefjDvCKmR0LIcz9L8nokSNH+PRvH4HC3YQ098pSbevg24qlmZmNmtmjkg4D3+j/tZldkvQXSa3PW5ptlpL3ZaIN99OS9F7+IgKUgSyEkNyv2nHT7DZX0dr9rpjua2l2r4rogRAYVqZvnPsPqVnpEXjEaB4AAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-wheel-zoom{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgskILvMJQAABTtJREFUWMPdl1+MXVUVxn/fPvf2zrSFmUKnoBCUdjRoVaIxEpO2JhilMYBCtBQS2hejpg1Uo2NUrIFAoyGmtiE+GHwQGtvQJhqDmKYRBv+URFsFDNCSptH60DJTO3dKnX/33rM/H7rvsDu9M20fDMaVnGTvtb69z7fWXmvtc/TEzqd4OyXwNsv/FwFJQVI/sA14SZKRLOlPkr5TrVYXHz70quYkEEK4TtI2YAgYkrQthHDdhV5uuw+43/ZrwCbgRttgY/tjtrc0m83X3/f+D6ydnJhYcB4BSZcBA7aP2d4ELAGW2N5k+xgwkDB0IH19CGGH7R8B1aQeAf4KvAw0ku4K2zu7uru3ApdPEyiKohd4TNKjtjt5h6RHgccSNrddbvuHtm9Jqoak7xVF8WFgdavV+pSk5cCObNmXgK++85prCj3z28HKqZMnH7D9YAY4BvwujT8BvCuL1INX9vVt+dfwcCvNb7f9q2RuSfrGvWu/sL2Nf3LX7pzvj4ENSGBPVarVd4fRkZFltjdmoMGiKO4IIWwIIWwoiuIOYDDzeOPoyMiyFLkum7WJCMDztrcrTTrIRuAQZ6NcK1utL4dWq/VZoC8BhqvV6l1lWb4YYxyLMY6VZflitVq9CxhOmL60hhCKeYiV7WMKIXw9jT1HpXw3c+bOAKzOjJubzebJrKQCQLPZPClpc7bP6rMYKtjXth2OMf7tIkr11Wz8oQDc1Fb09vY+kQw1YAuwJY2nbUluAnCWpKkaFl6IQIzxivaR2SYA89sJVK/Xp2x32R6w/a30DNjuqtfrU0ArYecDCEqgLqm94T0dEm9mBG7PxkdDlkBnkhebgIezNQ8nHcCZPL9ijE1Jf/bZZoPtzbavmqNZLbf9tSxq+yoduuJ+SZ+zXSZyBXCqU+d8fvC5yRUrV+0G2j3g2hDCLyXd/+Su3QdnvP/zCuH72LWsgf2k0oHlH2c2odlkxcpVEdgr6aDtjyb8x20/J+mA7T9I6rL9SWA5dne2/GdXLl58qNJh398An85yTMA+4DOz8Dgu6Zu2dwJXJ91ltm8Gbp7Fgb+EEB4aHhpq5CEtACqVyr3AC0AlPS8k3TSmQ2YPhhBuS/1/LpmS9JTtNTHGfwBU2uUALARotVqniqJYH2Pck85pfavVaufAwnQvnHc0McaDKVptebN94QAnJB0EdtjekydyZXqjs/0ZgLIs/w6sy8bnYGYJ63pgERKC05JutT1kOwITwL9tvzlzUQUYB+Zjs2DBgu6xsbGJZHstByZbezregcBXeCsEz1bnzXt5anLyzLq71zDLxTRdVgemdx0fv2e2w5thO5DbiqL4oKT3ZKpnpyYnz+SY2ZpTAPZmJfdIrVZbNBNUq9UW2X4kU+2dcf53Aj1pj2PA7y/6m1DS00A9za9uNBq7iqJYBuoGdRdFsazRaOzKSqye1rTbaa/tlbYrqXQP2X4FIA9/J1l39xrC0v7+w5IeB8XkwS1lWe6TGJAYKMty31tfO4qSHl/a3384I3CDpI+kzC4lnRfrue6GytEjR8oQwlY73gC0L4qlth/q0M1/LYWtR48cKQF6enrC6dOnVwGLEpnxnp7en4+O1i/tszzGOCTpPmB7ahb57QUwBWyXdF+McWg6MScmuoA8OX8xOlpvXGz422XYTsB/SnpA0h7bX5R0WzI9HUL4qe2XbI+dk3xl+V7gxoztD5jRI+YK/zkEEokx2/uB/RdzIfUtueqVN04cXwF8G3iHY3z9Urw/j8ClyhsnjrcS2Vv/J/8NLxT+/zqBTkcxU/cfEkyEAu3kmjAAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-box-edit{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4QfHjM1QAAAGRJREFUWMNjXLhsJcNAAiaGAQYsDAwM/+lsJ+OgCwGsLqMB+D8o08CoA0YdMOqAUQewDFQdMBoFIyoN/B/U7YFRB7DQIc7xyo9GwbBMA4xDqhxgISH1klXbDYk0QOseEeOgDgEAIS0JQleje6IAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-freehand-draw{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADTElEQVRYCeWWTWwMYRjH/88721X1lZJIGxJxcEE4OOiBgzjXWh8TJKR76kWacOBGxdEJIdk4VChZI/phidRBHMRRIr7DSUiaSCRFRM3u88gz+o7Z6bBTdjmYZPf9eJ55fv/5zzvvDPC/H9QsA66Olo9Ga+/MdR+Ljm2/KQIULsz9FqItGdOfJKLhApLgVkiSCGODjWit7QpKWy+TNrFeXvzKVUT8NiTVaIgDcbiCFJ7GiT8WkARXAdYBK0Lbhi/CenArRNskuM7/tgNp4ArQ42dwjf3WY5gWTqC7O/NbNn2Xkfw/YwdSw/We14HP2IEZwX+y9cZ9SH0LmgFP7UCz4KkENBNeV0Cz4b8U8DfgKiDxMWwUXETqLvJpCQpXZfawbzS7t9v5pL19cHBwfja7YA0y/lyCM0+E5hv5+piZXwKYcF23as+37bTXsQVqgkL0p/34fHR7DcBtbetFsBmGDwMOJCggYG55yw7dMlk6DuC1Bdu2RsCU9TYWQq2IoGbsreZ5NzvEqfSBsIsIy8OTbcdgiRHeh4o8AFAEwDakbY2AaCCpH7V9aGhoUUUy3UyVbkPYFuYLDlUZH8XBpwxkK0Dbgxg5HcVi0ent7a0RULMIozaHBSMfF9b2SzdutFcFB2FkwMIJOG6qfteXOa1nHZ48tyefuwyfT9s6wtzZ3t7eZse2DR2I228TtHXzuWCx9g8MtK5cuHCZTH4tiHEOa4xFngvTyS8f35d6enomiCi4/foEXBkZaQuukChL4FYA2Whd7YcC4gEdW3CpdL3LtGAVCVYJywEyTpAuJKeMOKXZs/Bw947C50KhUFOG4cwz35cjWNBlHGeD53n3xsfHP/T19U1qciggar8Fa4I3PHobIotBWBtc2hSiChyZxVzM53Pv7FVH6Tp3uVy+g0r1ImD2GjIrQGYIxjnfuXTZGICS5k/bBwJoubwEFX4TLah9EXomJGMA3za+f9913Yl4TnzsDQ+vE6YTZOjHh4ngibstt1pzQwd04F0bPStEBpXqRoBeQ/AKghfBnOEKgS+Q7z91Xfdz/HGKg8Ox7z8iYD9z6wqTkZFgnvhMGP9VZ2or1XVkPM9z0mytSfVsHa1RLBZbLoyNzUnK+ydz3wC6I9x+lwbngwAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-poly-draw{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEjglo9eZgwAAAc5JREFUWMPt1zFrU1EUB/DfS4OmVTGDIChCP4BgnQXRxVHqIJUupp9AB8VBQcRBQUXIB9DWQoMRiXZzcnQSA34A7aAuHSJKkgo2LvfBrU3aJnlYkBy4vHcP557zP/9z3r33JdXa647N0kHSZd5Nn0rSxc8G3cXp85sMcnZZ8vge3osZ+l3vB8CWFA0iL14t79h210swAjACMAIwAjACkB90D/8/GchI9ve4nPwTBh5E9ws7OepzGWb9EddSn51Op9ZstadSg4VK1UKlKkmSDSMLALewiuNh/hVJq71Wxttmqz0dG88vPc+MgWP4grvYG3SLOBrZFFFrttqPe4HIDxh4GSei+98iSlusuYopXEAjBtEPA3tQwUpwluAbDm4TPJUz+BTW9l2Ce6G7L0X/Bw8D3T/7SKKIDzHg7QCcxjvcQAEtXAnrrg/RP0/DKPbqgcN4iVOR7gcO4dcQgRuoh7HSqwlP4n20m63jJu5n8MkWMYfP3UowhzdR8FU8w9iQwevBdyq3/27CMRzAE5yLuvsRLg+ZcR1nJ8YL81HWJUzGAPaFZwe/Q5MdyYDyNHgjzO90YyGHtVDncuiJchaHw8R4oREFV5qdiVmYLM3OgD9k5209/atmIAAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-point-draw{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEiERGWPELgAAA4RJREFUWMO1lr1uG1cQhb9ztdRSP7AF1QxgwKlcuZSqRC9gWUUUINWqTh5AnaFOnVPEteQmRuhCURqWsSqqc9IolREXdEvQBElxtdw7KURSFEVKu4w8wAKLxdw9Z+bMnRmZGXfZ29//II8th4WwGVNyIoQLYB5vxA9Caq04iUd9A+7ZlsNC2I7TdSd2hZXMJKlnTqp9jtl/GBaqoyQ0noFKpUIzBicYYc+DEFpxkglc4oVJa5gvDn8v1xV2irG3FM4NSVwjUKlUaMcpJhCGmSEJQ6QGD8M5WnHCd8+f3QCXpPLx8WNwv0j6Bm9FMK7FJ3WBE+R/2t7c/GBmFvSBrzRTCsyTDjXrxUgEMtpxynJYmJoBJ4VAybwVARgvL7Oik0okCodnKpVKX7P0leiVMb0VvbJT+upznK4vh0GIeQwwQStJkHQD3MwsCALTJRG7Qrdrj5m/djgYaIa0hlkRdJk26XEgC9txurccBtVW3IudBImmZuACUP+ZlIDBt9FKcubYNTcAH/X0RYM1E7utJPlqe+uZzPxUcEkiSS4sTT95n15Mud0xWC0o2PAWOCdK3KYZlFxfM+tHOcnMzNr1es18ug+cgsVjP4yBU/Ppfrter1m/+l0+zYygML1xRVHU7TSb1cSzBzoBzszsH+AMdJJ49jrNZjWKou6wBnwOzcyndBpNbuueURR1Dw8Pq35p9cc5p/Dy9Dypt7jXrtdGwQECS9NPhr6Gq6txUzNigE6zydLK6lTw12/KT4FGFEUfJX2YJNONq5tVs4ODA7sD/DnwJ/BoADZuE3tHFs12dna6d4C/BI6AlbyzI8ii2TTw12/KK33gb2cdXsNZoAntbZC2SeO4c9592k/5eNQbiwvFd1kJuFGwLJr1wSPg/SwpvyFBHufOeXcFeAlE97U/uCxOY+P3b+Bn4B3Q+L8EdJfD4a+/AbC4UBzPxiPg3wlHZquB28Cn2IuR9x3gr3uV4DbwfvSDOvi4uFA8BDZmIRHkjHpS9Ht9iRqd8+5G3g05mAGcQbsdiX5QJ428G7Kygo8XYdb1/K4NWVmjzkNge2sz84bs+ELmpDDLtqWsNZBXgvmw8CTtpWVMT7x5YWBjLARnwZfKQNYN2U2LPvrh+5nBt7c2M2/It9bArCTKR8eZN+SJ13AScPnoODeRdqNenH+wul5w2gUr2WUjMFAt8bZ/0axX/wNnv4H8vTFb1QAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-poly-edit{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gELFi46qJmxxAAABV9JREFUWMOdl19vFFUYxn9n9u9sCyylUIzWUoMQBAWCMdEEIt6xIRQSLIEKtvHe6AcA4yeQb7CAUNJy0daLeomJN8SEULAC2kBBapBKoLvbmdl/c14vdmY7u91tF95kknPOnHmf95znPc97Ro2OTeBbdjFDT3c32ZxVHUOE9kSMB0/m6ExuoJn1H+ur6Y+OTfD50SMN5168OgrAlyf7CfuD+z7+iDs3p8hkLUQ0iFQ/yFl5Nm/qonfHVva+s32Zw9GxCYILsZ08tpNfBhbs+1YN4OH9+7huGdECSBVfqUosbsllfmauBqiR+cCNwOr7AEo8pPHJnymXykhg5fUWjoQpl0vVvhZhbSzGoUOHqgBlt6B6uruj2Zy1E9jo0fhfeyL2x4Mnc8VErK0KUEOB64JSyptfG4RSytsJjUJVxw2lsFy3urL9nx1Qd25ObctkrVMi+jQivd7U2ZyV/3Hzpq7h3h1b/7p9Y0o8v8rwAbTWrGpSocN/FGDlbAI0Rl23PCBan0Ok158H9Ipwzi25A/Mzc9Gl/BYx/E4kYqC1NKRARNAaDCNUM27Z+Zr+ouXs0q4+LSLBHPYCFkTkC6uU39kwCdsS7WRKmaYUiAhdnZ3MPX2K4+QjQI+C94A93rMzm8ltMwyDeDzWjMZeEb2pYQDdW3vITU2jtUZ5QThOPgm8C7wP7J15OPsBsB3oWpGnVWisCeDS1VHj4vBI92+/3tgB7Ab2AruAXiDBK5oIOkhtkEYRNRuJhObrd8Dl9ewf4D5wG7hVLpen29vb5wzD+BrkbBMaL3d1dk5nsrnlFDTTFWAWmAZueWD3gCemGde2k2fw1Al1YXhEvjozoO49eczdqekrWmsc2zlrmvEKOGoW1GUjFLqSk2KpJrCLwyMCPAP+BO54QL8DM6YZX/ClsP9YnwKkXnIBP4jdIpJRpdJTCYdMwwi98KU0Hjc/dDILNyUcwTCWdOSMJ0TRmBktGRhLugu0xyLk7CIqVNm+0bGJptl1YXikD0grpY4Rjc4a8Fbgdab/6OGbAJeCUuyJnnHmZH9pbSyGuBXV8NUwlUpR1EWyixmSyTWEwqGlJ2Swbo2JXbAAfgDGgGQA9I1A9t1tlq0AxrXxn0ilUpw4fhQqYkH/sT41OTnJJwf2s6FjI5mshdYa7bqVR2uezr9MJmJt14FvGrh/O9D+e6UkM/xyCuCqEKCYnJyUTKFQrZDHjxzGshwWLQcRsOz8Hi85P23id0ug/XilAMLBmm4tPGdoaKjSH5+oAGrhwvBI9SjZTn4QSK9yenoD7dlrExPoJlXW8G8ytpNHxRKk02lGxsdRKFwXLNvx5yY94HQLGhGk4LFCYQSqaE0AwWM1eOoEbR0dKBSW7bC4mKuffxs4D/wCLKwQQPAUzIkslfp6cVomROWSolh0GjldAM4nzDi2k9/i5UAzC9aKfwNJ3zgJg9YEvN6+C7SHgKm69+sD7RfNnKTTaZRPQfAut4oFV//IS7gkcB34VlVo8kGzphlfB+DU+TfNGBpZtRastvrvARJmfMF28ge9sc2B9/PNnCilMIDwK6y8/ow/Ai4kvILTljAXvDvEvrqKSUs60KolzPjBxspavQD2tKqCAGF/Ba+xE/Wbilu54wZV8NEKF5fXzQHl/bh4hUsE0WAXSlDMYcQSrQXgCmsTseXHsJkNnjqBFGwKJaHsKlxtUHYVhbLCzr1kaOA4bcn1y1Swmb+iLpJKpVrfgdpfsiVVCYcgluwgnU7jEgJ4s5UkLFtWYyHyEg0/N1q1tmQH+YXnAMFr97Nmv3p+0QsHQRsF8qpBOE5+rb9Nkaj50tVQKjqh4OU3GNL/1/So3vuUgbAAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-line-edit{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAG/3pUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarVdpknSpDfzPKXwEJBDLccQW4Rv4+E4BtXR198znCdeLLijgQUoppWg3//Pv5f6FDwefXJRcUk3J4xNrrKzoFH8+pyUf9/f+8J3C7y/j7jnBGApow/mZ5l2vGJfXCzne8fZ13OV+9yl3ozvx2DDYyXbauCDvRoHPON3frl5Imt7MuX8hH0seiz9/xwxnDMFgYMczUPD7m89J4fwp/iK+OVRbiMf6gm8K4bv/3NN1Pzjw2fvwn+93PLzccTZ6mJU+/HTHSX723/bSOyLi58n8jmiqz/798+a/tUZZax7rNCKOakzXqIcpu4eFDe483kh4Mv4E/byfiqd49R2OHzC1Od/woxLD44siDVJaNHfbqQNi5MkZLXPnsMdKyFy5gwwCHXhocXahhhEK+OhgLmCYn1hon1vtPBxWcPIgrGTCZrR5fHvc58A/fb5stJaFOZEvT18BF1t8AYYxZ99YBUJoXZ/K9i+50/jPjxEbwKBsNxcYqL6dLZrQK7bC5jl4cVga/Ql5yuNuABfhbAEYCmDAJwpCiXxmzkTwYwE/CuQcIjcwQOKEB1ByDCGBnMJ2Nt7JtNey8BmGvIAICSlkUFODgqwYJSbkW0EIqZMgUUSSZClSRVNIMUlKKSfTKc0hxyw55ZxLrllLKLFISSWXUmrRyjVAxsTVVHMttVZVHKpRsZdivWKgcQstNmmp5VZabdoRPj126annXnrtOniEAQlwI408yqhDJ02E0oxTZpp5llmnLsTaCisuWWnlVVZd+mTtsvqVtU/m/po1uqzxJsrW5RdrGM75sQWZnIhxBsY4EhjPxgACmo0zXyhGNuaMM185uBCEgVKMnEHGGBiMk1gWPbl7Mfcrbw7e/V9545+Yc0bd/4M5Z9S9Mfedtx9YG7rlNmyCLAvhUyhkQPrNhvO5AJFnrZIR0plaLL5liQYdDi5TubaIokFDkmoFEB8CzxZVxemssDqthPhUblPgW1iQU5g6XwNwyVI7bUFRm035iNziMkgWvEso2SXnsJfveR0Y4SlVF8YWC1pVQhJiQa8JwDvlMNIxAfq3F7GDObHU1LlhzlZaWwNp6BvACxAgInGXlllMGZCpEnZHrGA6GM2718xuFcz7YdUQxzEEfjdWz4GlkcwaonT0pgA6mB25grPILtnSMhuCpsGhmMU6uJbixJs4lbKHqh+wos1jW2rchyGRCIvN9MXu+KAmMSfAlIKVvi/tybhCPJZCu2Ow9pLdyo427+X2ovMBmKNu8PA0zgl3fS0PB1DWWkVYB47bkyiJHhkFPzTzCjzn4Dq1mqoIWzCmcDGsHQmQAQdEHsixK1IXESd5rLU7THVJNV8obHS8sZeN0G5Jdt5pQTVKCCbgK1hItTS8o92iEZpuWJ/oC2r/0+zTmhvFXoaMVKRe27altDtid6OvG1hENVwBnC61KKugNoemOiPCCNb3GoHAZOFuDxxPsD+07nbSPcr/o1Zmc4jARhotrA5F5ZcjP9rPk90vR8A+k028A+8+5wKlHVID542sMzMCuXktkRzUCpE+xCBZywjNcJITx0II9x5948CekBl4XaC5OCX2nCyObdwN3HwQh5DWL/BBEkhDYHn/vpXNgZkVTZs8rj+HO8JFC6qvDVhgAEQSYCDyC86rMhG1WPzAVB9ZldDWG6EzDcFiqJBDvFS8mXDv3SK2LPoguVB2kwUx7UL5KqZWiEzocsbvSjNnaYDNtcYJuA5cDcsrvHd6yCxGjqvl9+wh3Qh8Kc9py8sNW8ncU8qwxdPj1qIGfrPqlXeoS4/JLa/LwRLTCtxuSoZUT+2Su6kXW3QNacYQbId6NUKVbROpviybFSPQQL9lhB2MamEnFyB9Y+hrG1+xBg+L0QG2TZdTdlcsBdq9oHdt9Bu5/IM9+Nfh1AwrSqlboTA6Bgq568A7UfbaMrZjoQZhQphofvNw93+bN+5X7FYKBgLmRid+tSdV6c02A4R0cHwKobmoMt5+6WI9XNISFIywpf6RMd5/a91vE78FzVHIFmxud4woyJx76OMTCa4yhgN3iJO2VfRPFMv9sYTxFzU+1eWeYS52pwOoSJldZY6koib4P1O427rbeUrNZfu44hWjz5ZSuu/vKPpimoXbLkfxWSPetvxDWG5jQSaZCxA3ad+p6rlttDhK+YwwK1LHVe0drDtorc5vnQ1247g58vewDtU7L3DRwrG4dhCUDRKKOtYr2dXHtpt+33d1WZmfkAHdl7Q8ENF+CNgB+nOw29n5F7SeNo/ckbu4laLTCdqJLHjmhJbKzmrCEX7zULrhefuHmu0V/1nbP1pnb6FaT7sOxn4pvWkfrYhYtCeJ4Xv+kOXrroIs1eHWXN1/AfzaY94ms5vaAAABg2lDQ1BJQ0MgcHJvZmlsZQAAeJx9kT1Iw0AcxV/TSkUqDnYQUchQnSyIijhqFYpQIdQKrTqYXPoFTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxcnRSdJES/5cUWsR4cNyPd/ced+8AoVFhmhUaBzTdNtPJhJjNrYrhV4QwjAgGIMrMMuYkKQXf8XWPAF/v4jzL/9yfo1fNWwwIiMSzzDBt4g3i6U3b4LxPHGUlWSU+Jx4z6YLEj1xXPH7jXHRZ4JlRM5OeJ44Si8UOVjqYlUyNeIo4pmo65QtZj1XOW5y1So217slfGMnrK8tcpzmEJBaxBAkiFNRQRgU24rTqpFhI037Cxz/o+iVyKeQqg5FjAVVokF0/+B/87tYqTE54SZEE0PXiOB8jQHgXaNYd5/vYcZonQPAZuNLb/moDmPkkvd7WYkdA3zZwcd3WlD3gcgcYeDJkU3alIE2hUADez+ibckD/LdCz5vXW2sfpA5ChrlI3wMEhMFqk7HWfd3d39vbvmVZ/P2aecqIM1FFZAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AQdDBkQmV+argAABM5JREFUWMOtl9trHFUcxz9n9jYzm7Tb9JIWGtqUllLwVgRBQWl90S6lTaGmF6E2/4H+A4r+A0offdlWodL4kEZw9bG+iC9iKqLF0os0EBq02dtcdmdnfj7szGZ2M5vulv5g4JwzZ873+7ufUfMLi0RSa1TZNzVFrW511xBhzMxx79EyOwrbGSSzZ073zOcXFnlv5lTi3mvfzAPwwYVZ0tHiq6+/xu+/LlGtWYgEINL9oG657N41yfSRgxw9cHjDgfMLi8QVsR0X23E3gMXnkXQJ3L9zB99vI4EA0sVXqsPF93xW7y73ACVJBJwE1j8HUBIi3Sz/QNtrIzHN+yWdSdNue915IMKWXI4TJ050Adp+U+2bmkrV6tZeYAXwEJExMyf3Hi0rM5fvAvS4wPdBKRW6vZeEUiq0RIBCddddpymu0+rRbPvEzkPVmmWLBA1EdGAbYNctt7V712QwfeSgd/uXJQnPVVoEEAQBTxXpuEMELNtNNFW1WrsrQdBCRImQEeE/wBUh53v+7tW7y5n1+BZRIoJSioXvy3itdgclURSZTBrP87AdV57G1TT0d4GPgC+Bw8Ca7bifATsTgzBvjlH1qgNdICJM7tjB8soKw4jtuD+Gw3c229e1wF+P/uHPpT86rhBBRHActwAcAl4EjgIvAYcFJnlOoq5dv6EBU8AR4OUQ6AVgGjATwuC5YUdZ4A+z+1mBTUM/AKwqpZSIpPfu2VP7+/6DYEMMPE9N83lzq23ZWwxDd4GaQnmgUloqperSCpKC8HGCXz8G7NANU8CWUKPzsUDbyLPVyjYC39e0VMZx3Ccoha4b4lQqbUlnsBqNWCXpEMgKfA38DNSBcdPQr4zlMtTtFiqlulmQmJv9ks2idUZGZMjZmZMAfBUvxWHR0y5dmPV2FcbPG9ncFdPQS3nTuAJQLBZpBS1qjSqFwjipdGr9SWlsHTewm9ZmnngMKAaV9nBd+/bmdxSLRc6dnemm3+yZ06pcLvPGW2+yfWIn1ZpFEAQEvt95goCV1TXMXH4zAt4woaRF7RTAVylAUS6Xpdpsdjvk2VMnsSyHhuVEZTh+xgywBhwLfZIdKRfj7dWqPGFubq7T428ukslkaHttLNsZ9P3nwIfh+DhwS4EO9DA0zByBCE2n1fPxpQuznSCaX1js9nFp2pjbtqGhobQ0jUY9CbgALERah3IM+El1rNqTaqaph5W1uYGAFrfA5YvnyE9MoFBYtjMI/BXgQR/4pqVDZL3V9/cYrX+x7SnsXh/H5TLwW2iBQbVLNgn65CDsrSPOIJOXwmdQ4fRHrZilUqmXwNXrNzbbfxv4ArgFVBLeJ95oDEMHwHHcvvUcRqEwuBf0SSUEB9gfxsAgAkO1kcj/WvwKPaR8EhvPAUvRtdIMtR1FtBH37w8DEeChaehXw/xfAnzHcVOjEkhHrIe0Qlz7T8PuWLEd9+2w9KphgUUgQJ7JAgAPDT13NTrJyOYqIilrlEwQv/NPMTSByxfPIU37eCqtq2zWmPYDjbavaLYVdn2NuffPjqRJK2hRLBaHzoK+X7L1QE+nIFeYoFQqkTVMaTn2UOe1LWtwEJqGzqgRnS9M4Fb+3XBJGfSrFzW9dBw0icioJBzHzUXdMJM18APwWo6Kmy1O6X+V8UHDotBqogAAAABJRU5ErkJggg==");}';const divider="bk-divider",active$2="bk-active",menu="bk-menu",below$2="bk-below",caret="bk-caret",down="bk-down";var menus_css=".bk-root .bk-menu-icon{width:28px;height:28px;background-size:60%;background-color:transparent;background-repeat:no-repeat;background-position:center center;}.bk-root .bk-context-menu{position:absolute;display:inline-flex;display:-webkit-inline-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;width:auto;height:auto;z-index:100;cursor:pointer;font-size:12px;background-color:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 6px 12px rgba(0, 0, 0, 0.175);}.bk-root .bk-context-menu.bk-horizontal{flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-context-menu.bk-vertical{flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-context-menu > .bk-divider{cursor:default;overflow:hidden;background-color:#e5e5e5;}.bk-root .bk-context-menu.bk-horizontal > .bk-divider{width:1px;margin:5px 0;}.bk-root .bk-context-menu.bk-vertical > .bk-divider{height:1px;margin:0 5px;}.bk-root .bk-context-menu > :not(.bk-divider){border:1px solid transparent;}.bk-root .bk-context-menu > :not(.bk-divider).bk-active{border-color:#26aae1;}.bk-root .bk-context-menu > :not(.bk-divider):hover{background-color:#f9f9f9;}.bk-root .bk-context-menu.bk-horizontal > :not(.bk-divider):first-child{border-top-left-radius:4px;border-bottom-left-radius:4px;}.bk-root .bk-context-menu.bk-horizontal > :not(.bk-divider):last-child{border-top-right-radius:4px;border-bottom-right-radius:4px;}.bk-root .bk-context-menu.bk-vertical > :not(.bk-divider):first-child{border-top-left-radius:4px;border-top-right-radius:4px;}.bk-root .bk-context-menu.bk-vertical > :not(.bk-divider):last-child{border-bottom-left-radius:4px;border-bottom-right-radius:4px;}.bk-root .bk-menu{position:absolute;left:0;width:100%;z-index:100;cursor:pointer;font-size:12px;background-color:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 6px 12px rgba(0, 0, 0, 0.175);}.bk-root .bk-menu.bk-above{bottom:100%;}.bk-root .bk-menu.bk-below{top:100%;}.bk-root .bk-menu > .bk-divider{height:1px;margin:7.5px 0;overflow:hidden;background-color:#e5e5e5;}.bk-root .bk-menu > :not(.bk-divider){padding:6px 12px;}.bk-root .bk-menu > :not(.bk-divider):hover,.bk-root .bk-menu > :not(.bk-divider).bk-active{background-color:#e6e6e6;}.bk-root .bk-caret{display:inline-block;vertical-align:middle;width:0;height:0;margin:0 5px;}.bk-root .bk-caret.bk-down{border-top:4px solid;}.bk-root .bk-caret.bk-up{border-bottom:4px solid;}.bk-root .bk-caret.bk-down,.bk-root .bk-caret.bk-up{border-right:4px solid transparent;border-left:4px solid transparent;}.bk-root .bk-caret.bk-left{border-right:4px solid;}.bk-root .bk-caret.bk-right{border-left:4px solid;}.bk-root .bk-caret.bk-left,.bk-root .bk-caret.bk-right{border-top:4px solid transparent;border-bottom:4px solid transparent;}";function*enumerate(e){let t=0;for(const i of e)yield[i,t++]}class ContextMenu{constructor(e,t={}){this.items=e,this.options=t,this.el=div(),this._open=!1,this._item_click=e=>{var t;null==(t=this.items[e])||t.handler(),this.hide()},this._on_mousedown=e=>{var t,i;const{target:n}=e;n instanceof Node&&this.el.contains(n)||(null==(i=(t=this.options).prevent_hide)?void 0:i.call(t,e))||this.hide()},this._on_keydown=e=>{e.keyCode==Keys.Esc&&this.hide()},this._on_blur=()=>{this.hide()},undisplay(this.el)}get is_open(){return this._open}get can_open(){return 0!=this.items.length}remove(){remove(this.el),this._unlisten()}_listen(){document.addEventListener("mousedown",this._on_mousedown),document.addEventListener("keydown",this._on_keydown),window.addEventListener("blur",this._on_blur)}_unlisten(){document.removeEventListener("mousedown",this._on_mousedown),document.removeEventListener("keydown",this._on_keydown),window.removeEventListener("blur",this._on_blur)}_position(e){const t=this.el.parentElement;if(null!=t){const i=t.getBoundingClientRect();this.el.style.left=null!=e.left?e.left-i.left+"px":"",this.el.style.top=null!=e.top?e.top-i.top+"px":"",this.el.style.right=null!=e.right?i.right-e.right+"px":"",this.el.style.bottom=null!=e.bottom?i.bottom-e.bottom+"px":""}}render(){var e,t;empty$1(this.el,!0);const i=null!=(e=this.options.orientation)?e:"vertical";classes(this.el).add("bk-context-menu",`bk-${i}`);for(const[n,o]of enumerate(this.items)){let e;if(null==n)e=div({class:divider});else{if(null!=n.if&&!n.if())continue;{const i=null!=n.icon?div({class:["bk-menu-icon",n.icon]}):null;e=div({class:(null==(t=n.active)?void 0:t.call(n))?"bk-active":null,title:n.tooltip},i,n.label)}}e.addEventListener("click",(()=>this._item_click(o))),this.el.appendChild(e)}}show(e){if(0!=this.items.length&&!this._open){if(this.render(),0==this.el.children.length)return;this._position(null!=e?e:{left:0,top:0}),display(this.el),this._listen(),this._open=!0}}hide(){this._open&&(this._open=!1,this._unlisten(),undisplay(this.el))}toggle(e){this._open?this.hide():this.show(e)}}ContextMenu.__name__="ContextMenu";class ButtonToolButtonView extends DOMView{initialize(){super.initialize();const e=this.model.menu;if(null!=e){const t=this.parent.model.toolbar_location,i="left"==t||"above"==t,n=this.parent.model.horizontal?"vertical":"horizontal";this._menu=new ContextMenu(i?reversed(e):e,{orientation:n,prevent_hide:e=>e.target==this.el})}this._hammer=new Hammer(this.el,{touchAction:"auto",inputClass:Hammer.TouchMouseInput}),this.connect(this.model.change,(()=>this.render())),this._hammer.on("tap",(e=>{var t;(null==(t=this._menu)?void 0:t.is_open)?this._menu.hide():e.target==this.el&&this._clicked()})),this._hammer.on("press",(()=>this._pressed()))}remove(){var e;this._hammer.destroy(),null==(e=this._menu)||e.remove(),super.remove()}styles(){return[...super.styles(),toolbars_css,icons_css,menus_css]}css_classes(){return super.css_classes().concat(toolbar_button)}render(){empty$1(this.el);const e=this.model.computed_icon;isString(e)&&(startsWith(e,"data:image")?this.el.style.backgroundImage="url('"+e+"')":this.el.classList.add(e)),this.el.title=this.model.tooltip,null!=this._menu&&this.root.el.appendChild(this._menu.el)}_pressed(){var e;const{left:t,top:i,right:n,bottom:o}=this.el.getBoundingClientRect(),r=(()=>{switch(this.parent.model.toolbar_location){case"right":return{right:t,top:i};case"left":return{left:n,top:i};case"above":return{left:t,top:o};case"below":return{left:t,bottom:i}}})();null==(e=this._menu)||e.toggle(r)}}ButtonToolButtonView.__name__="ButtonToolButtonView";class ButtonToolView extends ToolView{}ButtonToolView.__name__="ButtonToolView";class ButtonTool extends Tool{constructor(e){super(e)}static init_ButtonTool(){this.internal((({Boolean:e})=>({disabled:[e,!1]})))}_get_dim_tooltip(e){const{description:t,tool_name:i}=this;return null!=t?t:"both"==e?i:`${i} (${"width"==e?"x":"y"}-axis)`}get tooltip(){var e;return null!=(e=this.description)?e:this.tool_name}get computed_icon(){return this.icon}get menu(){return null}}ButtonTool.__name__="ButtonTool",ButtonTool.init_ButtonTool();class OnOffButtonView extends ButtonToolButtonView{render(){super.render(),classes(this.el).toggle(active$3,this.model.active)}_clicked(){const{active:e}=this.model;this.model.active=!e}}OnOffButtonView.__name__="OnOffButtonView";class GestureToolView extends ButtonToolView{}GestureToolView.__name__="GestureToolView";class GestureTool extends ButtonTool{constructor(e){super(e),this.button_view=OnOffButtonView}}GestureTool.__name__="GestureTool";class InspectToolView extends ButtonToolView{}InspectToolView.__name__="InspectToolView";class InspectTool extends ButtonTool{constructor(e){super(e),this.event_type="move"}static init_InspectTool(){this.prototype.button_view=OnOffButtonView,this.define((({Boolean:e})=>({toggleable:[e,!0]}))),this.override({active:!0})}}function randomString(e){if(!e)throw new Error("cannot create a random attribute name for an undefined object");const t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";let i="";do{i="";for(let e=0;e<12;e++)i+=t[Math.floor(Math.random()*t.length)]}while(e[i]);return i}function createNamedToNumberedLookup(e,t){const i=new Map,n=e.split(",");t=null!=t?t:10;for(let o=0;o<n.length;o+=2){const e="&"+n[o+1]+";",r=parseInt(n[o],t);i.set(e,"&#"+r+";")}return i.set("\\xa0","&#160;"),i}function getTextAnchor(e){var t;const i={left:"start",right:"end",center:"middle",start:"start",end:"end"};return null!=(t=i[e])?t:i.start}function getDominantBaseline(e){var t;const i={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return null!=(t=i[e])?t:i.alphabetic}InspectTool.__name__="InspectTool",InspectTool.init_InspectTool();const namedEntities=createNamedToNumberedLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),STYLES={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}};class CanvasGradient{constructor(e,t){this.__root=e,this.__ctx=t}addColorStop(e,t){const i=this.__ctx.__createElement("stop");if(i.setAttribute("offset",`${e}`),-1!==t.indexOf("rgba")){const e=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(t),[,n,o,r,s]=e;i.setAttribute("stop-color",`rgb(${n},${o},${r})`),i.setAttribute("stop-opacity",s)}else i.setAttribute("stop-color",t);this.__root.appendChild(i)}}CanvasGradient.__name__="CanvasGradient";class CanvasPattern{constructor(e,t){this.__root=e,this.__ctx=t}}CanvasPattern.__name__="CanvasPattern";class SVGRenderingContext2D{constructor(e){var t,i,n;this.__currentPosition=null,this._transform=new AffineTransform,this._clip_path=null,this.__document=null!=(t=null==e?void 0:e.document)?t:document,(null==e?void 0:e.ctx)?this.__ctx=e.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version","1.1"),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.width=null!=(i=null==e?void 0:e.width)?i:500,this.height=null!=(n=null==e?void 0:e.height)?n:500,this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs)}get canvas(){return this}get width(){return this._width}set width(e){this._width=e,this.__root.setAttribute("width",`${e}`)}get height(){return this._height}set height(e){this._height=e,this.__root.setAttribute("height",`${e}`)}__createElement(e,t={},i=!1){const n=this.__document.createElementNS("http://www.w3.org/2000/svg",e);i&&(n.setAttribute("fill","none"),n.setAttribute("stroke","none"));const o=Object.keys(t);for(const r of o)n.setAttribute(r,`${t[r]}`);return n}__setDefaultStyles(){const e=Object.keys(STYLES),t=this;for(let i=0;i<e.length;i++){const n=e[i];t[n]=STYLES[n].canvas}}__applyStyleState(e){const t=Object.keys(e),i=this;for(let n=0;n<t.length;n++){const o=t[n];i[o]=e[o]}}__getStyleState(){const e=Object.keys(STYLES),t={};for(let i=0;i<e.length;i++){const n=e[i];t[n]=this[n]}return t}__applyStyleToCurrentElement(e){var t;const i=this.__currentElement,n=Object.keys(STYLES);for(let o=0;o<n.length;o++){const r=STYLES[n[o]],s=this[n[o]];if(null==(t=r.apply)?void 0:t.includes(e))if(s instanceof CanvasPattern){for(const t of[...s.__ctx.__defs.childNodes])if(t instanceof Element){const e=t.getAttribute("id");this.__ids[e]=e,this.__defs.appendChild(t)}const e=s.__root.getAttribute("id");i.setAttribute(r.apply,`url(#${e})`)}else if(s instanceof CanvasGradient){const e=s.__root.getAttribute("id");i.setAttribute(r.apply,`url(#${e})`)}else if(r.svg!==s)if("stroke"!==r.svgAttr&&"fill"!==r.svgAttr||!isString(s)||-1===s.indexOf("rgba")){let t=r.svgAttr;if("globalAlpha"===n[o]&&(t=e+"-"+r.svgAttr,i.getAttribute(t)))continue;i.setAttribute(t,`${s}`)}else{const e=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(s),[,t,n,o,a]=e;i.setAttribute(r.svgAttr,`rgb(${t},${n},${o})`);let l=parseFloat(a);const c=this.globalAlpha;null!=c&&(l*=c),i.setAttribute(r.svgAttr+"-opacity",`${l}`)}}}get_serialized_svg(e=!1){let t=(new XMLSerializer).serializeToString(this.__root);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(t)&&(t=t.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(const[i,n]of namedEntities){const e=new RegExp(i,"gi");e.test(t)&&(t=t.replace(e,n))}return t}get_svg(){return this.__root}save(){this.__stack.push({transform:this._transform,clip_path:this._clip_path,attributes:this.__getStyleState()}),this._transform=this._transform.clone()}restore(){if(0==this.__stack.length)return;const{transform:e,clip_path:t,attributes:i}=this.__stack.pop();this._transform=e,this._clip_path=t,this.__applyStyleState(i)}_apply_transform(e,t=this._transform){t.is_identity||e.setAttribute("transform",t.toString())}scale(e,t){isFinite(e)&&(null==t||isFinite(t))&&this._transform.scale(e,null!=t?t:e)}rotate(e){isFinite(e)&&this._transform.rotate(e)}translate(e,t){isFinite(e+t)&&this._transform.translate(e,t)}transform(e,t,i,n,o,r){isFinite(e+t+i+n+o+r)&&this._transform.transform(e,t,i,n,o,r)}beginPath(){this.__currentDefaultPath="",this.__currentPosition=null;const e=this.__createElement("path",{},!0);this.__root.appendChild(e),this.__currentElement=e}__applyCurrentDefaultPath(){const e=this.__currentElement;"path"===e.nodeName?e.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",e.nodeName)}__addPathCommand(e,t,i){const n=this.__currentDefaultPath?" ":"";this.__currentDefaultPath+=n+i,this.__currentPosition={x:e,y:t}}get _hasCurrentDefaultPath(){return!!this.__currentDefaultPath}moveTo(e,t){if(!isFinite(e+t))return;"path"!==this.__currentElement.nodeName&&this.beginPath();const[i,n]=this._transform.apply(e,t);this.__addPathCommand(i,n,`M ${i} ${n}`)}closePath(){this._hasCurrentDefaultPath&&this.__addPathCommand(NaN,NaN,"Z")}lineTo(e,t){if(isFinite(e+t))if(this._hasCurrentDefaultPath){const[i,n]=this._transform.apply(e,t);this.__addPathCommand(i,n,`L ${i} ${n}`)}else this.moveTo(e,t)}bezierCurveTo(e,t,i,n,o,r){if(!isFinite(e+t+i+n+o+r))return;const[s,a]=this._transform.apply(o,r),[l,c]=this._transform.apply(e,t),[d,h]=this._transform.apply(i,n);this.__addPathCommand(s,a,`C ${l} ${c} ${d} ${h} ${s} ${a}`)}quadraticCurveTo(e,t,i,n){if(!isFinite(e+t+i+n))return;const[o,r]=this._transform.apply(i,n),[s,a]=this._transform.apply(e,t);this.__addPathCommand(o,r,`Q ${s} ${a} ${o} ${r}`)}arcTo(e,t,i,n,o){if(!isFinite(e+t+i+n+o))return;if(null==this.__currentPosition)return;const r=this.__currentPosition.x,s=this.__currentPosition.y;if(o<0)throw new Error("IndexSizeError: The radius provided ("+o+") is negative.");if(r===e&&s===t||e===i&&t===n||0===o)return void this.lineTo(e,t);function a([e,t]){const i=Math.sqrt(e**2+t**2);return[e/i,t/i]}const l=a([r-e,s-t]),c=a([i-e,n-t]);if(l[0]*c[1]==l[1]*c[0])return void this.lineTo(e,t);const d=l[0]*c[0]+l[1]*c[1],h=Math.acos(Math.abs(d)),u=a([l[0]+c[0],l[1]+c[1]]),p=o/Math.sin(h/2),_=e+p*u[0],f=t+p*u[1],g=[-l[1],l[0]],m=[c[1],-c[0]];function v(e){const t=e[0];return e[1]>=0?Math.acos(t):-Math.acos(t)}const b=v(g),y=v(m);this.lineTo(_+g[0]*o,f+g[1]*o),this.arc(_,f,o,b,y)}stroke(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke"),null!=this._clip_path&&this.__currentElement.setAttribute("clip-path",this._clip_path)}fill(e){if("path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","stroke"),"none"!=this.__currentElement.getAttribute("fill")){const e=this.__currentElement.cloneNode(!0);this.__root.appendChild(e),this.__currentElement=e}this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill"),null!=e&&this.__currentElement.setAttribute("fill-rule",e),null!=this._clip_path&&this.__currentElement.setAttribute("clip-path",this._clip_path)}rect(e,t,i,n){isFinite(e+t+i+n)&&("path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.lineTo(e,t))}fillRect(e,t,i,n){isFinite(e+t+i+n)&&(this.beginPath(),this.rect(e,t,i,n),this.fill())}strokeRect(e,t,i,n){isFinite(e+t+i+n)&&(this.beginPath(),this.rect(e,t,i,n),this.stroke())}__clearCanvas(){empty$1(this.__defs),empty$1(this.__root),this.__root.appendChild(this.__defs),this.__currentElement=this.__root}clearRect(e,t,i,n){if(!isFinite(e+t+i+n))return;if(0===e&&0===t&&i===this.width&&n===this.height)return void this.__clearCanvas();const o=this.__createElement("rect",{x:e,y:t,width:i,height:n,fill:"#FFFFFF"},!0);this._apply_transform(o),this.__root.appendChild(o)}createLinearGradient(e,t,i,n){if(!isFinite(e+t+i+n))throw new Error("The provided double value is non-finite");const[o,r]=this._transform.apply(e,t),[s,a]=this._transform.apply(i,n),l=this.__createElement("linearGradient",{id:randomString(this.__ids),x1:`${o}px`,x2:`${s}px`,y1:`${r}px`,y2:`${a}px`,gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(l),new CanvasGradient(l,this)}createRadialGradient(e,t,i,n,o,r){if(!isFinite(e+t+i+n+o+r))throw new Error("The provided double value is non-finite");const[s,a]=this._transform.apply(e,t),[l,c]=this._transform.apply(n,o),d=this.__createElement("radialGradient",{id:randomString(this.__ids),cx:`${l}px`,cy:`${c}px`,r:`${r}px`,fx:`${s}px`,fy:`${a}px`,gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(d),new CanvasGradient(d,this)}__parseFont(){var e,t,i,n,o;const r=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i.exec(this.font),s={style:null!=(e=r[1])?e:"normal",size:null!=(t=r[4])?t:"10px",family:null!=(i=r[6])?i:"sans-serif",weight:null!=(n=r[3])?n:"normal",decoration:null!=(o=r[2])?o:"normal"};return"underline"===this.__fontUnderline&&(s.decoration="underline"),null!=this.__fontHref&&(s.href=this.__fontHref),s}__wrapTextLink(e,t){if(e.href){const i=this.__createElement("a");return i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.href),i.appendChild(t),i}return t}__applyText(e,t,i,n){const o=this.__parseFont(),r=this.__createElement("text",{"font-family":o.family,"font-size":o.size,"font-style":o.style,"font-weight":o.weight,"text-decoration":o.decoration,x:t,y:i,"text-anchor":getTextAnchor(this.textAlign),"dominant-baseline":getDominantBaseline(this.textBaseline)},!0);r.appendChild(this.__document.createTextNode(e)),this._apply_transform(r),this.__currentElement=r,this.__applyStyleToCurrentElement(n),this.__root.appendChild(this.__wrapTextLink(o,r))}fillText(e,t,i){null!=e&&isFinite(t+i)&&this.__applyText(e,t,i,"fill")}strokeText(e,t,i){null!=e&&isFinite(t+i)&&this.__applyText(e,t,i,"stroke")}measureText(e){return this.__ctx.font=this.font,this.__ctx.measureText(e)}arc(e,t,i,n,o,r=!1){if(!isFinite(e+t+i+n+o))return;if(n===o)return;(n%=2*Math.PI)===(o%=2*Math.PI)&&(o=(o+2*Math.PI-.001*(r?-1:1))%(2*Math.PI));const s=e+i*Math.cos(o),a=t+i*Math.sin(o),l=e+i*Math.cos(n),c=t+i*Math.sin(n),d=r?0:1;let h=0,u=o-n;u<0&&(u+=2*Math.PI),h=r?u>Math.PI?0:1:u>Math.PI?1:0,this.lineTo(l,c);const p=i,_=i,[f,g]=this._transform.apply(s,a);this.__addPathCommand(f,g,`A ${p} ${_} 0 ${h} ${d} ${f} ${g}`)}clip(){const e=this.__createElement("clipPath"),t=randomString(this.__ids);this.__applyCurrentDefaultPath(),e.setAttribute("id",t),e.appendChild(this.__currentElement),this.__defs.appendChild(e),this._clip_path=`url(#${t})`}drawImage(e,...t){let i,n,o,r,s,a,l,c;if(2==t.length){if([i,n]=t,!isFinite(i+n))return;s=0,a=0,l=e.width,c=e.height,o=l,r=c}else if(4==t.length){if([i,n,o,r]=t,!isFinite(i+n+o+r))return;s=0,a=0,l=e.width,c=e.height}else{if(8!==t.length)throw new Error(`Inavlid number of arguments passed to drawImage: ${arguments.length}`);if([s,a,l,c,i,n,o,r]=t,!isFinite(s+a+l+c+i+n+o+r))return}const d=this.__root,h=this._transform.clone().translate(i,n);if(e instanceof SVGRenderingContext2D||e instanceof SVGSVGElement){const t=(e instanceof SVGSVGElement?e:e.get_svg()).cloneNode(!0);let i;h.is_identity?i=d:(i=this.__createElement("g"),this._apply_transform(i,h),d.appendChild(i));for(const e of[...t.childNodes])if(e instanceof SVGDefsElement){for(const t of[...e.childNodes])if(t instanceof Element){const e=t.getAttribute("id");this.__ids[e]=e,this.__defs.appendChild(t)}}else i.appendChild(e)}else if(e instanceof HTMLImageElement||e instanceof SVGImageElement){const t=this.__createElement("image");if(t.setAttribute("width",`${o}`),t.setAttribute("height",`${r}`),t.setAttribute("preserveAspectRatio","none"),s||a||l!==e.width||c!==e.height){const t=this.__document.createElement("canvas");t.width=o,t.height=r;t.getContext("2d").drawImage(e,s,a,l,c,0,0,o,r),e=t}this._apply_transform(t,h);const i=e instanceof HTMLCanvasElement?e.toDataURL():e.getAttribute("src");t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i),d.appendChild(t)}else if(e instanceof HTMLCanvasElement){const t=this.__createElement("image");t.setAttribute("width",`${o}`),t.setAttribute("height",`${r}`),t.setAttribute("preserveAspectRatio","none");const i=this.__document.createElement("canvas");i.width=o,i.height=r;const n=i.getContext("2d");n.imageSmoothingEnabled=!1,n.drawImage(e,s,a,l,c,0,0,o,r),e=i,this._apply_transform(t,h),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.toDataURL()),d.appendChild(t)}}createPattern(e,t){const i=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),n=randomString(this.__ids);if(i.setAttribute("id",n),i.setAttribute("width",`${this._to_number(e.width)}`),i.setAttribute("height",`${this._to_number(e.height)}`),i.setAttribute("patternUnits","userSpaceOnUse"),e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof SVGImageElement){const t=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),n=e instanceof HTMLCanvasElement?e.toDataURL():e.getAttribute("src");t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n),i.appendChild(t),this.__defs.appendChild(i)}else if(e instanceof SVGRenderingContext2D){for(const t of[...e.__root.childNodes])t instanceof SVGDefsElement||i.appendChild(t);this.__defs.appendChild(i)}else{if(!(e instanceof SVGSVGElement))throw new Error("unsupported");for(const t of[...e.childNodes])t instanceof SVGDefsElement||i.appendChild(t);this.__defs.appendChild(i)}return new CanvasPattern(i,this)}setLineDash(e){e&&e.length>0?this.lineDash=e.join(","):this.lineDash=null}_to_number(e){return isNumber(e)?e:e.baseVal.value}}function fixup_line_dash(e){void 0===e.lineDash&&Object.defineProperty(e,"lineDash",{get:()=>e.getLineDash(),set:t=>e.setLineDash(t)})}function fixup_image_smoothing(e){e.setImageSmoothingEnabled=t=>{e.imageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t,e.oImageSmoothingEnabled=t,e.webkitImageSmoothingEnabled=t,e.msImageSmoothingEnabled=t},e.getImageSmoothingEnabled=()=>{const t=e.imageSmoothingEnabled;return null==t||t}}function fixup_ellipse(e){e.ellipse||(e.ellipse=function(t,i,n,o,r,s,a,l=!1){const c=.551784;e.translate(t,i),e.rotate(r);let d=n,h=o;l&&(d=-n,h=-o),e.moveTo(-d,0),e.bezierCurveTo(-d,h*c,-d*c,h,0,h),e.bezierCurveTo(d*c,h,d,h*c,d,0),e.bezierCurveTo(d,-h*c,d*c,-h,0,-h),e.bezierCurveTo(-d*c,-h,-d,-h*c,-d,0),e.rotate(-r),e.translate(-t,-i)})}function fixup_ctx(e){fixup_line_dash(e),fixup_image_smoothing(e),fixup_ellipse(e)}SVGRenderingContext2D.__name__="SVGRenderingContext2D";const style$1={position:"absolute",top:"0",left:"0",width:"100%",height:"100%"};class CanvasLayer{constructor(e,t){switch(this.backend=e,this.hidpi=t,this.pixel_ratio=1,this.bbox=new BBox,e){case"webgl":case"canvas":{this._el=this._canvas=canvas({style:style$1});const e=this.canvas.getContext("2d");if(null==e)throw new Error("unable to obtain 2D rendering context");this._ctx=e,t&&(this.pixel_ratio=devicePixelRatio);break}case"svg":{const e=new SVGRenderingContext2D;this._ctx=e,this._canvas=e.get_svg(),this._el=div({style:style$1},this._canvas);break}}fixup_ctx(this._ctx)}get canvas(){return this._canvas}get ctx(){return this._ctx}get el(){return this._el}resize(e,t){this.bbox=new BBox({left:0,top:0,width:e,height:t});const i=this._ctx instanceof SVGRenderingContext2D?this._ctx:this.canvas;i.width=e*this.pixel_ratio,i.height=t*this.pixel_ratio}prepare(){const{ctx:e,hidpi:t,pixel_ratio:i}=this;e.save(),t&&(e.scale(i,i),e.translate(.5,.5)),this.clear()}clear(){const{x:e,y:t,width:i,height:n}=this.bbox;this.ctx.clearRect(e,t,i,n)}finish(){this.ctx.restore()}to_blob(){const{_canvas:e}=this;if(e instanceof HTMLCanvasElement)return null!=e.msToBlob?Promise.resolve(e.msToBlob()):new Promise(((t,i)=>{e.toBlob((e=>null!=e?t(e):i()),"image/png")}));{const e=this._ctx.get_serialized_svg(!0),t=new Blob([e],{type:"image/svg+xml"});return Promise.resolve(t)}}}CanvasLayer.__name__="CanvasLayer";class ActionToolButtonView extends ButtonToolButtonView{_clicked(){this.model.do.emit(void 0)}}ActionToolButtonView.__name__="ActionToolButtonView";class ActionToolView extends ButtonToolView{connect_signals(){super.connect_signals(),this.connect(this.model.do,(e=>this.doit(e)))}}ActionToolView.__name__="ActionToolView";class ActionTool extends ButtonTool{constructor(e){super(e),this.button_view=ActionToolButtonView,this.do=new Signal(this,"do")}}ActionTool.__name__="ActionTool";class HelpToolView extends ActionToolView{doit(){window.open(this.model.redirect)}}HelpToolView.__name__="HelpToolView";class HelpTool extends ActionTool{constructor(e){super(e),this.tool_name="Help",this.icon=tool_icon_help}static init_HelpTool(){this.prototype.default_view=HelpToolView,this.define((({String:e})=>({redirect:[e,"https://docs.bokeh.org/en/latest/docs/user_guide/tools.html"]}))),this.override({description:"Click the question mark to learn more about Bokeh plot tools."}),this.register_alias("help",(()=>new HelpTool))}}HelpTool.__name__="HelpTool",HelpTool.init_HelpTool();const logo="bk-logo",grey$1="bk-grey",logo_small="bk-logo-small";var logo_css=".bk-root .bk-logo{margin:5px;position:relative;display:block;background-repeat:no-repeat;}.bk-root .bk-logo.bk-grey{filter:url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'><filter id='grayscale'><feColorMatrix type='matrix' values='0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0'/></filter></svg>#grayscale\");filter:gray;-webkit-filter:grayscale(100%);}.bk-root .bk-logo-small{width:20px;height:20px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);}.bk-root .bk-logo-notebook{display:inline-block;vertical-align:middle;margin-right:5px;}";class ToolbarViewModel extends Model{constructor(e){super(e)}static init_ToolbarViewModel(){this.define((({Boolean:e,Nullable:t})=>({_visible:[t(e),null],autohide:[e,!1]})))}get visible(){return!this.autohide||null!=this._visible&&this._visible}}ToolbarViewModel.__name__="ToolbarViewModel",ToolbarViewModel.init_ToolbarViewModel();class ToolbarBaseView extends DOMView{constructor(){super(...arguments),this.layout={bbox:new BBox}}initialize(){super.initialize(),this._tool_button_views=new Map,this._toolbar_view_model=new ToolbarViewModel({autohide:this.model.autohide})}async lazy_initialize(){await super.lazy_initialize(),await this._build_tool_button_views()}connect_signals(){super.connect_signals(),this.connect(this.model.properties.tools.change,(async()=>{await this._build_tool_button_views(),this.render()})),this.connect(this.model.properties.autohide.change,(()=>{this._toolbar_view_model.autohide=this.model.autohide,this._on_visible_change()})),this.connect(this._toolbar_view_model.properties._visible.change,(()=>this._on_visible_change()))}styles(){return[...super.styles(),toolbars_css,logo_css]}remove(){remove_views(this._tool_button_views),super.remove()}async _build_tool_button_views(){const e=null!=this.model._proxied_tools?this.model._proxied_tools:this.model.tools;await build_views(this._tool_button_views,e,{parent:this},(e=>e.button_view))}set_visibility(e){e!=this._toolbar_view_model._visible&&(this._toolbar_view_model._visible=e)}_on_visible_change(){const e=this._toolbar_view_model.visible,t=toolbar_hidden;this.el.classList.contains(t)&&e?this.el.classList.remove(t):e||this.el.classList.add(t)}render(){if(empty$1(this.el),this.el.classList.add(toolbar),this.el.classList.add(toolbars[this.model.toolbar_location]),this._toolbar_view_model.autohide=this.model.autohide,this._on_visible_change(),null!=this.model.logo){const e="grey"===this.model.logo?grey$1:null,t=a({href:"https://bokeh.org/",target:"_blank",class:[logo,logo_small,e]});this.el.appendChild(t)}for(const[,n]of this._tool_button_views)n.render();const e=[],t=e=>this._tool_button_views.get(e).el,{gestures:i}=this.model;for(const n of values(i))e.push(n.tools.map(t));e.push(this.model.actions.map(t)),e.push(this.model.inspectors.filter((e=>e.toggleable)).map(t));for(const n of e)if(0!==n.length){const e=div({class:button_bar},n);this.el.appendChild(e)}}update_layout(){}update_position(){}after_layout(){this._has_finished=!0}export(e,t=!0){const i=new CanvasLayer("png"==e?"canvas":"svg",t);return i.resize(0,0),i}}function create_gesture_map(){return{pan:{tools:[],active:null},scroll:{tools:[],active:null},pinch:{tools:[],active:null},tap:{tools:[],active:null},doubletap:{tools:[],active:null},press:{tools:[],active:null},pressup:{tools:[],active:null},rotate:{tools:[],active:null},move:{tools:[],active:null},multi:{tools:[],active:null}}}ToolbarBaseView.__name__="ToolbarBaseView";class ToolbarBase extends Model{constructor(e){super(e)}static init_ToolbarBase(){this.prototype.default_view=ToolbarBaseView,this.define((({Boolean:e,Array:t,Ref:i,Nullable:n})=>({tools:[t(i(Tool)),[]],logo:[n(Logo),"normal"],autohide:[e,!1]}))),this.internal((({Array:e,Struct:t,Ref:i,Nullable:n})=>{const o=t({tools:e(i(GestureTool)),active:n(i(Tool))});return{gestures:[t({pan:o,scroll:o,pinch:o,tap:o,doubletap:o,press:o,pressup:o,rotate:o,move:o,multi:o}),create_gesture_map],actions:[e(i(ActionTool)),[]],inspectors:[e(i(InspectTool)),[]],help:[e(i(HelpTool)),[]],toolbar_location:[Location,"right"]}}))}initialize(){super.initialize(),this._init_tools()}_init_tools(){const e=function(e,t){if(e.length!=t.length)return!0;const i=new Set(t.map((e=>e.id)));return some(e,(e=>!i.has(e.id)))},t=this.tools.filter((e=>e instanceof InspectTool));e(this.inspectors,t)&&(this.inspectors=t);const i=this.tools.filter((e=>e instanceof HelpTool));e(this.help,i)&&(this.help=i);const n=this.tools.filter((e=>e instanceof ActionTool));e(this.actions,n)&&(this.actions=n);const o=(e,t)=>{e in this.gestures||logger.warn(`Toolbar: unknown event type '${e}' for tool: ${t}`)},r=create_gesture_map();for(const s of this.tools)if(s instanceof GestureTool&&s.event_type)if(isString(s.event_type))r[s.event_type].tools.push(s),o(s.event_type,s);else{r.multi.tools.push(s);for(const e of s.event_type)o(e,s)}for(const s of Object.keys(r)){const t=this.gestures[s];e(t.tools,r[s].tools)&&(t.tools=r[s].tools),t.active&&every(t.tools,(e=>e.id!=t.active.id))&&(t.active=null)}}get horizontal(){return"above"===this.toolbar_location||"below"===this.toolbar_location}get vertical(){return"left"===this.toolbar_location||"right"===this.toolbar_location}_active_change(e){const{event_type:t}=e;if(null==t)return;const i=isString(t)?[t]:t;for(const n of i)if(e.active){const t=this.gestures[n].active;null!=t&&e!=t&&(logger.debug(`Toolbar: deactivating tool: ${t} for event type '${n}'`),t.active=!1),this.gestures[n].active=e,logger.debug(`Toolbar: activating tool: ${e} for event type '${n}'`)}else this.gestures[n].active=null}}ToolbarBase.__name__="ToolbarBase",ToolbarBase.init_ToolbarBase();const Drag=Tool,Inspection=Tool,Scroll=Tool,Tap$1=Tool,_get_active_attr=e=>{switch(e){case"tap":return"active_tap";case"pan":return"active_drag";case"pinch":case"scroll":return"active_scroll";case"multi":return"active_multi"}return null},_supports_auto=e=>"tap"==e||"pan"==e;class Toolbar extends ToolbarBase{constructor(e){super(e)}static init_Toolbar(){this.prototype.default_view=ToolbarBaseView,this.define((({Or:e,Ref:t,Auto:i,Null:n,Nullable:o})=>({active_drag:[e(t(Drag),i,n),"auto"],active_inspect:[e(t(Inspection),i,n),"auto"],active_scroll:[e(t(Scroll),i,n),"auto"],active_tap:[e(t(Tap$1),i,n),"auto"],active_multi:[o(t(GestureTool)),null]})))}connect_signals(){super.connect_signals();const{tools:e,active_drag:t,active_inspect:i,active_scroll:n,active_tap:o,active_multi:r}=this.properties;this.on_change([e,t,i,n,o,r],(()=>this._init_tools()))}_init_tools(){if(super._init_tools(),"auto"==this.active_inspect);else if(this.active_inspect instanceof InspectTool){let e=!1;for(const t of this.inspectors)t!=this.active_inspect?t.active=!1:e=!0;e||(this.active_inspect=null)}else if(isArray(this.active_inspect)){const e=intersection(this.active_inspect,this.inspectors);e.length!=this.active_inspect.length&&(this.active_inspect=e);for(const t of this.inspectors)includes(this.active_inspect,t)||(t.active=!1)}else if(null==this.active_inspect)for(const t of this.inspectors)t.active=!1;const e=e=>{e.active?this._active_change(e):e.active=!0};for(const t of values(this.gestures)){t.tools=sort_by(t.tools,(e=>e.default_order));for(const e of t.tools)this.connect(e.properties.active.change,(()=>this._active_change(e)))}for(const[t,i]of entries(this.gestures)){const n=_get_active_attr(t);if(n){const o=this[n];"auto"==o?0!=i.tools.length&&_supports_auto(t)&&e(i.tools[0]):null!=o&&(includes(this.tools,o)?e(o):this[n]=null)}}}}Toolbar.__name__="Toolbar",Toolbar.init_Toolbar();class ToolbarPanelView extends AnnotationView{constructor(){super(...arguments),this._invalidate_toolbar=!0,this._previous_bbox=new BBox}update_layout(){this.layout=new SideLayout(this.panel,(()=>this.get_size()),!0)}initialize(){super.initialize(),this.el=div(),this.plot_view.canvas_view.add_event(this.el)}async lazy_initialize(){await super.lazy_initialize(),this._toolbar_view=await build_view(this.model.toolbar,{parent:this}),this.plot_view.visibility_callbacks.push((e=>this._toolbar_view.set_visibility(e)))}remove(){this._toolbar_view.remove(),remove(this.el),super.remove()}render(){this.model.visible||undisplay(this.el),super.render()}_render(){const{bbox:e}=this.layout;this._previous_bbox.equals(e)||(position(this.el,e),this._previous_bbox=e),this._invalidate_toolbar&&(this.el.style.position="absolute",this.el.style.overflow="hidden",this._toolbar_view.render(),empty$1(this.el),this.el.appendChild(this._toolbar_view.el),this._invalidate_toolbar=!1),display(this.el)}_get_size(){const{tools:e,logo:t}=this.model.toolbar;return{width:30*e.length+(null!=t?25:0),height:30}}}ToolbarPanelView.__name__="ToolbarPanelView";class ToolbarPanel extends Annotation{constructor(e){super(e)}static init_ToolbarPanel(){this.prototype.default_view=ToolbarPanelView,this.define((({Ref:e})=>({toolbar:[e(Toolbar)]})))}}ToolbarPanel.__name__="ToolbarPanel",ToolbarPanel.init_ToolbarPanel();const tooltip="bk-tooltip",left$1="bk-left",tooltip_arrow="bk-tooltip-arrow",right$1="bk-right",above$1="bk-above",below$1="bk-below",tooltip_row_label="bk-tooltip-row-label",tooltip_row_value="bk-tooltip-row-value",tooltip_color_block="bk-tooltip-color-block";var tooltips_css='.bk-root{}.bk-root .bk-tooltip{font-weight:300;font-size:12px;position:absolute;padding:5px;border:1px solid #e5e5e5;color:#2f2f2f;background-color:white;pointer-events:none;opacity:0.95;z-index:100;}.bk-root .bk-tooltip > div:not(:first-child){margin-top:5px;border-top:#e5e5e5 1px dashed;}.bk-root .bk-tooltip.bk-left.bk-tooltip-arrow::before{position:absolute;margin:-7px 0 0 0;top:50%;width:0;height:0;border-style:solid;border-width:7px 0 7px 0;border-color:transparent;content:" ";display:block;left:-10px;border-right-width:10px;border-right-color:#909599;}.bk-root .bk-tooltip.bk-left::before{left:-10px;border-right-width:10px;border-right-color:#909599;}.bk-root .bk-tooltip.bk-right.bk-tooltip-arrow::after{position:absolute;margin:-7px 0 0 0;top:50%;width:0;height:0;border-style:solid;border-width:7px 0 7px 0;border-color:transparent;content:" ";display:block;right:-10px;border-left-width:10px;border-left-color:#909599;}.bk-root .bk-tooltip.bk-right::after{right:-10px;border-left-width:10px;border-left-color:#909599;}.bk-root .bk-tooltip.bk-above::before{position:absolute;margin:0 0 0 -7px;left:50%;width:0;height:0;border-style:solid;border-width:0 7px 0 7px;border-color:transparent;content:" ";display:block;top:-10px;border-bottom-width:10px;border-bottom-color:#909599;}.bk-root .bk-tooltip.bk-below::after{position:absolute;margin:0 0 0 -7px;left:50%;width:0;height:0;border-style:solid;border-width:0 7px 0 7px;border-color:transparent;content:" ";display:block;bottom:-10px;border-top-width:10px;border-top-color:#909599;}.bk-root .bk-tooltip-row-label{text-align:right;color:#26aae1;}.bk-root .bk-tooltip-row-value{color:default;}.bk-root .bk-tooltip-color-block{width:12px;height:12px;margin-left:5px;margin-right:5px;outline:#dddddd solid 1px;display:inline-block;}';const arrow_size=10;class TooltipView extends AnnotationView{initialize(){super.initialize(),this.el=div({class:tooltip}),undisplay(this.el),this.plot_view.canvas_view.add_overlay(this.el)}remove(){remove(this.el),super.remove()}connect_signals(){super.connect_signals(),this.connect(this.model.properties.content.change,(()=>this.render())),this.connect(this.model.properties.position.change,(()=>this._reposition()))}styles(){return[...super.styles(),tooltips_css]}render(){this.model.visible||undisplay(this.el),super.render()}_render(){const{content:e}=this.model;null!=e?(empty$1(this.el),classes(this.el).toggle("bk-tooltip-custom",this.model.custom),this.el.appendChild(e),this.model.show_arrow&&this.el.classList.add(tooltip_arrow)):undisplay(this.el)}_reposition(){const{position:e}=this.model;if(null==e)return void undisplay(this.el);const[t,i]=e,n=(()=>{const e=this.parent.layout.bbox.relative(),{attachment:n}=this.model;switch(n){case"horizontal":return t<e.hcenter?"right":"left";case"vertical":return i<e.vcenter?"below":"above";default:return n}})();let o;this.el.classList.remove(right$1),this.el.classList.remove(left$1),this.el.classList.remove(above$1),this.el.classList.remove(below$1),display(this.el);let r=null,s=null;switch(n){case"right":this.el.classList.add(left$1),r=t+(this.el.offsetWidth-this.el.clientWidth)+arrow_size,o=i-this.el.offsetHeight/2;break;case"left":this.el.classList.add(right$1),s=this.plot_view.layout.bbox.width-t+arrow_size,o=i-this.el.offsetHeight/2;break;case"below":this.el.classList.add(above$1),o=i+(this.el.offsetHeight-this.el.clientHeight)+arrow_size,r=Math.round(t-this.el.offsetWidth/2);break;case"above":this.el.classList.add(below$1),o=i-this.el.offsetHeight-arrow_size,r=Math.round(t-this.el.offsetWidth/2)}this.el.style.top=`${o}px`,this.el.style.left=null!=r?`${r}px`:"auto",this.el.style.right=null!=s?`${s}px`:"auto"}}TooltipView.__name__="TooltipView";class Tooltip extends Annotation{constructor(e){super(e)}static init_Tooltip(){this.prototype.default_view=TooltipView,this.define((({Boolean:e})=>({attachment:[TooltipAttachment,"horizontal"],inner_only:[e,!0],show_arrow:[e,!0]}))),this.internal((({Boolean:e,Number:t,Tuple:i,Ref:n,Nullable:o})=>({position:[o(i(t,t)),null],content:[n(HTMLElement),()=>div()],custom:[e]}))),this.override({level:"overlay"})}clear(){this.position=null}}Tooltip.__name__="Tooltip",Tooltip.init_Tooltip();class WhiskerView extends UpperLowerView{async lazy_initialize(){await super.lazy_initialize();const{lower_head:e,upper_head:t}=this.model;null!=e&&(this.lower_head=await build_view(e,{parent:this})),null!=t&&(this.upper_head=await build_view(t,{parent:this}))}set_data(e){var t,i;super.set_data(e),null==(t=this.lower_head)||t.set_data(e),null==(i=this.upper_head)||i.set_data(e)}paint(e){if(this.visuals.line.doit)for(let i=0,n=this._lower_sx.length;i<n;i++)this.visuals.line.set_vectorize(e,i),e.beginPath(),e.moveTo(this._lower_sx[i],this._lower_sy[i]),e.lineTo(this._upper_sx[i],this._upper_sy[i]),e.stroke();const t="height"==this.model.dimension?0:Math.PI/2;if(null!=this.lower_head)for(let i=0,n=this._lower_sx.length;i<n;i++)e.save(),e.translate(this._lower_sx[i],this._lower_sy[i]),e.rotate(t+Math.PI),this.lower_head.render(e,i),e.restore();if(null!=this.upper_head)for(let i=0,n=this._upper_sx.length;i<n;i++)e.save(),e.translate(this._upper_sx[i],this._upper_sy[i]),e.rotate(t),this.upper_head.render(e,i),e.restore()}}WhiskerView.__name__="WhiskerView";class Whisker extends UpperLower{constructor(e){super(e)}static init_Whisker(){this.prototype.default_view=WhiskerView,this.mixins(LineVector$1),this.define((({Ref:e,Nullable:t})=>({lower_head:[t(e(ArrowHead)),()=>new TeeHead({size:10})],upper_head:[t(e(ArrowHead)),()=>new TeeHead({size:10})]}))),this.override({level:"underlay"})}}Whisker.__name__="Whisker",Whisker.init_Whisker();class Callback extends Model{constructor(e){super(e)}}Callback.__name__="Callback";class CustomJS extends Callback{constructor(e){super(e)}static init_CustomJS(){this.define((({Unknown:e,String:t,Dict:i})=>({args:[i(e),{}],code:[t,""]})))}get names(){return keys(this.args)}get values(){return values(this.args)}get func(){const e=use_strict(this.code);return new Function(...this.names,"cb_obj","cb_data",e)}execute(e,t={}){return this.func.apply(e,this.values.concat(e,t))}}CustomJS.__name__="CustomJS",CustomJS.init_CustomJS();class OpenURL extends Callback{constructor(e){super(e)}static init_OpenURL(){this.define((({Boolean:e,String:t})=>({url:[t,"http://"],same_tab:[e,!1]})))}navigate(e){this.same_tab?window.location.href=e:window.open(e)}execute(e,{source:t}){const i=e=>{const i=replace_placeholders(this.url,t,e,void 0,void 0,encodeURI);if(!isString(i))throw new Error("HTML output is not supported in this context");this.navigate(i)},{selected:n}=t;for(const o of n.indices)i(o);for(const o of n.line_indices)i(o)}}OpenURL.__name__="OpenURL",OpenURL.init_OpenURL();var __decorate=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};function event(e){return function(t){t.prototype.event_name=e}}class BokehEvent{to_json(){const{event_name:e}=this;return{event_name:e,event_values:this._to_json()}}}BokehEvent.__name__="BokehEvent";class ModelEvent extends BokehEvent{constructor(){super(...arguments),this.origin=null}_to_json(){return{model:this.origin}}}ModelEvent.__name__="ModelEvent";let DocumentReady=class extends BokehEvent{_to_json(){return{}}};DocumentReady.__name__="DocumentReady",DocumentReady=__decorate([event("document_ready")],DocumentReady);let ButtonClick=class extends ModelEvent{};ButtonClick.__name__="ButtonClick",ButtonClick=__decorate([event("button_click")],ButtonClick);let MenuItemClick=class extends ModelEvent{constructor(e){super(),this.item=e}_to_json(){const{item:e}=this;return __spreadProps(__spreadValues({},super._to_json()),{item:e})}};MenuItemClick.__name__="MenuItemClick",MenuItemClick=__decorate([event("menu_item_click")],MenuItemClick);class UIEvent extends ModelEvent{}UIEvent.__name__="UIEvent";let LODStart=class extends UIEvent{};LODStart.__name__="LODStart",LODStart=__decorate([event("lodstart")],LODStart);let LODEnd=class extends UIEvent{};LODEnd.__name__="LODEnd",LODEnd=__decorate([event("lodend")],LODEnd);let SelectionGeometry=class extends UIEvent{constructor(e,t){super(),this.geometry=e,this.final=t}_to_json(){const{geometry:e,final:t}=this;return __spreadProps(__spreadValues({},super._to_json()),{geometry:e,final:t})}};SelectionGeometry.__name__="SelectionGeometry",SelectionGeometry=__decorate([event("selectiongeometry")],SelectionGeometry);let Reset=class extends UIEvent{};Reset.__name__="Reset",Reset=__decorate([event("reset")],Reset);class PointEvent extends UIEvent{constructor(e,t,i,n){super(),this.sx=e,this.sy=t,this.x=i,this.y=n}_to_json(){const{sx:e,sy:t,x:i,y:n}=this;return __spreadProps(__spreadValues({},super._to_json()),{sx:e,sy:t,x:i,y:n})}}PointEvent.__name__="PointEvent";let Pan=class extends PointEvent{constructor(e,t,i,n,o,r){super(e,t,i,n),this.sx=e,this.sy=t,this.x=i,this.y=n,this.delta_x=o,this.delta_y=r}_to_json(){const{delta_x:e,delta_y:t}=this;return __spreadProps(__spreadValues({},super._to_json()),{delta_x:e,delta_y:t})}};Pan.__name__="Pan",Pan=__decorate([event("pan")],Pan);let Pinch=class extends PointEvent{constructor(e,t,i,n,o){super(e,t,i,n),this.sx=e,this.sy=t,this.x=i,this.y=n,this.scale=o}_to_json(){const{scale:e}=this;return __spreadProps(__spreadValues({},super._to_json()),{scale:e})}};Pinch.__name__="Pinch",Pinch=__decorate([event("pinch")],Pinch);let Rotate=class extends PointEvent{constructor(e,t,i,n,o){super(e,t,i,n),this.sx=e,this.sy=t,this.x=i,this.y=n,this.rotation=o}_to_json(){const{rotation:e}=this;return __spreadProps(__spreadValues({},super._to_json()),{rotation:e})}};Rotate.__name__="Rotate",Rotate=__decorate([event("rotate")],Rotate);let MouseWheel=class extends PointEvent{constructor(e,t,i,n,o){super(e,t,i,n),this.sx=e,this.sy=t,this.x=i,this.y=n,this.delta=o}_to_json(){const{delta:e}=this;return __spreadProps(__spreadValues({},super._to_json()),{delta:e})}};MouseWheel.__name__="MouseWheel",MouseWheel=__decorate([event("wheel")],MouseWheel);let MouseMove=class extends PointEvent{};MouseMove.__name__="MouseMove",MouseMove=__decorate([event("mousemove")],MouseMove);let MouseEnter=class extends PointEvent{};MouseEnter.__name__="MouseEnter",MouseEnter=__decorate([event("mouseenter")],MouseEnter);let MouseLeave=class extends PointEvent{};MouseLeave.__name__="MouseLeave",MouseLeave=__decorate([event("mouseleave")],MouseLeave);let Tap=class extends PointEvent{};Tap.__name__="Tap",Tap=__decorate([event("tap")],Tap);let DoubleTap=class extends PointEvent{};DoubleTap.__name__="DoubleTap",DoubleTap=__decorate([event("doubletap")],DoubleTap);let Press=class extends PointEvent{};Press.__name__="Press",Press=__decorate([event("press")],Press);let PressUp=class extends PointEvent{};PressUp.__name__="PressUp",PressUp=__decorate([event("pressup")],PressUp);let PanStart=class extends PointEvent{};PanStart.__name__="PanStart",PanStart=__decorate([event("panstart")],PanStart);let PanEnd=class extends PointEvent{};PanEnd.__name__="PanEnd",PanEnd=__decorate([event("panend")],PanEnd);let PinchStart=class extends PointEvent{};PinchStart.__name__="PinchStart",PinchStart=__decorate([event("pinchstart")],PinchStart);let PinchEnd=class extends PointEvent{};PinchEnd.__name__="PinchEnd",PinchEnd=__decorate([event("pinchend")],PinchEnd);let RotateStart=class extends PointEvent{};RotateStart.__name__="RotateStart",RotateStart=__decorate([event("rotatestart")],RotateStart);let RotateEnd=class extends PointEvent{};
/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
function fontSize(e){const t=getComputedStyle(e).fontSize;return null!=t?parseInt(t,10):null}function lineHeight(e){var t,i,n;return null!=(n=null!=(i=fontSize(null!=(t=e.offsetParent)?t:document.body))?i:fontSize(e))?n:16}function pageHeight(e){return e.clientHeight}function getDeltaY(e){let t=-e.deltaY;if(e.target instanceof HTMLElement)switch(e.deltaMode){case e.DOM_DELTA_LINE:t*=lineHeight(e.target);break;case e.DOM_DELTA_PAGE:t*=pageHeight(e.target)}return t}function is_touch(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}RotateEnd.__name__="RotateEnd",RotateEnd=__decorate([event("rotateend")],RotateEnd);class UIEventBus{constructor(e){this.canvas_view=e,this.pan_start=new Signal(this,"pan:start"),this.pan=new Signal(this,"pan"),this.pan_end=new Signal(this,"pan:end"),this.pinch_start=new Signal(this,"pinch:start"),this.pinch=new Signal(this,"pinch"),this.pinch_end=new Signal(this,"pinch:end"),this.rotate_start=new Signal(this,"rotate:start"),this.rotate=new Signal(this,"rotate"),this.rotate_end=new Signal(this,"rotate:end"),this.tap=new Signal(this,"tap"),this.doubletap=new Signal(this,"doubletap"),this.press=new Signal(this,"press"),this.pressup=new Signal(this,"pressup"),this.move_enter=new Signal(this,"move:enter"),this.move=new Signal(this,"move"),this.move_exit=new Signal(this,"move:exit"),this.scroll=new Signal(this,"scroll"),this.keydown=new Signal(this,"keydown"),this.keyup=new Signal(this,"keyup"),this.hammer=new Hammer(this.hit_area,{touchAction:"auto",inputClass:Hammer.TouchMouseInput}),this._prev_move=null,this._curr_pan=null,this._curr_pinch=null,this._curr_rotate=null,this._configure_hammerjs(),this.hit_area.addEventListener("mousemove",(e=>this._mouse_move(e))),this.hit_area.addEventListener("mouseenter",(e=>this._mouse_enter(e))),this.hit_area.addEventListener("mouseleave",(e=>this._mouse_exit(e))),this.hit_area.addEventListener("contextmenu",(e=>this._context_menu(e))),this.hit_area.addEventListener("wheel",(e=>this._mouse_wheel(e))),document.addEventListener("keydown",this),document.addEventListener("keyup",this),this.menu=new ContextMenu([],{prevent_hide:e=>2==e.button&&e.target==this.hit_area}),this.hit_area.appendChild(this.menu.el)}get hit_area(){return this.canvas_view.events_el}destroy(){this.menu.remove(),this.hammer.destroy(),document.removeEventListener("keydown",this),document.removeEventListener("keyup",this)}handleEvent(e){"keydown"==e.type?this._key_down(e):"keyup"==e.type&&this._key_up(e)}_configure_hammerjs(){this.hammer.get("doubletap").recognizeWith("tap"),this.hammer.get("tap").requireFailure("doubletap"),this.hammer.get("doubletap").dropRequireFailure("tap"),this.hammer.on("doubletap",(e=>this._doubletap(e))),this.hammer.on("tap",(e=>this._tap(e))),this.hammer.on("press",(e=>this._press(e))),this.hammer.on("pressup",(e=>this._pressup(e))),this.hammer.get("pan").set({direction:Hammer.DIRECTION_ALL}),this.hammer.on("panstart",(e=>this._pan_start(e))),this.hammer.on("pan",(e=>this._pan(e))),this.hammer.on("panend",(e=>this._pan_end(e))),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("pinchstart",(e=>this._pinch_start(e))),this.hammer.on("pinch",(e=>this._pinch(e))),this.hammer.on("pinchend",(e=>this._pinch_end(e))),this.hammer.get("rotate").set({enable:!0}),this.hammer.on("rotatestart",(e=>this._rotate_start(e))),this.hammer.on("rotate",(e=>this._rotate(e))),this.hammer.on("rotateend",(e=>this._rotate_end(e)))}register_tool(e){const t=e.model.event_type;null!=t&&(isString(t)?this._register_tool(e,t):t.forEach(((t,i)=>this._register_tool(e,t,i<1))))}_register_tool(e,t,i=!0){const n=e,{id:o}=n.model,r=e=>t=>{t.id==o&&e(t.e)},s=e=>t=>{e(t.e)};switch(t){case"pan":null!=n._pan_start&&n.connect(this.pan_start,r(n._pan_start.bind(n))),null!=n._pan&&n.connect(this.pan,r(n._pan.bind(n))),null!=n._pan_end&&n.connect(this.pan_end,r(n._pan_end.bind(n)));break;case"pinch":null!=n._pinch_start&&n.connect(this.pinch_start,r(n._pinch_start.bind(n))),null!=n._pinch&&n.connect(this.pinch,r(n._pinch.bind(n))),null!=n._pinch_end&&n.connect(this.pinch_end,r(n._pinch_end.bind(n)));break;case"rotate":null!=n._rotate_start&&n.connect(this.rotate_start,r(n._rotate_start.bind(n))),null!=n._rotate&&n.connect(this.rotate,r(n._rotate.bind(n))),null!=n._rotate_end&&n.connect(this.rotate_end,r(n._rotate_end.bind(n)));break;case"move":null!=n._move_enter&&n.connect(this.move_enter,r(n._move_enter.bind(n))),null!=n._move&&n.connect(this.move,r(n._move.bind(n))),null!=n._move_exit&&n.connect(this.move_exit,r(n._move_exit.bind(n)));break;case"tap":null!=n._tap&&n.connect(this.tap,r(n._tap.bind(n))),null!=n._doubletap&&n.connect(this.doubletap,r(n._doubletap.bind(n)));break;case"press":null!=n._press&&n.connect(this.press,r(n._press.bind(n))),null!=n._pressup&&n.connect(this.pressup,r(n._pressup.bind(n)));break;case"scroll":null!=n._scroll&&n.connect(this.scroll,r(n._scroll.bind(n)));break;default:throw new Error(`unsupported event_type: ${t}`)}i&&(null!=n._keydown&&n.connect(this.keydown,s(n._keydown.bind(n))),null!=n._keyup&&n.connect(this.keyup,s(n._keyup.bind(n))),is_mobile&&null!=n._scroll&&"pinch"==t&&(logger.debug("Registering scroll on touch screen"),n.connect(this.scroll,r(n._scroll.bind(n)))))}_hit_test_renderers(e,t,i){var n;const o=e.get_renderer_views();for(const r of reversed(o))if(null==(n=r.interactive_hit)?void 0:n.call(r,t,i))return r;return null}set_cursor(e="default"){this.hit_area.style.cursor=e}_hit_test_frame(e,t,i){return e.frame.bbox.contains(t,i)}_hit_test_canvas(e,t,i){return e.layout.bbox.contains(t,i)}_hit_test_plot(e,t){for(const i of this.canvas_view.plot_views)if(i.layout.bbox.relative().contains(e,t))return i;return null}_trigger(e,t,i){var n;const{sx:o,sy:r}=t,s=this._hit_test_plot(o,r),a=e=>{const[i,n]=[o,r];return __spreadProps(__spreadValues({},t),{sx:i,sy:n})};if("panstart"==t.type||"pan"==t.type||"panend"==t.type){let n;if("panstart"==t.type&&null!=s?(this._curr_pan={plot_view:s},n=s):"pan"==t.type&&null!=this._curr_pan?n=this._curr_pan.plot_view:"panend"==t.type&&null!=this._curr_pan?(n=this._curr_pan.plot_view,this._curr_pan=null):n=null,null!=n){const t=a();this.__trigger(n,e,t,i)}}else if("pinchstart"==t.type||"pinch"==t.type||"pinchend"==t.type){let n;if("pinchstart"==t.type&&null!=s?(this._curr_pinch={plot_view:s},n=s):"pinch"==t.type&&null!=this._curr_pinch?n=this._curr_pinch.plot_view:"pinchend"==t.type&&null!=this._curr_pinch?(n=this._curr_pinch.plot_view,this._curr_pinch=null):n=null,null!=n){const t=a();this.__trigger(n,e,t,i)}}else if("rotatestart"==t.type||"rotate"==t.type||"rotateend"==t.type){let n;if("rotatestart"==t.type&&null!=s?(this._curr_rotate={plot_view:s},n=s):"rotate"==t.type&&null!=this._curr_rotate?n=this._curr_rotate.plot_view:"rotateend"==t.type&&null!=this._curr_rotate?(n=this._curr_rotate.plot_view,this._curr_rotate=null):n=null,null!=n){const t=a();this.__trigger(n,e,t,i)}}else if("mouseenter"==t.type||"mousemove"==t.type||"mouseleave"==t.type){const l=null==(n=this._prev_move)?void 0:n.plot_view;if(null!=l&&("mouseleave"==t.type||l!=s)){const{sx:e,sy:t}=a();this.__trigger(l,this.move_exit,{type:"mouseleave",sx:e,sy:t,shiftKey:!1,ctrlKey:!1},i)}if(null!=s&&("mouseenter"==t.type||l!=s)){const{sx:e,sy:t}=a();this.__trigger(s,this.move_enter,{type:"mouseenter",sx:e,sy:t,shiftKey:!1,ctrlKey:!1},i)}if(null!=s&&"mousemove"==t.type){const t=a();this.__trigger(s,e,t,i)}this._prev_move={sx:o,sy:r,plot_view:s}}else if(null!=s){const t=a();this.__trigger(s,e,t,i)}}__trigger(e,t,i,n){var o,r;const s=e.model.toolbar.gestures,a=t.name.split(":")[0],l=this._hit_test_renderers(e,i.sx,i.sy),c=this._hit_test_canvas(e,i.sx,i.sy);switch(a){case"move":{const n=s[a].active;null!=n&&this.trigger(t,i,n.id);const r=e.model.toolbar.inspectors.filter((e=>e.active));let d="default";null!=l?(d=null!=(o=l.cursor(i.sx,i.sy))?o:d,is_empty(r)||(t=this.move_exit)):this._hit_test_frame(e,i.sx,i.sy)&&(is_empty(r)||(d="crosshair")),this.set_cursor(d),e.set_toolbar_visibility(c),r.map((e=>this.trigger(t,i,e.id)));break}case"tap":{const{target:e}=n;if(null!=e&&e!=this.hit_area)return;null!=l&&null!=l.on_hit&&l.on_hit(i.sx,i.sy);const o=s[a].active;null!=o&&this.trigger(t,i,o.id);break}case"doubletap":{const e=null!=(r=s.doubletap.active)?r:s.tap.active;null!=e&&this.trigger(t,i,e.id);break}case"scroll":{const e=s[is_mobile?"pinch":"scroll"].active;null!=e&&(n.preventDefault(),n.stopPropagation(),this.trigger(t,i,e.id));break}case"pan":{const e=s[a].active;null!=e&&(n.preventDefault(),this.trigger(t,i,e.id));break}default:{const e=s[a].active;null!=e&&this.trigger(t,i,e.id)}}this._trigger_bokeh_event(e,i)}trigger(e,t,i=null){e.emit({id:i,e:t})}_trigger_bokeh_event(e,t){const i=(()=>{const{sx:i,sy:n}=t,o=e.frame.x_scale.invert(i),r=e.frame.y_scale.invert(n);switch(t.type){case"wheel":return new MouseWheel(i,n,o,r,t.delta);case"mousemove":return new MouseMove(i,n,o,r);case"mouseenter":return new MouseEnter(i,n,o,r);case"mouseleave":return new MouseLeave(i,n,o,r);case"tap":return new Tap(i,n,o,r);case"doubletap":return new DoubleTap(i,n,o,r);case"press":return new Press(i,n,o,r);case"pressup":return new PressUp(i,n,o,r);case"pan":return new Pan(i,n,o,r,t.deltaX,t.deltaY);case"panstart":return new PanStart(i,n,o,r);case"panend":return new PanEnd(i,n,o,r);case"pinch":return new Pinch(i,n,o,r,t.scale);case"pinchstart":return new PinchStart(i,n,o,r);case"pinchend":return new PinchEnd(i,n,o,r);case"rotate":return new Rotate(i,n,o,r,t.rotation);case"rotatestart":return new RotateStart(i,n,o,r);case"rotateend":return new RotateEnd(i,n,o,r);default:return}})();null!=i&&e.model.trigger_event(i)}_get_sxy(e){const{pageX:t,pageY:i}=is_touch(e)?(0!=e.touches.length?e.touches:e.changedTouches)[0]:e,{left:n,top:o}=offset(this.hit_area);return{sx:t-n,sy:i-o}}_pan_event(e){return __spreadProps(__spreadValues({type:e.type},this._get_sxy(e.srcEvent)),{deltaX:e.deltaX,deltaY:e.deltaY,shiftKey:e.srcEvent.shiftKey,ctrlKey:e.srcEvent.ctrlKey})}_pinch_event(e){return __spreadProps(__spreadValues({type:e.type},this._get_sxy(e.srcEvent)),{scale:e.scale,shiftKey:e.srcEvent.shiftKey,ctrlKey:e.srcEvent.ctrlKey})}_rotate_event(e){return __spreadProps(__spreadValues({type:e.type},this._get_sxy(e.srcEvent)),{rotation:e.rotation,shiftKey:e.srcEvent.shiftKey,ctrlKey:e.srcEvent.ctrlKey})}_tap_event(e){return __spreadProps(__spreadValues({type:e.type},this._get_sxy(e.srcEvent)),{shiftKey:e.srcEvent.shiftKey,ctrlKey:e.srcEvent.ctrlKey})}_move_event(e){return __spreadProps(__spreadValues({type:e.type},this._get_sxy(e)),{shiftKey:e.shiftKey,ctrlKey:e.ctrlKey})}_scroll_event(e){return __spreadProps(__spreadValues({type:e.type},this._get_sxy(e)),{delta:getDeltaY(e),shiftKey:e.shiftKey,ctrlKey:e.ctrlKey})}_key_event(e){return{type:e.type,keyCode:e.keyCode}}_pan_start(e){const t=this._pan_event(e);t.sx-=e.deltaX,t.sy-=e.deltaY,this._trigger(this.pan_start,t,e.srcEvent)}_pan(e){this._trigger(this.pan,this._pan_event(e),e.srcEvent)}_pan_end(e){this._trigger(this.pan_end,this._pan_event(e),e.srcEvent)}_pinch_start(e){this._trigger(this.pinch_start,this._pinch_event(e),e.srcEvent)}_pinch(e){this._trigger(this.pinch,this._pinch_event(e),e.srcEvent)}_pinch_end(e){this._trigger(this.pinch_end,this._pinch_event(e),e.srcEvent)}_rotate_start(e){this._trigger(this.rotate_start,this._rotate_event(e),e.srcEvent)}_rotate(e){this._trigger(this.rotate,this._rotate_event(e),e.srcEvent)}_rotate_end(e){this._trigger(this.rotate_end,this._rotate_event(e),e.srcEvent)}_tap(e){this._trigger(this.tap,this._tap_event(e),e.srcEvent)}_doubletap(e){this._trigger(this.doubletap,this._tap_event(e),e.srcEvent)}_press(e){this._trigger(this.press,this._tap_event(e),e.srcEvent)}_pressup(e){this._trigger(this.pressup,this._tap_event(e),e.srcEvent)}_mouse_enter(e){this._trigger(this.move_enter,this._move_event(e),e)}_mouse_move(e){this._trigger(this.move,this._move_event(e),e)}_mouse_exit(e){this._trigger(this.move_exit,this._move_event(e),e)}_mouse_wheel(e){this._trigger(this.scroll,this._scroll_event(e),e)}_context_menu(e){!this.menu.is_open&&this.menu.can_open&&e.preventDefault();const{sx:t,sy:i}=this._get_sxy(e);this.menu.toggle({left:t,top:i})}_key_down(e){this.trigger(this.keydown,this._key_event(e))}_key_up(e){this.trigger(this.keyup,this._key_event(e))}}UIEventBus.__name__="UIEventBus";const global_webgl=(()=>{const e=document.createElement("canvas"),t=e.getContext("webgl",{premultipliedAlpha:!0});return null!=t?{canvas:e,gl:t}:void logger.trace("WebGL is not supported")})(),style={position:"absolute",top:"0",left:"0",width:"100%",height:"100%"};class CanvasView extends DOMView{constructor(){super(...arguments),this.bbox=new BBox}initialize(){super.initialize(),"webgl"==this.model.output_backend&&(this.webgl=global_webgl),this.underlays_el=div({style:style}),this.primary=this.create_layer(),this.overlays=this.create_layer(),this.overlays_el=div({style:style}),this.events_el=div({class:"bk-canvas-events",style:style});const e=[this.underlays_el,this.primary.el,this.overlays.el,this.overlays_el,this.events_el];extend$1(this.el.style,style),append(this.el,...e),this.ui_event_bus=new UIEventBus(this)}remove(){this.ui_event_bus.destroy(),super.remove()}add_underlay(e){this.underlays_el.appendChild(e)}add_overlay(e){this.overlays_el.appendChild(e)}add_event(e){this.events_el.appendChild(e)}get pixel_ratio(){return this.primary.pixel_ratio}resize(e,t){this.bbox=new BBox({left:0,top:0,width:e,height:t}),this.primary.resize(e,t),this.overlays.resize(e,t)}prepare_webgl(e){const{webgl:t}=this;if(null!=t){const{width:i,height:n}=this.bbox;t.canvas.width=this.pixel_ratio*i,t.canvas.height=this.pixel_ratio*n;const{gl:o}=t;o.enable(o.SCISSOR_TEST);const[r,s,a,l]=e,{xview:c,yview:d}=this.bbox,h=c.compute(r),u=d.compute(s+l),p=this.pixel_ratio;o.scissor(p*h,p*u,p*a,p*l),o.enable(o.BLEND),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE_MINUS_DST_ALPHA,o.ONE),this._clear_webgl()}}blit_webgl(e){const{webgl:t}=this;if(null!=t){if(logger.debug("Blitting WebGL canvas"),e.restore(),e.drawImage(t.canvas,0,0),e.save(),this.model.hidpi){const t=this.pixel_ratio;e.scale(t,t),e.translate(.5,.5)}this._clear_webgl()}}_clear_webgl(){const{webgl:e}=this;if(null!=e){const{gl:t,canvas:i}=e;t.viewport(0,0,i.width,i.height),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}}compose(){const e=this.create_layer(),{width:t,height:i}=this.bbox;return e.resize(t,i),e.ctx.drawImage(this.primary.canvas,0,0),e.ctx.drawImage(this.overlays.canvas,0,0),e}create_layer(){const{output_backend:e,hidpi:t}=this.model;return new CanvasLayer(e,t)}to_blob(){return this.compose().to_blob()}}CanvasView.__name__="CanvasView";class Canvas extends HasProps{constructor(e){super(e)}static init_Canvas(){this.prototype.default_view=CanvasView,this.internal((({Boolean:e})=>({hidpi:[e,!0],output_backend:[OutputBackend,"canvas"]})))}}Canvas.__name__="Canvas",Canvas.init_Canvas();class CustomJSExpr extends Expression{constructor(e){super(e)}static init_CustomJSExpr(){this.define((({Unknown:e,String:t,Dict:i})=>({args:[i(e),{}],code:[t,""]})))}connect_signals(){super.connect_signals();for(const e of values(this.args))e instanceof HasProps&&e.change.connect((()=>{this._result.clear(),this.change.emit()}))}get names(){return keys(this.args)}get values(){return values(this.args)}get func(){const e=use_strict(this.code);return new GeneratorFunction(...this.names,e)}_v_compute(e){const t=this.func.apply(e,this.values);let i=t.next();if(i.done&&void 0!==i.value){const{value:t}=i;return isArray(t)||isTypedArray(t)?t:isIterable(t)?[...t]:repeat(t,e.length)}{const e=[];do{e.push(i.value),i=t.next()}while(!i.done);return e}}}CustomJSExpr.__name__="CustomJSExpr",CustomJSExpr.init_CustomJSExpr();class Stack extends Expression{constructor(e){super(e)}static init_Stack(){this.define((({String:e,Array:t})=>({fields:[t(e),[]]})))}_v_compute(e){var t;const i=null!=(t=e.get_length())?t:0,n=new Float64Array(i);for(const o of this.fields){const t=e.data[o];if(null!=t)for(let e=0,o=Math.min(i,t.length);e<o;e++)n[e]+=t[e]}return n}}Stack.__name__="Stack",Stack.init_Stack();class CumSum extends Expression{constructor(e){super(e)}static init_CumSum(){this.define((({Boolean:e,String:t})=>({field:[t],include_zero:[e,!1]})))}_v_compute(e){var t;const i=new Float64Array(null!=(t=e.get_length())?t:0),n=e.data[this.field],o=this.include_zero?1:0;i[0]=this.include_zero?0:n[0];for(let r=1;r<i.length;r++)i[r]=i[r-1]+n[r-o];return i}}CumSum.__name__="CumSum",CumSum.init_CumSum();class Minimum extends ScalarExpression{constructor(e){super(e)}static init_Minimum(){this.define((({Number:e,String:t,Nullable:i})=>({field:[t],initial:[i(e),null]})))}_compute(e){var t,i;const n=null!=(t=e.data[this.field])?t:[];return Math.min(null!=(i=this.initial)?i:1/0,min$6(n))}}Minimum.__name__="Minimum",Minimum.init_Minimum();class Maximum extends ScalarExpression{constructor(e){super(e)}static init_Maximum(){this.define((({Number:e,String:t,Nullable:i})=>({field:[t],initial:[i(e),null]})))}_compute(e){var t,i;const n=null!=(t=e.data[this.field])?t:[];return Math.max(null!=(i=this.initial)?i:-1/0,max$7(n))}}Maximum.__name__="Maximum",Maximum.init_Maximum();class BooleanFilter extends Filter{constructor(e){super(e)}static init_BooleanFilter(){this.define((({Boolean:e,Array:t,Nullable:i})=>({booleans:[i(t(e)),null]})))}compute_indices(e){const t=e.length,{booleans:i}=this;return null==i?BitSet.all_set(t):BitSet.from_booleans(t,i)}}BooleanFilter.__name__="BooleanFilter",BooleanFilter.init_BooleanFilter();class CustomJSFilter extends Filter{constructor(e){super(e)}static init_CustomJSFilter(){this.define((({Unknown:e,String:t,Dict:i})=>({args:[i(e),{}],code:[t,""]})))}get names(){return keys(this.args)}get values(){return values(this.args)}get func(){const e=use_strict(this.code);return new Function(...this.names,"source",e)}compute_indices(e){const t=e.length,i=this.func(...this.values,e);if(null==i)return BitSet.all_set(t);if(isArrayOf(i,isInteger))return BitSet.from_indices(t,i);if(isArrayOf(i,isBoolean))return BitSet.from_booleans(t,i);throw new Error(`expect an array of integers or booleans, or null, got ${i}`)}}CustomJSFilter.__name__="CustomJSFilter",CustomJSFilter.init_CustomJSFilter();class GroupFilter extends Filter{constructor(e){super(e)}static init_GroupFilter(){this.define((({String:e})=>({column_name:[e],group:[e]})))}compute_indices(e){const t=e.get_column(this.column_name);if(null==t)return logger.warn(`${this}: groupby column '${this.column_name}' not found in the data source`),new BitSet(e.length,1);{const i=new BitSet(e.length);for(let e=0;e<i.size;e++)t[e]===this.group&&i.set(e);return i}}}GroupFilter.__name__="GroupFilter",GroupFilter.init_GroupFilter();class IndexFilter extends Filter{constructor(e){super(e)}static init_IndexFilter(){this.define((({Int:e,Array:t,Nullable:i})=>({indices:[i(t(e)),null]})))}compute_indices(e){const t=e.length,{indices:i}=this;return null==i?BitSet.all_set(t):BitSet.from_indices(t,i)}}IndexFilter.__name__="IndexFilter",IndexFilter.init_IndexFilter();class AnnularWedgeView extends XYGlyphView{_map_data(){"data"==this.model.properties.inner_radius.units?this.sinner_radius=this.sdist(this.renderer.xscale,this._x,this.inner_radius):this.sinner_radius=to_screen(this.inner_radius),"data"==this.model.properties.outer_radius.units?this.souter_radius=this.sdist(this.renderer.xscale,this._x,this.outer_radius):this.souter_radius=to_screen(this.outer_radius)}_render(e,t,i){const{sx:n,sy:o,start_angle:r,end_angle:s,sinner_radius:a,souter_radius:l}=null!=i?i:this,c="anticlock"==this.model.direction;for(const d of t){const t=n[d],i=o[d],h=a[d],u=l[d],p=r.get(d),_=s.get(d);if(isNaN(t+i+h+u+p+_))continue;const f=_-p;e.translate(t,i),e.rotate(p),e.beginPath(),e.moveTo(u,0),e.arc(0,0,u,0,f,c),e.rotate(f),e.lineTo(h,0),e.arc(0,0,h,0,-f,!c),e.closePath(),e.rotate(-f-p),e.translate(-t,-i),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,d),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,d),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,d),e.stroke())}}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i);let r,s,a,l;if("data"==this.model.properties.outer_radius.units)r=n-this.max_outer_radius,a=n+this.max_outer_radius,s=o-this.max_outer_radius,l=o+this.max_outer_radius;else{const e=t-this.max_outer_radius,n=t+this.max_outer_radius;[r,a]=this.renderer.xscale.r_invert(e,n);const o=i-this.max_outer_radius,c=i+this.max_outer_radius;[s,l]=this.renderer.yscale.r_invert(o,c)}const c=[];for(const u of this.index.indices({x0:r,x1:a,y0:s,y1:l})){const e=this.souter_radius[u]**2,t=this.sinner_radius[u]**2,[i,r]=this.renderer.xscale.r_compute(n,this._x[u]),[s,a]=this.renderer.yscale.r_compute(o,this._y[u]),l=(i-r)**2+(s-a)**2;l<=e&&l>=t&&c.push(u)}const d="anticlock"==this.model.direction,h=[];for(const u of c){angle_between(-Math.atan2(i-this.sy[u],t-this.sx[u]),-this.start_angle.get(u),-this.end_angle.get(u),d)&&h.push(u)}return new Selection({indices:h})}draw_legend_for_index(e,t,i){generic_area_vector_legend(this.visuals,e,t,i)}scenterxy(e){const t=(this.sinner_radius[e]+this.souter_radius[e])/2,i=(this.start_angle.get(e)+this.end_angle.get(e))/2;return[this.sx[e]+t*Math.cos(i),this.sy[e]+t*Math.sin(i)]}}AnnularWedgeView.__name__="AnnularWedgeView";class AnnularWedge extends XYGlyph{constructor(e){super(e)}static init_AnnularWedge(){this.prototype.default_view=AnnularWedgeView,this.mixins([LineVector$1,FillVector$1,HatchVector$1]),this.define((({})=>({direction:[Direction$1,"anticlock"],inner_radius:[DistanceSpec,{field:"inner_radius"}],outer_radius:[DistanceSpec,{field:"outer_radius"}],start_angle:[AngleSpec,{field:"start_angle"}],end_angle:[AngleSpec,{field:"end_angle"}]})))}}AnnularWedge.__name__="AnnularWedge",AnnularWedge.init_AnnularWedge();class AnnulusView extends XYGlyphView{_map_data(){"data"==this.model.properties.inner_radius.units?this.sinner_radius=this.sdist(this.renderer.xscale,this._x,this.inner_radius):this.sinner_radius=to_screen(this.inner_radius),"data"==this.model.properties.outer_radius.units?this.souter_radius=this.sdist(this.renderer.xscale,this._x,this.outer_radius):this.souter_radius=to_screen(this.outer_radius)}_render(e,t,i){const{sx:n,sy:o,sinner_radius:r,souter_radius:s}=null!=i?i:this;for(const a of t){let t=function(){if(e.beginPath(),is_ie)for(const t of[!1,!0])e.arc(i,l,c,0,Math.PI,t),e.arc(i,l,d,Math.PI,0,!t);else e.arc(i,l,c,0,2*Math.PI,!0),e.arc(i,l,d,2*Math.PI,0,!1)};const i=n[a],l=o[a],c=r[a],d=s[a];isNaN(i+l+c+d)||(this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,a),t(),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,a),t(),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,a),e.beginPath(),e.arc(i,l,c,0,2*Math.PI),e.moveTo(i+d,l),e.arc(i,l,d,0,2*Math.PI),e.stroke()))}}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i);let r,s,a,l;if("data"==this.model.properties.outer_radius.units)r=n-this.max_outer_radius,a=n+this.max_outer_radius,s=o-this.max_outer_radius,l=o+this.max_outer_radius;else{const e=t-this.max_outer_radius,n=t+this.max_outer_radius;[r,a]=this.renderer.xscale.r_invert(e,n);const o=i-this.max_outer_radius,c=i+this.max_outer_radius;[s,l]=this.renderer.yscale.r_invert(o,c)}const c=[];for(const d of this.index.indices({x0:r,x1:a,y0:s,y1:l})){const e=this.souter_radius[d]**2,t=this.sinner_radius[d]**2,[i,r]=this.renderer.xscale.r_compute(n,this._x[d]),[s,a]=this.renderer.yscale.r_compute(o,this._y[d]),l=(i-r)**2+(s-a)**2;l<=e&&l>=t&&c.push(d)}return new Selection({indices:c})}draw_legend_for_index(e,{x0:t,y0:i,x1:n,y1:o},r){const s=r+1,a=new Array(s);a[r]=(t+n)/2;const l=new Array(s);l[r]=(i+o)/2;const c=.5*Math.min(Math.abs(n-t),Math.abs(o-i)),d=new Array(s);d[r]=.4*c;const h=new Array(s);h[r]=.8*c,this._render(e,[r],{sx:a,sy:l,sinner_radius:d,souter_radius:h})}}AnnulusView.__name__="AnnulusView";class Annulus extends XYGlyph{constructor(e){super(e)}static init_Annulus(){this.prototype.default_view=AnnulusView,this.mixins([LineVector$1,FillVector$1,HatchVector$1]),this.define((({})=>({inner_radius:[DistanceSpec,{field:"inner_radius"}],outer_radius:[DistanceSpec,{field:"outer_radius"}]})))}}Annulus.__name__="Annulus",Annulus.init_Annulus();class ArcView extends XYGlyphView{_map_data(){"data"==this.model.properties.radius.units?this.sradius=this.sdist(this.renderer.xscale,this._x,this.radius):this.sradius=to_screen(this.radius)}_render(e,t,i){if(this.visuals.line.doit){const{sx:n,sy:o,sradius:r,start_angle:s,end_angle:a}=null!=i?i:this,l="anticlock"==this.model.direction;for(const i of t){const t=n[i],c=o[i],d=r[i],h=s.get(i),u=a.get(i);isNaN(t+c+d+h+u)||(e.beginPath(),e.arc(t,c,d,h,u,l),this.visuals.line.set_vectorize(e,i),e.stroke())}}}draw_legend_for_index(e,t,i){generic_line_vector_legend(this.visuals,e,t,i)}}ArcView.__name__="ArcView";class Arc extends XYGlyph{constructor(e){super(e)}static init_Arc(){this.prototype.default_view=ArcView,this.mixins(LineVector$1),this.define((({})=>({direction:[Direction$1,"anticlock"],radius:[DistanceSpec,{field:"radius"}],start_angle:[AngleSpec,{field:"start_angle"}],end_angle:[AngleSpec,{field:"end_angle"}]})))}}function _cbb(e,t,i,n,o,r,s,a){const l=[],c=[[],[]];for(let u=0;u<=2;u++){let c,d,h;if(0===u?(d=6*e-12*i+6*o,c=-3*e+9*i-9*o+3*s,h=3*i-3*e):(d=6*t-12*n+6*r,c=-3*t+9*n-9*r+3*a,h=3*n-3*t),Math.abs(c)<1e-12){if(Math.abs(d)<1e-12)continue;const e=-h/d;0<e&&e<1&&l.push(e);continue}const p=d*d-4*h*c,_=Math.sqrt(p);if(p<0)continue;const f=(-d+_)/(2*c);0<f&&f<1&&l.push(f);const g=(-d-_)/(2*c);0<g&&g<1&&l.push(g)}let d=l.length;const h=d;for(;d--;){const h=l[d],u=1-h,p=u*u*u*e+3*u*u*h*i+3*u*h*h*o+h*h*h*s;c[0][d]=p;const _=u*u*u*t+3*u*u*h*n+3*u*h*h*r+h*h*h*a;c[1][d]=_}return c[0][h]=e,c[1][h]=t,c[0][h+1]=s,c[1][h+1]=a,[Math.min(...c[0]),Math.max(...c[1]),Math.max(...c[0]),Math.min(...c[1])]}Arc.__name__="Arc",Arc.init_Arc();class BezierView extends GlyphView{_project_data(){inplace.project_xy(this._x0,this._y0),inplace.project_xy(this._x1,this._y1)}_index_data(e){const{data_size:t,_x0:i,_y0:n,_x1:o,_y1:r,_cx0:s,_cy0:a,_cx1:l,_cy1:c}=this;for(let d=0;d<t;d++){const t=i[d],h=n[d],u=o[d],p=r[d],_=s[d],f=a[d],g=l[d],m=c[d];if(isNaN(t+u+h+p+_+f+g+m))e.add_empty();else{const[i,n,o,r]=_cbb(t,h,u,p,_,f,g,m);e.add(i,n,o,r)}}}_render(e,t,i){if(this.visuals.line.doit){const{sx0:n,sy0:o,sx1:r,sy1:s,scx0:a,scy0:l,scx1:c,scy1:d}=null!=i?i:this;for(const i of t){const t=n[i],h=o[i],u=r[i],p=s[i],_=a[i],f=l[i],g=c[i],m=d[i];isNaN(t+h+u+p+_+f+g+m)||(e.beginPath(),e.moveTo(t,h),e.bezierCurveTo(_,f,g,m,u,p),this.visuals.line.set_vectorize(e,i),e.stroke())}}}draw_legend_for_index(e,t,i){generic_line_vector_legend(this.visuals,e,t,i)}scenterxy(){throw new Error(`${this}.scenterxy() is not implemented`)}}BezierView.__name__="BezierView";class Bezier extends Glyph{constructor(e){super(e)}static init_Bezier(){this.prototype.default_view=BezierView,this.define((({})=>({x0:[XCoordinateSpec,{field:"x0"}],y0:[YCoordinateSpec,{field:"y0"}],x1:[XCoordinateSpec,{field:"x1"}],y1:[YCoordinateSpec,{field:"y1"}],cx0:[XCoordinateSpec,{field:"cx0"}],cy0:[YCoordinateSpec,{field:"cy0"}],cx1:[XCoordinateSpec,{field:"cx1"}],cy1:[YCoordinateSpec,{field:"cy1"}]}))),this.mixins(LineVector$1)}}Bezier.__name__="Bezier",Bezier.init_Bezier();const shader$1="\nprecision mediump float;\nconst float SQRT_2 = 1.4142135623730951;\n//\nuniform float u_pixel_ratio;\nuniform vec2 u_canvas_size;\nuniform vec2 u_offset;\nuniform vec2 u_scale;\nuniform float u_antialias;\n//\nattribute float a_sx;\nattribute float a_sy;\nattribute float a_size;\nattribute float a_angle;  // in radians\nattribute float a_linewidth;\nattribute vec4  a_fg_color;\nattribute vec4  a_bg_color;\n//\nvarying float v_linewidth;\nvarying float v_size;\nvarying vec4  v_fg_color;\nvarying vec4  v_bg_color;\nvarying vec2  v_rotation;\n\nvoid main (void)\n{\n    v_size = a_size * u_pixel_ratio;\n    v_linewidth = a_linewidth * u_pixel_ratio;\n    v_fg_color = a_fg_color;\n    v_bg_color = a_bg_color;\n    v_rotation = vec2(cos(-a_angle), sin(-a_angle));\n    vec2 pos = vec2(a_sx, a_sy);  // in pixels\n    pos += 0.5;  // make up for Bokeh's offset\n    pos /= u_canvas_size / u_pixel_ratio;  // in 0..1\n    gl_Position = vec4(pos*2.0-1.0, 0.0, 1.0);\n    gl_Position.y *= -1.0;\n    gl_PointSize = SQRT_2 * v_size + 2.0 * (v_linewidth + 1.5*u_antialias);\n}\n",shader='\nprecision mediump float;\n\nconst float SQRT_2 = 1.4142135623730951;\nconst float PI = 3.14159265358979323846264;\n\nconst float IN_ANGLE = 0.6283185307179586; // PI/5. = 36 degrees (star of 5 pikes)\n//const float OUT_ANGLE = PI/2. - IN_ANGLE; // External angle for regular stars\nconst float COS_A = 0.8090169943749475; // cos(IN_ANGLE)\nconst float SIN_A = 0.5877852522924731; // sin(IN_ANGLE)\nconst float COS_B = 0.5877852522924731; // cos(OUT_ANGLE)\nconst float SIN_B = 0.8090169943749475; // sin(OUT_ANGLE)\n\n//\nuniform float u_antialias;\n//\nvarying vec4  v_fg_color;\nvarying vec4  v_bg_color;\nvarying float v_linewidth;\nvarying float v_size;\nvarying vec2  v_rotation;\n\n#ifdef USE_ASTERISK\n// asterisk\nfloat marker(vec2 P, float size)\n{\n    // Masks\n    float diamond = max(abs(SQRT_2 / 2.0 * (P.x - P.y)), abs(SQRT_2 / 2.0 * (P.x + P.y))) - size / (2.0 * SQRT_2);\n    float square = max(abs(P.x), abs(P.y)) - size / (2.0 * SQRT_2);\n    // Shapes\n    float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0;  // bit of "width" for aa\n    float cross = min(abs(P.x), abs(P.y)) - size / 100.0;  // bit of "width" for aa\n    // Result is union of masked shapes\n    return min(max(X, diamond), max(cross, square));\n}\n#endif\n\n#ifdef USE_CIRCLE\n// circle\nfloat marker(vec2 P, float size)\n{\n    return length(P) - size/2.0;\n}\n#endif\n\n#ifdef USE_SQUARE\n// square\nfloat marker(vec2 P, float size)\n{\n    return max(abs(P.x), abs(P.y)) - size/2.0;\n}\n#endif\n\n#ifdef USE_DIAMOND\n// diamond\nfloat marker(vec2 P, float size)\n{\n    float x = SQRT_2 / 2.0 * (P.x * 1.5 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.5 + P.y);\n    float r1 = max(abs(x), abs(y)) - size / (2.0 * SQRT_2);\n    return r1 / SQRT_2;\n}\n#endif\n\n#ifdef USE_HEX\n// hex\nfloat marker(vec2 P, float size)\n{\n    vec2 q = abs(P);\n    return max(q.y * 0.57735 + q.x - 1.0 * size/2.0, q.y - 0.866 * size/2.0);\n}\n#endif\n\n#ifdef USE_STAR\n// star\n// https://iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\nfloat marker(vec2 P, float size)\n{\n    float bn = mod(atan(P.x, -P.y), 2.0*IN_ANGLE) - IN_ANGLE;\n    P = length(P)*vec2(cos(bn), abs(sin(bn)));\n    P -= size*vec2(COS_A, SIN_A)/2.;\n    P += vec2(COS_B, SIN_B)*clamp(-(P.x*COS_B + P.y*SIN_B), 0.0, size*SIN_A/SIN_B/2.);\n\n    return length(P)*sign(P.x);\n}\n#endif\n\n#ifdef USE_TRIANGLE\n// triangle\nfloat marker(vec2 P, float size)\n{\n    P.y -= size * 0.3;\n    float x = SQRT_2 / 2.0 * (P.x * 1.7 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.7 + P.y);\n    float r1 = max(abs(x), abs(y)) - size / 1.6;\n    float r2 = P.y;\n    return max(r1 / SQRT_2, r2);  // Intersect diamond with rectangle\n}\n#endif\n\n#ifdef USE_INVERTED_TRIANGLE\n// inverted_triangle\nfloat marker(vec2 P, float size)\n{\n    P.y += size * 0.3;\n    float x = SQRT_2 / 2.0 * (P.x * 1.7 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.7 + P.y);\n    float r1 = max(abs(x), abs(y)) - size / 1.6;\n    float r2 = - P.y;\n    return max(r1 / SQRT_2, r2);  // Intersect diamond with rectangle\n}\n#endif\n\n#ifdef USE_CROSS\n// cross\nfloat marker(vec2 P, float size)\n{\n    float square = max(abs(P.x), abs(P.y)) - size / 2.5;   // 2.5 is a tweak\n    float cross = min(abs(P.x), abs(P.y)) - size / 100.0;  // bit of "width" for aa\n    return max(square, cross);\n}\n#endif\n\n#ifdef USE_CIRCLE_CROSS\n// circle_cross\nfloat marker(vec2 P, float size)\n{\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\n    float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\n    float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\n    float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float circle = length(P) - size/2.0;\n    float c1 = max(circle, s1);\n    float c2 = max(circle, s2);\n    float c3 = max(circle, s3);\n    float c4 = max(circle, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\n#ifdef USE_SQUARE_CROSS\n// square_cross\nfloat marker(vec2 P, float size)\n{\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\n    float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\n    float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\n    float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float square = max(abs(P.x), abs(P.y)) - size/2.0;\n    float c1 = max(square, s1);\n    float c2 = max(square, s2);\n    float c3 = max(square, s3);\n    float c4 = max(square, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\n#ifdef USE_DIAMOND_CROSS\n// diamond_cross\nfloat marker(vec2 P, float size)\n{\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\n    float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\n    float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\n    float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float x = SQRT_2 / 2.0 * (P.x * 1.5 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.5 + P.y);\n    float diamond = max(abs(x), abs(y)) - size / (2.0 * SQRT_2);\n    diamond /= SQRT_2;\n    float c1 = max(diamond, s1);\n    float c2 = max(diamond, s2);\n    float c3 = max(diamond, s3);\n    float c4 = max(diamond, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\n#ifdef USE_X\n// x\nfloat marker(vec2 P, float size)\n{\n    float circle = length(P) - size / 1.6;\n    float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0;  // bit of "width" for aa\n    return max(circle, X);\n}\n#endif\n\n#ifdef USE_CIRCLE_X\n// circle_x\nfloat marker(vec2 P, float size)\n{\n    float x = P.x - P.y;\n    float y = P.x + P.y;\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(x - qs), abs(y - qs)) - qs;\n    float s2 = max(abs(x + qs), abs(y - qs)) - qs;\n    float s3 = max(abs(x - qs), abs(y + qs)) - qs;\n    float s4 = max(abs(x + qs), abs(y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float circle = length(P) - size/2.0;\n    float c1 = max(circle, s1);\n    float c2 = max(circle, s2);\n    float c3 = max(circle, s3);\n    float c4 = max(circle, s4);\n    // Union\n    float almost = min(min(min(c1, c2), c3), c4);\n    // In this case, the X is also outside of the main shape\n    float Xmask = length(P) - size / 1.6;  // a circle\n    float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0;  // bit of "width" for aa\n    return min(max(X, Xmask), almost);\n}\n#endif\n\n#ifdef USE_SQUARE_X\n// square_x\nfloat marker(vec2 P, float size)\n{\n    float x = P.x - P.y;\n    float y = P.x + P.y;\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(x - qs), abs(y - qs)) - qs;\n    float s2 = max(abs(x + qs), abs(y - qs)) - qs;\n    float s3 = max(abs(x - qs), abs(y + qs)) - qs;\n    float s4 = max(abs(x + qs), abs(y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float square = max(abs(P.x), abs(P.y)) - size/2.0;\n    float c1 = max(square, s1);\n    float c2 = max(square, s2);\n    float c3 = max(square, s3);\n    float c4 = max(square, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\nvec4 outline(float distance, float linewidth, float antialias, vec4 fg_color, vec4 bg_color)\n{\n    vec4 frag_color;\n    float t = linewidth/2.0 - antialias;\n    float signed_distance = distance;\n    float border_distance = abs(signed_distance) - t;\n    float alpha = border_distance/antialias;\n    alpha = exp(-alpha*alpha);\n\n    // If fg alpha is zero, it probably means no outline. To avoid a dark outline\n    // shining through due to aa, we set the fg color to the bg color. Avoid if (i.e. branching).\n    float select = float(bool(fg_color.a));\n    fg_color.rgb = select * fg_color.rgb + (1.0  - select) * bg_color.rgb;\n    // Similarly, if we want a transparent bg\n    select = float(bool(bg_color.a));\n    bg_color.rgb = select * bg_color.rgb + (1.0  - select) * fg_color.rgb;\n\n    if( border_distance < 0.0)\n        frag_color = fg_color;\n    else if( signed_distance < 0.0 ) {\n        frag_color = mix(bg_color, fg_color, sqrt(alpha));\n    } else {\n        if( abs(signed_distance) < (linewidth/2.0 + antialias) ) {\n            frag_color = vec4(fg_color.rgb, fg_color.a * alpha);\n        } else {\n            discard;\n        }\n    }\n    return frag_color;\n}\n\nvoid main()\n{\n    vec2 P = gl_PointCoord.xy - vec2(0.5, 0.5);\n    P = vec2(v_rotation.x*P.x - v_rotation.y*P.y,\n             v_rotation.y*P.x + v_rotation.x*P.y);\n    float point_size = SQRT_2*v_size  + 2.0 * (v_linewidth + 1.5*u_antialias);\n    float distance = marker(P*point_size, v_size);\n    gl_FragColor = outline(distance, v_linewidth, u_antialias, v_fg_color, v_bg_color);\n}\n';function attach_float(e,t,i,n,o,r){if(o.doit){if(r.is_Scalar())t.used=!1,e.set_attribute(i,"float",[r.value]);else if(r.is_Vector()){t.used=!0;const o=new Float32Array(r.array);t.set_size(4*n),t.set_data(0,o),e.set_attribute(i,"float",t)}}else t.used=!1,e.set_attribute(i,"float",[0])}function attach_color(e,t,i,n,o,r,s){if(o.doit)if(r.is_Scalar()&&s.is_Scalar()){t.used=!1;const[n,o,a,l]=color2rgba(r.value,s.value);e.set_attribute(i,"vec4",[n/255,o/255,a/255,l/255])}else{let o;if(t.used=!0,r.is_Vector()){const e=new ColorArray(r.array);if(o=new RGBAArray(e.buffer),!s.is_Scalar()||1!=s.value)for(let t=0;t<n;t++){const e=4*t+3;255==o[e]&&(o[e]=255*s.get(t))}}else if(r.is_Scalar()&&s.is_Vector()){const e=new ColorArray(n);e.fill(r.value),o=new RGBAArray(e.buffer);for(let t=0;t<n;t++)for(let e=0;e<n;e++){const t=4*e+3;255==o[t]&&(o[t]=255*s.get(e))}}else unreachable();t.set_size(4*n),t.set_data(0,o),e.set_attribute(i,"vec4_uint8",t,0,0,!0)}else t.used=!1,e.set_attribute(i,"vec4",[0,0,0,0])}class MarkerGL extends BaseGLGlyph{constructor(e,t,i){super(e,t),this.glyph=t,this.marker_type=i;const n=[`#define USE_${i.toUpperCase()}`],o=shader$1,r=`${n.join("\n")}\n\n${shader}`;this.prog=new Program(e),this.prog.set_shaders(o,r),this.vbo_sx=new VertexBuffer(e),this.prog.set_attribute("a_sx","float",this.vbo_sx),this.vbo_sy=new VertexBuffer(e),this.prog.set_attribute("a_sy","float",this.vbo_sy),this.vbo_s=new VertexBuffer(e),this.prog.set_attribute("a_size","float",this.vbo_s),this.vbo_a=new VertexBuffer(e),this.prog.set_attribute("a_angle","float",this.vbo_a),this.vbo_linewidth=new VertexBuffer(e),this.vbo_fg_color=new VertexBuffer(e),this.vbo_bg_color=new VertexBuffer(e),this.index_buffer=new IndexBuffer(e)}static is_supported(e){switch(e){case"asterisk":case"circle":case"circle_cross":case"circle_x":case"cross":case"diamond":case"diamond_cross":case"hex":case"inverted_triangle":case"square":case"square_cross":case"square_x":case"star":case"triangle":case"x":return!0;default:return!1}}draw(e,t,i){const n=t.glglyph,{nvertices:o}=n;if(n.data_changed&&(n._set_data(o),this.glyph instanceof CircleView&&null!=this.glyph.radius&&this.vbo_s.set_data(0,map(this.glyph.sradius,(e=>2*e))),n.data_changed=!1),this.visuals_changed&&(this._set_visuals(o),this.visuals_changed=!1),this.prog.set_uniform("u_pixel_ratio","float",[i.pixel_ratio]),this.prog.set_uniform("u_canvas_size","vec2",[i.width,i.height]),this.prog.set_attribute("a_sx","float",n.vbo_sx),this.prog.set_attribute("a_sy","float",n.vbo_sy),this.prog.set_attribute("a_size","float",n.vbo_s),this.prog.set_attribute("a_angle","float",n.vbo_a),0!=e.length)if(e.length===o)this.prog.draw(this.gl.POINTS,[0,o]);else if(o<65535){const t=window.navigator.userAgent;t.indexOf("MSIE ")+t.indexOf("Trident/")+t.indexOf("Edge/")>0&&logger.warn("WebGL warning: IE is known to produce 1px sprites whith selections."),this.index_buffer.set_size(2*e.length),this.index_buffer.set_data(0,new Uint16Array(e)),this.prog.draw(this.gl.POINTS,this.index_buffer)}else{const t=64e3,i=[];for(let e=0,n=Math.ceil(o/t);e<n;e++)i.push([]);for(let n=0,o=e.length;n<o;n++){const o=e[n]%t;i[Math.floor(e[n]/t)].push(o)}for(let e=0,o=i.length;e<o;e++){const o=new Uint16Array(i[e]),r=e*t*4;0!==o.length&&(this.prog.set_attribute("a_sx","float",n.vbo_sx,0,r),this.prog.set_attribute("a_sy","float",n.vbo_sy,0,r),this.prog.set_attribute("a_size","float",n.vbo_s,0,r),this.prog.set_attribute("a_angle","float",n.vbo_a,0,r),this.vbo_linewidth.used&&this.prog.set_attribute("a_linewidth","float",this.vbo_linewidth,0,r),this.vbo_fg_color.used&&this.prog.set_attribute("a_fg_color","vec4_uint8",this.vbo_fg_color,0,4*r,!0),this.vbo_bg_color.used&&this.prog.set_attribute("a_bg_color","vec4_uint8",this.vbo_bg_color,0,4*r,!0),this.index_buffer.set_size(2*o.length),this.index_buffer.set_data(0,o),this.prog.draw(this.gl.POINTS,this.index_buffer))}}}_set_data(e){const t=4*e;this.vbo_sx.set_size(t),this.vbo_sy.set_size(t),this.vbo_a.set_size(t),this.vbo_s.set_size(t),this.vbo_sx.set_data(0,this.glyph.sx),this.vbo_sy.set_data(0,this.glyph.sy),null!=this.glyph.angle&&this.vbo_a.set_data(0,new Float32Array(this.glyph.angle)),this.glyph instanceof CircleView&&null!=this.glyph.radius?this.vbo_s.set_data(0,map(this.glyph.sradius,(e=>2*e))):this.vbo_s.set_data(0,new Float32Array(this.glyph.size))}_set_visuals(e){const{line:t,fill:i}=this.glyph.visuals;attach_float(this.prog,this.vbo_linewidth,"a_linewidth",e,t,t.line_width),attach_color(this.prog,this.vbo_fg_color,"a_fg_color",e,t,t.line_color,t.line_alpha),attach_color(this.prog,this.vbo_bg_color,"a_bg_color",e,i,i.fill_color,i.fill_alpha),this.prog.set_uniform("u_antialias","float",[.8])}}MarkerGL.__name__="MarkerGL";class CircleView extends XYGlyphView{initialize(){super.initialize();const{webgl:e}=this.renderer.plot_view.canvas_view;null!=e&&(this.glglyph=new MarkerGL(e.gl,this,"circle"))}get use_radius(){return!(this.radius.is_Scalar()&&isNaN(this.radius.value))}_map_data(){if(this.use_radius)if("data"==this.model.properties.radius.units)switch(this.model.radius_dimension){case"x":this.sradius=this.sdist(this.renderer.xscale,this._x,this.radius);break;case"y":this.sradius=this.sdist(this.renderer.yscale,this._y,this.radius);break;case"max":{const e=this.sdist(this.renderer.xscale,this._x,this.radius),t=this.sdist(this.renderer.yscale,this._y,this.radius);this.sradius=map(e,((e,i)=>Math.max(e,t[i])));break}case"min":{const e=this.sdist(this.renderer.xscale,this._x,this.radius),t=this.sdist(this.renderer.yscale,this._y,this.radius);this.sradius=map(e,((e,i)=>Math.min(e,t[i])));break}}else this.sradius=to_screen(this.radius),this._configure("max_size",{value:2*this.max_radius});else{const e=new ScreenArray(this.size);this.sradius=map(e,(e=>e/2))}}_mask_data(){const{frame:e}=this.renderer.plot_view,t=e.x_target,i=e.y_target;let n,o;return this.use_radius&&"data"==this.model.properties.radius.units?(n=t.map((e=>this.renderer.xscale.invert(e))).widen(this.max_radius),o=i.map((e=>this.renderer.yscale.invert(e))).widen(this.max_radius)):(n=t.widen(this.max_size).map((e=>this.renderer.xscale.invert(e))),o=i.widen(this.max_size).map((e=>this.renderer.yscale.invert(e)))),this.index.indices({x0:n.start,x1:n.end,y0:o.start,y1:o.end})}_render(e,t,i){const{sx:n,sy:o,sradius:r}=null!=i?i:this;for(const s of t){const t=n[s],i=o[s],a=r[s];isNaN(t+i+a)||(e.beginPath(),e.arc(t,i,a,0,2*Math.PI,!1),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,s),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,s),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,s),e.stroke()))}}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i),{hit_dilation:r}=this.model;let s,a,l,c;if(this.use_radius&&"data"==this.model.properties.radius.units)s=n-this.max_radius*r,a=n+this.max_radius*r,l=o-this.max_radius*r,c=o+this.max_radius*r;else{const e=t-this.max_size*r,n=t+this.max_size*r;[s,a]=this.renderer.xscale.r_invert(e,n);const o=i-this.max_size*r,d=i+this.max_size*r;[l,c]=this.renderer.yscale.r_invert(o,d)}const d=this.index.indices({x0:s,x1:a,y0:l,y1:c}),h=[];if(this.use_radius&&"data"==this.model.properties.radius.units)for(const u of d){const e=(this.sradius[u]*r)**2,[t,i]=this.renderer.xscale.r_compute(n,this._x[u]),[s,a]=this.renderer.yscale.r_compute(o,this._y[u]);(t-i)**2+(s-a)**2<=e&&h.push(u)}else for(const u of d){const e=(this.sradius[u]*r)**2;(this.sx[u]-t)**2+(this.sy[u]-i)**2<=e&&h.push(u)}return new Selection({indices:h})}_hit_span(e){const{sx:t,sy:i}=e,n=this.bounds();let o,r,s,a;if("h"==e.direction){let e,i;if(s=n.y0,a=n.y1,this.use_radius&&"data"==this.model.properties.radius.units)e=t-this.max_radius,i=t+this.max_radius,[o,r]=this.renderer.xscale.r_invert(e,i);else{const n=this.max_size/2;e=t-n,i=t+n,[o,r]=this.renderer.xscale.r_invert(e,i)}}else{let e,t;if(o=n.x0,r=n.x1,this.use_radius&&"data"==this.model.properties.radius.units)e=i-this.max_radius,t=i+this.max_radius,[s,a]=this.renderer.yscale.r_invert(e,t);else{const n=this.max_size/2;e=i-n,t=i+n,[s,a]=this.renderer.yscale.r_invert(e,t)}}const l=[...this.index.indices({x0:o,x1:r,y0:s,y1:a})];return new Selection({indices:l})}_hit_rect(e){const{sx0:t,sx1:i,sy0:n,sy1:o}=e,[r,s]=this.renderer.xscale.r_invert(t,i),[a,l]=this.renderer.yscale.r_invert(n,o),c=[...this.index.indices({x0:r,x1:s,y0:a,y1:l})];return new Selection({indices:c})}_hit_poly(e){const{sx:t,sy:i}=e,n=range(0,this.sx.length),o=[];for(let r=0,s=n.length;r<s;r++){const e=n[r];point_in_poly(this.sx[r],this.sy[r],t,i)&&o.push(e)}return new Selection({indices:o})}draw_legend_for_index(e,{x0:t,y0:i,x1:n,y1:o},r){const s=r+1,a=new Array(s);a[r]=(t+n)/2;const l=new Array(s);l[r]=(i+o)/2;const c=new Array(s);c[r]=.2*Math.min(Math.abs(n-t),Math.abs(o-i)),this._render(e,[r],{sx:a,sy:l,sradius:c})}}CircleView.__name__="CircleView";class Circle extends XYGlyph{constructor(e){super(e)}static init_Circle(){this.prototype.default_view=CircleView,this.mixins([LineVector$1,FillVector$1,HatchVector$1]),this.define((({Number:e})=>({angle:[AngleSpec,0],size:[ScreenDistanceSpec,{value:4}],radius:[NullDistanceSpec,null],radius_dimension:[RadiusDimension,"x"],hit_dilation:[e,1]})))}}Circle.__name__="Circle",Circle.init_Circle();class CenterRotatableView extends XYGlyphView{get max_w2(){return"data"==this.model.properties.width.units?this.max_width/2:0}get max_h2(){return"data"==this.model.properties.height.units?this.max_height/2:0}_bounds({x0:e,x1:t,y0:i,y1:n}){const{max_w2:o,max_h2:r}=this;return{x0:e-o,x1:t+o,y0:i-r,y1:n+r}}}CenterRotatableView.__name__="CenterRotatableView";class CenterRotatable extends XYGlyph{constructor(e){super(e)}static init_CenterRotatable(){this.mixins([LineVector$1,FillVector$1,HatchVector$1]),this.define((({})=>({angle:[AngleSpec,0],width:[DistanceSpec,{field:"width"}],height:[DistanceSpec,{field:"height"}]})))}}CenterRotatable.__name__="CenterRotatable",CenterRotatable.init_CenterRotatable();class EllipseOvalView extends CenterRotatableView{_map_data(){"data"==this.model.properties.width.units?this.sw=this.sdist(this.renderer.xscale,this._x,this.width,"center"):this.sw=to_screen(this.width),"data"==this.model.properties.height.units?this.sh=this.sdist(this.renderer.yscale,this._y,this.height,"center"):this.sh=to_screen(this.height)}_render(e,t,i){const{sx:n,sy:o,sw:r,sh:s,angle:a}=null!=i?i:this;for(const l of t){const t=n[l],i=o[l],c=r[l],d=s[l],h=a.get(l);isNaN(t+i+c+d+h)||(e.beginPath(),e.ellipse(t,i,c/2,d/2,h,0,2*Math.PI),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,l),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,l),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,l),e.stroke()))}}_hit_point(e){let t,i,n,o,r,s,a,l,c;const{sx:d,sy:h}=e,u=this.renderer.xscale.invert(d),p=this.renderer.yscale.invert(h);"data"==this.model.properties.width.units?(t=u-this.max_width,i=u+this.max_width):(s=d-this.max_width,a=d+this.max_width,[t,i]=this.renderer.xscale.r_invert(s,a)),"data"==this.model.properties.height.units?(n=p-this.max_height,o=p+this.max_height):(l=h-this.max_height,c=h+this.max_height,[n,o]=this.renderer.yscale.r_invert(l,c));const _=this.index.indices({x0:t,x1:i,y0:n,y1:o}),f=[];for(const g of _)r=point_in_ellipse(d,h,this.angle.get(g),this.sh[g]/2,this.sw[g]/2,this.sx[g],this.sy[g]),r&&f.push(g);return new Selection({indices:f})}draw_legend_for_index(e,{x0:t,y0:i,x1:n,y1:o},r){const s=r+1,a=new Array(s);a[r]=(t+n)/2;const l=new Array(s);l[r]=(i+o)/2;const c=this.sw[r]/this.sh[r],d=.8*Math.min(Math.abs(n-t),Math.abs(o-i)),h=new Array(s),u=new Array(s);c>1?(h[r]=d,u[r]=d/c):(h[r]=d*c,u[r]=d);const p=new UniformScalar(0,s);this._render(e,[r],{sx:a,sy:l,sw:h,sh:u,angle:p})}}EllipseOvalView.__name__="EllipseOvalView";class EllipseOval extends CenterRotatable{constructor(e){super(e)}}EllipseOval.__name__="EllipseOval";class EllipseView extends EllipseOvalView{}EllipseView.__name__="EllipseView";class Ellipse extends EllipseOval{constructor(e){super(e)}static init_Ellipse(){this.prototype.default_view=EllipseView}}Ellipse.__name__="Ellipse",Ellipse.init_Ellipse();class BoxView$1 extends GlyphView{get_anchor_point(e,t,i){const n=Math.min(this.sleft[t],this.sright[t]),o=Math.max(this.sright[t],this.sleft[t]),r=Math.min(this.stop[t],this.sbottom[t]),s=Math.max(this.sbottom[t],this.stop[t]);switch(e){case"top_left":return{x:n,y:r};case"top":case"top_center":return{x:(n+o)/2,y:r};case"top_right":return{x:o,y:r};case"bottom_left":return{x:n,y:s};case"bottom":case"bottom_center":return{x:(n+o)/2,y:s};case"bottom_right":return{x:o,y:s};case"left":case"center_left":return{x:n,y:(r+s)/2};case"center":case"center_center":return{x:(n+o)/2,y:(r+s)/2};case"right":case"center_right":return{x:o,y:(r+s)/2}}}_index_data(e){const{min:t,max:i}=Math,{data_size:n}=this;for(let o=0;o<n;o++){const[n,r,s,a]=this._lrtb(o);isNaN(n+r+s+a)||!isFinite(n+r+s+a)?e.add_empty():e.add(t(n,r),t(s,a),i(r,n),i(s,a))}}_render(e,t,i){const{sleft:n,sright:o,stop:r,sbottom:s}=null!=i?i:this;for(const a of t){let t=function(){e.beginPath(),e.rect(i,l,c-i,d-l)};const i=n[a],l=r[a],c=o[a],d=s[a];isNaN(i+l+c+d)||(this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,a),t(),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,a),t(),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,a),t(),e.stroke()))}}_clamp_viewport(){const e=this.renderer.plot_view.frame.bbox.h_range,t=this.renderer.plot_view.frame.bbox.v_range,i=this.stop.length;for(let n=0;n<i;n++)this.stop[n]=Math.max(this.stop[n],t.start),this.sbottom[n]=Math.min(this.sbottom[n],t.end),this.sleft[n]=Math.max(this.sleft[n],e.start),this.sright[n]=Math.min(this.sright[n],e.end)}_hit_rect(e){return this._hit_rect_against_index(e)}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i),r=[...this.index.indices({x0:n,y0:o,x1:n,y1:o})];return new Selection({indices:r})}_hit_span(e){const{sx:t,sy:i}=e;let n;if("v"==e.direction){const e=this.renderer.yscale.invert(i),t=this.renderer.plot_view.frame.bbox.h_range,[o,r]=this.renderer.xscale.r_invert(t.start,t.end);n=[...this.index.indices({x0:o,y0:e,x1:r,y1:e})]}else{const e=this.renderer.xscale.invert(t),i=this.renderer.plot_view.frame.bbox.v_range,[o,r]=this.renderer.yscale.r_invert(i.start,i.end);n=[...this.index.indices({x0:e,y0:o,x1:e,y1:r})]}return new Selection({indices:n})}draw_legend_for_index(e,t,i){generic_area_vector_legend(this.visuals,e,t,i)}}BoxView$1.__name__="BoxView";class Box$1 extends Glyph{constructor(e){super(e)}static init_Box(){this.mixins([LineVector$1,FillVector$1,HatchVector$1])}}Box$1.__name__="Box",Box$1.init_Box();class HBarView extends BoxView$1{scenterxy(e){return[(this.sleft[e]+this.sright[e])/2,this.sy[e]]}_lrtb(e){const t=this._left[e],i=this._right[e],n=this._y[e],o=this.height.get(e)/2;return[Math.min(t,i),Math.max(t,i),n+o,n-o]}_map_data(){this.sy=this.renderer.yscale.v_compute(this._y),this.sh=this.sdist(this.renderer.yscale,this._y,this.height,"center"),this.sleft=this.renderer.xscale.v_compute(this._left),this.sright=this.renderer.xscale.v_compute(this._right);const e=this.sy.length;this.stop=new ScreenArray(e),this.sbottom=new ScreenArray(e);for(let t=0;t<e;t++)this.stop[t]=this.sy[t]-this.sh[t]/2,this.sbottom[t]=this.sy[t]+this.sh[t]/2;this._clamp_viewport()}}HBarView.__name__="HBarView";class HBar extends Box$1{constructor(e){super(e)}static init_HBar(){this.prototype.default_view=HBarView,this.define((({})=>({left:[XCoordinateSpec,{value:0}],y:[YCoordinateSpec,{field:"y"}],height:[NumberSpec,{value:1}],right:[XCoordinateSpec,{field:"right"}]})))}}HBar.__name__="HBar",HBar.init_HBar();class HexTileView extends GlyphView{scenterxy(e){return[this.sx[e],this.sy[e]]}_set_data(){const{orientation:e,size:t,aspect_scale:i}=this.model,{q:n,r:o}=this,r=this.q.length;this._x=new Float64Array(r),this._y=new Float64Array(r);const{_x:s,_y:a}=this,l=Math.sqrt(3);if("pointytop"==e)for(let c=0;c<r;c++){const e=n.get(c),r=o.get(c)/2;s[c]=t*l*(e+r)/i,a[c]=-3*t*r}else for(let c=0;c<r;c++){const e=n.get(c)/2,r=o.get(c);s[c]=3*t*e,a[c]=-t*l*(r+e)*i}}_project_data(){inplace.project_xy(this._x,this._y)}_index_data(e){let t=this.model.size,i=Math.sqrt(3)*t/2;"flattop"==this.model.orientation?([i,t]=[t,i],t*=this.model.aspect_scale):i/=this.model.aspect_scale;const{data_size:n}=this;for(let o=0;o<n;o++){const n=this._x[o],r=this._y[o];isNaN(n+r)||!isFinite(n+r)?e.add_empty():e.add(n-i,r-t,n+i,r+t)}}map_data(){[this.sx,this.sy]=this.renderer.coordinates.map_to_screen(this._x,this._y),[this.svx,this.svy]=this._get_unscaled_vertices()}_get_unscaled_vertices(){const e=this.model.size,t=this.model.aspect_scale;if("pointytop"==this.model.orientation){const i=this.renderer.yscale,n=this.renderer.xscale,o=Math.abs(i.compute(0)-i.compute(e)),r=Math.sqrt(3)/2*Math.abs(n.compute(0)-n.compute(e))/t,s=o/2;return[[0,-r,-r,0,r,r],[o,s,-s,-o,-s,s]]}{const i=this.renderer.xscale,n=this.renderer.yscale,o=Math.abs(i.compute(0)-i.compute(e)),r=Math.sqrt(3)/2*Math.abs(n.compute(0)-n.compute(e))*t,s=o/2;return[[o,s,-s,-o,-s,s],[0,-r,-r,0,r,r]]}}_render(e,t,i){const{sx:n,sy:o,svx:r,svy:s,scale:a}=null!=i?i:this;for(const l of t){const t=n[l],i=o[l],c=a.get(l);if(!isNaN(t+i+c)){e.translate(t,i),e.beginPath();for(let t=0;t<6;t++)e.lineTo(r[t]*c,s[t]*c);e.closePath(),e.translate(-t,-i),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,l),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,l),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,l),e.stroke())}}}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i),r=this.index.indices({x0:n,y0:o,x1:n,y1:o}),s=[];for(const a of r)point_in_poly(t-this.sx[a],i-this.sy[a],this.svx,this.svy)&&s.push(a);return new Selection({indices:s})}_hit_span(e){const{sx:t,sy:i}=e;let n;if("v"==e.direction){const e=this.renderer.yscale.invert(i),t=this.renderer.plot_view.frame.bbox.h_range,[o,r]=this.renderer.xscale.r_invert(t.start,t.end);n=[...this.index.indices({x0:o,y0:e,x1:r,y1:e})]}else{const e=this.renderer.xscale.invert(t),i=this.renderer.plot_view.frame.bbox.v_range,[o,r]=this.renderer.yscale.r_invert(i.start,i.end);n=[...this.index.indices({x0:e,y0:o,x1:e,y1:r})]}return new Selection({indices:n})}_hit_rect(e){const{sx0:t,sx1:i,sy0:n,sy1:o}=e,[r,s]=this.renderer.xscale.r_invert(t,i),[a,l]=this.renderer.yscale.r_invert(n,o),c=[...this.index.indices({x0:r,x1:s,y0:a,y1:l})];return new Selection({indices:c})}draw_legend_for_index(e,t,i){generic_area_vector_legend(this.visuals,e,t,i)}}HexTileView.__name__="HexTileView";class HexTile extends Glyph{constructor(e){super(e)}static init_HexTile(){this.prototype.default_view=HexTileView,this.mixins([LineVector$1,FillVector$1,HatchVector$1]),this.define((({Number:e})=>({r:[NumberSpec,{field:"r"}],q:[NumberSpec,{field:"q"}],scale:[NumberSpec,1],size:[e,1],aspect_scale:[e,1],orientation:[HexTileOrientation,"pointytop"]}))),this.override({line_color:null})}}HexTile.__name__="HexTile",HexTile.init_HexTile();class ImageBaseView extends XYGlyphView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.global_alpha.change,(()=>this.renderer.request_render()))}_render(e,t,i){const{image_data:n,sx:o,sy:r,sw:s,sh:a}=null!=i?i:this,l=e.getImageSmoothingEnabled();e.setImageSmoothingEnabled(!1),e.globalAlpha=this.model.global_alpha;for(const c of t){const t=n[c],i=o[c],l=r[c],d=s[c],h=a[c];if(null==t||isNaN(i+l+d+h))continue;const u=l;e.translate(0,u),e.scale(1,-1),e.translate(0,-u),e.drawImage(t,0|i,0|l,d,h),e.translate(0,u),e.scale(1,-1),e.translate(0,-u)}e.setImageSmoothingEnabled(l)}_set_data(e){this._set_width_heigh_data();for(let t=0,i=this.image.length;t<i;t++){if(null!=e&&e.indexOf(t)<0)continue;const i=this.image.get(t);let n;is_NDArray(i)?(assert(2==i.dimension,"expected a 2D array"),n=i,this._height[t]=i.shape[0],this._width[t]=i.shape[1]):(n=concat$1(i),this._height[t]=i.length,this._width[t]=i[0].length);const o=this._flat_img_to_buf8(n);this._set_image_data_from_buffer(t,o)}}_index_data(e){const{data_size:t}=this;for(let i=0;i<t;i++){const[t,n,o,r]=this._lrtb(i);isNaN(t+n+o+r)||!isFinite(t+n+o+r)?e.add_empty():e.add(t,r,n,o)}}_lrtb(e){const t=this.dw.get(e),i=this.dh.get(e),n=this.renderer.xscale.source_range,o=this._x[e],r=n.is_reversed?o-t:o+t,s=this.renderer.yscale.source_range,a=this._y[e],l=s.is_reversed?a-i:a+i,[c,d]=o<r?[o,r]:[r,o],[h,u]=a<l?[a,l]:[l,a];return[c,d,u,h]}_set_width_heigh_data(){null!=this.image_data&&this.image_data.length==this.image.length||(this.image_data=new Array(this.image.length)),null!=this._width&&this._width.length==this.image.length||(this._width=new Uint32Array(this.image.length)),null!=this._height&&this._height.length==this.image.length||(this._height=new Uint32Array(this.image.length))}_get_or_create_canvas(e){const t=this.image_data[e];if(null!=t&&t.width==this._width[e]&&t.height==this._height[e])return t;{const t=document.createElement("canvas");return t.width=this._width[e],t.height=this._height[e],t}}_set_image_data_from_buffer(e,t){const i=this._get_or_create_canvas(e),n=i.getContext("2d"),o=n.getImageData(0,0,this._width[e],this._height[e]);o.data.set(t),n.putImageData(o,0,0),this.image_data[e]=i}_map_data(){"data"==this.model.properties.dw.units?this.sw=this.sdist(this.renderer.xscale,this._x,this.dw,"edge",this.model.dilate):this.sw=to_screen(this.dw),"data"==this.model.properties.dh.units?this.sh=this.sdist(this.renderer.yscale,this._y,this.dh,"edge",this.model.dilate):this.sh=to_screen(this.dh)}_image_index(e,t,i){const[n,o,r,s]=this._lrtb(e),a=this._width[e],l=this._height[e],c=(o-n)/a,d=(r-s)/l;let h=Math.floor((t-n)/c),u=Math.floor((i-s)/d);return this.renderer.xscale.source_range.is_reversed&&(h=a-h-1),this.renderer.yscale.source_range.is_reversed&&(u=l-u-1),{index:e,dim1:h,dim2:u,flat_index:u*a+h}}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i),r=this.index.indices({x0:n,x1:n,y0:o,y1:o}),s=new Selection;for(const a of r)t!=1/0&&i!=1/0&&s.image_indices.push(this._image_index(a,n,o));return s}}ImageBaseView.__name__="ImageBaseView";class ImageBase extends XYGlyph{constructor(e){super(e)}static init_ImageBase(){this.define((({Boolean:e,Alpha:t})=>({image:[NDArraySpec,{field:"image"}],dw:[DistanceSpec,{field:"dw"}],dh:[DistanceSpec,{field:"dh"}],dilate:[e,!1],global_alpha:[t,1]})))}}ImageBase.__name__="ImageBase",ImageBase.init_ImageBase();class ImageView extends ImageBaseView{connect_signals(){super.connect_signals(),this.connect(this.model.color_mapper.change,(()=>this._update_image()))}_update_image(){null!=this.image_data&&(this._set_data(null),this.renderer.request_render())}_flat_img_to_buf8(e){return this.model.color_mapper.rgba_mapper.v_compute(e)}}ImageView.__name__="ImageView";const Greys9$1=()=>["#000000","#252525","#525252","#737373","#969696","#bdbdbd","#d9d9d9","#f0f0f0","#ffffff"];class Image$1 extends ImageBase{constructor(e){super(e)}static init_Image(){this.prototype.default_view=ImageView,this.define((({Ref:e})=>({color_mapper:[e(ColorMapper),()=>new LinearColorMapper({palette:Greys9$1()})]})))}}Image$1.__name__="Image",Image$1.init_Image();class ImageRGBAView extends ImageBaseView{_flat_img_to_buf8(e){let t;return t=isArray(e)?new Uint32Array(e):e,new Uint8ClampedArray(t.buffer)}}ImageRGBAView.__name__="ImageRGBAView";class ImageRGBA extends ImageBase{constructor(e){super(e)}static init_ImageRGBA(){this.prototype.default_view=ImageRGBAView}}ImageRGBA.__name__="ImageRGBA",ImageRGBA.init_ImageRGBA();class ImageLoader{constructor(e,t={}){this._image=new Image,this._finished=!1;const{attempts:i=1,timeout:n=1}=t;this.promise=new Promise(((o,r)=>{this._image.crossOrigin="anonymous";let s=0;this._image.onerror=()=>{if(++s==i){const n=`unable to load ${e} image after ${i} attempts`;if(logger.warn(n),null==this._image.crossOrigin)return void(null!=t.failed&&t.failed());logger.warn(`attempting to load ${e} without a cross origin policy`),this._image.crossOrigin=null,s=0}setTimeout((()=>this._image.src=e),n)},this._image.onload=()=>{this._finished=!0,null!=t.loaded&&t.loaded(this._image),o(this._image)},this._image.src=e}))}get finished(){return this._finished}get image(){if(this._finished)return this._image;throw new Error("not loaded yet")}}ImageLoader.__name__="ImageLoader";class ImageURLView extends XYGlyphView{constructor(){super(...arguments),this._images_rendered=!1,this._set_data_iteration=0}connect_signals(){super.connect_signals(),this.connect(this.model.properties.global_alpha.change,(()=>this.renderer.request_render()))}_index_data(e){const{data_size:t}=this;for(let i=0;i<t;i++)e.add_empty()}_set_data(){this._set_data_iteration++;const e=this.url.length;this.image=new Array(e);const{retry_attempts:t,retry_timeout:i}=this.model,{_set_data_iteration:n}=this;for(let g=0;g<e;g++){const e=this.url.get(g);e&&new ImageLoader(e,{loaded:e=>{this._set_data_iteration==n&&(this.image[g]=e,this.renderer.request_render())},attempts:t+1,timeout:i})}const o="data"==this.model.properties.w.units,r="data"==this.model.properties.h.units,s=this._x.length,a=new ScreenArray(o?2*s:s),l=new ScreenArray(r?2*s:s),{anchor:c}=this.model;function d(e,t){switch(c){case"top_left":case"bottom_left":case"left":case"center_left":return[e,e+t];case"top":case"top_center":case"bottom":case"bottom_center":case"center":case"center_center":return[e-t/2,e+t/2];case"top_right":case"bottom_right":case"right":case"center_right":return[e-t,e]}}function h(e,t){switch(c){case"top_left":case"top":case"top_center":case"top_right":return[e,e-t];case"bottom_left":case"bottom":case"bottom_center":case"bottom_right":return[e+t,e];case"left":case"center_left":case"center":case"center_center":case"right":case"center_right":return[e+t/2,e-t/2]}}if(o)for(let g=0;g<s;g++)[a[g],a[s+g]]=d(this._x[g],this.w.get(g));else a.set(this._x,0);if(r)for(let g=0;g<s;g++)[l[g],l[s+g]]=h(this._y[g],this.h.get(g));else l.set(this._y,0);const[u,p]=minmax(a),[_,f]=minmax(l);this._bounds_rect={x0:u,x1:p,y0:_,y1:f}}has_finished(){return super.has_finished()&&1==this._images_rendered}_map_data(){"data"==this.model.properties.w.units?this.sw=this.sdist(this.renderer.xscale,this._x,this.w,"edge",this.model.dilate):this.sw=to_screen(this.w),"data"==this.model.properties.h.units?this.sh=this.sdist(this.renderer.yscale,this._y,this.h,"edge",this.model.dilate):this.sh=to_screen(this.h)}_render(e,t,i){const{image:n,sx:o,sy:r,sw:s,sh:a,angle:l}=null!=i?i:this,{frame:c}=this.renderer.plot_view;e.rect(c.bbox.left+1,c.bbox.top+1,c.bbox.width-2,c.bbox.height-2),e.clip();let d=!0;for(const h of t){if(isNaN(o[h]+r[h]+l.get(h)))continue;const t=n[h];null!=t?this._render_image(e,h,t,o,r,s,a,l):d=!1}d&&!this._images_rendered&&(this._images_rendered=!0,this.notify_finished())}_final_sx_sy(e,t,i,n,o){switch(e){case"top_left":return[t,i];case"top":case"top_center":return[t-n/2,i];case"top_right":return[t-n,i];case"right":case"center_right":return[t-n,i-o/2];case"bottom_right":return[t-n,i-o];case"bottom":case"bottom_center":return[t-n/2,i-o];case"bottom_left":return[t,i-o];case"left":case"center_left":return[t,i-o/2];case"center":case"center_center":return[t-n/2,i-o/2]}}_render_image(e,t,i,n,o,r,s,a){isNaN(r[t])&&(r[t]=i.width),isNaN(s[t])&&(s[t]=i.height);const l=r[t],c=s[t],{anchor:d}=this.model,[h,u]=this._final_sx_sy(d,n[t],o[t],l,c),p=a.get(t);e.save(),e.globalAlpha=this.model.global_alpha;const _=l/2,f=c/2;p?(e.translate(h,u),e.translate(_,f),e.rotate(p),e.translate(-_,-f),e.drawImage(i,0,0,l,c),e.translate(_,f),e.rotate(-p),e.translate(-_,-f),e.translate(-h,-u)):e.drawImage(i,h,u,l,c),e.restore()}bounds(){return this._bounds_rect}}ImageURLView.__name__="ImageURLView";class ImageURL extends XYGlyph{constructor(e){super(e)}static init_ImageURL(){this.prototype.default_view=ImageURLView,this.define((({Boolean:e,Int:t,Alpha:i})=>({url:[StringSpec,{field:"url"}],anchor:[Anchor,"top_left"],global_alpha:[i,1],angle:[AngleSpec,0],w:[NullDistanceSpec,null],h:[NullDistanceSpec,null],dilate:[e,!1],retry_attempts:[t,0],retry_timeout:[t,0]})))}}ImageURL.__name__="ImageURL",ImageURL.init_ImageURL();class MultiPolygonsView extends GlyphView{_project_data(){}_index_data(e){const{min:t,max:i}=Math,{data_size:n}=this;for(let o=0;o<n;o++){const n=this._xs[o],r=this._ys[o];if(0==n.length||0==r.length){e.add_empty();continue}let s=1/0,a=-1/0,l=1/0,c=-1/0;for(let e=0,o=n.length;e<o;e++){const o=n[e][0],d=r[e][0];if(0!=o.length&&0!=d.length){const[e,n]=minmax(o),[r,h]=minmax(d);s=t(s,e),a=i(a,n),l=t(l,r),c=i(c,h)}}isFinite(s+a+l+c)?e.add(s,l,a,c):e.add_empty()}this._hole_index=this._index_hole_data()}_index_hole_data(){const{min:e,max:t}=Math,{data_size:i}=this,n=new SpatialIndex(i);for(let o=0;o<i;o++){const i=this._xs[o],r=this._ys[o];if(0==i.length||0==r.length){n.add_empty();continue}let s=1/0,a=-1/0,l=1/0,c=-1/0;for(let n=0,o=i.length;n<o;n++){const o=i[n],d=r[n];if(o.length>1&&d.length>1)for(let i=1,n=o.length;i<n;i++){const[n,r]=minmax(o[i]),[h,u]=minmax(d[i]);s=e(s,n),a=t(a,r),l=e(l,h),c=t(c,u)}}isFinite(s+a+l+c)?n.add(s,l,a,c):n.add_empty()}return n.finish(),n}_mask_data(){const{x_range:e,y_range:t}=this.renderer.plot_view.frame;return this.index.indices({x0:e.min,x1:e.max,y0:t.min,y1:t.max})}_inner_loop(e,t,i){e.beginPath();for(let n=0,o=t.length;n<o;n++)for(let r=0,s=t[n].length;r<s;r++){const o=t[n][r],s=i[n][r];for(let t=0,i=o.length;t<i;t++)0!=t?e.lineTo(o[t],s[t]):e.moveTo(o[t],s[t]);e.closePath()}}_render(e,t,i){if(this.visuals.fill.doit||this.visuals.line.doit){const{sxs:n,sys:o}=null!=i?i:this;for(const i of t){const t=n[i],r=o[i];this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,i),this._inner_loop(e,t,r),e.fill("evenodd")),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,i),this._inner_loop(e,t,r),e.fill("evenodd")),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,i),this._inner_loop(e,t,r),e.stroke())}}}_hit_rect(e){const{sx0:t,sx1:i,sy0:n,sy1:o}=e,r=[t,i,i,t],s=[n,n,o,o],[a,l]=this.renderer.xscale.r_invert(t,i),[c,d]=this.renderer.yscale.r_invert(n,o),h=this.index.indices({x0:a,x1:l,y0:c,y1:d}),u=[];for(const p of h){const e=this.sxs[p],t=this.sys[p];let i=!0;for(let n=0,o=e.length;n<o;n++){for(let o=0,a=e[n][0].length;o<a;o++){if(!point_in_poly(e[n][0][o],t[n][0][o],r,s)){i=!1;break}}if(!i)break}i&&u.push(p)}return new Selection({indices:u})}_hit_point(e){const{sx:t,sy:i}=e,n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i),r=this.index.indices({x0:n,y0:o,x1:n,y1:o}),s=this._hole_index.indices({x0:n,y0:o,x1:n,y1:o}),a=[];for(const l of r){const e=this.sxs[l],n=this.sys[l];for(let o=0,r=e.length;o<r;o++){const r=e[o].length;if(point_in_poly(t,i,e[o][0],n[o][0]))if(1==r)a.push(l);else if(s.get(l)){if(r>1){let s=!1;for(let a=1;a<r;a++){if(point_in_poly(t,i,e[o][a],n[o][a])){s=!0;break}}s||a.push(l)}}else a.push(l)}}return new Selection({indices:a})}_get_snap_coord(e){return sum$1(e)/e.length}scenterxy(e,t,i){if(1==this.sxs[e].length){return[this._get_snap_coord(this.sxs[e][0][0]),this._get_snap_coord(this.sys[e][0][0])]}{const n=this.sxs[e],o=this.sys[e];for(let e=0,r=n.length;e<r;e++)if(point_in_poly(t,i,n[e][0],o[e][0])){return[this._get_snap_coord(n[e][0]),this._get_snap_coord(o[e][0])]}}unreachable()}map_data(){const e=this._xs.length;this.sxs=new Array(e),this.sys=new Array(e);for(let t=0;t<e;t++){const e=this._xs[t].length;this.sxs[t]=new Array(e),this.sys[t]=new Array(e);for(let i=0;i<e;i++){const e=this._xs[t][i].length;this.sxs[t][i]=new Array(e),this.sys[t][i]=new Array(e);for(let n=0;n<e;n++){const[e,o]=this.renderer.coordinates.map_to_screen(this._xs[t][i][n],this._ys[t][i][n]);this.sxs[t][i][n]=e,this.sys[t][i][n]=o}}}}draw_legend_for_index(e,t,i){generic_area_vector_legend(this.visuals,e,t,i)}}MultiPolygonsView.__name__="MultiPolygonsView";class MultiPolygons extends Glyph{constructor(e){super(e)}static init_MultiPolygons(){this.prototype.default_view=MultiPolygonsView,this.define((({})=>({xs:[XCoordinateSeqSeqSeqSpec,{field:"xs"}],ys:[YCoordinateSeqSeqSeqSpec,{field:"ys"}]}))),this.mixins([LineVector$1,FillVector$1,HatchVector$1])}}MultiPolygons.__name__="MultiPolygons",MultiPolygons.init_MultiPolygons();class OvalView extends EllipseOvalView{_map_data(){super._map_data(),mul(this.sw,.75)}}OvalView.__name__="OvalView";class Oval extends EllipseOval{constructor(e){super(e)}static init_Oval(){this.prototype.default_view=OvalView}}Oval.__name__="Oval",Oval.init_Oval();class QuadView extends BoxView$1{scenterxy(e){return[this.sleft[e]/2+this.sright[e]/2,this.stop[e]/2+this.sbottom[e]/2]}_lrtb(e){return[this._left[e],this._right[e],this._top[e],this._bottom[e]]}}QuadView.__name__="QuadView";class Quad extends Box$1{constructor(e){super(e)}static init_Quad(){this.prototype.default_view=QuadView,this.define((({})=>({right:[XCoordinateSpec,{field:"right"}],bottom:[YCoordinateSpec,{field:"bottom"}],left:[XCoordinateSpec,{field:"left"}],top:[YCoordinateSpec,{field:"top"}]})))}}function _qbb(e,t,i){if(t==(e+i)/2)return[e,i];{const n=(e-t)/(e-2*t+i),o=e*(1-n)**2+2*t*(1-n)*n+i*n**2;return[Math.min(e,i,o),Math.max(e,i,o)]}}Quad.__name__="Quad",Quad.init_Quad();class QuadraticView extends GlyphView{_project_data(){inplace.project_xy(this._x0,this._y0),inplace.project_xy(this._x1,this._y1)}_index_data(e){const{_x0:t,_x1:i,_y0:n,_y1:o,_cx:r,_cy:s,data_size:a}=this;for(let l=0;l<a;l++){const a=t[l],c=i[l],d=n[l],h=o[l],u=r[l],p=s[l];if(isNaN(a+c+d+h+u+p))e.add_empty();else{const[t,i]=_qbb(a,u,c),[n,o]=_qbb(d,p,h);e.add(t,n,i,o)}}}_render(e,t,i){if(this.visuals.line.doit){const{sx0:n,sy0:o,sx1:r,sy1:s,scx:a,scy:l}=null!=i?i:this;for(const i of t){const t=n[i],c=o[i],d=r[i],h=s[i],u=a[i],p=l[i];isNaN(t+c+d+h+u+p)||(e.beginPath(),e.moveTo(t,c),e.quadraticCurveTo(u,p,d,h),this.visuals.line.set_vectorize(e,i),e.stroke())}}}draw_legend_for_index(e,t,i){generic_line_vector_legend(this.visuals,e,t,i)}scenterxy(){throw new Error(`${this}.scenterxy() is not implemented`)}}QuadraticView.__name__="QuadraticView";class Quadratic extends Glyph{constructor(e){super(e)}static init_Quadratic(){this.prototype.default_view=QuadraticView,this.define((({})=>({x0:[XCoordinateSpec,{field:"x0"}],y0:[YCoordinateSpec,{field:"y0"}],x1:[XCoordinateSpec,{field:"x1"}],y1:[YCoordinateSpec,{field:"y1"}],cx:[XCoordinateSpec,{field:"cx"}],cy:[YCoordinateSpec,{field:"cy"}]}))),this.mixins(LineVector$1)}}Quadratic.__name__="Quadratic",Quadratic.init_Quadratic();class RayView extends XYGlyphView{_map_data(){"data"==this.model.properties.length.units?this.slength=this.sdist(this.renderer.xscale,this._x,this.length):this.slength=to_screen(this.length);const{width:e,height:t}=this.renderer.plot_view.frame.bbox,i=2*(e+t),{slength:n}=this;for(let o=0,r=n.length;o<r;o++)0==n[o]&&(n[o]=i)}_render(e,t,i){const{sx:n,sy:o,slength:r,angle:s}=null!=i?i:this;if(this.visuals.line.doit)for(const a of t){const t=n[a],i=o[a],l=s.get(a),c=r[a];isNaN(t+i+l+c)||(e.translate(t,i),e.rotate(l),e.beginPath(),e.moveTo(0,0),e.lineTo(c,0),this.visuals.line.set_vectorize(e,a),e.stroke(),e.rotate(-l),e.translate(-t,-i))}}draw_legend_for_index(e,t,i){generic_line_vector_legend(this.visuals,e,t,i)}}RayView.__name__="RayView";class Ray extends XYGlyph{constructor(e){super(e)}static init_Ray(){this.prototype.default_view=RayView,this.mixins(LineVector$1),this.define((({})=>({length:[DistanceSpec,0],angle:[AngleSpec,0]})))}}Ray.__name__="Ray",Ray.init_Ray();class RectView extends CenterRotatableView{_map_data(){if("data"==this.model.properties.width.units)[this.sw,this.sx0]=this._map_dist_corner_for_data_side_length(this._x,this.width,this.renderer.xscale);else{this.sw=to_screen(this.width);const e=this.sx.length;this.sx0=new ScreenArray(e);for(let t=0;t<e;t++)this.sx0[t]=this.sx[t]-this.sw[t]/2}if("data"==this.model.properties.height.units)[this.sh,this.sy1]=this._map_dist_corner_for_data_side_length(this._y,this.height,this.renderer.yscale);else{this.sh=to_screen(this.height);const e=this.sy.length;this.sy1=new ScreenArray(e);for(let t=0;t<e;t++)this.sy1[t]=this.sy[t]-this.sh[t]/2}const e=this.sw.length;this.ssemi_diag=new ScreenArray(e);for(let t=0;t<e;t++)this.ssemi_diag[t]=Math.sqrt(this.sw[t]/2*this.sw[t]/2+this.sh[t]/2*this.sh[t]/2)}_render(e,t,i){const{sx:n,sy:o,sx0:r,sy1:s,sw:a,sh:l,angle:c}=null!=i?i:this;for(const d of t){const t=n[d],i=o[d],h=r[d],u=s[d],p=a[d],_=l[d],f=c.get(d);isNaN(t+i+h+u+p+_+f)||0!=p&&0!=_&&(e.beginPath(),f?(e.translate(t,i),e.rotate(f),e.rect(-p/2,-_/2,p,_),e.rotate(-f),e.translate(-t,-i)):e.rect(h,u,p,_),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,d),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,d),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,d),e.stroke()))}}_hit_rect(e){return this._hit_rect_against_index(e)}_hit_point(e){let{sx:t,sy:i}=e;const n=this.renderer.xscale.invert(t),o=this.renderer.yscale.invert(i),r=this.sx0.length,s=new ScreenArray(r);for(let m=0;m<r;m++)s[m]=this.sx0[m]+this.sw[m]/2;const a=new ScreenArray(r);for(let m=0;m<r;m++)a[m]=this.sy1[m]+this.sh[m]/2;const l=max$7(this._ddist(0,s,this.ssemi_diag)),c=max$7(this._ddist(1,a,this.ssemi_diag)),d=n-l,h=n+l,u=o-c,p=o+c;let _,f;const g=[];for(const m of this.index.indices({x0:d,x1:h,y0:u,y1:p})){const e=this.angle.get(m);if(e){const n=Math.sin(-e),o=Math.cos(-e),r=o*(t-this.sx[m])-n*(i-this.sy[m])+this.sx[m],s=n*(t-this.sx[m])+o*(i-this.sy[m])+this.sy[m];t=r,i=s,_=Math.abs(this.sx[m]-t)<=this.sw[m]/2,f=Math.abs(this.sy[m]-i)<=this.sh[m]/2}else{const e=t-this.sx0[m],n=i-this.sy1[m];_=0<=e&&e<=this.sw[m],f=0<=n&&n<=this.sh[m]}_&&f&&g.push(m)}return new Selection({indices:g})}_map_dist_corner_for_data_side_length(e,t,i){const n=e.length,o=new Float64Array(n),r=new Float64Array(n);for(let d=0;d<n;d++){const i=e[d],n=t.get(d)/2;o[d]=i-n,r[d]=i+n}const s=i.v_compute(o),a=i.v_compute(r),l=this.sdist(i,o,t,"edge",this.model.dilate);let c=s;for(let d=0;d<n;d++){const e=s[d],t=a[d];if(!isNaN(e+t)&&e!=t){c=e<t?s:a;break}}return[l,c]}_ddist(e,t,i){const n=infer_type(t,i),o=0==e?this.renderer.xscale:this.renderer.yscale,r=t,s=r.length,a=new n(s);for(let u=0;u<s;u++)a[u]=r[u]+i[u];const l=o.v_invert(r),c=o.v_invert(a),d=l.length,h=new n(d);for(let u=0;u<d;u++)h[u]=Math.abs(c[u]-l[u]);return h}draw_legend_for_index(e,t,i){generic_area_vector_legend(this.visuals,e,t,i)}}RectView.__name__="RectView";class Rect extends CenterRotatable{constructor(e){super(e)}static init_Rect(){this.prototype.default_view=RectView,this.define((({Boolean:e})=>({dilate:[e,!1]})))}}Rect.__name__="Rect",Rect.init_Rect();class MarkerView extends XYGlyphView{_render(e,t,i){const{sx:n,sy:o,size:r,angle:s}=null!=i?i:this;for(const a of t){const t=n[a],i=o[a],l=r.get(a),c=s.get(a);if(isNaN(t+i+l+c))continue;const d=l/2;e.beginPath(),e.translate(t,i),c&&e.rotate(c),this._render_one(e,a,d,this.visuals),c&&e.rotate(-c),e.translate(-t,-i)}}_mask_data(){const{x_target:e,y_target:t}=this.renderer.plot_view.frame,i=e.widen(this.max_size).map((e=>this.renderer.xscale.invert(e))),n=t.widen(this.max_size).map((e=>this.renderer.yscale.invert(e)));return this.index.indices({x0:i.start,x1:i.end,y0:n.start,y1:n.end})}_hit_point(e){const{sx:t,sy:i}=e,{max_size:n}=this,{hit_dilation:o}=this.model,r=t-n*o,s=t+n*o,[a,l]=this.renderer.xscale.r_invert(r,s),c=i-n*o,d=i+n*o,[h,u]=this.renderer.yscale.r_invert(c,d),p=this.index.indices({x0:a,x1:l,y0:h,y1:u}),_=[];for(const f of p){const e=this.size.get(f)/2*o;Math.abs(this.sx[f]-t)<=e&&Math.abs(this.sy[f]-i)<=e&&_.push(f)}return new Selection({indices:_})}_hit_span(e){const{sx:t,sy:i}=e,n=this.bounds(),o=this.max_size/2;let r,s,a,l;if("h"==e.direction){a=n.y0,l=n.y1;const e=t-o,i=t+o;[r,s]=this.renderer.xscale.r_invert(e,i)}else{r=n.x0,s=n.x1;const e=i-o,t=i+o;[a,l]=this.renderer.yscale.r_invert(e,t)}const c=[...this.index.indices({x0:r,x1:s,y0:a,y1:l})];return new Selection({indices:c})}_hit_rect(e){const{sx0:t,sx1:i,sy0:n,sy1:o}=e,[r,s]=this.renderer.xscale.r_invert(t,i),[a,l]=this.renderer.yscale.r_invert(n,o),c=[...this.index.indices({x0:r,x1:s,y0:a,y1:l})];return new Selection({indices:c})}_hit_poly(e){const{sx:t,sy:i}=e,n=range(0,this.sx.length),o=[];for(let r=0,s=n.length;r<s;r++){const e=n[r];point_in_poly(this.sx[r],this.sy[r],t,i)&&o.push(e)}return new Selection({indices:o})}_get_legend_args({x0:e,x1:t,y0:i,y1:n},o){const r=o+1,s=new Array(r),a=new Array(r);s[o]=(e+t)/2,a[o]=(i+n)/2;const l=.4*Math.min(Math.abs(t-e),Math.abs(n-i));return{sx:s,sy:a,size:new UniformScalar(l,r),angle:new UniformScalar(0,r)}}draw_legend_for_index(e,{x0:t,x1:i,y0:n,y1:o},r){const s=this._get_legend_args({x0:t,x1:i,y0:n,y1:o},r);this._render(e,[r],s)}}MarkerView.__name__="MarkerView";class Marker extends XYGlyph{constructor(e){super(e)}static init_Marker(){this.mixins([LineVector$1,FillVector$1,HatchVector$1]),this.define((({Number:e})=>({size:[ScreenDistanceSpec,{value:4}],angle:[AngleSpec,0],hit_dilation:[e,1]})))}}Marker.__name__="Marker",Marker.init_Marker();const SQ3=Math.sqrt(3),SQ5=Math.sqrt(5),c36=(SQ5+1)/4,s36=Math.sqrt((5-SQ5)/8),c72=(SQ5-1)/4,s72=Math.sqrt((5+SQ5)/8);function _one_line(e,t){e.moveTo(-t,0),e.lineTo(t,0)}function _one_x(e,t){e.rotate(Math.PI/4),_one_cross(e,t),e.rotate(-Math.PI/4)}function _one_y(e,t){const i=t*SQ3,n=i/3;e.moveTo(-i/2,-n),e.lineTo(0,0),e.lineTo(i/2,-n),e.lineTo(0,0),e.lineTo(0,t)}function _one_cross(e,t){e.moveTo(0,t),e.lineTo(0,-t),e.moveTo(-t,0),e.lineTo(t,0)}function _one_dot(e,t){e.beginPath(),e.arc(0,0,t/4,0,2*Math.PI,!1),e.closePath()}function _one_diamond(e,t){e.moveTo(0,t),e.lineTo(t/1.5,0),e.lineTo(0,-t),e.lineTo(-t/1.5,0),e.closePath()}function _one_hex(e,t){const i=t/2,n=SQ3*i;e.moveTo(t,0),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-t,0),e.lineTo(-i,n),e.lineTo(i,n),e.closePath()}function _one_star(e,t){const i=Math.sqrt(5-2*SQ5)*t;e.moveTo(0,-t),e.lineTo(i*c72,i*s72-t),e.lineTo(i*(1+c72),i*s72-t),e.lineTo(i*(1+c72-c36),i*(s72+s36)-t),e.lineTo(i*(1+2*c72-c36),i*(2*s72+s36)-t),e.lineTo(0,2*i*s72-t),e.lineTo(-i*(1+2*c72-c36),i*(2*s72+s36)-t),e.lineTo(-i*(1+c72-c36),i*(s72+s36)-t),e.lineTo(-i*(1+c72),i*s72-t),e.lineTo(-i*c72,i*s72-t),e.closePath()}function _one_tri(e,t){const i=t*SQ3,n=i/3;e.moveTo(-t,n),e.lineTo(t,n),e.lineTo(0,n-i),e.closePath()}function asterisk(e,t,i,n){_one_cross(e,i),_one_x(e,i),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function circle(e,t,i,n){e.arc(0,0,i,0,2*Math.PI,!1),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function circle_cross(e,t,i,n){e.arc(0,0,i,0,2*Math.PI,!1),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),_one_cross(e,i),e.stroke())}function circle_dot(e,t,i,n){circle(e,t,i,n),dot(e,t,i,n)}function circle_y(e,t,i,n){e.arc(0,0,i,0,2*Math.PI,!1),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),_one_y(e,i),e.stroke())}function circle_x(e,t,i,n){e.arc(0,0,i,0,2*Math.PI,!1),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),_one_x(e,i),e.stroke())}function cross(e,t,i,n){_one_cross(e,i),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function diamond(e,t,i,n){_one_diamond(e,i),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function diamond_cross(e,t,i,n){_one_diamond(e,i),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.moveTo(0,i),e.lineTo(0,-i),e.moveTo(-i/1.5,0),e.lineTo(i/1.5,0),e.stroke())}function diamond_dot(e,t,i,n){diamond(e,t,i,n),dot(e,t,i,n)}function dot(e,t,i,n){_one_dot(e,i),n.line.set_vectorize(e,t),e.fillStyle=e.strokeStyle,e.fill()}function hex(e,t,i,n){_one_hex(e,i),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function hex_dot(e,t,i,n){hex(e,t,i,n),dot(e,t,i,n)}function inverted_triangle(e,t,i,n){e.rotate(Math.PI),_one_tri(e,i),e.rotate(-Math.PI),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function plus(e,t,i,n){const o=3*i/8,r=[o,o,i,i,o,o,-o,-o,-i,-i,-o,-o],s=[i,o,o,-o,-o,-i,-i,-o,-o,o,o,i];e.beginPath();for(let a=0;a<12;a++)e.lineTo(r[a],s[a]);e.closePath(),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function square(e,t,i,n){const o=2*i;e.rect(-i,-i,o,o),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function square_pin(e,t,i,n){const o=3*i/8;e.moveTo(-i,-i),e.quadraticCurveTo(0,-o,i,-i),e.quadraticCurveTo(o,0,i,i),e.quadraticCurveTo(0,o,-i,i),e.quadraticCurveTo(-o,0,-i,-i),e.closePath(),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function square_cross(e,t,i,n){const o=2*i;e.rect(-i,-i,o,o),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),_one_cross(e,i),e.stroke())}function square_dot(e,t,i,n){square(e,t,i,n),dot(e,t,i,n)}function square_x(e,t,i,n){const o=2*i;e.rect(-i,-i,o,o),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.moveTo(-i,i),e.lineTo(i,-i),e.moveTo(-i,-i),e.lineTo(i,i),e.stroke())}function star(e,t,i,n){_one_star(e,i),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function star_dot(e,t,i,n){star(e,t,i,n),dot(e,t,i,n)}function triangle(e,t,i,n){_one_tri(e,i),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function triangle_dot(e,t,i,n){triangle(e,t,i,n),dot(e,t,i,n)}function triangle_pin(e,t,i,n){const o=i*SQ3,r=o/3,s=3*r/8;e.moveTo(-i,r),e.quadraticCurveTo(0,s,i,r),e.quadraticCurveTo(SQ3*s/2,s/2,0,r-o),e.quadraticCurveTo(-SQ3*s/2,s/2,-i,r),e.closePath(),n.fill.doit&&(n.fill.set_vectorize(e,t),e.fill()),n.hatch.doit&&(n.hatch.set_vectorize(e,t),e.fill()),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function dash(e,t,i,n){_one_line(e,i),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function x(e,t,i,n){_one_x(e,i),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}function y(e,t,i,n){_one_y(e,i),n.line.doit&&(n.line.set_vectorize(e,t),e.stroke())}const marker_funcs={asterisk:asterisk,circle:circle,circle_cross:circle_cross,circle_dot:circle_dot,circle_y:circle_y,circle_x:circle_x,cross:cross,diamond:diamond,diamond_dot:diamond_dot,diamond_cross:diamond_cross,dot:dot,hex:hex,hex_dot:hex_dot,inverted_triangle:inverted_triangle,plus:plus,square:square,square_cross:square_cross,square_dot:square_dot,square_pin:square_pin,square_x:square_x,star:star,star_dot:star_dot,triangle:triangle,triangle_dot:triangle_dot,triangle_pin:triangle_pin,dash:dash,x:x,y:y};class ScatterView extends MarkerView{_init_webgl(){const{webgl:e}=this.renderer.plot_view.canvas_view;if(null!=e){const t=new Set(this.marker);if(1==t.size){const[i]=[...t];if(MarkerGL.is_supported(i)){const{glglyph:t}=this;if(null==t||t.marker_type!=i)return void(this.glglyph=new MarkerGL(e.gl,this,i))}}}delete this.glglyph}_set_data(e){super._set_data(e),this._init_webgl()}_render(e,t,i){const{sx:n,sy:o,size:r,angle:s,marker:a}=null!=i?i:this;for(const l of t){const t=n[l],i=o[l],c=r.get(l),d=s.get(l),h=a.get(l);if(isNaN(t+i+c+d)||null==h)continue;const u=c/2;e.beginPath(),e.translate(t,i),d&&e.rotate(d),marker_funcs[h](e,l,u,this.visuals),d&&e.rotate(-d),e.translate(-t,-i)}}draw_legend_for_index(e,{x0:t,x1:i,y0:n,y1:o},r){const s=r+1,a=this.marker.get(r),l=__spreadProps(__spreadValues({},this._get_legend_args({x0:t,x1:i,y0:n,y1:o},r)),{marker:new UniformScalar(a,s)});this._render(e,[r],l)}}ScatterView.__name__="ScatterView";class Scatter extends Marker{constructor(e){super(e)}static init_Scatter(){this.prototype.default_view=ScatterView,this.define((()=>({marker:[MarkerSpec,{value:"circle"}]})))}}Scatter.__name__="Scatter",Scatter.init_Scatter();class SegmentView extends GlyphView{_project_data(){inplace.project_xy(this._x0,this._y0),inplace.project_xy(this._x1,this._y1)}_index_data(e){const{min:t,max:i}=Math,{_x0:n,_x1:o,_y0:r,_y1:s,data_size:a}=this;for(let l=0;l<a;l++){const a=n[l],c=o[l],d=r[l],h=s[l];isNaN(a+c+d+h)?e.add_empty():e.add(t(a,c),t(d,h),i(a,c),i(d,h))}}_render(e,t,i){if(this.visuals.line.doit){const{sx0:n,sy0:o,sx1:r,sy1:s}=null!=i?i:this;for(const i of t){const t=n[i],a=o[i],l=r[i],c=s[i];isNaN(t+a+l+c)||(e.beginPath(),e.moveTo(t,a),e.lineTo(l,c),this.visuals.line.set_vectorize(e,i),e.stroke())}}}_hit_point(e){const{sx:t,sy:i}=e,n={x:t,y:i},[o,r]=this.renderer.xscale.r_invert(t-2,t+2),[s,a]=this.renderer.yscale.r_invert(i-2,i+2),l=this.index.indices({x0:o,y0:s,x1:r,y1:a}),c=[];for(const d of l){const e=Math.max(2,this.line_width.get(d)/2)**2;dist_to_segment_squared(n,{x:this.sx0[d],y:this.sy0[d]},{x:this.sx1[d],y:this.sy1[d]})<e&&c.push(d)}return new Selection({indices:c})}_hit_span(e){const[t,i]=this.renderer.plot_view.frame.bbox.ranges,{sx:n,sy:o}=e;let r,s,a;"v"==e.direction?(a=this.renderer.yscale.invert(o),[r,s]=[this._y0,this._y1]):(a=this.renderer.xscale.invert(n),[r,s]=[this._x0,this._x1]);const l=[],[c,d]=this.renderer.xscale.r_invert(t.start,t.end),[h,u]=this.renderer.yscale.r_invert(i.start,i.end),p=this.index.indices({x0:c,y0:h,x1:d,y1:u});for(const _ of p){(r[_]<=a&&a<=s[_]||s[_]<=a&&a<=r[_])&&l.push(_);const t=1.5+this.line_width.get(_)/2;r[_]==s[_]&&("h"==e.direction?Math.abs(this.sx0[_]-n)<=t&&l.push(_):Math.abs(this.sy0[_]-o)<=t&&l.push(_))}return new Selection({indices:l})}scenterxy(e){return[this.sx0[e]/2+this.sx1[e]/2,this.sy0[e]/2+this.sy1[e]/2]}draw_legend_for_index(e,t,i){generic_line_vector_legend(this.visuals,e,t,i)}}SegmentView.__name__="SegmentView";class Segment extends Glyph{constructor(e){super(e)}static init_Segment(){this.prototype.default_view=SegmentView,this.define((({})=>({x0:[XCoordinateSpec,{field:"x0"}],y0:[YCoordinateSpec,{field:"y0"}],x1:[XCoordinateSpec,{field:"x1"}],y1:[YCoordinateSpec,{field:"y1"}]}))),this.mixins(LineVector$1)}}function catmullrom_spline(e,t,i=10,n=.5,o=!1){assert(e.length==t.length);const r=e.length,s=o?r+1:r,a=infer_type(e,t),l=new a(s+2),c=new a(s+2);l.set(e,1),c.set(t,1),o?(l[0]=e[r-1],c[0]=t[r-1],l[s]=e[0],c[s]=t[0],l[s+1]=e[1],c[s+1]=t[1]):(l[0]=e[0],c[0]=t[0],l[s+1]=e[r-1],c[s+1]=t[r-1]);const d=new a(4*(i+1));for(let p=0,_=0;p<=i;p++){const e=p/i,t=e**2,n=e*t;d[_++]=2*n-3*t+1,d[_++]=-2*n+3*t,d[_++]=n-2*t+e,d[_++]=n-t}const h=new a((s-1)*(i+1)),u=new a((s-1)*(i+1));for(let p=1,_=0;p<s;p++){const e=(l[p+1]-l[p-1])*n,t=(c[p+1]-c[p-1])*n,o=(l[p+2]-l[p])*n,r=(c[p+2]-c[p])*n;for(let n=0;n<=4*i;_++){const i=d[n++],s=d[n++],a=d[n++],f=d[n++];h[_]=i*l[p]+s*l[p+1]+a*e+f*o,u[_]=i*c[p]+s*c[p+1]+a*t+f*r}}return[h,u]}Segment.__name__="Segment",Segment.init_Segment();class SplineView extends XYGlyphView{_set_data(){const{tension:e,closed:t}=this.model;[this._xt,this._yt]=catmullrom_spline(this._x,this._y,20,e,t)}_map_data(){const{x_scale:e,y_scale:t}=this.renderer.coordinates;this.sxt=e.v_compute(this._xt),this.syt=t.v_compute(this._yt)}_render(e,t,i){const{sxt:n,syt:o}=null!=i?i:this;this.visuals.line.set_value(e);const r=n.length;for(let s=0;s<r;s++)0!=s?isNaN(n[s])||isNaN(o[s])?(e.stroke(),e.beginPath()):e.lineTo(n[s],o[s]):(e.beginPath(),e.moveTo(n[s],o[s]));e.stroke()}}SplineView.__name__="SplineView";class Spline extends XYGlyph{constructor(e){super(e)}static init_Spline(){this.prototype.default_view=SplineView,this.mixins(LineScalar$1),this.define((({Boolean:e,Number:t})=>({tension:[t,.5],closed:[e,!1]})))}}Spline.__name__="Spline",Spline.init_Spline();class StepView extends XYGlyphView{_render(e,t,i){const{sx:n,sy:o}=null!=i?i:this;let r=!1,s=null;this.visuals.line.set_value(e);const a=t.length;if(!(a<2)){e.beginPath(),e.moveTo(n[0],o[0]);for(const i of t){let t,a,l,c;switch(this.model.mode){case"before":[t,l]=[n[i-1],o[i]],[a,c]=[n[i],o[i]];break;case"after":[t,l]=[n[i],o[i-1]],[a,c]=[n[i],o[i]];break;case"center":{const e=(n[i-1]+n[i])/2;[t,l]=[e,o[i-1]],[a,c]=[e,o[i]];break}default:throw new Error("unexpected")}if(r){if(!isFinite(n[i]+o[i])){e.stroke(),e.beginPath(),r=!1,s=i;continue}null!=s&&i-s>1&&(e.stroke(),r=!1)}r?(e.lineTo(t,l),e.lineTo(a,c)):(e.beginPath(),e.moveTo(n[i],o[i]),r=!0),s=i}e.lineTo(n[a-1],o[a-1]),e.stroke()}}draw_legend_for_index(e,t,i){generic_line_scalar_legend(this.visuals,e,t)}}StepView.__name__="StepView";class Step extends XYGlyph{constructor(e){super(e)}static init_Step(){this.prototype.default_view=StepView,this.mixins(LineScalar$1),this.define((()=>({mode:[StepMode,"before"]})))}}Step.__name__="Step",Step.init_Step();class TextView extends XYGlyphView{_rotate_point(e,t,i,n,o){return[(e-i)*Math.cos(o)-(t-n)*Math.sin(o)+i,(e-i)*Math.sin(o)+(t-n)*Math.cos(o)+n]}_text_bounds(e,t,i,n){return[[e,e+i,e+i,e,e],[t,t,t-n,t-n,t]]}_render(e,t,i){const{sx:n,sy:o,x_offset:r,y_offset:s,angle:a,text:l}=null!=i?i:this;this._sys=[],this._sxs=[];for(const c of t){const t=this._sxs[c]=[],i=this._sys[c]=[],d=n[c],h=o[c],u=r.get(c),p=s.get(c),_=a.get(c),f=l.get(c);if(!isNaN(d+h+u+p+_)&&null!=f&&this.visuals.text.doit){const n=`${f}`;e.save(),e.translate(d+u,h+p),e.rotate(_),this.visuals.text.set_vectorize(e,c);const o=this.visuals.text.font_value(c),{height:r}=font_metrics(o),s=this.text_line_height.get(c)*r;if(-1==n.indexOf("\n")){e.fillText(n,0,0);const o=d+u,r=h+p,a=e.measureText(n).width,[l,c]=this._text_bounds(o,r,a,s);t.push(l),i.push(c)}else{const o=n.split("\n"),r=s*o.length,a=this.text_baseline.get(c);let l;switch(a){case"top":l=0;break;case"middle":l=-r/2+s/2;break;case"bottom":l=-r+s;break;default:l=0,console.warn(`'${a}' baseline not supported with multi line text`)}for(const n of o){e.fillText(n,0,l);const o=d+u,r=l+h+p,a=e.measureText(n).width,[c,_]=this._text_bounds(o,r,a,s);t.push(c),i.push(_),l+=s}}e.restore()}}}_hit_point(e){const{sx:t,sy:i}=e,n=[];for(let o=0;o<this._sxs.length;o++){const e=this._sxs[o],r=this._sys[o],s=e.length;for(let a=0,l=s;a<l;a++){const[l,c]=this._rotate_point(t,i,e[s-1][0],r[s-1][0],-this.angle.get(o));point_in_poly(l,c,e[a],r[a])&&n.push(o)}}return new Selection({indices:n})}scenterxy(e){const t=this._sxs[e],i=this._sys[e];assert(0!=t.length&&0!=i.length);const n=t[0][0],o=i[0][0],r=(t[0][2]+n)/2,s=(i[0][2]+o)/2,[a,l]=this._rotate_point(r,s,n,o,this.angle.get(e));return[a,l]}}TextView.__name__="TextView";class Text extends XYGlyph{constructor(e){super(e)}static init_Text(){this.prototype.default_view=TextView,this.mixins(TextVector$1),this.define((({})=>({text:[NullStringSpec,{field:"text"}],angle:[AngleSpec,0],x_offset:[NumberSpec,0],y_offset:[NumberSpec,0]})))}}Text.__name__="Text",Text.init_Text();class VBarView extends BoxView$1{scenterxy(e){return[this.sx[e],(this.stop[e]+this.sbottom[e])/2]}_lrtb(e){const t=this.width.get(e)/2,i=this._x[e],n=this._top[e],o=this._bottom[e];return[i-t,i+t,Math.max(n,o),Math.min(n,o)]}_map_data(){this.sx=this.renderer.xscale.v_compute(this._x),this.sw=this.sdist(this.renderer.xscale,this._x,this.width,"center"),this.stop=this.renderer.yscale.v_compute(this._top),this.sbottom=this.renderer.yscale.v_compute(this._bottom);const e=this.sx.length;this.sleft=new ScreenArray(e),this.sright=new ScreenArray(e);for(let t=0;t<e;t++)this.sleft[t]=this.sx[t]-this.sw[t]/2,this.sright[t]=this.sx[t]+this.sw[t]/2;this._clamp_viewport()}}VBarView.__name__="VBarView";class VBar extends Box$1{constructor(e){super(e)}static init_VBar(){this.prototype.default_view=VBarView,this.define((({})=>({x:[XCoordinateSpec,{field:"x"}],bottom:[YCoordinateSpec,{value:0}],width:[NumberSpec,{value:1}],top:[YCoordinateSpec,{field:"top"}]})))}}VBar.__name__="VBar",VBar.init_VBar();class WedgeView extends XYGlyphView{_map_data(){"data"==this.model.properties.radius.units?this.sradius=this.sdist(this.renderer.xscale,this._x,this.radius):this.sradius=to_screen(this.radius)}_render(e,t,i){const{sx:n,sy:o,sradius:r,start_angle:s,end_angle:a}=null!=i?i:this,l="anticlock"==this.model.direction;for(const c of t){const t=n[c],i=o[c],d=r[c],h=s.get(c),u=a.get(c);isNaN(t+i+d+h+u)||(e.beginPath(),e.arc(t,i,d,h,u,l),e.lineTo(t,i),e.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(e,c),e.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(e,c),e.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(e,c),e.stroke()))}}_hit_point(e){let t,i,n,o,r,s,a,l,c;const{sx:d,sy:h}=e,u=this.renderer.xscale.invert(d),p=this.renderer.yscale.invert(h),_=2*this.max_radius;"data"===this.model.properties.radius.units?(s=u-_,a=u+_,l=p-_,c=p+_):(i=d-_,n=d+_,[s,a]=this.renderer.xscale.r_invert(i,n),o=h-_,r=h+_,[l,c]=this.renderer.yscale.r_invert(o,r));const f=[];for(const v of this.index.indices({x0:s,x1:a,y0:l,y1:c})){const e=this.sradius[v]**2;[i,n]=this.renderer.xscale.r_compute(u,this._x[v]),[o,r]=this.renderer.yscale.r_compute(p,this._y[v]),t=(i-n)**2+(o-r)**2,t<=e&&f.push(v)}const g="anticlock"==this.model.direction,m=[];for(const v of f){angle_between(-Math.atan2(h-this.sy[v],d-this.sx[v]),-this.start_angle.get(v),-this.end_angle.get(v),g)&&m.push(v)}return new Selection({indices:m})}draw_legend_for_index(e,t,i){generic_area_vector_legend(this.visuals,e,t,i)}scenterxy(e){const t=this.sradius[e]/2,i=(this.start_angle.get(e)+this.end_angle.get(e))/2;return[this.sx[e]+t*Math.cos(i),this.sy[e]+t*Math.sin(i)]}}WedgeView.__name__="WedgeView";class Wedge extends XYGlyph{constructor(e){super(e)}static init_Wedge(){this.prototype.default_view=WedgeView,this.mixins([LineVector$1,FillVector$1,HatchVector$1]),this.define((({})=>({direction:[Direction$1,"anticlock"],radius:[DistanceSpec,{field:"radius"}],start_angle:[AngleSpec,{field:"start_angle"}],end_angle:[AngleSpec,{field:"end_angle"}]})))}}Wedge.__name__="Wedge",Wedge.init_Wedge();class StaticLayoutProvider extends LayoutProvider{constructor(e){super(e)}static init_StaticLayoutProvider(){this.define((({Number:e,Tuple:t,Dict:i})=>({graph_layout:[i(t(e,e)),{}]})))}get_node_coordinates(e){var t;const i=null!=(t=e.data.index)?t:[],n=i.length,o=new Float64Array(n),r=new Float64Array(n);for(let s=0;s<n;s++){const e=this.graph_layout[i[s]],[t,n]=null!=e?e:[NaN,NaN];o[s]=t,r[s]=n}return[o,r]}get_edge_coordinates(e){var t,i;const n=null!=(t=e.data.start)?t:[],o=null!=(i=e.data.end)?i:[],r=Math.min(n.length,o.length),s=[],a=[],l=null!=e.data.xs&&null!=e.data.ys;for(let c=0;c<r;c++){const t=null!=this.graph_layout[n[c]]&&null!=this.graph_layout[o[c]];if(l&&t)s.push(e.data.xs[c]),a.push(e.data.ys[c]);else{let e,i;t?(e=this.graph_layout[n[c]],i=this.graph_layout[o[c]]):(e=[NaN,NaN],i=[NaN,NaN]),s.push([e[0],i[0]]),a.push([e[1],i[1]])}}return[s,a]}}StaticLayoutProvider.__name__="StaticLayoutProvider",StaticLayoutProvider.init_StaticLayoutProvider();class GridView extends GuideRendererView{_render(){const e=this.layer.ctx;e.save(),this._draw_regions(e),this._draw_minor_grids(e),this._draw_grids(e),e.restore()}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_draw_regions(e){if(!this.visuals.band_fill.doit&&!this.visuals.band_hatch.doit)return;const[t,i]=this.grid_coords("major",!1);for(let n=0;n<t.length-1;n++){if(n%2!=1)continue;const[o,r]=this.coordinates.map_to_screen(t[n],i[n]),[s,a]=this.coordinates.map_to_screen(t[n+1],i[n+1]);e.beginPath(),e.rect(o[0],r[0],s[1]-o[0],a[1]-r[0]),this.visuals.band_fill.doit&&(this.visuals.band_fill.set_value(e),e.fill()),this.visuals.band_hatch.doit&&(this.visuals.band_hatch.set_value(e),e.fill())}}_draw_grids(e){if(!this.visuals.grid_line.doit)return;const[t,i]=this.grid_coords("major");this._draw_grid_helper(e,this.visuals.grid_line,t,i)}_draw_minor_grids(e){if(!this.visuals.minor_grid_line.doit)return;const[t,i]=this.grid_coords("minor");this._draw_grid_helper(e,this.visuals.minor_grid_line,t,i)}_draw_grid_helper(e,t,i,n){t.set_value(e),e.beginPath();for(let o=0;o<i.length;o++){const[t,r]=this.coordinates.map_to_screen(i[o],n[o]);e.moveTo(Math.round(t[0]),Math.round(r[0]));for(let i=1;i<t.length;i++)e.lineTo(Math.round(t[i]),Math.round(r[i]))}e.stroke()}ranges(){const e=this.model.dimension,t=(e+1)%2,{ranges:i}=this.coordinates;return[i[e],i[t]]}computed_bounds(){const[e]=this.ranges(),t=this.model.bounds,i=[e.min,e.max];let n,o;if(isArray(t))n=Math.min(t[0],t[1]),o=Math.max(t[0],t[1]),n<i[0]&&(n=i[0]),o>i[1]&&(o=i[1]);else{[n,o]=i;for(const e of this.plot_view.axis_views)e.dimension==this.model.dimension&&e.model.x_range_name==this.model.x_range_name&&e.model.y_range_name==this.model.y_range_name&&([n,o]=e.computed_bounds)}return[n,o]}grid_coords(e,t=!0){const i=this.model.dimension,n=(i+1)%2,[o,r]=this.ranges();let[s,a]=this.computed_bounds();[s,a]=[Math.min(s,a),Math.max(s,a)];const l=[[],[]],c=this.model.get_ticker();if(null==c)return l;const d=c.get_ticks(s,a,o,r.min)[e],h=o.min,u=o.max,p=r.min,_=r.max;t||(d[0]!=h&&d.splice(0,0,h),d[d.length-1]!=u&&d.push(u));for(let f=0;f<d.length;f++){if((d[f]==h||d[f]==u)&&t)continue;const e=[],o=[],r=2;for(let t=0;t<r;t++){const i=p+(_-p)/(r-1)*t;e.push(d[f]),o.push(i)}l[i].push(e),l[n].push(o)}return l}}GridView.__name__="GridView";class Grid extends GuideRenderer{constructor(e){super(e)}static init_Grid(){this.prototype.default_view=GridView,this.mixins([["grid_",Line$2],["minor_grid_",Line$2],["band_",Fill$1],["band_",Hatch$1]]),this.define((({Number:e,Auto:t,Enum:i,Ref:n,Tuple:o,Or:r,Nullable:s})=>({bounds:[r(o(e,e),t),"auto"],dimension:[i(0,1),0],axis:[s(n(Axis)),null],ticker:[s(n(Ticker)),null]}))),this.override({level:"underlay",band_fill_color:null,band_fill_alpha:0,grid_line_color:"#e5e5e5",minor_grid_line_color:null})}get_ticker(){return null!=this.ticker?this.ticker:null!=this.axis?this.axis.ticker:null}}Grid.__name__="Grid",Grid.init_Grid();class LayoutDOMView extends DOMView{constructor(){super(...arguments),this._idle_notified=!1,this._offset_parent=null,this._viewport={}}get base_font_size(){const e=parse_css_font_size(getComputedStyle(this.el).fontSize);if(null!=e){const{value:t,unit:i}=e;if("px"==i)return t}return 13}initialize(){super.initialize(),this.el.style.position=this.is_root?"relative":"absolute",this._child_views=new Map}async lazy_initialize(){await super.lazy_initialize(),await this.build_child_views()}remove(){for(const e of this.child_views)e.remove();this._child_views.clear(),super.remove()}connect_signals(){super.connect_signals(),this.is_root&&(this._on_resize=()=>this.resize_layout(),window.addEventListener("resize",this._on_resize),this._parent_observer=setInterval((()=>{const e=this.el.offsetParent;this._offset_parent!=e&&(this._offset_parent=e,null!=e&&(this.compute_viewport(),this.invalidate_layout()))}),250));const e=this.model.properties;this.on_change([e.width,e.height,e.min_width,e.min_height,e.max_width,e.max_height,e.margin,e.width_policy,e.height_policy,e.sizing_mode,e.aspect_ratio,e.visible],(()=>this.invalidate_layout())),this.on_change([e.background,e.css_classes],(()=>this.invalidate_render()))}disconnect_signals(){null!=this._parent_observer&&clearTimeout(this._parent_observer),null!=this._on_resize&&window.removeEventListener("resize",this._on_resize),super.disconnect_signals()}css_classes(){return super.css_classes().concat(this.model.css_classes)}get child_views(){return this.child_models.map((e=>this._child_views.get(e)))}async build_child_views(){await build_views(this._child_views,this.child_models,{parent:this})}render(){super.render(),empty$1(this.el);const{background:e}=this.model;this.el.style.backgroundColor=null!=e?color2css(e):"",classes(this.el).clear().add(...this.css_classes());for(const t of this.child_views)this.el.appendChild(t.el),t.render()}update_layout(){for(const e of this.child_views)e.update_layout();this._update_layout()}update_position(){this.el.style.display=this.model.visible?"block":"none";const e=this.is_root?this.layout.sizing.margin:void 0;position(this.el,this.layout.bbox,e);for(const t of this.child_views)t.update_position()}after_layout(){for(const e of this.child_views)e.after_layout();this._has_finished=!0}compute_viewport(){this._viewport=this._viewport_size()}renderTo(e){e.appendChild(this.el),this._offset_parent=this.el.offsetParent,this.compute_viewport(),this.build()}build(){return this.assert_root(),this.render(),this.update_layout(),this.compute_layout(),this}async rebuild(){await this.build_child_views(),this.invalidate_render()}compute_layout(){const e=Date.now();this.layout.compute(this._viewport),this.update_position(),this.after_layout(),logger.debug(`layout computed in ${Date.now()-e} ms`),this.notify_finished()}resize_layout(){this.root.compute_viewport(),this.root.compute_layout()}invalidate_layout(){this.root.update_layout(),this.root.compute_layout()}invalidate_render(){this.render(),this.invalidate_layout()}has_finished(){if(!super.has_finished())return!1;for(const e of this.child_views)if(!e.has_finished())return!1;return!0}notify_finished(){this.is_root?!this._idle_notified&&this.has_finished()&&null!=this.model.document&&(this._idle_notified=!0,this.model.document.notify_idle(this.model)):this.root.notify_finished()}_width_policy(){return null!=this.model.width?"fixed":"fit"}_height_policy(){return null!=this.model.height?"fixed":"fit"}box_sizing(){let{width_policy:e,height_policy:t,aspect_ratio:i}=this.model;"auto"==e&&(e=this._width_policy()),"auto"==t&&(t=this._height_policy());const{sizing_mode:n}=this.model;if(null!=n)if("fixed"==n)e=t="fixed";else if("stretch_both"==n)e=t="max";else if("stretch_width"==n)e="max";else if("stretch_height"==n)t="max";else switch(null==i&&(i="auto"),n){case"scale_width":e="max",t="min";break;case"scale_height":e="min",t="max";break;case"scale_both":e="max",t="max"}const o={width_policy:e,height_policy:t},{min_width:r,min_height:s}=this.model;null!=r&&(o.min_width=r),null!=s&&(o.min_height=s);const{width:a,height:l}=this.model;null!=a&&(o.width=a),null!=l&&(o.height=l);const{max_width:c,max_height:d}=this.model;null!=c&&(o.max_width=c),null!=d&&(o.max_height=d),"auto"==i&&null!=a&&null!=l?o.aspect=a/l:isNumber(i)&&(o.aspect=i);const{margin:h}=this.model;if(null!=h)if(isNumber(h))o.margin={top:h,right:h,bottom:h,left:h};else if(2==h.length){const[e,t]=h;o.margin={top:e,right:t,bottom:e,left:t}}else{const[e,t,i,n]=h;o.margin={top:e,right:t,bottom:i,left:n}}o.visible=this.model.visible;const{align:u}=this.model;return isArray(u)?[o.halign,o.valign]=u:o.halign=o.valign=u,o}_viewport_size(){return undisplayed(this.el,(()=>{let e=this.el;for(;e=e.parentElement;){if(e.classList.contains(root$3))continue;if(e==document.body){const{margin:{left:e,right:t,top:i,bottom:n}}=extents(document.body);return{width:Math.ceil(document.documentElement.clientWidth-e-t),height:Math.ceil(document.documentElement.clientHeight-i-n)}}const{padding:{left:t,right:i,top:n,bottom:o}}=extents(e),{width:r,height:s}=e.getBoundingClientRect(),a=Math.ceil(r-t-i),l=Math.ceil(s-n-o);if(a>0||l>0)return{width:a>0?a:void 0,height:l>0?l:void 0}}return{}}))}export(e,t=!0){const i=new CanvasLayer("png"==e?"canvas":"svg",t),{width:n,height:o}=this.layout.bbox;i.resize(n,o);for(const r of this.child_views){const n=r.export(e,t),{x:o,y:s}=r.layout.bbox;i.ctx.drawImage(n.canvas,o,s)}return i}serializable_state(){return __spreadProps(__spreadValues({},super.serializable_state()),{bbox:this.layout.bbox.box,children:this.child_views.map((e=>e.serializable_state()))})}}LayoutDOMView.__name__="LayoutDOMView";class LayoutDOM extends Model{constructor(e){super(e)}static init_LayoutDOM(){this.define((e=>{const{Boolean:t,Number:i,String:n,Auto:o,Color:r,Array:s,Tuple:a,Or:l,Null:c,Nullable:d}=e,h=a(i,i),u=a(i,i,i,i);return{width:[d(i),null],height:[d(i),null],min_width:[d(i),null],min_height:[d(i),null],max_width:[d(i),null],max_height:[d(i),null],margin:[d(l(i,h,u)),[0,0,0,0]],width_policy:[l(SizingPolicy,o),"auto"],height_policy:[l(SizingPolicy,o),"auto"],aspect_ratio:[l(i,o,c),null],sizing_mode:[d(SizingMode),null],visible:[t,!0],disabled:[t,!1],align:[l(Align,a(Align,Align)),"start"],background:[d(r),null],css_classes:[s(n),[]]}}))}}LayoutDOM.__name__="LayoutDOM",LayoutDOM.init_LayoutDOM();class BoxView extends LayoutDOMView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.children.change,(()=>this.rebuild()))}get child_models(){return this.model.children}}BoxView.__name__="BoxView";class Box extends LayoutDOM{constructor(e){super(e)}static init_Box(){this.define((({Number:e,Array:t,Ref:i})=>({children:[t(i(LayoutDOM)),[]],spacing:[e,0]})))}}Box.__name__="Box",Box.init_Box();class ColumnView extends BoxView{_update_layout(){const e=this.child_views.map((e=>e.layout));this.layout=new Column$1(e),this.layout.rows=this.model.rows,this.layout.spacing=[this.model.spacing,0],this.layout.set_sizing(this.box_sizing())}}ColumnView.__name__="ColumnView";class Column extends Box{constructor(e){super(e)}static init_Column(){this.prototype.default_view=ColumnView,this.define((({Any:e})=>({rows:[e,"auto"]})))}}Column.__name__="Column",Column.init_Column();class GridBoxView extends LayoutDOMView{connect_signals(){super.connect_signals();const{children:e,rows:t,cols:i,spacing:n}=this.model.properties;this.on_change([e,t,i,n],(()=>this.rebuild()))}get child_models(){return this.model.children.map((([e])=>e))}_update_layout(){this.layout=new Grid$1,this.layout.rows=this.model.rows,this.layout.cols=this.model.cols,this.layout.spacing=this.model.spacing;for(const[e,t,i,n,o]of this.model.children){const r=this._child_views.get(e);this.layout.items.push({layout:r.layout,row:t,col:i,row_span:n,col_span:o})}this.layout.set_sizing(this.box_sizing())}}GridBoxView.__name__="GridBoxView";class GridBox extends LayoutDOM{constructor(e){super(e)}static init_GridBox(){this.prototype.default_view=GridBoxView,this.define((({Any:e,Int:t,Number:i,Tuple:n,Array:o,Ref:r,Or:s,Opt:a})=>({children:[o(n(r(LayoutDOM),t,t,a(t),a(t))),[]],rows:[e,"auto"],cols:[e,"auto"],spacing:[s(i,n(i,i)),0]})))}}GridBox.__name__="GridBox",GridBox.init_GridBox();class HTMLBoxView extends LayoutDOMView{get child_models(){return[]}_update_layout(){this.layout=new ContentBox(this.el),this.layout.set_sizing(this.box_sizing())}}HTMLBoxView.__name__="HTMLBoxView";class HTMLBox extends LayoutDOM{constructor(e){super(e)}}HTMLBox.__name__="HTMLBox";class Panel extends Model{constructor(e){super(e)}static init_Panel(){this.define((({Boolean:e,String:t,Ref:i})=>({title:[t,""],child:[i(LayoutDOM)],closable:[e,!1]})))}}Panel.__name__="Panel",Panel.init_Panel();class RowView extends BoxView{_update_layout(){const e=this.child_views.map((e=>e.layout));this.layout=new Row$1(e),this.layout.cols=this.model.cols,this.layout.spacing=[0,this.model.spacing],this.layout.set_sizing(this.box_sizing())}}RowView.__name__="RowView";class Row extends Box{constructor(e){super(e)}static init_Row(){this.prototype.default_view=RowView,this.define((({Any:e})=>({cols:[e,"auto"]})))}}Row.__name__="Row",Row.init_Row();class SpacerView extends LayoutDOMView{get child_models(){return[]}_update_layout(){this.layout=new LayoutItem,this.layout.set_sizing(this.box_sizing())}}SpacerView.__name__="SpacerView";class Spacer extends LayoutDOM{constructor(e){super(e)}static init_Spacer(){this.prototype.default_view=SpacerView}}Spacer.__name__="Spacer",Spacer.init_Spacer();const root$1="bk-root",tabs_header="bk-tabs-header",btn_group$1="bk-btn-group",btn$1="bk-btn",headers_wrapper="bk-headers-wrapper",above="bk-above",right="bk-right",below="bk-below",left="bk-left",headers="bk-headers",tab="bk-tab",active$1="bk-active",close="bk-close";var tabs_css='.bk-root .bk-tabs-header{display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;overflow:hidden;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;}.bk-root .bk-tabs-header .bk-btn-group{height:auto;margin-right:5px;}.bk-root .bk-tabs-header .bk-btn-group > .bk-btn{flex-grow:0;-webkit-flex-grow:0;height:auto;padding:4px 4px;}.bk-root .bk-tabs-header .bk-headers-wrapper{flex-grow:1;-webkit-flex-grow:1;overflow:hidden;color:#666666;}.bk-root .bk-tabs-header.bk-above .bk-headers-wrapper{border-bottom:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-right .bk-headers-wrapper{border-left:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-below .bk-headers-wrapper{border-top:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-left .bk-headers-wrapper{border-right:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-above,.bk-root .bk-tabs-header.bk-below{flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-tabs-header.bk-above .bk-headers,.bk-root .bk-tabs-header.bk-below .bk-headers{flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-tabs-header.bk-left,.bk-root .bk-tabs-header.bk-right{flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-tabs-header.bk-left .bk-headers,.bk-root .bk-tabs-header.bk-right .bk-headers{flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-tabs-header .bk-headers{position:relative;display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;}.bk-root .bk-tabs-header .bk-tab{padding:4px 8px;border:solid transparent;white-space:nowrap;cursor:pointer;}.bk-root .bk-tabs-header .bk-tab:hover{background-color:#f2f2f2;}.bk-root .bk-tabs-header .bk-tab.bk-active{color:#4d4d4d;background-color:white;border-color:#e6e6e6;}.bk-root .bk-tabs-header .bk-tab .bk-close{margin-left:10px;}.bk-root .bk-tabs-header.bk-above .bk-tab{border-width:3px 1px 0px 1px;border-radius:4px 4px 0 0;}.bk-root .bk-tabs-header.bk-right .bk-tab{border-width:1px 3px 1px 0px;border-radius:0 4px 4px 0;}.bk-root .bk-tabs-header.bk-below .bk-tab{border-width:0px 1px 3px 1px;border-radius:0 0 4px 4px;}.bk-root .bk-tabs-header.bk-left .bk-tab{border-width:1px 0px 1px 3px;border-radius:4px 0 0 4px;}.bk-root .bk-close{display:inline-block;width:10px;height:10px;vertical-align:middle;background-image:url(\'data:image/svg+xml;utf8,      <svg viewPort="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg">        <line x1="1" y1="9" x2="9" y2="1" stroke="gray" stroke-width="2"/>        <line x1="1" y1="1" x2="9" y2="9" stroke="gray" stroke-width="2"/>      </svg>\');}.bk-root .bk-close:hover{background-image:url(\'data:image/svg+xml;utf8,      <svg viewPort="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg">        <line x1="1" y1="9" x2="9" y2="1" stroke="red" stroke-width="2"/>        <line x1="1" y1="1" x2="9" y2="9" stroke="red" stroke-width="2"/>      </svg>\');}',tabs=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",root:root$1,tabs_header:tabs_header,btn_group:btn_group$1,btn:btn$1,headers_wrapper:headers_wrapper,above:above,right:right,below:below,left:left,headers:headers,tab:tab,active:active$1,close:close,default:tabs_css});const root="bk-root",btn="bk-btn",active="bk-active",btn_default="bk-btn-default",btn_primary="bk-btn-primary",btn_success="bk-btn-success",btn_warning="bk-btn-warning",btn_danger="bk-btn-danger",btn_light="bk-btn-light",btn_group="bk-btn-group",dropdown_toggle="bk-dropdown-toggle";var buttons_css=".bk-root .bk-btn{height:100%;display:inline-block;text-align:center;vertical-align:middle;white-space:nowrap;cursor:pointer;padding:6px 12px;font-size:12px;border:1px solid transparent;border-radius:4px;outline:0;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;}.bk-root .bk-btn:hover,.bk-root .bk-btn:focus{text-decoration:none;}.bk-root .bk-btn:active,.bk-root .bk-btn.bk-active{background-image:none;box-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);}.bk-root .bk-btn[disabled]{cursor:not-allowed;pointer-events:none;opacity:0.65;box-shadow:none;}.bk-root .bk-btn-default{color:#333;background-color:#fff;border-color:#ccc;}.bk-root .bk-btn-default:hover{background-color:#f5f5f5;border-color:#b8b8b8;}.bk-root .bk-btn-default.bk-active{background-color:#ebebeb;border-color:#adadad;}.bk-root .bk-btn-default[disabled],.bk-root .bk-btn-default[disabled]:hover,.bk-root .bk-btn-default[disabled]:focus,.bk-root .bk-btn-default[disabled]:active,.bk-root .bk-btn-default[disabled].bk-active{background-color:#e6e6e6;border-color:#ccc;}.bk-root .bk-btn-primary{color:#fff;background-color:#428bca;border-color:#357ebd;}.bk-root .bk-btn-primary:hover{background-color:#3681c1;border-color:#2c699e;}.bk-root .bk-btn-primary.bk-active{background-color:#3276b1;border-color:#285e8e;}.bk-root .bk-btn-primary[disabled],.bk-root .bk-btn-primary[disabled]:hover,.bk-root .bk-btn-primary[disabled]:focus,.bk-root .bk-btn-primary[disabled]:active,.bk-root .bk-btn-primary[disabled].bk-active{background-color:#506f89;border-color:#357ebd;}.bk-root .bk-btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c;}.bk-root .bk-btn-success:hover{background-color:#4eb24e;border-color:#409240;}.bk-root .bk-btn-success.bk-active{background-color:#47a447;border-color:#398439;}.bk-root .bk-btn-success[disabled],.bk-root .bk-btn-success[disabled]:hover,.bk-root .bk-btn-success[disabled]:focus,.bk-root .bk-btn-success[disabled]:active,.bk-root .bk-btn-success[disabled].bk-active{background-color:#667b66;border-color:#4cae4c;}.bk-root .bk-btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236;}.bk-root .bk-btn-warning:hover{background-color:#eea43b;border-color:#e89014;}.bk-root .bk-btn-warning.bk-active{background-color:#ed9c28;border-color:#d58512;}.bk-root .bk-btn-warning[disabled],.bk-root .bk-btn-warning[disabled]:hover,.bk-root .bk-btn-warning[disabled]:focus,.bk-root .bk-btn-warning[disabled]:active,.bk-root .bk-btn-warning[disabled].bk-active{background-color:#c89143;border-color:#eea236;}.bk-root .bk-btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a;}.bk-root .bk-btn-danger:hover{background-color:#d5433e;border-color:#bd2d29;}.bk-root .bk-btn-danger.bk-active{background-color:#d2322d;border-color:#ac2925;}.bk-root .bk-btn-danger[disabled],.bk-root .bk-btn-danger[disabled]:hover,.bk-root .bk-btn-danger[disabled]:focus,.bk-root .bk-btn-danger[disabled]:active,.bk-root .bk-btn-danger[disabled].bk-active{background-color:#a55350;border-color:#d43f3a;}.bk-root .bk-btn-light{color:#333;background-color:#fff;border-color:#ccc;border-color:transparent;}.bk-root .bk-btn-light:hover{background-color:#f5f5f5;border-color:#b8b8b8;}.bk-root .bk-btn-light.bk-active{background-color:#ebebeb;border-color:#adadad;}.bk-root .bk-btn-light[disabled],.bk-root .bk-btn-light[disabled]:hover,.bk-root .bk-btn-light[disabled]:focus,.bk-root .bk-btn-light[disabled]:active,.bk-root .bk-btn-light[disabled].bk-active{background-color:#e6e6e6;border-color:#ccc;}.bk-root .bk-btn-group{height:100%;display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-btn-group > .bk-btn{flex-grow:1;-webkit-flex-grow:1;}.bk-root .bk-btn-group > .bk-btn + .bk-btn{margin-left:-1px;}.bk-root .bk-btn-group > .bk-btn:first-child:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0;}.bk-root .bk-btn-group > .bk-btn:not(:first-child):last-child{border-bottom-left-radius:0;border-top-left-radius:0;}.bk-root .bk-btn-group > .bk-btn:not(:first-child):not(:last-child){border-radius:0;}.bk-root .bk-btn-group .bk-dropdown-toggle{flex:0 0 0;-webkit-flex:0 0 0;padding:6px 6px;}",buttons=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",root:root,btn:btn,active:active,btn_default:btn_default,btn_primary:btn_primary,btn_success:btn_success,btn_warning:btn_warning,btn_danger:btn_danger,btn_light:btn_light,btn_group:btn_group,dropdown_toggle:dropdown_toggle,default:buttons_css});class TabsView extends LayoutDOMView{constructor(){super(...arguments),this._scroll_index=0}connect_signals(){super.connect_signals(),this.connect(this.model.properties.tabs.change,(()=>this.rebuild())),this.connect(this.model.properties.active.change,(()=>this.on_active_change()))}styles(){return[...super.styles(),buttons_css,menus_css,tabs_css]}get child_models(){return this.model.tabs.map((e=>e.child))}_update_layout(){const e=this.model.tabs_location,t="above"==e||"below"==e,{scroll_el:i,headers_el:n}=this;this.header=new class extends ContentBox{_measure(e){const o=size(i),r=children(n).slice(0,3).map((e=>size(e))),{width:s,height:a}=super._measure(e);if(t){const t=o.width+sum$1(r.map((e=>e.width)));return{width:e.width!=1/0?e.width:t,height:a}}{const t=o.height+sum$1(r.map((e=>e.height)));return{width:s,height:e.height!=1/0?e.height:t}}}}(this.header_el),t?this.header.set_sizing({width_policy:"fit",height_policy:"fixed"}):this.header.set_sizing({width_policy:"fixed",height_policy:"fit"});let o=1,r=1;switch(e){case"above":o-=1;break;case"below":o+=1;break;case"left":r-=1;break;case"right":r+=1}const s={layout:this.header,row:o,col:r},a=this.child_views.map((e=>({layout:e.layout,row:1,col:1})));this.layout=new Grid$1([s,...a]),this.layout.set_sizing(this.box_sizing())}update_position(){super.update_position(),this.header_el.style.position="absolute",position(this.header_el,this.header.bbox);const e=this.model.tabs_location,t="above"==e||"below"==e,i=size(this.scroll_el),n=scroll_size(this.headers_el);if(t){const{width:e}=this.header.bbox;n.width>e?(this.wrapper_el.style.maxWidth=e-i.width+"px",display(this.scroll_el),this.do_scroll(this.model.active)):(this.wrapper_el.style.maxWidth="",undisplay(this.scroll_el))}else{const{height:e}=this.header.bbox;n.height>e?(this.wrapper_el.style.maxHeight=e-i.height+"px",display(this.scroll_el),this.do_scroll(this.model.active)):(this.wrapper_el.style.maxHeight="",undisplay(this.scroll_el))}const{child_views:o}=this;for(const s of o)hide(s.el);const r=o[this.model.active];null!=r&&show$1(r.el)}render(){super.render();const{active:e}=this.model,t=this.model.tabs.map(((t,i)=>{const n=div({class:[tab,i==e?active$1:null]},t.title);if(n.addEventListener("click",(e=>{e.target==e.currentTarget&&this.change_active(i)})),t.closable){const e=div({class:close});e.addEventListener("click",(e=>{if(e.target==e.currentTarget){this.model.tabs=remove_at(this.model.tabs,i);const e=this.model.tabs.length;this.model.active>e-1&&(this.model.active=e-1)}})),n.appendChild(e)}return n}));this.headers_el=div({class:[headers]},t),this.wrapper_el=div({class:headers_wrapper},this.headers_el),this.left_el=div({class:[btn,btn_default],disabled:""},div({class:[caret,left]})),this.right_el=div({class:[btn,btn_default]},div({class:[caret,right]})),this.left_el.addEventListener("click",(()=>this.do_scroll("left"))),this.right_el.addEventListener("click",(()=>this.do_scroll("right"))),this.scroll_el=div({class:btn_group},this.left_el,this.right_el);const i=this.model.tabs_location;this.header_el=div({class:[tabs_header,tabs[i]]},this.scroll_el,this.wrapper_el),this.el.appendChild(this.header_el)}do_scroll(e){const t=this.model.tabs.length;"left"==e?this._scroll_index-=1:"right"==e?this._scroll_index+=1:this._scroll_index=e,this._scroll_index=clamp(this._scroll_index,0,t-1),0==this._scroll_index?this.left_el.setAttribute("disabled",""):this.left_el.removeAttribute("disabled"),this._scroll_index==t-1?this.right_el.setAttribute("disabled",""):this.right_el.removeAttribute("disabled");const i=children(this.headers_el).slice(0,this._scroll_index).map((e=>e.getBoundingClientRect())),n=this.model.tabs_location;if("above"==n||"below"==n){const e=-sum$1(i.map((e=>e.width)));this.headers_el.style.left=`${e}px`}else{const e=-sum$1(i.map((e=>e.height)));this.headers_el.style.top=`${e}px`}}change_active(e){e!=this.model.active&&(this.model.active=e)}on_active_change(){const e=this.model.active,t=children(this.headers_el);for(const n of t)n.classList.remove(active$1);t[e].classList.add(active$1);const{child_views:i}=this;for(const n of i)hide(n.el);show$1(i[e].el)}}TabsView.__name__="TabsView";class Tabs extends LayoutDOM{constructor(e){super(e)}static init_Tabs(){this.prototype.default_view=TabsView,this.define((({Int:e,Array:t,Ref:i})=>({tabs:[t(i(Panel)),[]],tabs_location:[Location,"above"],active:[e,0]})))}}Tabs.__name__="Tabs",Tabs.init_Tabs();class WidgetBoxView extends ColumnView{}WidgetBoxView.__name__="WidgetBoxView";class WidgetBox extends Column{constructor(e){super(e)}static init_WidgetBox(){this.prototype.default_view=WidgetBoxView}}function throttle(e,t){let i=null,n=0,o=!1;return function(){return new Promise(((r,s)=>{const a=function(){n=Date.now(),i=null,o=!1;try{e(),r()}catch(t){s(t)}},l=Date.now(),c=t-(l-n);c<=0&&!o?(null!=i&&clearTimeout(i),o=!0,requestAnimationFrame(a)):i||o?r():i=setTimeout((()=>requestAnimationFrame(a)),c)}))}}WidgetBox.__name__="WidgetBox",WidgetBox.init_WidgetBox();class RangeManager{constructor(e){this.parent=e,this.invalidate_dataranges=!0}get frame(){return this.parent.frame}update(e,t){const{x_ranges:i,y_ranges:n}=this.frame;if(null==e){for(const[,e]of i)e.reset();for(const[,e]of n)e.reset();this.update_dataranges()}else{const o=[];for(const[t,n]of i)o.push([n,e.xrs.get(t)]);for(const[t,i]of n)o.push([i,e.yrs.get(t)]);(null==t?void 0:t.scrolling)&&this._update_ranges_together(o),this._update_ranges_individually(o,t)}}reset(){this.update(null)}update_dataranges(){const e=new Map,t=new Map;let i=!1;for(const[,l]of this.frame.x_ranges)l instanceof DataRange1d&&"log"==l.scale_hint&&(i=!0);for(const[,l]of this.frame.y_ranges)l instanceof DataRange1d&&"log"==l.scale_hint&&(i=!0);for(const l of this.parent.model.data_renderers){const n=this.parent.renderer_view(l);if(null==n)continue;const o=n.glyph_view.bounds();if(null!=o&&e.set(l,o),i){const e=n.glyph_view.log_bounds();null!=e&&t.set(l,e)}}let n=!1,o=!1;const{width:r,height:s}=this.frame.bbox;let a;!1!==this.parent.model.match_aspect&&0!=r&&0!=s&&(a=1/this.parent.model.aspect_scale*(r/s));for(const[,l]of this.frame.x_ranges){if(l instanceof DataRange1d){const i="log"==l.scale_hint?t:e;l.update(i,0,this.parent.model,a),l.follow&&(n=!0)}null!=l.bounds&&(o=!0)}for(const[,l]of this.frame.y_ranges){if(l instanceof DataRange1d){const i="log"==l.scale_hint?t:e;l.update(i,1,this.parent.model,a),l.follow&&(n=!0)}null!=l.bounds&&(o=!0)}if(n&&o){logger.warn("Follow enabled so bounds are unset.");for(const[,e]of this.frame.x_ranges)e.bounds=null;for(const[,e]of this.frame.y_ranges)e.bounds=null}this.invalidate_dataranges=!1}compute_initial(){let e=!0;const{x_ranges:t,y_ranges:i}=this.frame,n=new Map,o=new Map;for(const[r,s]of t){const{start:t,end:i}=s;if(null==t||null==i||isNaN(t+i)){e=!1;break}n.set(r,{start:t,end:i})}if(e)for(const[r,s]of i){const{start:t,end:i}=s;if(null==t||null==i||isNaN(t+i)){e=!1;break}o.set(r,{start:t,end:i})}return e?{xrs:n,yrs:o}:(logger.warn("could not set initial ranges"),null)}_update_ranges_together(e){let t=1;for(const[i,n]of e)t=Math.min(t,this._get_weight_to_constrain_interval(i,n));if(t<1)for(const[i,n]of e)n.start=t*n.start+(1-t)*i.start,n.end=t*n.end+(1-t)*i.end}_update_ranges_individually(e,t){const i=!!(null==t?void 0:t.panning),n=!!(null==t?void 0:t.scrolling);let o=!1;for(const[r,s]of e){if(!n){const e=this._get_weight_to_constrain_interval(r,s);e<1&&(s.start=e*s.start+(1-e)*r.start,s.end=e*s.end+(1-e)*r.end)}if(null!=r.bounds&&"auto"!=r.bounds){const[e,t]=r.bounds,a=Math.abs(s.end-s.start);r.is_reversed?(null!=e&&e>=s.end&&(o=!0,s.end=e,(i||n)&&(s.start=e+a)),null!=t&&t<=s.start&&(o=!0,s.start=t,(i||n)&&(s.end=t-a))):(null!=e&&e>=s.start&&(o=!0,s.start=e,(i||n)&&(s.end=e+a)),null!=t&&t<=s.end&&(o=!0,s.end=t,(i||n)&&(s.start=t-a)))}}if(!(n&&o&&(null==t?void 0:t.maintain_focus)))for(const[r,s]of e)r.have_updated_interactively=!0,r.start==s.start&&r.end==s.end||r.setv(s)}_get_weight_to_constrain_interval(e,t){const{min_interval:i}=e;let{max_interval:n}=e;if(null!=e.bounds&&"auto"!=e.bounds){const[t,i]=e.bounds;if(null!=t&&null!=i){const e=Math.abs(i-t);n=null!=n?Math.min(n,e):e}}let o=1;if(null!=i||null!=n){const r=Math.abs(e.end-e.start),s=Math.abs(t.end-t.start);null!=i&&i>0&&s<i&&(o=(r-i)/(r-s)),null!=n&&n>0&&s>n&&(o=(n-r)/(s-r)),o=Math.max(0,Math.min(1,o))}return o}}RangeManager.__name__="RangeManager";class StateManager{constructor(e,t){this.parent=e,this.initial_state=t,this.changed=new Signal0(this.parent,"state_changed"),this.history=[],this.index=-1}_do_state_change(e){const t=null!=this.history[e]?this.history[e].state:this.initial_state;null!=t.range&&this.parent.update_range(t.range),null!=t.selection&&this.parent.update_selection(t.selection)}push(e,t){const{history:i,index:n}=this,o=null!=i[n]?i[n].state:{},r=__spreadValues(__spreadValues(__spreadValues({},this.initial_state),o),t);this.history=this.history.slice(0,this.index+1),this.history.push({type:e,state:r}),this.index=this.history.length-1,this.changed.emit()}clear(){this.history=[],this.index=-1,this.changed.emit()}undo(){this.can_undo&&(this.index-=1,this._do_state_change(this.index),this.changed.emit())}redo(){this.can_redo&&(this.index+=1,this._do_state_change(this.index),this.changed.emit())}get can_undo(){return this.index>=0}get can_redo(){return this.index<this.history.length-1}}StateManager.__name__="StateManager";class PlotView extends LayoutDOMView{constructor(){super(...arguments),this._outer_bbox=new BBox,this._inner_bbox=new BBox,this._needs_paint=!0,this._needs_layout=!1,this._invalidated_painters=new Set,this._invalidate_all=!0}get canvas(){return this.canvas_view}get state(){return this._state_manager}set invalidate_dataranges(e){this._range_manager.invalidate_dataranges=e}renderer_view(e){const t=this.renderer_views.get(e);if(null==t)for(const[,i]of this.renderer_views){const t=i.renderer_view(e);if(null!=t)return t}return t}get is_paused(){return null!=this._is_paused&&0!==this._is_paused}get child_models(){return[]}pause(){null==this._is_paused?this._is_paused=1:this._is_paused+=1}unpause(e=!1){if(null==this._is_paused)throw new Error("wasn't paused");this._is_paused-=1,0!=this._is_paused||e||this.request_paint("everything")}request_render(){this.request_paint("everything")}request_paint(e){this.invalidate_painters(e),this.schedule_paint()}invalidate_painters(e){if("everything"==e)this._invalidate_all=!0;else if(isArray(e))for(const t of e)this._invalidated_painters.add(t);else this._invalidated_painters.add(e)}schedule_paint(){if(!this.is_paused){const e=this.throttled_paint();this._ready=this._ready.then((()=>e))}}request_layout(){this._needs_layout=!0,this.request_paint("everything")}reset(){"standard"==this.model.reset_policy&&(this.state.clear(),this.reset_range(),this.reset_selection()),this.model.trigger_event(new Reset)}remove(){remove_views(this.renderer_views),remove_views(this.tool_views),this.canvas_view.remove(),super.remove()}render(){super.render(),this.el.appendChild(this.canvas_view.el),this.canvas_view.render()}initialize(){this.pause(),super.initialize(),this.lod_started=!1,this.visuals=new Visuals(this),this._initial_state={selection:new Map,dimensions:{width:0,height:0}},this.visibility_callbacks=[],this.renderer_views=new Map,this.tool_views=new Map,this.frame=new CartesianFrame(this.model.x_scale,this.model.y_scale,this.model.x_range,this.model.y_range,this.model.extra_x_ranges,this.model.extra_y_ranges),this._range_manager=new RangeManager(this),this._state_manager=new StateManager(this,this._initial_state),this.throttled_paint=throttle((()=>this.repaint()),1e3/60);const{title_location:e,title:t}=this.model;null!=e&&null!=t&&(this._title=t instanceof Title?t:new Title({text:t}));const{toolbar_location:i,toolbar:n}=this.model;null!=i&&null!=n&&(this._toolbar=new ToolbarPanel({toolbar:n}),n.toolbar_location=i)}async lazy_initialize(){await super.lazy_initialize();const{hidpi:e,output_backend:t}=this.model,i=new Canvas({hidpi:e,output_backend:t});this.canvas_view=await build_view(i,{parent:this}),this.canvas_view.plot_views=[this],await this.build_renderer_views(),await this.build_tool_views(),this._range_manager.update_dataranges(),this.unpause(!0),logger.debug("PlotView initialized")}_width_policy(){return null==this.model.frame_width?super._width_policy():"min"}_height_policy(){return null==this.model.frame_height?super._height_policy():"min"}_update_layout(){var e,t,i,n,o;this.layout=new BorderLayout,this.layout.set_sizing(this.box_sizing());const r=copy(this.model.above),s=copy(this.model.below),a=copy(this.model.left),l=copy(this.model.right),c=e=>{switch(e){case"above":return r;case"below":return s;case"left":return a;case"right":return l}},{title_location:d,title:h}=this.model;null!=d&&null!=h&&c(d).push(this._title);const{toolbar_location:u,toolbar:p}=this.model;if(null!=u&&null!=p){const e=c(u);let t=!0;if(this.model.toolbar_sticky)for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof Title){e[i]="above"==u||"below"==u?[n,this._toolbar]:[this._toolbar,n],t=!1;break}}t&&e.push(this._toolbar)}const _=(e,t)=>{var i;const n=this.renderer_view(t);return n.panel=new Panel$1(e),null==(i=n.update_layout)||i.call(n),n.layout},f=(e,t)=>{const i="above"==e||"below"==e,n=[];for(const o of t)if(isArray(o)){const t=o.map((t=>{const n=_(e,t);if(t instanceof ToolbarPanel){const e=i?"width_policy":"height_policy";n.set_sizing(__spreadProps(__spreadValues({},n.sizing),{[e]:"min"}))}return n}));let r;i?(r=new Row$1(t),r.set_sizing({width_policy:"max",height_policy:"min"})):(r=new Column$1(t),r.set_sizing({width_policy:"min",height_policy:"max"})),r.absolute=!0,n.push(r)}else n.push(_(e,o));return n},g=null!=(e=this.model.min_border)?e:0;this.layout.min_border={left:null!=(t=this.model.min_border_left)?t:g,top:null!=(i=this.model.min_border_top)?i:g,right:null!=(n=this.model.min_border_right)?n:g,bottom:null!=(o=this.model.min_border_bottom)?o:g};const m=new NodeLayout,v=new VStack,b=new VStack,y=new HStack,w=new HStack;m.absolute=!0,v.absolute=!0,b.absolute=!0,y.absolute=!0,w.absolute=!0,m.children=this.model.center.filter((e=>e instanceof Annotation)).map((e=>{var t;const i=this.renderer_view(e);return null==(t=i.update_layout)||t.call(i),i.layout})).filter((e=>null!=e));const{frame_width:A,frame_height:x}=this.model;m.set_sizing(__spreadValues(__spreadValues({},null!=A?{width_policy:"fixed",width:A}:{width_policy:"fit"}),null!=x?{height_policy:"fixed",height:x}:{height_policy:"fit"})),m.on_resize((e=>this.frame.set_geometry(e))),v.children=reversed(f("above",r)),b.children=f("below",s),y.children=reversed(f("left",a)),w.children=f("right",l),v.set_sizing({width_policy:"fit",height_policy:"min"}),b.set_sizing({width_policy:"fit",height_policy:"min"}),y.set_sizing({width_policy:"min",height_policy:"fit"}),w.set_sizing({width_policy:"min",height_policy:"fit"}),this.layout.center_panel=m,this.layout.top_panel=v,this.layout.bottom_panel=b,this.layout.left_panel=y,this.layout.right_panel=w}get axis_views(){const e=[];for(const[,t]of this.renderer_views)t instanceof AxisView&&e.push(t);return e}set_toolbar_visibility(e){for(const t of this.visibility_callbacks)t(e)}update_range(e,t){this.pause(),this._range_manager.update(e,t),this.unpause()}reset_range(){this.update_range(null)}get_selection(){const e=new Map;for(const t of this.model.data_renderers){const{selected:i}=t.selection_manager.source;e.set(t,i)}return e}update_selection(e){for(const t of this.model.data_renderers){const i=t.selection_manager.source;if(null!=e){const n=e.get(t);null!=n&&i.selected.update(n,!0)}else i.selection_manager.clear()}}reset_selection(){this.update_selection(null)}_invalidate_layout(){(()=>{var e;for(const t of this.model.side_panels){const i=this.renderer_views.get(t);if(null==(e=i.layout)?void 0:e.has_size_changed())return this.invalidate_painters(i),!0}return!1})()&&this.root.compute_layout()}get_renderer_views(){return this.computed_renderers.map((e=>this.renderer_views.get(e)))}*_compute_renderers(){const{above:e,below:t,left:i,right:n,center:o,renderers:r}=this.model;yield*r,yield*e,yield*t,yield*i,yield*n,yield*o,null!=this._title&&(yield this._title),null!=this._toolbar&&(yield this._toolbar);for(const s of this.model.toolbar.tools)null!=s.overlay&&(yield s.overlay),yield*s.synthetic_renderers}async build_renderer_views(){this.computed_renderers=[...this._compute_renderers()],await build_views(this.renderer_views,this.computed_renderers,{parent:this})}async build_tool_views(){const e=this.model.toolbar.tools;(await build_views(this.tool_views,e,{parent:this})).map((e=>this.canvas_view.ui_event_bus.register_tool(e)))}connect_signals(){super.connect_signals();const{x_ranges:e,y_ranges:t}=this.frame;for(const[,l]of e)this.connect(l.change,(()=>{this._needs_layout=!0,this.request_paint("everything")}));for(const[,l]of t)this.connect(l.change,(()=>{this._needs_layout=!0,this.request_paint("everything")}));const{above:i,below:n,left:o,right:r,center:s,renderers:a}=this.model.properties;this.on_change([i,n,o,r,s,a],(async()=>await this.build_renderer_views())),this.connect(this.model.toolbar.properties.tools.change,(async()=>{await this.build_renderer_views(),await this.build_tool_views()})),this.connect(this.model.change,(()=>this.request_paint("everything"))),this.connect(this.model.reset,(()=>this.reset()))}has_finished(){if(!super.has_finished())return!1;if(this.model.visible)for(const[,e]of this.renderer_views)if(!e.has_finished())return!1;return!0}after_layout(){var e;super.after_layout();for(const[,i]of this.renderer_views)i instanceof AnnotationView&&(null==(e=i.after_layout)||e.call(i));if(this._needs_layout=!1,this.model.setv({inner_width:Math.round(this.frame.bbox.width),inner_height:Math.round(this.frame.bbox.height),outer_width:Math.round(this.layout.bbox.width),outer_height:Math.round(this.layout.bbox.height)},{no_change:!0}),!1!==this.model.match_aspect&&(this.pause(),this._range_manager.update_dataranges(),this.unpause(!0)),!this._outer_bbox.equals(this.layout.bbox)){const{width:e,height:t}=this.layout.bbox;this.canvas_view.resize(e,t),this._outer_bbox=this.layout.bbox,this._invalidate_all=!0,this._needs_paint=!0}const{inner_bbox:t}=this.layout;this._inner_bbox.equals(t)||(this._inner_bbox=t,this._needs_paint=!0),this._needs_paint&&this.paint()}repaint(){this._needs_layout&&this._invalidate_layout(),this.paint()}paint(){var e;if(this.is_paused||!this.model.visible)return;logger.trace(`PlotView.paint() for ${this.model.id}`);const{document:t}=this.model;if(null!=t){const e=t.interactive_duration();e>=0&&e<this.model.lod_interval?setTimeout((()=>{t.interactive_duration()>this.model.lod_timeout&&t.interactive_stop(),this.request_paint("everything")}),this.model.lod_timeout):t.interactive_stop()}this._range_manager.invalidate_dataranges&&(this._range_manager.update_dataranges(),this._invalidate_layout());let i=!1,n=!1;if(this._invalidate_all)i=!0,n=!0;else for(const a of this._invalidated_painters){const{level:e}=a.model;if("overlay"!=e?i=!0:n=!0,i&&n)break}this._invalidated_painters.clear(),this._invalidate_all=!1;const o=[this.frame.bbox.left,this.frame.bbox.top,this.frame.bbox.width,this.frame.bbox.height],{primary:r,overlays:s}=this.canvas_view;i&&(r.prepare(),this.canvas_view.prepare_webgl(o),this._map_hook(r.ctx,o),this._paint_empty(r.ctx,o),this._paint_outline(r.ctx,o),this._paint_levels(r.ctx,"image",o,!0),this._paint_levels(r.ctx,"underlay",o,!0),this._paint_levels(r.ctx,"glyph",o,!0),this._paint_levels(r.ctx,"guide",o,!1),this._paint_levels(r.ctx,"annotation",o,!1),r.finish()),(n||settings.wireframe)&&(s.prepare(),this._paint_levels(s.ctx,"overlay",o,!1),settings.wireframe&&this._paint_layout(s.ctx,this.layout),s.finish()),null==this._initial_state.range&&(this._initial_state.range=null!=(e=this._range_manager.compute_initial())?e:void 0),this._needs_paint=!1}_paint_levels(e,t,i,n){for(const o of this.computed_renderers){if(o.level!=t)continue;const r=this.renderer_views.get(o);e.save(),(n||r.needs_clip)&&(e.beginPath(),e.rect(...i),e.clip()),r.render(),e.restore(),r.has_webgl&&r.needs_webgl_blit&&this.canvas_view.blit_webgl(e)}}_paint_layout(e,t){const{x:i,y:n,width:o,height:r}=t.bbox;e.strokeStyle="blue",e.strokeRect(i,n,o,r);for(const s of t)e.save(),t.absolute||e.translate(i,n),this._paint_layout(e,s),e.restore()}_map_hook(e,t){}_paint_empty(e,t){const[i,n,o,r]=[0,0,this.layout.bbox.width,this.layout.bbox.height],[s,a,l,c]=t;this.visuals.border_fill.doit&&(this.visuals.border_fill.set_value(e),e.fillRect(i,n,o,r),e.clearRect(s,a,l,c)),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(e),e.fillRect(s,a,l,c))}_paint_outline(e,t){if(this.visuals.outline_line.doit){e.save(),this.visuals.outline_line.set_value(e);let[i,n,o,r]=t;i+o==this.layout.bbox.width&&(o-=1),n+r==this.layout.bbox.height&&(r-=1),e.strokeRect(i,n,o,r),e.restore()}}to_blob(){return this.canvas_view.to_blob()}export(e,t=!0){const i=new CanvasLayer("png"==e?"canvas":"svg",t),{width:n,height:o}=this.layout.bbox;i.resize(n,o);const{canvas:r}=this.canvas_view.compose();return i.ctx.drawImage(r,0,0),i}serializable_state(){const e=super.serializable_state(),{children:t}=e,i=__objRest(e,["children"]),n=this.get_renderer_views().map((e=>e.serializable_state())).filter((e=>null!=e.bbox));return __spreadProps(__spreadValues({},i),{children:[...null!=t?t:[],...n]})}}PlotView.__name__="PlotView";class Plot extends LayoutDOM{constructor(e){super(e),this.use_map=!1}static init_Plot(){this.prototype.default_view=PlotView,this.mixins([["outline_",Line$2],["background_",Fill$1],["border_",Fill$1]]),this.define((({Boolean:e,Number:t,String:i,Array:n,Dict:o,Or:r,Ref:s,Null:a,Nullable:l})=>({toolbar:[s(Toolbar),()=>new Toolbar],toolbar_location:[l(Location),"right"],toolbar_sticky:[e,!0],plot_width:[Alias("width")],plot_height:[Alias("height")],frame_width:[l(t),null],frame_height:[l(t),null],title:[r(s(Title),i,a),()=>new Title({text:""})],title_location:[l(Location),"above"],above:[n(r(s(Annotation),s(Axis))),[]],below:[n(r(s(Annotation),s(Axis))),[]],left:[n(r(s(Annotation),s(Axis))),[]],right:[n(r(s(Annotation),s(Axis))),[]],center:[n(r(s(Annotation),s(Grid))),[]],renderers:[n(s(Renderer)),[]],x_range:[s(Range$1),()=>new DataRange1d],extra_x_ranges:[o(s(Range$1)),{}],y_range:[s(Range$1),()=>new DataRange1d],extra_y_ranges:[o(s(Range$1)),{}],x_scale:[s(Scale),()=>new LinearScale],y_scale:[s(Scale),()=>new LinearScale],lod_factor:[t,10],lod_interval:[t,300],lod_threshold:[l(t),2e3],lod_timeout:[t,500],hidpi:[e,!0],output_backend:[OutputBackend,"canvas"],min_border:[l(t),5],min_border_top:[l(t),null],min_border_left:[l(t),null],min_border_bottom:[l(t),null],min_border_right:[l(t),null],inner_width:[t,0],inner_height:[t,0],outer_width:[t,0],outer_height:[t,0],match_aspect:[e,!1],aspect_scale:[t,1],reset_policy:[ResetPolicy,"standard"]}))),this.override({width:600,height:600,outline_line_color:"#e5e5e5",border_fill_color:"#ffffff",background_fill_color:"#ffffff"})}_doc_attached(){super._doc_attached(),this._push_changes([[this.properties.inner_height,null,this.inner_height],[this.properties.inner_width,null,this.inner_width]])}initialize(){super.initialize(),this.reset=new Signal0(this,"reset");for(const e of values(this.extra_x_ranges).concat(this.x_range)){let t=e.plots;isArray(t)&&(t=t.concat(this),e.setv({plots:t},{silent:!0}))}for(const e of values(this.extra_y_ranges).concat(this.y_range)){let t=e.plots;isArray(t)&&(t=t.concat(this),e.setv({plots:t},{silent:!0}))}}add_layout(e,t="center"){const i=this.properties[t].get_value();this.setv({[t]:[...i,e]})}remove_layout(e){const t=t=>{remove_by(t,(t=>t==e))};t(this.left),t(this.right),t(this.above),t(this.below),t(this.center)}get data_renderers(){return this.renderers.filter((e=>e instanceof DataRenderer))}add_renderers(...e){this.renderers=this.renderers.concat(e)}add_glyph(e,t=new ColumnDataSource,i={}){const n=new GlyphRenderer(__spreadProps(__spreadValues({},i),{data_source:t,glyph:e}));return this.add_renderers(n),n}add_tools(...e){this.toolbar.tools=this.toolbar.tools.concat(e)}get panels(){return[...this.side_panels,...this.center]}get side_panels(){const{above:e,below:t,left:i,right:n}=this;return concat$1([e,t,i,n])}}Plot.__name__="Plot",Plot.init_Plot();const gmaps_ready=new Signal0({},"gmaps_ready"),load_google_api=function(e,t){window._bokeh_gmaps_callback=()=>gmaps_ready.emit();const i=encodeURIComponent,n=document.createElement("script");n.type="text/javascript",n.src=`https://maps.googleapis.com/maps/api/js?v=${i(t)}&key=${i(e)}&callback=_bokeh_gmaps_callback`,document.body.appendChild(n)};class GMapPlotView extends PlotView{initialize(){this.pause(),super.initialize(),this._tiles_loaded=!1,this.zoom_count=0;const{zoom:e,lat:t,lng:i}=this.model.map_options;if(this.initial_zoom=e,this.initial_lat=t,this.initial_lng=i,!this.model.api_key){const e="https://developers.google.com/maps/documentation/javascript/get-api-key";logger.error(`api_key is required. See ${e} for more information on how to obtain your own.`)}if("undefined"==typeof google||null==google.maps){if(void 0===window._bokeh_gmaps_callback){const{api_key:e,api_version:t}=this.model;load_google_api(e,t)}gmaps_ready.connect((()=>this.request_paint("everything")))}this.unpause()}remove(){remove(this.map_el),super.remove()}update_range(e,t){var i,n;if(null==e)this.map.setCenter({lat:this.initial_lat,lng:this.initial_lng}),this.map.setOptions({zoom:this.initial_zoom}),super.update_range(null,t);else if(null!=e.sdx||null!=e.sdy)this.map.panBy(null!=(i=e.sdx)?i:0,null!=(n=e.sdy)?n:0),super.update_range(e,t);else if(null!=e.factor){if(10!==this.zoom_count)return void(this.zoom_count+=1);this.zoom_count=0,this.pause(),super.update_range(e,t);const i=e.factor<0?-1:1,n=this.map.getZoom(),o=n+i;if(o>=2){this.map.setZoom(o);const[e,t,,]=this._get_projected_bounds();t-e<0&&this.map.setZoom(n)}this.unpause()}this._set_bokeh_ranges()}_build_map(){const{maps:e}=google;this.map_types={satellite:e.MapTypeId.SATELLITE,terrain:e.MapTypeId.TERRAIN,roadmap:e.MapTypeId.ROADMAP,hybrid:e.MapTypeId.HYBRID};const t=this.model.map_options,i={center:new e.LatLng(t.lat,t.lng),zoom:t.zoom,disableDefaultUI:!0,mapTypeId:this.map_types[t.map_type],scaleControl:t.scale_control,tilt:t.tilt};null!=t.styles&&(i.styles=JSON.parse(t.styles)),this.map_el=div({style:{position:"absolute"}}),this.canvas_view.add_underlay(this.map_el),this.map=new e.Map(this.map_el,i),e.event.addListener(this.map,"idle",(()=>this._set_bokeh_ranges())),e.event.addListener(this.map,"bounds_changed",(()=>this._set_bokeh_ranges())),e.event.addListenerOnce(this.map,"tilesloaded",(()=>this._render_finished())),this.connect(this.model.properties.map_options.change,(()=>this._update_options())),this.connect(this.model.map_options.properties.styles.change,(()=>this._update_styles())),this.connect(this.model.map_options.properties.lat.change,(()=>this._update_center("lat"))),this.connect(this.model.map_options.properties.lng.change,(()=>this._update_center("lng"))),this.connect(this.model.map_options.properties.zoom.change,(()=>this._update_zoom())),this.connect(this.model.map_options.properties.map_type.change,(()=>this._update_map_type())),this.connect(this.model.map_options.properties.scale_control.change,(()=>this._update_scale_control())),this.connect(this.model.map_options.properties.tilt.change,(()=>this._update_tilt()))}_render_finished(){this._tiles_loaded=!0,this.notify_finished()}has_finished(){return super.has_finished()&&!0===this._tiles_loaded}_get_latlon_bounds(){const e=this.map.getBounds(),t=e.getNorthEast(),i=e.getSouthWest();return[i.lng(),t.lng(),i.lat(),t.lat()]}_get_projected_bounds(){const[e,t,i,n]=this._get_latlon_bounds(),[o,r]=wgs84_mercator.compute(e,i),[s,a]=wgs84_mercator.compute(t,n);return[o,s,r,a]}_set_bokeh_ranges(){const[e,t,i,n]=this._get_projected_bounds();this.frame.x_range.setv({start:e,end:t}),this.frame.y_range.setv({start:i,end:n})}_update_center(e){const t=this.map.getCenter().toJSON();t[e]=this.model.map_options[e],this.map.setCenter(t),this._set_bokeh_ranges()}_update_map_type(){this.map.setOptions({mapTypeId:this.map_types[this.model.map_options.map_type]})}_update_scale_control(){this.map.setOptions({scaleControl:this.model.map_options.scale_control})}_update_tilt(){this.map.setOptions({tilt:this.model.map_options.tilt})}_update_options(){this._update_styles(),this._update_center("lat"),this._update_center("lng"),this._update_zoom(),this._update_map_type()}_update_styles(){this.map.setOptions({styles:JSON.parse(this.model.map_options.styles)})}_update_zoom(){this.map.setOptions({zoom:this.model.map_options.zoom}),this._set_bokeh_ranges()}_map_hook(e,t){if(null==this.map&&"undefined"!=typeof google&&null!=google.maps&&this._build_map(),null!=this.map_el){const[e,i,n,o]=t;this.map_el.style.top=`${i}px`,this.map_el.style.left=`${e}px`,this.map_el.style.width=`${n}px`,this.map_el.style.height=`${o}px`}}_paint_empty(e,t){const i=this.layout.bbox.width,n=this.layout.bbox.height,[o,r,s,a]=t;e.clearRect(0,0,i,n),e.beginPath(),e.moveTo(0,0),e.lineTo(0,n),e.lineTo(i,n),e.lineTo(i,0),e.lineTo(0,0),e.moveTo(o,r),e.lineTo(o+s,r),e.lineTo(o+s,r+a),e.lineTo(o,r+a),e.lineTo(o,r),e.closePath(),null!=this.model.border_fill_color&&(e.fillStyle=color2css(this.model.border_fill_color),e.fill())}}GMapPlotView.__name__="GMapPlotView";class MapOptions extends Model{constructor(e){super(e)}static init_MapOptions(){this.define((({Int:e,Number:t})=>({lat:[t],lng:[t],zoom:[e,12]})))}}MapOptions.__name__="MapOptions",MapOptions.init_MapOptions();class GMapOptions extends MapOptions{constructor(e){super(e)}static init_GMapOptions(){this.define((({Boolean:e,Int:t,String:i})=>({map_type:[i,"roadmap"],scale_control:[e,!1],styles:[i],tilt:[t,45]})))}}GMapOptions.__name__="GMapOptions",GMapOptions.init_GMapOptions();class GMapPlot extends Plot{constructor(e){super(e),this.use_map=!0}static init_GMapPlot(){this.prototype.default_view=GMapPlotView,this.define((({String:e,Ref:t})=>({map_options:[t(GMapOptions)],api_key:[e],api_version:[e,"3.43"]}))),this.override({x_range:()=>new Range1d,y_range:()=>new Range1d})}}GMapPlot.__name__="GMapPlot",GMapPlot.init_GMapPlot();class WebDataSource extends ColumnDataSource{constructor(e){super(e)}get_column(e){const t=this.data[e];return null!=t?t:[]}get_length(){var e;return null!=(e=super.get_length())?e:0}initialize(){super.initialize(),this.setup()}load_data(e,t,i){const{adapter:n}=this;let o;switch(o=null!=n?n.execute(this,{response:e}):e,t){case"replace":this.data=o;break;case"append":{const e=this.data;for(const t of this.columns()){const n=Array.from(e[t]),r=Array.from(o[t]),s=n.concat(r);o[t]=null!=i?s.slice(-i):s}this.data=o;break}}}static init_WebDataSource(){this.define((({Any:e,Int:t,String:i,Nullable:n})=>({max_size:[n(t),null],mode:[UpdateMode,"replace"],adapter:[n(e),null],data_url:[i]})))}}WebDataSource.__name__="WebDataSource",WebDataSource.init_WebDataSource();class ServerSentDataSource extends WebDataSource{constructor(e){super(e),this.initialized=!1}setup(){if(!this.initialized){this.initialized=!0;new EventSource(this.data_url).onmessage=e=>{var t;this.load_data(JSON.parse(e.data),this.mode,null!=(t=this.max_size)?t:void 0)}}}}ServerSentDataSource.__name__="ServerSentDataSource";class AjaxDataSource extends WebDataSource{constructor(e){super(e),this.interval=null,this.initialized=!1}static init_AjaxDataSource(){this.define((({Boolean:e,Int:t,String:i,Dict:n,Nullable:o})=>({polling_interval:[o(t),null],content_type:[i,"application/json"],http_headers:[n(i),{}],method:[HTTPMethod,"POST"],if_modified:[e,!1]})))}destroy(){null!=this.interval&&clearInterval(this.interval),super.destroy()}setup(){if(!this.initialized&&(this.initialized=!0,this.get_data(this.mode),null!=this.polling_interval)){const e=()=>this.get_data(this.mode,this.max_size,this.if_modified);this.interval=setInterval(e,this.polling_interval)}}get_data(e,t=null,i=!1){const n=this.prepare_request();n.addEventListener("load",(()=>this.do_load(n,e,null!=t?t:void 0))),n.addEventListener("error",(()=>this.do_error(n))),n.send()}prepare_request(){const e=new XMLHttpRequest;e.open(this.method,this.data_url,!0),e.withCredentials=!1,e.setRequestHeader("Content-Type",this.content_type);const t=this.http_headers;for(const[i,n]of entries(t))e.setRequestHeader(i,n);return e}do_load(e,t,i){if(200===e.status){const n=JSON.parse(e.responseText);this.load_data(n,t,i)}}do_error(e){logger.error(`Failed to fetch JSON from ${this.data_url} with code ${e.status}`)}}function orNaN(e){return null!=e?e:NaN}AjaxDataSource.__name__="AjaxDataSource",AjaxDataSource.init_AjaxDataSource();const{hasOwnProperty:hasOwnProperty$2}=Object.prototype;class GeoJSONDataSource extends ColumnarDataSource{constructor(e){super(e)}static init_GeoJSONDataSource(){this.define((({String:e})=>({geojson:[e]}))),this.internal((({Dict:e,Arrayable:t})=>({data:[e(t),{}]})))}initialize(){super.initialize(),this._update_data()}connect_signals(){super.connect_signals(),this.connect(this.properties.geojson.change,(()=>this._update_data()))}_update_data(){this.data=this.geojson_to_column_data()}_get_new_list_array(e){return range(0,e).map((e=>[]))}_get_new_nan_array(e){return range(0,e).map((e=>NaN))}_add_properties(e,t,i,n){var o;const r=null!=(o=e.properties)?o:{};for(const[s,a]of entries(r))hasOwnProperty$2.call(t,s)||(t[s]=this._get_new_nan_array(n)),t[s][i]=orNaN(a)}_add_geometry(e,t,i){function n(e,t){return e.concat([[NaN,NaN,NaN]]).concat(t)}switch(e.type){case"Point":{const[n,o,r]=e.coordinates;t.x[i]=n,t.y[i]=o,t.z[i]=orNaN(r);break}case"LineString":{const{coordinates:n}=e;for(let e=0;e<n.length;e++){const[o,r,s]=n[e];t.xs[i][e]=o,t.ys[i][e]=r,t.zs[i][e]=orNaN(s)}break}case"Polygon":{e.coordinates.length>1&&logger.warn("Bokeh does not support Polygons with holes in, only exterior ring used.");const n=e.coordinates[0];for(let e=0;e<n.length;e++){const[o,r,s]=n[e];t.xs[i][e]=o,t.ys[i][e]=r,t.zs[i][e]=orNaN(s)}break}case"MultiPoint":logger.warn("MultiPoint not supported in Bokeh");break;case"MultiLineString":{const o=e.coordinates.reduce(n);for(let e=0;e<o.length;e++){const[n,r,s]=o[e];t.xs[i][e]=n,t.ys[i][e]=r,t.zs[i][e]=orNaN(s)}break}case"MultiPolygon":{const o=[];for(const t of e.coordinates)t.length>1&&logger.warn("Bokeh does not support Polygons with holes in, only exterior ring used."),o.push(t[0]);const r=o.reduce(n);for(let e=0;e<r.length;e++){const[n,o,s]=r[e];t.xs[i][e]=n,t.ys[i][e]=o,t.zs[i][e]=orNaN(s)}break}default:throw new Error(`Invalid GeoJSON geometry type: ${e.type}`)}}geojson_to_column_data(){const e=JSON.parse(this.geojson);let t;switch(e.type){case"GeometryCollection":if(null==e.geometries)throw new Error("No geometries found in GeometryCollection");if(0===e.geometries.length)throw new Error("geojson.geometries must have one or more items");t=e.geometries;break;case"FeatureCollection":if(null==e.features)throw new Error("No features found in FeaturesCollection");if(0==e.features.length)throw new Error("geojson.features must have one or more items");t=e.features;break;default:throw new Error("Bokeh only supports type GeometryCollection and FeatureCollection at top level")}let i=0;for(const r of t){const e="Feature"===r.type?r.geometry:r;"GeometryCollection"==e.type?i+=e.geometries.length:i+=1}const n={x:this._get_new_nan_array(i),y:this._get_new_nan_array(i),z:this._get_new_nan_array(i),xs:this._get_new_list_array(i),ys:this._get_new_list_array(i),zs:this._get_new_list_array(i)};let o=0;for(const r of t){const e="Feature"==r.type?r.geometry:r;if("GeometryCollection"==e.type)for(const t of e.geometries)this._add_geometry(t,n,o),"Feature"===r.type&&this._add_properties(r,n,o,i),o+=1;else this._add_geometry(e,n,o),"Feature"===r.type&&this._add_properties(r,n,o,i),o+=1}return n}}GeoJSONDataSource.__name__="GeoJSONDataSource",GeoJSONDataSource.init_GeoJSONDataSource();class TileSource extends Model{constructor(e){super(e)}static init_TileSource(){this.define((({Number:e,String:t,Dict:i,Nullable:n})=>({url:[t,""],tile_size:[e,256],max_zoom:[e,30],min_zoom:[e,0],extra_url_vars:[i(t),{}],attribution:[t,""],x_origin_offset:[e],y_origin_offset:[e],initial_resolution:[n(e),null]})))}initialize(){super.initialize(),this.tiles=new Map,this._normalize_case()}connect_signals(){super.connect_signals(),this.connect(this.change,(()=>this._clear_cache()))}string_lookup_replace(e,t){let i=e;for(const[n,o]of entries(t))i=i.replace(`{${n}}`,o);return i}_normalize_case(){const e=this.url.replace("{x}","{X}").replace("{y}","{Y}").replace("{z}","{Z}").replace("{q}","{Q}").replace("{xmin}","{XMIN}").replace("{ymin}","{YMIN}").replace("{xmax}","{XMAX}").replace("{ymax}","{YMAX}");this.url=e}_clear_cache(){this.tiles=new Map}tile_xyz_to_key(e,t,i){return`${e}:${t}:${i}`}key_to_tile_xyz(e){const[t,i,n]=e.split(":").map((e=>parseInt(e)));return[t,i,n]}sort_tiles_from_center(e,t){const[i,n,o,r]=t,s=(o-i)/2+i,a=(r-n)/2+n;e.sort((function(e,t){return Math.sqrt((s-e[0])**2+(a-e[1])**2)-Math.sqrt((s-t[0])**2+(a-t[1])**2)}))}get_image_url(e,t,i){return this.string_lookup_replace(this.url,this.extra_url_vars).replace("{X}",e.toString()).replace("{Y}",t.toString()).replace("{Z}",i.toString())}}function meters_to_geographic(e,t){return wgs84_mercator.invert(e,t)}function meters_extent_to_geographic(e){const[t,i,n,o]=e,[r,s]=meters_to_geographic(t,i),[a,l]=meters_to_geographic(n,o);return[r,s,a,l]}TileSource.__name__="TileSource",TileSource.init_TileSource();class MercatorTileSource extends TileSource{constructor(e){super(e)}static init_MercatorTileSource(){this.define((({Boolean:e})=>({snap_to_zoom:[e,!1],wrap_around:[e,!0]}))),this.override({x_origin_offset:20037508.34,y_origin_offset:20037508.34,initial_resolution:156543.03392804097})}initialize(){super.initialize(),this._resolutions=range(this.min_zoom,this.max_zoom+1).map((e=>this.get_resolution(e)))}_computed_initial_resolution(){return null!=this.initial_resolution?this.initial_resolution:2*Math.PI*6378137/this.tile_size}is_valid_tile(e,t,i){return!(!this.wrap_around&&(e<0||e>=2**i))&&!(t<0||t>=2**i)}parent_by_tile_xyz(e,t,i){const n=this.tile_xyz_to_quadkey(e,t,i),o=n.substring(0,n.length-1);return this.quadkey_to_tile_xyz(o)}get_resolution(e){return this._computed_initial_resolution()/2**e}get_resolution_by_extent(e,t,i){return[(e[2]-e[0])/i,(e[3]-e[1])/t]}get_level_by_extent(e,t,i){const n=(e[2]-e[0])/i,o=(e[3]-e[1])/t,r=Math.max(n,o);let s=0;for(const a of this._resolutions){if(r>a){if(0==s)return 0;if(s>0)return s-1}s+=1}return s-1}get_closest_level_by_extent(e,t,i){const n=(e[2]-e[0])/i,o=(e[3]-e[1])/t,r=Math.max(n,o),s=this._resolutions.reduce((function(e,t){return Math.abs(t-r)<Math.abs(e-r)?t:e}));return this._resolutions.indexOf(s)}snap_to_zoom_level(e,t,i,n){const[o,r,s,a]=e,l=this._resolutions[n];let c=i*l,d=t*l;if(!this.snap_to_zoom){const e=(s-o)/c,t=(a-r)/d;e>t?(c=s-o,d*=e):(c*=t,d=a-r)}const h=(c-(s-o))/2,u=(d-(a-r))/2;return[o-h,r-u,s+h,a+u]}tms_to_wmts(e,t,i){return[e,2**i-1-t,i]}wmts_to_tms(e,t,i){return[e,2**i-1-t,i]}pixels_to_meters(e,t,i){const n=this.get_resolution(i);return[e*n-this.x_origin_offset,t*n-this.y_origin_offset]}meters_to_pixels(e,t,i){const n=this.get_resolution(i);return[(e+this.x_origin_offset)/n,(t+this.y_origin_offset)/n]}pixels_to_tile(e,t){let i=Math.ceil(e/this.tile_size);i=0===i?i:i-1;return[i,Math.max(Math.ceil(t/this.tile_size)-1,0)]}pixels_to_raster(e,t,i){return[e,(this.tile_size<<i)-t]}meters_to_tile(e,t,i){const[n,o]=this.meters_to_pixels(e,t,i);return this.pixels_to_tile(n,o)}get_tile_meter_bounds(e,t,i){const[n,o]=this.pixels_to_meters(e*this.tile_size,t*this.tile_size,i),[r,s]=this.pixels_to_meters((e+1)*this.tile_size,(t+1)*this.tile_size,i);return[n,o,r,s]}get_tile_geographic_bounds(e,t,i){const n=this.get_tile_meter_bounds(e,t,i),[o,r,s,a]=meters_extent_to_geographic(n);return[o,r,s,a]}get_tiles_by_extent(e,t,i=1){const[n,o,r,s]=e;let[a,l]=this.meters_to_tile(n,o,t),[c,d]=this.meters_to_tile(r,s,t);a-=i,l-=i,c+=i,d+=i;const h=[];for(let u=d;u>=l;u--)for(let e=a;e<=c;e++)this.is_valid_tile(e,u,t)&&h.push([e,u,t,this.get_tile_meter_bounds(e,u,t)]);return this.sort_tiles_from_center(h,[a,l,c,d]),h}quadkey_to_tile_xyz(e){let t=0,i=0;const n=e.length;for(let o=n;o>0;o--){const r=1<<o-1;switch(e.charAt(n-o)){case"0":continue;case"1":t|=r;break;case"2":i|=r;break;case"3":t|=r,i|=r;break;default:throw new TypeError(`Invalid Quadkey: ${e}`)}}return[t,i,n]}tile_xyz_to_quadkey(e,t,i){let n="";for(let o=i;o>0;o--){const i=1<<o-1;let r=0;0!=(e&i)&&(r+=1),0!=(t&i)&&(r+=2),n+=r.toString()}return n}children_by_tile_xyz(e,t,i){const n=this.tile_xyz_to_quadkey(e,t,i),o=[];for(let r=0;r<=3;r++){const[e,t,i]=this.quadkey_to_tile_xyz(n+r.toString()),s=this.get_tile_meter_bounds(e,t,i);o.push([e,t,i,s])}return o}get_closest_parent_by_tile_xyz(e,t,i){const n=this.calculate_world_x_by_tile_xyz(e,t,i);[e,t,i]=this.normalize_xyz(e,t,i);let o=this.tile_xyz_to_quadkey(e,t,i);for(;o.length>0;)if(o=o.substring(0,o.length-1),[e,t,i]=this.quadkey_to_tile_xyz(o),[e,t,i]=this.denormalize_xyz(e,t,i,n),this.tiles.has(this.tile_xyz_to_key(e,t,i)))return[e,t,i];return[0,0,0]}normalize_xyz(e,t,i){if(this.wrap_around){const n=2**i;return[(e%n+n)%n,t,i]}return[e,t,i]}denormalize_xyz(e,t,i,n){return[e+n*2**i,t,i]}denormalize_meters(e,t,i,n){return[e+2*n*Math.PI*6378137,t]}calculate_world_x_by_tile_xyz(e,t,i){return Math.floor(e/2**i)}}MercatorTileSource.__name__="MercatorTileSource",MercatorTileSource.init_MercatorTileSource();class BBoxTileSource extends MercatorTileSource{constructor(e){super(e)}static init_BBoxTileSource(){this.define((({Boolean:e})=>({use_latlon:[e,!1]})))}get_image_url(e,t,i){const n=this.string_lookup_replace(this.url,this.extra_url_vars);let o,r,s,a;return this.use_latlon?[r,a,o,s]=this.get_tile_geographic_bounds(e,t,i):[r,a,o,s]=this.get_tile_meter_bounds(e,t,i),n.replace("{XMIN}",r.toString()).replace("{YMIN}",a.toString()).replace("{XMAX}",o.toString()).replace("{YMAX}",s.toString())}}BBoxTileSource.__name__="BBoxTileSource",BBoxTileSource.init_BBoxTileSource();class QUADKEYTileSource extends MercatorTileSource{constructor(e){super(e)}get_image_url(e,t,i){const n=this.string_lookup_replace(this.url,this.extra_url_vars),[o,r,s]=this.tms_to_wmts(e,t,i),a=this.tile_xyz_to_quadkey(o,r,s);return n.replace("{Q}",a)}}QUADKEYTileSource.__name__="QUADKEYTileSource";class WMTSTileSource extends MercatorTileSource{constructor(e){super(e)}get_image_url(e,t,i){const n=this.string_lookup_replace(this.url,this.extra_url_vars),[o,r,s]=this.tms_to_wmts(e,t,i);return n.replace("{X}",o.toString()).replace("{Y}",r.toString()).replace("{Z}",s.toString())}}WMTSTileSource.__name__="WMTSTileSource";const tile_attribution="bk-tile-attribution";var tiles_css=".bk-root .bk-tile-attribution a{color:black;}";class TileRendererView extends RendererView{initialize(){this._tiles=[],super.initialize()}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render())),this.connect(this.model.tile_source.change,(()=>this.request_render()))}styles(){return[...super.styles(),tiles_css]}get_extent(){return[this.x_range.start,this.y_range.start,this.x_range.end,this.y_range.end]}get map_plot(){return this.plot_model}get map_canvas(){return this.layer.ctx}get map_frame(){return this.plot_view.frame}get x_range(){return this.map_plot.x_range}get y_range(){return this.map_plot.y_range}_set_data(){this.extent=this.get_extent(),this._last_height=void 0,this._last_width=void 0}_update_attribution(){null!=this.attribution_el&&removeElement(this.attribution_el);const{attribution:e}=this.model.tile_source;if(isString(e)&&e.length>0){const{layout:t,frame:i}=this.plot_view,n=t.bbox.width-i.bbox.right,o=t.bbox.height-i.bbox.bottom,r=i.bbox.width;this.attribution_el=div({class:tile_attribution,style:{position:"absolute",right:`${n}px`,bottom:`${o}px`,"max-width":r-4+"px",padding:"2px","background-color":"rgba(255,255,255,0.5)","font-size":"9px","line-height":"1.05","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),this.plot_view.canvas_view.add_event(this.attribution_el),this.attribution_el.innerHTML=e,this.attribution_el.title=this.attribution_el.textContent.replace(/\s*\n\s*/g," ")}}_map_data(){this.initial_extent=this.get_extent();const e=this.model.tile_source.get_level_by_extent(this.initial_extent,this.map_frame.bbox.height,this.map_frame.bbox.width),t=this.model.tile_source.snap_to_zoom_level(this.initial_extent,this.map_frame.bbox.height,this.map_frame.bbox.width,e);this.x_range.start=t[0],this.y_range.start=t[1],this.x_range.end=t[2],this.y_range.end=t[3],this.x_range instanceof Range1d&&(this.x_range.reset_start=t[0],this.x_range.reset_end=t[2]),this.y_range instanceof Range1d&&(this.y_range.reset_start=t[1],this.y_range.reset_end=t[3]),this._update_attribution()}_create_tile(e,t,i,n,o=!1){const[r,s,a]=this.model.tile_source.normalize_xyz(e,t,i),l={img:void 0,tile_coords:[e,t,i],normalized_coords:[r,s,a],quadkey:this.model.tile_source.tile_xyz_to_quadkey(e,t,i),cache_key:this.model.tile_source.tile_xyz_to_key(e,t,i),bounds:n,loaded:!1,finished:!1,x_coord:n[0],y_coord:n[3]},c=this.model.tile_source.get_image_url(r,s,a);new ImageLoader(c,{loaded:e=>{Object.assign(l,{img:e,loaded:!0}),o?(l.finished=!0,this.notify_finished()):this.request_render()},failed(){l.finished=!0}}),this.model.tile_source.tiles.set(l.cache_key,l),this._tiles.push(l)}_enforce_aspect_ratio(){if(this._last_height!==this.map_frame.bbox.height||this._last_width!==this.map_frame.bbox.width){const e=this.get_extent(),t=this.model.tile_source.get_level_by_extent(e,this.map_frame.bbox.height,this.map_frame.bbox.width),i=this.model.tile_source.snap_to_zoom_level(e,this.map_frame.bbox.height,this.map_frame.bbox.width,t);this.x_range.setv({start:i[0],end:i[2]}),this.y_range.setv({start:i[1],end:i[3]}),this.extent=i,this._last_height=this.map_frame.bbox.height,this._last_width=this.map_frame.bbox.width}}has_finished(){if(!super.has_finished())return!1;if(0===this._tiles.length)return!1;for(const e of this._tiles)if(!e.finished)return!1;return!0}_render(){null==this.map_initialized&&(this._set_data(),this._map_data(),this.map_initialized=!0),this._enforce_aspect_ratio(),this._update(),null!=this.prefetch_timer&&clearTimeout(this.prefetch_timer),this.prefetch_timer=setTimeout(this._prefetch_tiles.bind(this),500),this.has_finished()&&this.notify_finished()}_draw_tile(e){const t=this.model.tile_source.tiles.get(e);if(null!=t&&t.loaded){const[[e],[i]]=this.coordinates.map_to_screen([t.bounds[0]],[t.bounds[3]]),[[n],[o]]=this.coordinates.map_to_screen([t.bounds[2]],[t.bounds[1]]),r=n-e,s=o-i,a=e,l=i,c=this.map_canvas.getImageSmoothingEnabled();this.map_canvas.setImageSmoothingEnabled(this.model.smoothing),this.map_canvas.drawImage(t.img,a,l,r,s),this.map_canvas.setImageSmoothingEnabled(c),t.finished=!0}}_set_rect(){const e=this.plot_model.outline_line_width,t=this.map_frame.bbox.left+e/2,i=this.map_frame.bbox.top+e/2,n=this.map_frame.bbox.width-e,o=this.map_frame.bbox.height-e;this.map_canvas.rect(t,i,n,o),this.map_canvas.clip()}_render_tiles(e){this.map_canvas.save(),this._set_rect(),this.map_canvas.globalAlpha=this.model.alpha;for(const t of e)this._draw_tile(t);this.map_canvas.restore()}_prefetch_tiles(){const{tile_source:e}=this.model,t=this.get_extent(),i=this.map_frame.bbox.height,n=this.map_frame.bbox.width,o=this.model.tile_source.get_level_by_extent(t,i,n),r=this.model.tile_source.get_tiles_by_extent(t,o);for(let s=0,a=Math.min(10,r.length);s<a;s++){const[t,i,n]=r[s],o=this.model.tile_source.children_by_tile_xyz(t,i,n);for(const r of o){const[t,i,n,o]=r;e.tiles.has(e.tile_xyz_to_key(t,i,n))||this._create_tile(t,i,n,o,!0)}}}_fetch_tiles(e){for(const t of e){const[e,i,n,o]=t;this._create_tile(e,i,n,o)}}_update(){const{tile_source:e}=this.model,{min_zoom:t}=e,{max_zoom:i}=e;let n=this.get_extent();const o=this.extent[2]-this.extent[0]<n[2]-n[0],r=this.map_frame.bbox.height,s=this.map_frame.bbox.width;let a=e.get_level_by_extent(n,r,s),l=!1;a<t?(n=this.extent,a=t,l=!0):a>i&&(n=this.extent,a=i,l=!0),l&&(this.x_range.setv({start:n[0],end:n[2]}),this.y_range.setv({start:n[1],end:n[3]})),this.extent=n;const c=e.get_tiles_by_extent(n,a),d=[],h=[],u=[],p=[];for(const _ of c){const[t,i,n]=_,r=e.tile_xyz_to_key(t,i,n),s=e.tiles.get(r);if(null!=s&&s.loaded)h.push(r);else if(this.model.render_parents){const[r,s,a]=e.get_closest_parent_by_tile_xyz(t,i,n),l=e.tile_xyz_to_key(r,s,a),c=e.tiles.get(l);if(null!=c&&c.loaded&&!includes(u,l)&&u.push(l),o){const o=e.children_by_tile_xyz(t,i,n);for(const[t,i,n]of o){const o=e.tile_xyz_to_key(t,i,n);e.tiles.has(o)&&p.push(o)}}}null==s&&d.push(_)}this._render_tiles(u),this._render_tiles(p),this._render_tiles(h),null!=this.render_timer&&clearTimeout(this.render_timer),this.render_timer=setTimeout((()=>this._fetch_tiles(d)),65)}}TileRendererView.__name__="TileRendererView";class TileRenderer extends Renderer{constructor(e){super(e)}static init_TileRenderer(){this.prototype.default_view=TileRendererView,this.define((({Boolean:e,Number:t,Ref:i})=>({alpha:[t,1],smoothing:[e,!0],tile_source:[i(TileSource),()=>new WMTSTileSource],render_parents:[e,!0]}))),this.override({level:"image"})}}TileRenderer.__name__="TileRenderer",TileRenderer.init_TileRenderer();class TMSTileSource extends MercatorTileSource{constructor(e){super(e)}get_image_url(e,t,i){return this.string_lookup_replace(this.url,this.extra_url_vars).replace("{X}",e.toString()).replace("{Y}",t.toString()).replace("{Z}",i.toString())}}TMSTileSource.__name__="TMSTileSource";class Texture extends Model{constructor(e){super(e)}static init_Texture(){this.define((()=>({repetition:[TextureRepetition,"repeat"]})))}}Texture.__name__="Texture",Texture.init_Texture();class CanvasTexture extends Texture{constructor(e){super(e)}static init_CanvasTexture(){this.define((({String:e})=>({code:[e]})))}get func(){const e=use_strict(this.code);return new Function("ctx","color","scale","weight",e)}get_pattern(e,t,i){const n=document.createElement("canvas");n.width=t,n.height=t;const o=n.getContext("2d");return this.func.call(this,o,e,t,i),n}}CanvasTexture.__name__="CanvasTexture",CanvasTexture.init_CanvasTexture();class ImageURLTexture extends Texture{constructor(e){super(e)}static init_ImageURLTexture(){this.define((({String:e})=>({url:[e]})))}initialize(){super.initialize(),this._loader=new ImageLoader(this.url)}get_pattern(e,t,i){const{_loader:n}=this;return this._loader.finished?n.image:n.promise}}ImageURLTexture.__name__="ImageURLTexture",ImageURLTexture.init_ImageURLTexture();class CustomActionButtonView extends ActionToolButtonView{css_classes(){return super.css_classes().concat("bk-toolbar-button-custom-action")}}CustomActionButtonView.__name__="CustomActionButtonView";class CustomActionView extends ActionToolView{doit(){var e;null==(e=this.model.callback)||e.execute(this.model)}}CustomActionView.__name__="CustomActionView";class CustomAction extends ActionTool{constructor(e){super(e),this.tool_name="Custom Action",this.button_view=CustomActionButtonView}static init_CustomAction(){this.prototype.default_view=CustomActionView,this.define((({Any:e,String:t,Nullable:i})=>({callback:[i(e)],icon:[t]}))),this.override({description:"Perform a Custom Action"})}}CustomAction.__name__="CustomAction",CustomAction.init_CustomAction();class RedoToolView extends ActionToolView{connect_signals(){super.connect_signals(),this.connect(this.plot_view.state.changed,(()=>this.model.disabled=!this.plot_view.state.can_redo))}doit(){this.plot_view.state.redo()}}RedoToolView.__name__="RedoToolView";class RedoTool extends ActionTool{constructor(e){super(e),this.tool_name="Redo",this.icon=tool_icon_redo}static init_RedoTool(){this.prototype.default_view=RedoToolView,this.override({disabled:!0}),this.register_alias("redo",(()=>new RedoTool))}}RedoTool.__name__="RedoTool",RedoTool.init_RedoTool();class ResetToolView extends ActionToolView{doit(){this.plot_view.reset()}}ResetToolView.__name__="ResetToolView";class ResetTool extends ActionTool{constructor(e){super(e),this.tool_name="Reset",this.icon=tool_icon_reset}static init_ResetTool(){this.prototype.default_view=ResetToolView,this.register_alias("reset",(()=>new ResetTool))}}ResetTool.__name__="ResetTool",ResetTool.init_ResetTool();class SaveToolView extends ActionToolView{async copy(){const e=await this.plot_view.to_blob(),t=new ClipboardItem({[e.type]:e});await navigator.clipboard.write([t])}async save(e){const t=await this.plot_view.to_blob(),i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=e,i.target="_blank",i.dispatchEvent(new MouseEvent("click"))}doit(e="save"){switch(e){case"save":this.save("bokeh_plot");break;case"copy":this.copy()}}}SaveToolView.__name__="SaveToolView";class SaveTool extends ActionTool{constructor(e){super(e),this.tool_name="Save",this.icon=tool_icon_save}static init_SaveTool(){this.prototype.default_view=SaveToolView,this.register_alias("save",(()=>new SaveTool))}get menu(){return[{icon:"bk-tool-icon-copy-to-clipboard",tooltip:"Copy image to clipboard",if:()=>"undefined"!=typeof ClipboardItem,handler:()=>{this.do.emit("copy")}}]}}SaveTool.__name__="SaveTool",SaveTool.init_SaveTool();class UndoToolView extends ActionToolView{connect_signals(){super.connect_signals(),this.connect(this.plot_view.state.changed,(()=>this.model.disabled=!this.plot_view.state.can_undo))}doit(){this.plot_view.state.undo()}}UndoToolView.__name__="UndoToolView";class UndoTool extends ActionTool{constructor(e){super(e),this.tool_name="Undo",this.icon=tool_icon_undo}static init_UndoTool(){this.prototype.default_view=UndoToolView,this.override({disabled:!0}),this.register_alias("undo",(()=>new UndoTool))}}function scale_highlow(e,t,i){const[n,o]=[e.start,e.end],r=null!=i?i:(o+n)/2;return[n-(n-r)*t,o-(o-r)*t]}function get_info(e,[t,i]){const n=new Map;for(const[o,r]of e){const[e,s]=r.r_invert(t,i);n.set(o,{start:e,end:s})}return n}function scale_range(e,t,i=!0,n=!0,o){t=clamp(t,-.9,.9);const r=i?t:0,[s,a]=scale_highlow(e.bbox.h_range,r,null!=o?o.x:void 0),l=get_info(e.x_scales,[s,a]),c=n?t:0,[d,h]=scale_highlow(e.bbox.v_range,c,null!=o?o.y:void 0);return{xrs:l,yrs:get_info(e.y_scales,[d,h]),factor:t}}UndoTool.__name__="UndoTool",UndoTool.init_UndoTool();class ZoomBaseToolView extends ActionToolView{doit(){var e;const t=this.plot_view.frame,i=this.model.dimensions,n="width"==i||"both"==i,o="height"==i||"both"==i,r=scale_range(t,this.model.sign*this.model.factor,n,o);this.plot_view.state.push("zoom_out",{range:r}),this.plot_view.update_range(r,{scrolling:!0}),null==(e=this.model.document)||e.interactive_start(this.plot_model)}}ZoomBaseToolView.__name__="ZoomBaseToolView";class ZoomBaseTool extends ActionTool{constructor(e){super(e)}static init_ZoomBaseTool(){this.define((({Percent:e})=>({factor:[e,.1],dimensions:[Dimensions,"both"]})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}ZoomBaseTool.__name__="ZoomBaseTool",ZoomBaseTool.init_ZoomBaseTool();class ZoomInToolView extends ZoomBaseToolView{}ZoomInToolView.__name__="ZoomInToolView";class ZoomInTool extends ZoomBaseTool{constructor(e){super(e),this.sign=1,this.tool_name="Zoom In",this.icon=tool_icon_zoom_in}static init_ZoomInTool(){this.prototype.default_view=ZoomInToolView,this.register_alias("zoom_in",(()=>new ZoomInTool({dimensions:"both"}))),this.register_alias("xzoom_in",(()=>new ZoomInTool({dimensions:"width"}))),this.register_alias("yzoom_in",(()=>new ZoomInTool({dimensions:"height"})))}}ZoomInTool.__name__="ZoomInTool",ZoomInTool.init_ZoomInTool();class ZoomOutToolView extends ZoomBaseToolView{}ZoomOutToolView.__name__="ZoomOutToolView";class ZoomOutTool extends ZoomBaseTool{constructor(e){super(e),this.sign=-1,this.tool_name="Zoom Out",this.icon=tool_icon_zoom_out}static init_ZoomOutTool(){this.prototype.default_view=ZoomOutToolView,this.register_alias("zoom_out",(()=>new ZoomOutTool({dimensions:"both"}))),this.register_alias("xzoom_out",(()=>new ZoomOutTool({dimensions:"width"}))),this.register_alias("yzoom_out",(()=>new ZoomOutTool({dimensions:"height"})))}}ZoomOutTool.__name__="ZoomOutTool",ZoomOutTool.init_ZoomOutTool();class EditToolView extends GestureToolView{constructor(){super(...arguments),this._mouse_in_frame=!0}_select_mode(e){const{shiftKey:t,ctrlKey:i}=e;return t||i?t&&!i?"append":!t&&i?"intersect":t&&i?"subtract":void unreachable():"replace"}_move_enter(e){this._mouse_in_frame=!0}_move_exit(e){this._mouse_in_frame=!1}_map_drag(e,t,i){if(!this.plot_view.frame.bbox.contains(e,t))return null;const n=this.plot_view.renderer_view(i);if(null==n)return null;return[n.coordinates.x_scale.invert(e),n.coordinates.y_scale.invert(t)]}_delete_selected(e){const t=e.data_source,i=t.selected.indices;i.sort();for(const n of t.columns()){const e=t.get_array(n);for(let t=0;t<i.length;t++){const n=i[t];e.splice(n-t,1)}}this._emit_cds_changes(t)}_pop_glyphs(e,t){const i=e.columns();if(t&&i.length)for(const n of i){let i=e.get_array(n);const o=i.length-t+1;o<1||(isArray(i)||(i=Array.from(i),e.data[n]=i),i.splice(0,o))}}_emit_cds_changes(e,t=!0,i=!0,n=!0){i&&e.selection_manager.clear(),t&&e.change.emit(),n&&(e.data=e.data,e.properties.data.change.emit())}_drag_points(e,t,i="both"){if(null==this._basepoint)return;const[n,o]=this._basepoint;for(const r of t){const t=this._map_drag(n,o,r),s=this._map_drag(e.sx,e.sy,r);if(null==s||null==t)continue;const[a,l]=s,[c,d]=t,[h,u]=[a-c,l-d],p=r.glyph,_=r.data_source,[f,g]=[p.x.field,p.y.field];for(const e of _.selected.indices)!f||"width"!=i&&"both"!=i||(_.data[f][e]+=h),!g||"height"!=i&&"both"!=i||(_.data[g][e]+=u);_.change.emit()}this._basepoint=[e.sx,e.sy]}_pad_empty_columns(e,t){for(const i of e.columns())includes(t,i)||e.get_array(i).push(this.model.empty_value)}_select_event(e,t,i){const n=this.plot_view.frame,{sx:o,sy:r}=e;if(!n.bbox.contains(o,r))return[];const s={type:"point",sx:o,sy:r},a=[];for(const l of i){const e=l.get_selection_manager(),i=l.data_source,n=this.plot_view.renderer_view(l);if(null!=n){e.select([n],s,!0,t)&&a.push(l),i.properties.selected.change.emit()}}return a}}EditToolView.__name__="EditToolView";class EditTool extends GestureTool{constructor(e){super(e)}static init_EditTool(){this.define((({Unknown:e,String:t,Array:i,Ref:n,Nullable:o})=>({custom_icon:[o(t),null],empty_value:[e],renderers:[i(n(GlyphRenderer)),[]]})))}get computed_icon(){var e;return null!=(e=this.custom_icon)?e:this.icon}}EditTool.__name__="EditTool",EditTool.init_EditTool();class BoxEditToolView extends EditToolView{_tap(e){null==this._draw_basepoint&&null==this._basepoint&&this._select_event(e,this._select_mode(e),this.model.renderers)}_keyup(e){if(this.model.active&&this._mouse_in_frame)for(const t of this.model.renderers)if(e.keyCode===Keys.Backspace)this._delete_selected(t);else if(e.keyCode==Keys.Esc){t.data_source.selection_manager.clear()}}_set_extent([e,t],[i,n],o,r=!1){const s=this.model.renderers[0],a=this.plot_view.renderer_view(s);if(null==a)return;const l=s.glyph,c=s.data_source,[d,h]=a.coordinates.x_scale.r_invert(e,t),[u,p]=a.coordinates.y_scale.r_invert(i,n),[_,f]=[(d+h)/2,(u+p)/2],[g,m]=[h-d,p-u],[v,b]=[l.x.field,l.y.field],[y,w]=[l.width.field,l.height.field];if(o)this._pop_glyphs(c,this.model.num_objects),v&&c.get_array(v).push(_),b&&c.get_array(b).push(f),y&&c.get_array(y).push(g),w&&c.get_array(w).push(m),this._pad_empty_columns(c,[v,b,y,w]);else{const e=c.data[v].length-1;v&&(c.data[v][e]=_),b&&(c.data[b][e]=f),y&&(c.data[y][e]=g),w&&(c.data[w][e]=m)}this._emit_cds_changes(c,!0,!1,r)}_update_box(e,t=!1,i=!1){if(null==this._draw_basepoint)return;const n=[e.sx,e.sy],o=this.plot_view.frame,r=this.model.dimensions,s=this.model._get_dim_limits(this._draw_basepoint,n,o,r);if(null!=s){const[e,n]=s;this._set_extent(e,n,t,i)}}_doubletap(e){this.model.active&&(null!=this._draw_basepoint?(this._update_box(e,!1,!0),this._draw_basepoint=null):(this._draw_basepoint=[e.sx,e.sy],this._select_event(e,"append",this.model.renderers),this._update_box(e,!0,!1)))}_move(e){this._update_box(e,!1,!1)}_pan_start(e){if(e.shiftKey){if(null!=this._draw_basepoint)return;this._draw_basepoint=[e.sx,e.sy],this._update_box(e,!0,!1)}else{if(null!=this._basepoint)return;this._select_event(e,"append",this.model.renderers),this._basepoint=[e.sx,e.sy]}}_pan(e,t=!1,i=!1){if(e.shiftKey){if(null==this._draw_basepoint)return;this._update_box(e,t,i)}else{if(null==this._basepoint)return;this._drag_points(e,this.model.renderers)}}_pan_end(e){if(this._pan(e,!1,!0),e.shiftKey)this._draw_basepoint=null;else{this._basepoint=null;for(const e of this.model.renderers)this._emit_cds_changes(e.data_source,!1,!0,!0)}}}BoxEditToolView.__name__="BoxEditToolView";class BoxEditTool extends EditTool{constructor(e){super(e),this.tool_name="Box Edit Tool",this.icon=tool_icon_box_edit,this.event_type=["tap","pan","move"],this.default_order=1}static init_BoxEditTool(){this.prototype.default_view=BoxEditToolView,this.define((({Int:e})=>({dimensions:[Dimensions,"both"],num_objects:[e,0]})))}}BoxEditTool.__name__="BoxEditTool",BoxEditTool.init_BoxEditTool();class FreehandDrawToolView extends EditToolView{_draw(e,t,i=!1){if(!this.model.active)return;const n=this.model.renderers[0],o=this._map_drag(e.sx,e.sy,n);if(null==o)return;const[r,s]=o,a=n.data_source,l=n.glyph,[c,d]=[l.xs.field,l.ys.field];if("new"==t)this._pop_glyphs(a,this.model.num_objects),c&&a.get_array(c).push([r]),d&&a.get_array(d).push([s]),this._pad_empty_columns(a,[c,d]);else if("add"==t){if(c){const e=a.data[c].length-1;let t=a.get_array(c)[e];isArray(t)||(t=Array.from(t),a.data[c][e]=t),t.push(r)}if(d){const e=a.data[d].length-1;let t=a.get_array(d)[e];isArray(t)||(t=Array.from(t),a.data[d][e]=t),t.push(s)}}this._emit_cds_changes(a,!0,!0,i)}_pan_start(e){this._draw(e,"new")}_pan(e){this._draw(e,"add")}_pan_end(e){this._draw(e,"add",!0)}_tap(e){this._select_event(e,this._select_mode(e),this.model.renderers)}_keyup(e){if(this.model.active&&this._mouse_in_frame)for(const t of this.model.renderers)e.keyCode===Keys.Esc?t.data_source.selection_manager.clear():e.keyCode===Keys.Backspace&&this._delete_selected(t)}}FreehandDrawToolView.__name__="FreehandDrawToolView";class FreehandDrawTool extends EditTool{constructor(e){super(e),this.tool_name="Freehand Draw Tool",this.icon=tool_icon_freehand_draw,this.event_type=["pan","tap"],this.default_order=3}static init_FreehandDrawTool(){this.prototype.default_view=FreehandDrawToolView,this.define((({Int:e})=>({num_objects:[e,0]}))),this.register_alias("freehand_draw",(()=>new FreehandDrawTool))}}FreehandDrawTool.__name__="FreehandDrawTool",FreehandDrawTool.init_FreehandDrawTool();class PointDrawToolView extends EditToolView{_tap(e){if(this._select_event(e,this._select_mode(e),this.model.renderers).length||!this.model.add)return;const t=this.model.renderers[0],i=this._map_drag(e.sx,e.sy,t);if(null==i)return;const n=t.glyph,o=t.data_source,[r,s]=[n.x.field,n.y.field],[a,l]=i;this._pop_glyphs(o,this.model.num_objects),r&&o.get_array(r).push(a),s&&o.get_array(s).push(l),this._pad_empty_columns(o,[r,s]),o.change.emit(),o.data=o.data,o.properties.data.change.emit()}_keyup(e){if(this.model.active&&this._mouse_in_frame)for(const t of this.model.renderers)e.keyCode===Keys.Backspace?this._delete_selected(t):e.keyCode==Keys.Esc&&t.data_source.selection_manager.clear()}_pan_start(e){this.model.drag&&(this._select_event(e,"append",this.model.renderers),this._basepoint=[e.sx,e.sy])}_pan(e){this.model.drag&&null!=this._basepoint&&this._drag_points(e,this.model.renderers)}_pan_end(e){if(this.model.drag){this._pan(e);for(const e of this.model.renderers)this._emit_cds_changes(e.data_source,!1,!0,!0);this._basepoint=null}}}PointDrawToolView.__name__="PointDrawToolView";class PointDrawTool extends EditTool{constructor(e){super(e),this.tool_name="Point Draw Tool",this.icon=tool_icon_point_draw,this.event_type=["tap","pan","move"],this.default_order=2}static init_PointDrawTool(){this.prototype.default_view=PointDrawToolView,this.define((({Boolean:e,Int:t})=>({add:[e,!0],drag:[e,!0],num_objects:[t,0]})))}}PointDrawTool.__name__="PointDrawTool",PointDrawTool.init_PointDrawTool();class PolyToolView extends EditToolView{_set_vertices(e,t){const i=this.model.vertex_renderer.glyph,n=this.model.vertex_renderer.data_source,[o,r]=[i.x.field,i.y.field];o&&(isArray(e)?n.data[o]=e:i.x={value:e}),r&&(isArray(t)?n.data[r]=t:i.y={value:t}),this._emit_cds_changes(n,!0,!0,!1)}_hide_vertices(){this._set_vertices([],[])}_snap_to_vertex(e,t,i){if(this.model.vertex_renderer){const n=this._select_event(e,"replace",[this.model.vertex_renderer]),o=this.model.vertex_renderer.data_source,r=this.model.vertex_renderer.glyph,[s,a]=[r.x.field,r.y.field];if(n.length){const e=o.selected.indices[0];s&&(t=o.data[s][e]),a&&(i=o.data[a][e]),o.selection_manager.clear()}}return[t,i]}}PolyToolView.__name__="PolyToolView";class PolyTool extends EditTool{constructor(e){super(e)}static init_PolyTool(){this.define((({AnyRef:e})=>({vertex_renderer:[e()]})))}}PolyTool.__name__="PolyTool",PolyTool.init_PolyTool();class PolyDrawToolView extends PolyToolView{constructor(){super(...arguments),this._drawing=!1,this._initialized=!1}_tap(e){this._drawing?this._draw(e,"add",!0):this._select_event(e,this._select_mode(e),this.model.renderers)}_draw(e,t,i=!1){const n=this.model.renderers[0],o=this._map_drag(e.sx,e.sy,n);if(this._initialized||this.activate(),null==o)return;const[r,s]=this._snap_to_vertex(e,...o),a=n.data_source,l=n.glyph,[c,d]=[l.xs.field,l.ys.field];if("new"==t)this._pop_glyphs(a,this.model.num_objects),c&&a.get_array(c).push([r,r]),d&&a.get_array(d).push([s,s]),this._pad_empty_columns(a,[c,d]);else if("edit"==t){if(c){const e=a.data[c][a.data[c].length-1];e[e.length-1]=r}if(d){const e=a.data[d][a.data[d].length-1];e[e.length-1]=s}}else if("add"==t){if(c){const e=a.data[c].length-1;let t=a.get_array(c)[e];const i=t[t.length-1];t[t.length-1]=r,isArray(t)||(t=Array.from(t),a.data[c][e]=t),t.push(i)}if(d){const e=a.data[d].length-1;let t=a.get_array(d)[e];const i=t[t.length-1];t[t.length-1]=s,isArray(t)||(t=Array.from(t),a.data[d][e]=t),t.push(i)}}this._emit_cds_changes(a,!0,!1,i)}_show_vertices(){if(!this.model.active)return;const e=[],t=[];for(let i=0;i<this.model.renderers.length;i++){const n=this.model.renderers[i],o=n.data_source,r=n.glyph,[s,a]=[r.xs.field,r.ys.field];if(s)for(const t of o.get_array(s))e.push(...t);if(a)for(const e of o.get_array(a))t.push(...e);this._drawing&&i==this.model.renderers.length-1&&(e.splice(e.length-1,1),t.splice(t.length-1,1))}this._set_vertices(e,t)}_doubletap(e){this.model.active&&(this._drawing?(this._drawing=!1,this._draw(e,"edit",!0)):(this._drawing=!0,this._draw(e,"new",!0)))}_move(e){this._drawing&&this._draw(e,"edit")}_remove(){const e=this.model.renderers[0],t=e.data_source,i=e.glyph,[n,o]=[i.xs.field,i.ys.field];if(n){const e=t.data[n].length-1,i=t.get_array(n)[e];i.splice(i.length-1,1)}if(o){const e=t.data[o].length-1,i=t.get_array(o)[e];i.splice(i.length-1,1)}this._emit_cds_changes(t)}_keyup(e){if(this.model.active&&this._mouse_in_frame)for(const t of this.model.renderers)e.keyCode===Keys.Backspace?this._delete_selected(t):e.keyCode==Keys.Esc&&(this._drawing&&(this._remove(),this._drawing=!1),t.data_source.selection_manager.clear())}_pan_start(e){this.model.drag&&(this._select_event(e,"append",this.model.renderers),this._basepoint=[e.sx,e.sy])}_pan(e){if(null==this._basepoint||!this.model.drag)return;const[t,i]=this._basepoint;for(const n of this.model.renderers){const o=this._map_drag(t,i,n),r=this._map_drag(e.sx,e.sy,n);if(null==r||null==o)continue;const s=n.data_source,a=n.glyph,[l,c]=[a.xs.field,a.ys.field];if(!l&&!c)continue;const[d,h]=r,[u,p]=o,[_,f]=[d-u,h-p];for(const e of s.selected.indices){let t,i,n;l&&(i=s.data[l][e]),c?(n=s.data[c][e],t=n.length):t=i.length;for(let e=0;e<t;e++)i&&(i[e]+=_),n&&(n[e]+=f)}s.change.emit()}this._basepoint=[e.sx,e.sy]}_pan_end(e){if(this.model.drag){this._pan(e);for(const e of this.model.renderers)this._emit_cds_changes(e.data_source);this._basepoint=null}}activate(){if(this.model.vertex_renderer&&this.model.active){if(this._show_vertices(),!this._initialized)for(const e of this.model.renderers){const t=e.data_source;t.connect(t.properties.data.change,(()=>this._show_vertices()))}this._initialized=!0}}deactivate(){this._drawing&&(this._remove(),this._drawing=!1),this.model.vertex_renderer&&this._hide_vertices()}}PolyDrawToolView.__name__="PolyDrawToolView";class PolyDrawTool extends PolyTool{constructor(e){super(e),this.tool_name="Polygon Draw Tool",this.icon=tool_icon_poly_draw,this.event_type=["pan","tap","move"],this.default_order=3}static init_PolyDrawTool(){this.prototype.default_view=PolyDrawToolView,this.define((({Boolean:e,Int:t})=>({drag:[e,!0],num_objects:[t,0]})))}}PolyDrawTool.__name__="PolyDrawTool",PolyDrawTool.init_PolyDrawTool();class PolyEditToolView extends PolyToolView{constructor(){super(...arguments),this._drawing=!1,this._cur_index=null}_doubletap(e){if(!this.model.active)return;const t=this._map_drag(e.sx,e.sy,this.model.vertex_renderer);if(null==t)return;const[i,n]=t,o=this._select_event(e,"replace",[this.model.vertex_renderer]),r=this.model.vertex_renderer.data_source,s=this.model.vertex_renderer.glyph,[a,l]=[s.x.field,s.y.field];if(o.length&&null!=this._selected_renderer){const e=r.selected.indices[0];this._drawing?(this._drawing=!1,r.selection_manager.clear()):(r.selected.indices=[e+1],a&&r.get_array(a).splice(e+1,0,i),l&&r.get_array(l).splice(e+1,0,n),this._drawing=!0),r.change.emit(),this._emit_cds_changes(this._selected_renderer.data_source)}else this._show_vertices(e)}_show_vertices(e){if(!this.model.active)return;const t=this.model.renderers[0],i=()=>this._update_vertices(t),n=null==t?void 0:t.data_source,o=this._select_event(e,"replace",this.model.renderers);if(!o.length)return this._set_vertices([],[]),this._selected_renderer=null,this._drawing=!1,this._cur_index=null,void(null!=n&&n.disconnect(n.properties.data.change,i));null!=n&&n.connect(n.properties.data.change,i),this._cur_index=o[0].data_source.selected.indices[0],this._update_vertices(o[0])}_update_vertices(e){const t=e.glyph,i=e.data_source,n=this._cur_index,[o,r]=[t.xs.field,t.ys.field];if(this._drawing)return;if(null==n&&(o||r))return;let s,a;o&&null!=n?(s=i.data[o][n],isArray(s)||(i.data[o][n]=s=Array.from(s))):s=t.xs.value,r&&null!=n?(a=i.data[r][n],isArray(a)||(i.data[r][n]=a=Array.from(a))):a=t.ys.value,this._selected_renderer=e,this._set_vertices(s,a)}_move(e){if(this._drawing&&null!=this._selected_renderer){const t=this.model.vertex_renderer,i=t.data_source,n=t.glyph,o=this._map_drag(e.sx,e.sy,t);if(null==o)return;let[r,s]=o;const a=i.selected.indices;[r,s]=this._snap_to_vertex(e,r,s),i.selected.indices=a;const[l,c]=[n.x.field,n.y.field],d=a[0];l&&(i.data[l][d]=r),c&&(i.data[c][d]=s),i.change.emit(),this._selected_renderer.data_source.change.emit()}}_tap(e){const t=this.model.vertex_renderer,i=this._map_drag(e.sx,e.sy,t);if(null==i)return;if(this._drawing&&this._selected_renderer){let[n,o]=i;const r=t.data_source,s=t.glyph,[a,l]=[s.x.field,s.y.field],c=r.selected.indices;[n,o]=this._snap_to_vertex(e,n,o);const d=c[0];if(r.selected.indices=[d+1],a){const e=r.get_array(a),t=e[d];e[d]=n,e.splice(d+1,0,t)}if(l){const e=r.get_array(l),t=e[d];e[d]=o,e.splice(d+1,0,t)}return r.change.emit(),void this._emit_cds_changes(this._selected_renderer.data_source,!0,!1,!0)}const n=this._select_mode(e);this._select_event(e,n,[t]),this._select_event(e,n,this.model.renderers)}_remove_vertex(){if(!this._drawing||!this._selected_renderer)return;const e=this.model.vertex_renderer,t=e.data_source,i=e.glyph,n=t.selected.indices[0],[o,r]=[i.x.field,i.y.field];o&&t.get_array(o).splice(n,1),r&&t.get_array(r).splice(n,1),t.change.emit(),this._emit_cds_changes(this._selected_renderer.data_source)}_pan_start(e){this._select_event(e,"append",[this.model.vertex_renderer]),this._basepoint=[e.sx,e.sy]}_pan(e){null!=this._basepoint&&(this._drag_points(e,[this.model.vertex_renderer]),this._selected_renderer&&this._selected_renderer.data_source.change.emit())}_pan_end(e){null!=this._basepoint&&(this._drag_points(e,[this.model.vertex_renderer]),this._emit_cds_changes(this.model.vertex_renderer.data_source,!1,!0,!0),this._selected_renderer&&this._emit_cds_changes(this._selected_renderer.data_source),this._basepoint=null)}_keyup(e){if(!this.model.active||!this._mouse_in_frame)return;let t;t=this._selected_renderer?[this.model.vertex_renderer]:this.model.renderers;for(const i of t)e.keyCode===Keys.Backspace?(this._delete_selected(i),this._selected_renderer&&this._emit_cds_changes(this._selected_renderer.data_source)):e.keyCode==Keys.Esc&&(this._drawing?(this._remove_vertex(),this._drawing=!1):this._selected_renderer&&this._hide_vertices(),i.data_source.selection_manager.clear())}deactivate(){this._selected_renderer&&(this._drawing&&(this._remove_vertex(),this._drawing=!1),this._hide_vertices())}}PolyEditToolView.__name__="PolyEditToolView";class PolyEditTool extends PolyTool{constructor(e){super(e),this.tool_name="Poly Edit Tool",this.icon=tool_icon_poly_edit,this.event_type=["tap","pan","move"],this.default_order=4}static init_PolyEditTool(){this.prototype.default_view=PolyEditToolView}}PolyEditTool.__name__="PolyEditTool",PolyEditTool.init_PolyEditTool();class SelectToolView extends GestureToolView{connect_signals(){super.connect_signals(),this.model.clear.connect((()=>this._clear()))}get computed_renderers(){const{renderers:e,names:t}=this.model;return compute_renderers(e,this.plot_model.data_renderers,t)}_computed_renderers_by_data_source(){var e;const t=new Map;for(const i of this.computed_renderers){let n;if(i instanceof GlyphRenderer)n=i.data_source;else{if(!(i instanceof GraphRenderer))continue;n=i.node_renderer.data_source}const o=null!=(e=t.get(n))?e:[];t.set(n,[...o,i])}return t}_select_mode(e){const{shiftKey:t,ctrlKey:i}=e;return t||i?t&&!i?"append":!t&&i?"intersect":t&&i?"subtract":void unreachable():this.model.mode}_keyup(e){e.keyCode==Keys.Esc&&this._clear()}_clear(){for(const t of this.computed_renderers)t.get_selection_manager().clear();const e=this.computed_renderers.map((e=>this.plot_view.renderer_view(e)));this.plot_view.request_paint(e)}_select(e,t,i){const n=this._computed_renderers_by_data_source();for(const[,o]of n){const n=o[0].get_selection_manager(),r=[];for(const e of o){const t=this.plot_view.renderer_view(e);null!=t&&r.push(t)}n.select(r,e,t,i)}null!=this.model.callback&&this._emit_callback(e),this._emit_selection_event(e,t)}_emit_selection_event(e,t=!0){const{x_scale:i,y_scale:n}=this.plot_view.frame;let o;switch(e.type){case"point":{const{sx:t,sy:r}=e,s=i.invert(t),a=n.invert(r);o=__spreadProps(__spreadValues({},e),{x:s,y:a});break}case"span":{const{sx:t,sy:r}=e,s=i.invert(t),a=n.invert(r);o=__spreadProps(__spreadValues({},e),{x:s,y:a});break}case"rect":{const{sx0:t,sx1:r,sy0:s,sy1:a}=e,[l,c]=i.r_invert(t,r),[d,h]=n.r_invert(s,a);o=__spreadProps(__spreadValues({},e),{x0:l,y0:d,x1:c,y1:h});break}case"poly":{const{sx:t,sy:r}=e,s=i.v_invert(t),a=n.v_invert(r);o=__spreadProps(__spreadValues({},e),{x:s,y:a});break}}this.plot_model.trigger_event(new SelectionGeometry(o,t))}}SelectToolView.__name__="SelectToolView";class SelectTool extends GestureTool{constructor(e){super(e)}initialize(){super.initialize(),this.clear=new Signal0(this,"clear")}static init_SelectTool(){this.define((({String:e,Array:t,Ref:i,Or:n,Auto:o})=>({renderers:[n(t(i(DataRenderer)),o),"auto"],names:[t(e),[]],mode:[SelectionMode,"replace"]})))}get menu(){return[{icon:"bk-tool-icon-replace-mode",tooltip:"Replace the current selection",active:()=>"replace"==this.mode,handler:()=>{this.mode="replace",this.active=!0}},{icon:"bk-tool-icon-append-mode",tooltip:"Append to the current selection (Shift)",active:()=>"append"==this.mode,handler:()=>{this.mode="append",this.active=!0}},{icon:"bk-tool-icon-intersect-mode",tooltip:"Intersect with the current selection (Ctrl)",active:()=>"intersect"==this.mode,handler:()=>{this.mode="intersect",this.active=!0}},{icon:"bk-tool-icon-subtract-mode",tooltip:"Subtract from the current selection (Shift+Ctrl)",active:()=>"subtract"==this.mode,handler:()=>{this.mode="subtract",this.active=!0}},null,{icon:"bk-tool-icon-clear-selection",tooltip:"Clear the current selection (Esc)",handler:()=>{this.clear.emit()}}]}}SelectTool.__name__="SelectTool",SelectTool.init_SelectTool();class BoxSelectToolView extends SelectToolView{_compute_limits(e){const t=this.plot_view.frame,i=this.model.dimensions;let n=this._base_point;if("center"==this.model.origin){const[t,i]=n,[o,r]=e;n=[t-(o-t),i-(r-i)]}return this.model._get_dim_limits(n,e,t,i)}_pan_start(e){const{sx:t,sy:i}=e;this._base_point=[t,i]}_pan(e){const{sx:t,sy:i}=e,n=[t,i],[o,r]=this._compute_limits(n);this.model.overlay.update({left:o[0],right:o[1],top:r[0],bottom:r[1]}),this.model.select_every_mousemove&&this._do_select(o,r,!1,this._select_mode(e))}_pan_end(e){const{sx:t,sy:i}=e,n=[t,i],[o,r]=this._compute_limits(n);this._do_select(o,r,!0,this._select_mode(e)),this.model.overlay.update({left:null,right:null,top:null,bottom:null}),this._base_point=null,this.plot_view.state.push("box_select",{selection:this.plot_view.get_selection()})}_do_select([e,t],[i,n],o,r="replace"){const s={type:"rect",sx0:e,sx1:t,sy0:i,sy1:n};this._select(s,o,r)}}BoxSelectToolView.__name__="BoxSelectToolView";const DEFAULT_BOX_OVERLAY$1=()=>new BoxAnnotation({level:"overlay",top_units:"screen",left_units:"screen",bottom_units:"screen",right_units:"screen",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:2,line_dash:[4,4]});class BoxSelectTool extends SelectTool{constructor(e){super(e),this.tool_name="Box Select",this.icon=tool_icon_box_select,this.event_type="pan",this.default_order=30}static init_BoxSelectTool(){this.prototype.default_view=BoxSelectToolView,this.define((({Boolean:e,Ref:t})=>({dimensions:[Dimensions,"both"],select_every_mousemove:[e,!1],overlay:[t(BoxAnnotation),DEFAULT_BOX_OVERLAY$1],origin:[BoxOrigin,"corner"]}))),this.register_alias("box_select",(()=>new BoxSelectTool)),this.register_alias("xbox_select",(()=>new BoxSelectTool({dimensions:"width"}))),this.register_alias("ybox_select",(()=>new BoxSelectTool({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}BoxSelectTool.__name__="BoxSelectTool",BoxSelectTool.init_BoxSelectTool();class BoxZoomToolView extends GestureToolView{_match_aspect(e,t,i){const n=i.bbox.aspect,o=i.bbox.h_range.end,r=i.bbox.h_range.start,s=i.bbox.v_range.end,a=i.bbox.v_range.start;let l=Math.abs(e[0]-t[0]),c=Math.abs(e[1]-t[1]);const d=0==c?0:l/c,[h]=d>=n?[1,d/n]:[n/d,1];let u,p,_,f;return e[0]<=t[0]?(u=e[0],p=e[0]+l*h,p>o&&(p=o)):(p=e[0],u=e[0]-l*h,u<r&&(u=r)),l=Math.abs(p-u),e[1]<=t[1]?(f=e[1],_=e[1]+l/n,_>s&&(_=s)):(_=e[1],f=e[1]-l/n,f<a&&(f=a)),c=Math.abs(_-f),e[0]<=t[0]?p=e[0]+n*c:u=e[0]-n*c,[[u,p],[f,_]]}_compute_limits(e){const t=this.plot_view.frame,i=this.model.dimensions;let n,o,r=this._base_point;if("center"==this.model.origin){const[t,i]=r,[n,o]=e;r=[t-(n-t),i-(o-i)]}return this.model.match_aspect&&"both"==i?[n,o]=this._match_aspect(r,e,t):[n,o]=this.model._get_dim_limits(r,e,t,i),[n,o]}_pan_start(e){this._base_point=[e.sx,e.sy]}_pan(e){const t=[e.sx,e.sy],[i,n]=this._compute_limits(t);this.model.overlay.update({left:i[0],right:i[1],top:n[0],bottom:n[1]})}_pan_end(e){const t=[e.sx,e.sy],[i,n]=this._compute_limits(t);this._update(i,n),this.model.overlay.update({left:null,right:null,top:null,bottom:null}),this._base_point=null}_update([e,t],[i,n]){if(Math.abs(t-e)<=5||Math.abs(n-i)<=5)return;const{x_scales:o,y_scales:r}=this.plot_view.frame,s=new Map;for(const[c,d]of o){const[i,n]=d.r_invert(e,t);s.set(c,{start:i,end:n})}const a=new Map;for(const[c,d]of r){const[e,t]=d.r_invert(i,n);a.set(c,{start:e,end:t})}const l={xrs:s,yrs:a};this.plot_view.state.push("box_zoom",{range:l}),this.plot_view.update_range(l)}}BoxZoomToolView.__name__="BoxZoomToolView";const DEFAULT_BOX_OVERLAY=()=>new BoxAnnotation({level:"overlay",top_units:"screen",left_units:"screen",bottom_units:"screen",right_units:"screen",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:2,line_dash:[4,4]});class BoxZoomTool extends GestureTool{constructor(e){super(e),this.tool_name="Box Zoom",this.icon=tool_icon_box_zoom,this.event_type="pan",this.default_order=20}static init_BoxZoomTool(){this.prototype.default_view=BoxZoomToolView,this.define((({Boolean:e,Ref:t})=>({dimensions:[Dimensions,"both"],overlay:[t(BoxAnnotation),DEFAULT_BOX_OVERLAY],match_aspect:[e,!1],origin:[BoxOrigin,"corner"]}))),this.register_alias("box_zoom",(()=>new BoxZoomTool({dimensions:"both"}))),this.register_alias("xbox_zoom",(()=>new BoxZoomTool({dimensions:"width"}))),this.register_alias("ybox_zoom",(()=>new BoxZoomTool({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}BoxZoomTool.__name__="BoxZoomTool",BoxZoomTool.init_BoxZoomTool();class PolySelectToolView extends SelectToolView{initialize(){super.initialize(),this.data={sx:[],sy:[]}}connect_signals(){super.connect_signals(),this.connect(this.model.properties.active.change,(()=>this._active_change()))}_active_change(){this.model.active||this._clear_data()}_keyup(e){e.keyCode==Keys.Enter&&this._clear_data()}_doubletap(e){this._do_select(this.data.sx,this.data.sy,!0,this._select_mode(e)),this.plot_view.state.push("poly_select",{selection:this.plot_view.get_selection()}),this._clear_data()}_clear_data(){this.data={sx:[],sy:[]},this.model.overlay.update({xs:[],ys:[]})}_tap(e){const{sx:t,sy:i}=e;this.plot_view.frame.bbox.contains(t,i)&&(this.data.sx.push(t),this.data.sy.push(i),this.model.overlay.update({xs:copy(this.data.sx),ys:copy(this.data.sy)}))}_do_select(e,t,i,n){const o={type:"poly",sx:e,sy:t};this._select(o,i,n)}}PolySelectToolView.__name__="PolySelectToolView";const DEFAULT_POLY_OVERLAY=()=>new PolyAnnotation({level:"overlay",xs_units:"screen",ys_units:"screen",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:2,line_dash:[4,4]});class PolySelectTool extends SelectTool{constructor(e){super(e),this.tool_name="Poly Select",this.icon=tool_icon_polygon_select,this.event_type="tap",this.default_order=11}static init_PolySelectTool(){this.prototype.default_view=PolySelectToolView,this.define((({Ref:e})=>({overlay:[e(PolyAnnotation),DEFAULT_POLY_OVERLAY]}))),this.register_alias("poly_select",(()=>new PolySelectTool))}}PolySelectTool.__name__="PolySelectTool",PolySelectTool.init_PolySelectTool();class LassoSelectToolView extends SelectToolView{constructor(){super(...arguments),this.sxs=[],this.sys=[]}connect_signals(){super.connect_signals(),this.connect(this.model.properties.active.change,(()=>this._active_change()))}_active_change(){this.model.active||this._clear_overlay()}_keyup(e){e.keyCode==Keys.Enter&&this._clear_overlay()}_pan_start(e){this.sxs=[],this.sys=[];const{sx:t,sy:i}=e;this._append_overlay(t,i)}_pan(e){const[t,i]=this.plot_view.frame.bbox.clip(e.sx,e.sy);this._append_overlay(t,i),this.model.select_every_mousemove&&this._do_select(this.sxs,this.sys,!1,this._select_mode(e))}_pan_end(e){const{sxs:t,sys:i}=this;this._clear_overlay(),this._do_select(t,i,!0,this._select_mode(e)),this.plot_view.state.push("lasso_select",{selection:this.plot_view.get_selection()})}_append_overlay(e,t){const{sxs:i,sys:n}=this;i.push(e),n.push(t),this.model.overlay.update({xs:i,ys:n})}_clear_overlay(){this.sxs=[],this.sys=[],this.model.overlay.update({xs:this.sxs,ys:this.sys})}_do_select(e,t,i,n){const o={type:"poly",sx:e,sy:t};this._select(o,i,n)}}LassoSelectToolView.__name__="LassoSelectToolView";class LassoSelectTool extends SelectTool{constructor(e){super(e),this.tool_name="Lasso Select",this.icon=tool_icon_lasso_select,this.event_type="pan",this.default_order=12}static init_LassoSelectTool(){this.prototype.default_view=LassoSelectToolView,this.define((({Boolean:e,Ref:t})=>({select_every_mousemove:[e,!0],overlay:[t(PolyAnnotation),DEFAULT_POLY_OVERLAY]}))),this.register_alias("lasso_select",(()=>new LassoSelectTool))}}LassoSelectTool.__name__="LassoSelectTool",LassoSelectTool.init_LassoSelectTool();class LineToolView extends EditToolView{_set_intersection(e,t){const i=this.model.intersection_renderer.glyph,n=this.model.intersection_renderer.data_source,[o,r]=[i.x.field,i.y.field];o&&(isArray(e)?n.data[o]=e:i.x={value:e}),r&&(isArray(t)?n.data[r]=t:i.y={value:t}),this._emit_cds_changes(n,!0,!0,!1)}_hide_intersections(){this._set_intersection([],[])}}LineToolView.__name__="LineToolView";class LineTool extends EditTool{constructor(e){super(e)}static init_LineTool(){this.define((({AnyRef:e})=>({intersection_renderer:[e()]})))}}LineTool.__name__="LineTool",LineTool.init_LineTool();class LineEditToolView extends LineToolView{constructor(){super(...arguments),this._drawing=!1}_doubletap(e){if(!this.model.active)return;const t=this.model.renderers;for(const i of t){1==this._select_event(e,"replace",[i]).length&&(this._selected_renderer=i)}this._show_intersections(),this._update_line_cds()}_show_intersections(){if(!this.model.active)return;if(null==this._selected_renderer)return;if(!this.model.renderers.length)return this._set_intersection([],[]),this._selected_renderer=null,void(this._drawing=!1);const e=this._selected_renderer.data_source,t=this._selected_renderer.glyph,[i,n]=[t.x.field,t.y.field],o=e.get_array(i),r=e.get_array(n);this._set_intersection(o,r)}_tap(e){const t=this.model.intersection_renderer;if(null==this._map_drag(e.sx,e.sy,t))return;if(this._drawing&&this._selected_renderer){const i=this._select_mode(e);if(0==this._select_event(e,i,[t]).length)return}const i=this._select_mode(e);this._select_event(e,i,[t]),this._select_event(e,i,this.model.renderers)}_update_line_cds(){if(null==this._selected_renderer)return;const e=this.model.intersection_renderer.glyph,t=this.model.intersection_renderer.data_source,[i,n]=[e.x.field,e.y.field];if(i&&n){const e=t.data[i],o=t.data[n];this._selected_renderer.data_source.data[i]=e,this._selected_renderer.data_source.data[n]=o}this._emit_cds_changes(this._selected_renderer.data_source,!0,!0,!1)}_pan_start(e){this._select_event(e,"append",[this.model.intersection_renderer]),this._basepoint=[e.sx,e.sy]}_pan(e){null!=this._basepoint&&(this._drag_points(e,[this.model.intersection_renderer],this.model.dimensions),this._selected_renderer&&this._selected_renderer.data_source.change.emit())}_pan_end(e){null!=this._basepoint&&(this._drag_points(e,[this.model.intersection_renderer]),this._emit_cds_changes(this.model.intersection_renderer.data_source,!1,!0,!0),this._selected_renderer&&this._emit_cds_changes(this._selected_renderer.data_source),this._basepoint=null)}activate(){this._drawing=!0}deactivate(){this._selected_renderer&&(this._drawing&&(this._drawing=!1),this._hide_intersections())}}LineEditToolView.__name__="LineEditToolView";class LineEditTool extends LineTool{constructor(e){super(e),this.tool_name="Line Edit Tool",this.icon=tool_icon_line_edit,this.event_type=["tap","pan","move"],this.default_order=4}static init_LineEditTool(){this.prototype.default_view=LineEditToolView,this.define((()=>({dimensions:[Dimensions,"both"]})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}function update_ranges(e,t,i){const n=new Map;for(const[o,r]of e){const[e,s]=r.r_invert(t,i);n.set(o,{start:e,end:s})}return n}LineEditTool.__name__="LineEditTool",LineEditTool.init_LineEditTool();class PanToolView extends GestureToolView{_pan_start(e){var t;this.last_dx=0,this.last_dy=0;const{sx:i,sy:n}=e,o=this.plot_view.frame.bbox;if(!o.contains(i,n)){const e=o.h_range,t=o.v_range;(i<e.start||i>e.end)&&(this.v_axis_only=!0),(n<t.start||n>t.end)&&(this.h_axis_only=!0)}null==(t=this.model.document)||t.interactive_start(this.plot_model)}_pan(e){var t;this._update(e.deltaX,e.deltaY),null==(t=this.model.document)||t.interactive_start(this.plot_model)}_pan_end(e){this.h_axis_only=!1,this.v_axis_only=!1,null!=this.pan_info&&this.plot_view.state.push("pan",{range:this.pan_info})}_update(e,t){const i=this.plot_view.frame,n=e-this.last_dx,o=t-this.last_dy,r=i.bbox.h_range,s=r.start-n,a=r.end-n,l=i.bbox.v_range,c=l.start-o,d=l.end-o,h=this.model.dimensions;let u,p,_,f,g,m;"width"!=h&&"both"!=h||this.v_axis_only?(u=r.start,p=r.end,_=0):(u=s,p=a,_=-n),"height"!=h&&"both"!=h||this.h_axis_only?(f=l.start,g=l.end,m=0):(f=c,g=d,m=-o),this.last_dx=e,this.last_dy=t;const{x_scales:v,y_scales:b}=i,y=update_ranges(v,u,p),w=update_ranges(b,f,g);this.pan_info={xrs:y,yrs:w,sdx:_,sdy:m},this.plot_view.update_range(this.pan_info,{panning:!0})}}PanToolView.__name__="PanToolView";class PanTool extends GestureTool{constructor(e){super(e),this.tool_name="Pan",this.event_type="pan",this.default_order=10}static init_PanTool(){this.prototype.default_view=PanToolView,this.define((()=>({dimensions:[Dimensions,"both",{on_update(e,t){switch(e){case"both":t.icon=tool_icon_pan;break;case"width":t.icon=tool_icon_xpan;break;case"height":t.icon=tool_icon_ypan}}}]}))),this.register_alias("pan",(()=>new PanTool({dimensions:"both"}))),this.register_alias("xpan",(()=>new PanTool({dimensions:"width"}))),this.register_alias("ypan",(()=>new PanTool({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}function flip_side(e){switch(e){case 1:return 2;case 2:return 1;case 4:return 5;case 5:return 4;default:return e}}function is_near(e,t,i,n){if(null==t)return!1;const o=i.compute(t);return Math.abs(e-o)<n}function is_inside(e,t,i,n,o){let r=!0;if(null!=o.left&&null!=o.right){const t=i.invert(e);(t<o.left||t>o.right)&&(r=!1)}if(null!=o.bottom&&null!=o.top){const e=n.invert(t);(e<o.bottom||e>o.top)&&(r=!1)}return r}function sides_inside(e,t,i){let n=0;return e>=i.start&&e<=i.end&&(n+=1),t>=i.start&&t<=i.end&&(n+=1),n}function compute_value(e,t,i,n){const o=t.compute(e),r=t.invert(o+i);return r>=n.start&&r<=n.end?r:e}function update_range_end_side(e,t,i){return e>t.start?(t.end=e,i):(t.end=t.start,t.start=e,flip_side(i))}function update_range_start_side(e,t,i){return e<t.end?(t.start=e,i):(t.start=t.end,t.end=e,flip_side(i))}function update_range(e,t,i,n){const[o,r]=t.r_compute(e.start,e.end),[s,a]=t.r_invert(o+i,r+i),l=sides_inside(e.start,e.end,n);sides_inside(s,a,n)>=l&&(e.start=s,e.end=a)}PanTool.__name__="PanTool",PanTool.init_PanTool();class RangeToolView extends GestureToolView{initialize(){super.initialize(),this.side=0,this.model.update_overlay_from_ranges()}connect_signals(){super.connect_signals(),null!=this.model.x_range&&this.connect(this.model.x_range.change,(()=>this.model.update_overlay_from_ranges())),null!=this.model.y_range&&this.connect(this.model.y_range.change,(()=>this.model.update_overlay_from_ranges()))}_pan_start(e){this.last_dx=0,this.last_dy=0;const t=this.model.x_range,i=this.model.y_range,{frame:n}=this.plot_view,o=n.x_scale,r=n.y_scale,s=this.model.overlay,{left:a,right:l,top:c,bottom:d}=s,h=this.model.overlay.line_width+EDGE_TOLERANCE;null!=t&&this.model.x_interaction&&(is_near(e.sx,a,o,h)?this.side=1:is_near(e.sx,l,o,h)?this.side=2:is_inside(e.sx,e.sy,o,r,s)&&(this.side=3)),null!=i&&this.model.y_interaction&&(0==this.side&&is_near(e.sy,d,r,h)&&(this.side=4),0==this.side&&is_near(e.sy,c,r,h)?this.side=5:is_inside(e.sx,e.sy,o,r,this.model.overlay)&&(3==this.side?this.side=7:this.side=6))}_pan(e){const t=this.plot_view.frame,i=e.deltaX-this.last_dx,n=e.deltaY-this.last_dy,o=this.model.x_range,r=this.model.y_range,s=t.x_scale,a=t.y_scale;if(null!=o)if(3==this.side||7==this.side)update_range(o,s,i,t.x_range);else if(1==this.side){const e=compute_value(o.start,s,i,t.x_range);this.side=update_range_start_side(e,o,this.side)}else if(2==this.side){const e=compute_value(o.end,s,i,t.x_range);this.side=update_range_end_side(e,o,this.side)}if(null!=r)if(6==this.side||7==this.side)update_range(r,a,n,t.y_range);else if(4==this.side){const e=compute_value(r.start,a,n,t.y_range);this.side=update_range_start_side(e,r,this.side)}else if(5==this.side){const e=compute_value(r.end,a,n,t.y_range);this.side=update_range_end_side(e,r,this.side)}this.last_dx=e.deltaX,this.last_dy=e.deltaY}_pan_end(e){this.side=0}}RangeToolView.__name__="RangeToolView";const DEFAULT_RANGE_OVERLAY=()=>new BoxAnnotation({level:"overlay",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:.5,line_dash:[2,2]});class RangeTool extends GestureTool{constructor(e){super(e),this.tool_name="Range Tool",this.icon=tool_icon_range,this.event_type="pan",this.default_order=1}static init_RangeTool(){this.prototype.default_view=RangeToolView,this.define((({Boolean:e,Ref:t,Nullable:i})=>({x_range:[i(t(Range1d)),null],x_interaction:[e,!0],y_range:[i(t(Range1d)),null],y_interaction:[e,!0],overlay:[t(BoxAnnotation),DEFAULT_RANGE_OVERLAY]})))}initialize(){super.initialize(),this.overlay.in_cursor="grab",this.overlay.ew_cursor=null!=this.x_range&&this.x_interaction?"ew-resize":null,this.overlay.ns_cursor=null!=this.y_range&&this.y_interaction?"ns-resize":null}update_overlay_from_ranges(){null==this.x_range&&null==this.y_range&&(this.overlay.left=null,this.overlay.right=null,this.overlay.bottom=null,this.overlay.top=null,logger.warn("RangeTool not configured with any Ranges.")),null==this.x_range?(this.overlay.left=null,this.overlay.right=null):(this.overlay.left=this.x_range.start,this.overlay.right=this.x_range.end),null==this.y_range?(this.overlay.bottom=null,this.overlay.top=null):(this.overlay.bottom=this.y_range.start,this.overlay.top=this.y_range.end)}}RangeTool.__name__="RangeTool",RangeTool.init_RangeTool();class TapToolView extends SelectToolView{_tap(e){"tap"==this.model.gesture&&this._handle_tap(e)}_doubletap(e){"doubletap"==this.model.gesture&&this._handle_tap(e)}_handle_tap(e){const{sx:t,sy:i}=e,n={type:"point",sx:t,sy:i};this._select(n,!0,this._select_mode(e))}_select(e,t,i){const{callback:n}=this.model;if("select"==this.model.behavior){const o=this._computed_renderers_by_data_source();for(const[,r]of o){const o=r[0].get_selection_manager(),s=r.map((e=>this.plot_view.renderer_view(e))).filter((e=>null!=e));if(o.select(s,e,t,i)&&null!=n){const t=s[0].coordinates.x_scale.invert(e.sx),i=s[0].coordinates.y_scale.invert(e.sy),r={geometries:__spreadProps(__spreadValues({},e),{x:t,y:i}),source:o.source};n.execute(this.model,r)}}this._emit_selection_event(e),this.plot_view.state.push("tap",{selection:this.plot_view.get_selection()})}else for(const o of this.computed_renderers){const t=this.plot_view.renderer_view(o);if(null==t)continue;const i=o.get_selection_manager();if(i.inspect(t,e)&&null!=n){const o=t.coordinates.x_scale.invert(e.sx),r=t.coordinates.y_scale.invert(e.sy),s={geometries:__spreadProps(__spreadValues({},e),{x:o,y:r}),source:i.source};n.execute(this.model,s)}}}}TapToolView.__name__="TapToolView";class TapTool extends SelectTool{constructor(e){super(e),this.tool_name="Tap",this.icon=tool_icon_tap_select,this.event_type="tap",this.default_order=10}static init_TapTool(){this.prototype.default_view=TapToolView,this.define((({Any:e,Enum:t,Nullable:i})=>({behavior:[TapBehavior,"select"],gesture:[t("tap","doubletap"),"tap"],callback:[i(e)]}))),this.register_alias("click",(()=>new TapTool({behavior:"inspect"}))),this.register_alias("tap",(()=>new TapTool)),this.register_alias("doubletap",(()=>new TapTool({gesture:"doubletap"})))}}TapTool.__name__="TapTool",TapTool.init_TapTool();class WheelPanToolView extends GestureToolView{_scroll(e){let t=this.model.speed*e.delta;t>.9?t=.9:t<-.9&&(t=-.9),this._update_ranges(t)}_update_ranges(e){var t;const{frame:i}=this.plot_view,n=i.bbox.h_range,o=i.bbox.v_range,[r,s]=[n.start,n.end],[a,l]=[o.start,o.end];let c,d,h,u;switch(this.model.dimension){case"height":{const t=Math.abs(l-a);c=r,d=s,h=a-t*e,u=l-t*e;break}case"width":{const t=Math.abs(s-r);c=r-t*e,d=s-t*e,h=a,u=l;break}}const{x_scales:p,y_scales:_}=i,f={xrs:update_ranges(p,c,d),yrs:update_ranges(_,h,u),factor:e};this.plot_view.state.push("wheel_pan",{range:f}),this.plot_view.update_range(f,{scrolling:!0}),null==(t=this.model.document)||t.interactive_start(this.plot_model)}}WheelPanToolView.__name__="WheelPanToolView";class WheelPanTool extends GestureTool{constructor(e){super(e),this.tool_name="Wheel Pan",this.icon=tool_icon_wheel_pan,this.event_type="scroll",this.default_order=12}static init_WheelPanTool(){this.prototype.default_view=WheelPanToolView,this.define((()=>({dimension:[Dimension,"width"]}))),this.internal((({Number:e})=>({speed:[e,.001]}))),this.register_alias("xwheel_pan",(()=>new WheelPanTool({dimension:"width"}))),this.register_alias("ywheel_pan",(()=>new WheelPanTool({dimension:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimension)}}WheelPanTool.__name__="WheelPanTool",WheelPanTool.init_WheelPanTool();class WheelZoomToolView extends GestureToolView{_pinch(e){const{sx:t,sy:i,scale:n,ctrlKey:o,shiftKey:r}=e;let s;s=n>=1?20*(n-1):-20/n,this._scroll({type:"wheel",sx:t,sy:i,delta:s,ctrlKey:o,shiftKey:r})}_scroll(e){var t;const{frame:i}=this.plot_view,n=i.bbox.h_range,o=i.bbox.v_range,{sx:r,sy:s}=e,a=this.model.dimensions,l=("width"==a||"both"==a)&&n.start<r&&r<n.end,c=("height"==a||"both"==a)&&o.start<s&&s<o.end;if(!(l&&c||this.model.zoom_on_axis))return;const d=scale_range(i,this.model.speed*e.delta,l,c,{x:r,y:s});this.plot_view.state.push("wheel_zoom",{range:d});const{maintain_focus:h}=this.model;this.plot_view.update_range(d,{scrolling:!0,maintain_focus:h}),null==(t=this.model.document)||t.interactive_start(this.plot_model)}}WheelZoomToolView.__name__="WheelZoomToolView";class WheelZoomTool extends GestureTool{constructor(e){super(e),this.tool_name="Wheel Zoom",this.icon=tool_icon_wheel_zoom,this.event_type=is_mobile?"pinch":"scroll",this.default_order=10}static init_WheelZoomTool(){this.prototype.default_view=WheelZoomToolView,this.define((({Boolean:e,Number:t})=>({dimensions:[Dimensions,"both"],maintain_focus:[e,!0],zoom_on_axis:[e,!0],speed:[t,1/600]}))),this.register_alias("wheel_zoom",(()=>new WheelZoomTool({dimensions:"both"}))),this.register_alias("xwheel_zoom",(()=>new WheelZoomTool({dimensions:"width"}))),this.register_alias("ywheel_zoom",(()=>new WheelZoomTool({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}WheelZoomTool.__name__="WheelZoomTool",WheelZoomTool.init_WheelZoomTool();class CrosshairToolView extends InspectToolView{_move(e){if(!this.model.active)return;const{sx:t,sy:i}=e;this.plot_view.frame.bbox.contains(t,i)?this._update_spans(t,i):this._update_spans(null,null)}_move_exit(e){this._update_spans(null,null)}_update_spans(e,t){const i=this.model.dimensions;"width"!=i&&"both"!=i||(this.model.spans.width.location=t),"height"!=i&&"both"!=i||(this.model.spans.height.location=e)}}CrosshairToolView.__name__="CrosshairToolView";class CrosshairTool extends InspectTool{constructor(e){super(e),this.tool_name="Crosshair",this.icon=tool_icon_crosshair}static init_CrosshairTool(){function e(e,t){return new Span({for_hover:!0,dimension:t,location_units:"screen",level:"overlay",line_color:e.line_color,line_width:e.line_width,line_alpha:e.line_alpha})}this.prototype.default_view=CrosshairToolView,this.define((({Alpha:e,Number:t,Color:i})=>({dimensions:[Dimensions,"both"],line_color:[i,"black"],line_width:[t,1],line_alpha:[e,1]}))),this.internal((({Struct:t,Ref:i})=>({spans:[t({width:i(Span),height:i(Span)}),t=>({width:e(t,"width"),height:e(t,"height")})]}))),this.register_alias("crosshair",(()=>new CrosshairTool))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}get synthetic_renderers(){return values(this.spans)}}CrosshairTool.__name__="CrosshairTool",CrosshairTool.init_CrosshairTool();class CustomJSHover extends Model{constructor(e){super(e)}static init_CustomJSHover(){this.define((({Unknown:e,String:t,Dict:i})=>({args:[i(e),{}],code:[t,""]})))}get values(){return values(this.args)}_make_code(e,t,i,n){return new Function(...keys(this.args),e,t,i,use_strict(n))}format(e,t,i){return this._make_code("value","format","special_vars",this.code)(...this.values,e,t,i)}}function _nearest_line_hit(e,t,i,n,o,r){const s={x:o[e],y:r[e]},a={x:o[e+1],y:r[e+1]};let l,c;if("span"==t.type)"h"==t.direction?(l=Math.abs(s.x-i),c=Math.abs(a.x-i)):(l=Math.abs(s.y-n),c=Math.abs(a.y-n));else{const e={x:i,y:n};l=dist_2_pts(s,e),c=dist_2_pts(a,e)}return l<c?[[s.x,s.y],e]:[[a.x,a.y],e+1]}function _line_hit(e,t,i){return[[e[i],t[i]],i]}CustomJSHover.__name__="CustomJSHover",CustomJSHover.init_CustomJSHover();class HoverToolView extends InspectToolView{initialize(){super.initialize(),this._ttmodels=new Map,this._ttviews=new Map}async lazy_initialize(){await super.lazy_initialize(),await this._update_ttmodels()}remove(){remove_views(this._ttviews),super.remove()}connect_signals(){super.connect_signals();const e=this.plot_model.properties.renderers,{renderers:t,tooltips:i}=this.model.properties;this.on_change(i,(()=>delete this._template_el)),this.on_change([e,t,i],(async()=>await this._update_ttmodels()))}async _update_ttmodels(){const{_ttmodels:e,computed_renderers:t}=this;e.clear();const{tooltips:i}=this.model;if(null!=i)for(const s of this.computed_renderers){const t=new Tooltip({custom:isString(i)||isFunction(i),attachment:this.model.attachment,show_arrow:this.model.show_arrow});s instanceof GlyphRenderer?e.set(s,t):s instanceof GraphRenderer&&(e.set(s.node_renderer,t),e.set(s.edge_renderer,t))}const n=await build_views(this._ttviews,[...e.values()],{parent:this.plot_view});for(const s of n)s.render();const o=[...function*(){for(const e of t)e instanceof GlyphRenderer?yield e:e instanceof GraphRenderer&&(yield e.node_renderer,yield e.edge_renderer)}()],r=this._slots.get(this._update);if(null!=r){const e=new Set(o.map((e=>e.data_source)));Signal.disconnect_receiver(this,r,e)}for(const s of o)this.connect(s.data_source.inspect,this._update)}get computed_renderers(){const{renderers:e,names:t}=this.model;return compute_renderers(e,this.plot_model.data_renderers,t)}get ttmodels(){return this._ttmodels}_clear(){this._inspect(1/0,1/0);for(const[,e]of this.ttmodels)e.clear()}_move(e){if(!this.model.active)return;const{sx:t,sy:i}=e;this.plot_view.frame.bbox.contains(t,i)?this._inspect(t,i):this._clear()}_move_exit(){this._clear()}_inspect(e,t){let i;if("mouse"==this.model.mode)i={type:"point",sx:e,sy:t};else{i={type:"span",direction:"vline"==this.model.mode?"h":"v",sx:e,sy:t}}for(const n of this.computed_renderers){const e=n.get_selection_manager(),t=this.plot_view.renderer_view(n);null!=t&&e.inspect(t,i)}this._emit_callback(i)}_update([e,{geometry:t}]){var i,n;if(!this.model.active)return;if("point"!=t.type&&"span"!=t.type)return;if(!(e instanceof GlyphRenderer))return;if("ignore"==this.model.muted_policy&&e.muted)return;const o=this.ttmodels.get(e);if(null==o)return;const r=e.get_selection_manager();let s=r.inspectors.get(e);if(s=e.view.convert_selection_to_subset(s),s.is_empty())return void o.clear();const a=r.source,l=this.plot_view.renderer_view(e);if(null==l)return;const{sx:c,sy:d}=t,h=l.coordinates.x_scale,u=l.coordinates.y_scale,p=h.invert(c),_=u.invert(d),{glyph:f}=l,g=[];if(f instanceof LineView)for(const m of s.line_indices){let i,n,o=f._x[m+1],r=f._y[m+1],l=m;switch(this.model.line_policy){case"interp":[o,r]=f.get_interpolation_hit(m,t),i=h.compute(o),n=u.compute(r);break;case"prev":[[i,n],l]=_line_hit(f.sx,f.sy,m);break;case"next":[[i,n],l]=_line_hit(f.sx,f.sy,m+1);break;case"nearest":[[i,n],l]=_nearest_line_hit(m,t,c,d,f.sx,f.sy),o=f._x[l],r=f._y[l];break;default:[i,n]=[c,d]}const v={index:l,x:p,y:_,sx:c,sy:d,data_x:o,data_y:r,rx:i,ry:n,indices:s.line_indices,name:e.name};g.push([i,n,this._render_tooltips(a,l,v)])}for(const m of s.image_indices){const t={index:m.index,x:p,y:_,sx:c,sy:d,name:e.name},i=this._render_tooltips(a,m,t);g.push([c,d,i])}for(const m of s.indices)if(f instanceof MultiLineView&&!isEmpty(s.multiline_indices))for(const i of s.multiline_indices[m.toString()]){let n,o,r,l=f._xs.get(m)[i],v=f._ys.get(m)[i],b=i;switch(this.model.line_policy){case"interp":[l,v]=f.get_interpolation_hit(m,i,t),n=h.compute(l),o=u.compute(v);break;case"prev":[[n,o],b]=_line_hit(f.sxs.get(m),f.sys.get(m),i);break;case"next":[[n,o],b]=_line_hit(f.sxs.get(m),f.sys.get(m),i+1);break;case"nearest":[[n,o],b]=_nearest_line_hit(i,t,c,d,f.sxs.get(m),f.sys.get(m)),l=f._xs.get(m)[b],v=f._ys.get(m)[b];break;default:throw new Error("shouldn't have happened")}r=e instanceof GlyphRenderer?e.view.convert_indices_from_subset([m])[0]:m;const y={index:r,x:p,y:_,sx:c,sy:d,data_x:l,data_y:v,segment_index:b,indices:s.multiline_indices,name:e.name};g.push([n,o,this._render_tooltips(a,r,y)])}else{const t=null==(i=f._x)?void 0:i[m],o=null==(n=f._y)?void 0:n[m];let r,l,h;if("snap_to_data"==this.model.point_policy){let e=f.get_anchor_point(this.model.anchor,m,[c,d]);if(null==e&&(e=f.get_anchor_point("center",m,[c,d]),null==e))continue;r=e.x,l=e.y}else[r,l]=[c,d];h=e instanceof GlyphRenderer?e.view.convert_indices_from_subset([m])[0]:m;const u={index:h,x:p,y:_,sx:c,sy:d,data_x:t,data_y:o,indices:s.indices,name:e.name};g.push([r,l,this._render_tooltips(a,h,u)])}if(0==g.length)o.clear();else{const{content:e}=o;empty$1(o.content);for(const[,,n]of g)null!=n&&e.appendChild(n);const[t,i]=g[g.length-1];o.setv({position:[t,i]},{check_eq:!1})}}_emit_callback(e){const{callback:t}=this.model;if(null!=t)for(const i of this.computed_renderers){if(!(i instanceof GlyphRenderer))continue;const n=this.plot_view.renderer_view(i);if(null==n)continue;const{x_scale:o,y_scale:r}=n.coordinates,s=o.invert(e.sx),a=r.invert(e.sy),l=i.data_source.inspected;t.execute(this.model,{geometry:__spreadValues({x:s,y:a},e),renderer:i,index:l})}}_create_template(e){const t=div({style:{display:"table",borderSpacing:"2px"}});for(const[i]of e){const e=div({style:{display:"table-row"}});t.appendChild(e);const n=div({style:{display:"table-cell"},class:tooltip_row_label},0!=i.length?`${i}: `:"");e.appendChild(n);const o=span();o.dataset.value="";const r=span({class:tooltip_color_block}," ");r.dataset.swatch="",undisplay(r);const s=div({style:{display:"table-cell"},class:tooltip_row_value},o,r);e.appendChild(s)}return t}_render_template(e,t,i,n,o){const r=e.cloneNode(!0),s=r.querySelectorAll("[data-value]"),a=r.querySelectorAll("[data-swatch]"),l=/\$color(\[.*\])?:(\w*)/,c=/\$swatch:(\w*)/;for(const[[,d],h]of enumerate(t)){const e=d.match(c),t=d.match(l);if(null!=e||null!=t){if(null!=e){const[,t]=e,o=i.get_column(t);if(null==o)s[h].textContent=`${t} unknown`;else{const e=isNumber(n)?o[n]:null;null!=e&&(a[h].style.backgroundColor=color2css(e),display(a[h]))}}if(null!=t){const[,e="",o]=t,r=i.get_column(o);if(null==r){s[h].textContent=`${o} unknown`;continue}const l=e.indexOf("hex")>=0,c=e.indexOf("swatch")>=0,d=isNumber(n)?r[n]:null;if(null==d){s[h].textContent="(null)";continue}s[h].textContent=l?color2hex(d):color2css(d),c&&(a[h].style.backgroundColor=color2css(d),display(a[h]))}}else{const e=replace_placeholders(d.replace("$~","$data_"),i,n,this.model.formatters,o);if(isString(e))s[h].textContent=e;else for(const t of e)s[h].appendChild(t)}}return r}_render_tooltips(e,t,i){var n;const{tooltips:o}=this.model;if(isString(o)){const n=replace_placeholders({html:o},e,t,this.model.formatters,i);return div({},n)}if(isFunction(o))return o(e,i);if(null!=o){const r=null!=(n=this._template_el)?n:this._template_el=this._create_template(o);return this._render_template(r,o,e,t,i)}return null}}HoverToolView.__name__="HoverToolView";class HoverTool extends InspectTool{constructor(e){super(e),this.tool_name="Hover",this.icon=tool_icon_hover}static init_HoverTool(){this.prototype.default_view=HoverToolView,this.define((({Any:e,Boolean:t,String:i,Array:n,Tuple:o,Dict:r,Or:s,Ref:a,Function:l,Auto:c,Nullable:d})=>({tooltips:[d(s(i,n(o(i,i)),l())),[["index","$index"],["data (x, y)","($x, $y)"],["screen (x, y)","($sx, $sy)"]]],formatters:[r(s(a(CustomJSHover),FormatterType)),{}],renderers:[s(n(a(DataRenderer)),c),"auto"],names:[n(i),[]],mode:[HoverMode,"mouse"],muted_policy:[MutedPolicy,"show"],point_policy:[PointPolicy,"snap_to_data"],line_policy:[LinePolicy,"nearest"],show_arrow:[t,!0],anchor:[Anchor,"center"],attachment:[TooltipAttachment,"horizontal"],callback:[d(e)]}))),this.register_alias("hover",(()=>new HoverTool))}}HoverTool.__name__="HoverTool",HoverTool.init_HoverTool();class ToolProxy extends Model{constructor(e){super(e)}static init_ToolProxy(){this.define((({Boolean:e,Array:t,Ref:i})=>({tools:[t(i(ButtonTool)),[]],active:[e,!1],disabled:[e,!1]})))}get button_view(){return this.tools[0].button_view}get event_type(){return this.tools[0].event_type}get tooltip(){return this.tools[0].tooltip}get tool_name(){return this.tools[0].tool_name}get icon(){return this.tools[0].computed_icon}get computed_icon(){return this.icon}get toggleable(){const e=this.tools[0];return e instanceof InspectTool&&e.toggleable}initialize(){super.initialize(),this.do=new Signal0(this,"do")}connect_signals(){super.connect_signals(),this.connect(this.do,(()=>this.doit())),this.connect(this.properties.active.change,(()=>this.set_active()));for(const e of this.tools)this.connect(e.properties.active.change,(()=>{this.active=e.active}))}doit(){for(const e of this.tools)e.do.emit()}set_active(){for(const e of this.tools)e.active=this.active}get menu(){const{menu:e}=this.tools[0];if(null==e)return null;const t=[];for(const[i,n]of enumerate(e))if(null==i)t.push(null);else{const e=()=>{var e,t;for(const i of this.tools)null==(t=null==(e=i.menu)?void 0:e[n])||t.handler()};t.push(__spreadProps(__spreadValues({},i),{handler:e}))}return t}}ToolProxy.__name__="ToolProxy",ToolProxy.init_ToolProxy();class ProxyToolbar extends ToolbarBase{constructor(e){super(e)}static init_ProxyToolbar(){this.define((({Array:e,Ref:t})=>({toolbars:[e(t(Toolbar)),[]]})))}initialize(){super.initialize(),this._merge_tools()}_merge_tools(){this._proxied_tools=[];const e={},t={},i={},n=[],o=[];for(const s of this.help)includes(o,s.redirect)||(n.push(s),o.push(s.redirect));this._proxied_tools.push(...n),this.help=n;for(const[s,a]of entries(this.gestures)){s in i||(i[s]={});for(const e of a.tools)e.type in i[s]||(i[s][e.type]=[]),i[s][e.type].push(e)}for(const s of this.inspectors)s.type in e||(e[s.type]=[]),e[s.type].push(s);for(const s of this.actions)s.type in t||(t[s.type]=[]),t[s.type].push(s);const r=(e,t=!1)=>{const i=new ToolProxy({tools:e,active:t});return this._proxied_tools.push(i),i};for(const s of keys(i)){const e=this.gestures[s];e.tools=[];for(const t of keys(i[s])){const n=i[s][t];if(n.length>0)if("multi"==s)for(const t of n){const i=r([t]);e.tools.push(i),this.connect(i.properties.active.change,(()=>this._active_change(i)))}else{const t=r(n);e.tools.push(t),this.connect(t.properties.active.change,(()=>this._active_change(t)))}}}this.actions=[];for(const[s,a]of entries(t))if("CustomAction"==s)for(const e of a)this.actions.push(r([e]));else a.length>0&&this.actions.push(r(a));this.inspectors=[];for(const s of values(e))s.length>0&&this.inspectors.push(r(s,!0));for(const[s,a]of entries(this.gestures))0!=a.tools.length&&(a.tools=sort_by(a.tools,(e=>e.default_order)),"pinch"!=s&&"scroll"!=s&&"multi"!=s&&(a.tools[0].active=!0))}}ProxyToolbar.__name__="ProxyToolbar",ProxyToolbar.init_ProxyToolbar();class ToolbarBoxView extends LayoutDOMView{initialize(){this.model.toolbar.toolbar_location=this.model.toolbar_location,super.initialize()}get child_models(){return[this.model.toolbar]}_update_layout(){this.layout=new ContentBox(this.child_views[0].el);const{toolbar:e}=this.model;e.horizontal?this.layout.set_sizing({width_policy:"fit",min_width:100,height_policy:"fixed"}):this.layout.set_sizing({width_policy:"fixed",height_policy:"fit",min_height:100})}}ToolbarBoxView.__name__="ToolbarBoxView";class ToolbarBox extends LayoutDOM{constructor(e){super(e)}static init_ToolbarBox(){this.prototype.default_view=ToolbarBoxView,this.define((({Ref:e})=>({toolbar:[e(ToolbarBase)],toolbar_location:[Location,"right"]})))}}ToolbarBox.__name__="ToolbarBox",ToolbarBox.init_ToolbarBox();var AllModels=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Annotation:Annotation,Arrow:Arrow,ArrowHead:ArrowHead,OpenHead:OpenHead,NormalHead:NormalHead,TeeHead:TeeHead,VeeHead:VeeHead,Band:Band,BoxAnnotation:BoxAnnotation,ColorBar:ColorBar,Label:Label,LabelSet:LabelSet,Legend:Legend,LegendItem:LegendItem,PolyAnnotation:PolyAnnotation,Slope:Slope,Span:Span,TextAnnotation:TextAnnotation,Title:Title,ToolbarPanel:ToolbarPanel,Tooltip:Tooltip,Whisker:Whisker,Axis:Axis,CategoricalAxis:CategoricalAxis,ContinuousAxis:ContinuousAxis,DatetimeAxis:DatetimeAxis,LinearAxis:LinearAxis,LogAxis:LogAxis,MercatorAxis:MercatorAxis,CustomJS:CustomJS,OpenURL:OpenURL,Canvas:Canvas,CartesianFrame:CartesianFrame,Expression:Expression,CustomJSExpr:CustomJSExpr,Stack:Stack,CumSum:CumSum,ScalarExpression:ScalarExpression,Minimum:Minimum,Maximum:Maximum,BooleanFilter:BooleanFilter,CustomJSFilter:CustomJSFilter,Filter:Filter,GroupFilter:GroupFilter,IndexFilter:IndexFilter,BasicTickFormatter:BasicTickFormatter,CategoricalTickFormatter:CategoricalTickFormatter,DatetimeTickFormatter:DatetimeTickFormatter,FuncTickFormatter:FuncTickFormatter,LogTickFormatter:LogTickFormatter,MercatorTickFormatter:MercatorTickFormatter,NumeralTickFormatter:NumeralTickFormatter,PrintfTickFormatter:PrintfTickFormatter,TickFormatter:TickFormatter,AnnularWedge:AnnularWedge,Annulus:Annulus,Arc:Arc,Bezier:Bezier,Circle:Circle,Ellipse:Ellipse,EllipseOval:EllipseOval,Glyph:Glyph,HArea:HArea,HBar:HBar,HexTile:HexTile,Image:Image$1,ImageRGBA:ImageRGBA,ImageURL:ImageURL,Line:Line,MultiLine:MultiLine,MultiPolygons:MultiPolygons,Oval:Oval,Patch:Patch,Patches:Patches,Quad:Quad,Quadratic:Quadratic,Ray:Ray,Rect:Rect,Scatter:Scatter,Segment:Segment,Spline:Spline,Step:Step,Text:Text,VArea:VArea,VBar:VBar,Wedge:Wedge,GraphHitTestPolicy:GraphHitTestPolicy,EdgesOnly:EdgesOnly,NodesOnly:NodesOnly,NodesAndLinkedEdges:NodesAndLinkedEdges,EdgesAndLinkedNodes:EdgesAndLinkedNodes,LayoutProvider:LayoutProvider,StaticLayoutProvider:StaticLayoutProvider,Grid:Grid,Box:Box,Column:Column,GridBox:GridBox,HTMLBox:HTMLBox,LayoutDOM:LayoutDOM,Panel:Panel,Row:Row,Spacer:Spacer,Tabs:Tabs,WidgetBox:WidgetBox,CategoricalColorMapper:CategoricalColorMapper,CategoricalMarkerMapper:CategoricalMarkerMapper,CategoricalPatternMapper:CategoricalPatternMapper,ContinuousColorMapper:ContinuousColorMapper,ColorMapper:ColorMapper,LinearColorMapper:LinearColorMapper,LogColorMapper:LogColorMapper,ScanningColorMapper:ScanningColorMapper,EqHistColorMapper:EqHistColorMapper,CustomJSTransform:CustomJSTransform,Dodge:Dodge,Interpolator:Interpolator,Jitter:Jitter,LinearInterpolator:LinearInterpolator,StepInterpolator:StepInterpolator,Transform:Transform,MapOptions:MapOptions,GMapOptions:GMapOptions,GMapPlot:GMapPlot,Plot:Plot,LabelingPolicy:LabelingPolicy,AllLabels:AllLabels,NoOverlap:NoOverlap,CustomLabelingPolicy:CustomLabelingPolicy,DataRange:DataRange,DataRange1d:DataRange1d,FactorRange:FactorRange,Range:Range$1,Range1d:Range1d,GlyphRenderer:GlyphRenderer,GraphRenderer:GraphRenderer,GuideRenderer:GuideRenderer,Renderer:Renderer,CategoricalScale:CategoricalScale,ContinuousScale:ContinuousScale,LinearScale:LinearScale,LinearInterpolationScale:LinearInterpolationScale,LogScale:LogScale,Scale:Scale,Selection:Selection,SelectionPolicy:SelectionPolicy,IntersectRenderers:IntersectRenderers,UnionRenderers:UnionRenderers,ServerSentDataSource:ServerSentDataSource,AjaxDataSource:AjaxDataSource,ColumnDataSource:ColumnDataSource,ColumnarDataSource:ColumnarDataSource,CDSView:CDSView,DataSource:DataSource,GeoJSONDataSource:GeoJSONDataSource,WebDataSource:WebDataSource,AdaptiveTicker:AdaptiveTicker,BasicTicker:BasicTicker,CategoricalTicker:CategoricalTicker,CompositeTicker:CompositeTicker,ContinuousTicker:ContinuousTicker,DatetimeTicker:DatetimeTicker,DaysTicker:DaysTicker,FixedTicker:FixedTicker,LogTicker:LogTicker,MercatorTicker:MercatorTicker,MonthsTicker:MonthsTicker,SingleIntervalTicker:SingleIntervalTicker,Ticker:Ticker,YearsTicker:YearsTicker,BinnedTicker:BinnedTicker,BBoxTileSource:BBoxTileSource,MercatorTileSource:MercatorTileSource,QUADKEYTileSource:QUADKEYTileSource,TileRenderer:TileRenderer,TileSource:TileSource,TMSTileSource:TMSTileSource,WMTSTileSource:WMTSTileSource,CanvasTexture:CanvasTexture,ImageURLTexture:ImageURLTexture,Texture:Texture,ActionTool:ActionTool,CustomAction:CustomAction,HelpTool:HelpTool,RedoTool:RedoTool,ResetTool:ResetTool,SaveTool:SaveTool,UndoTool:UndoTool,ZoomInTool:ZoomInTool,ZoomOutTool:ZoomOutTool,ButtonTool:ButtonTool,EditTool:EditTool,BoxEditTool:BoxEditTool,FreehandDrawTool:FreehandDrawTool,PointDrawTool:PointDrawTool,PolyDrawTool:PolyDrawTool,PolyTool:PolyTool,PolyEditTool:PolyEditTool,BoxSelectTool:BoxSelectTool,BoxZoomTool:BoxZoomTool,GestureTool:GestureTool,LassoSelectTool:LassoSelectTool,LineEditTool:LineEditTool,PanTool:PanTool,PolySelectTool:PolySelectTool,RangeTool:RangeTool,SelectTool:SelectTool,TapTool:TapTool,WheelPanTool:WheelPanTool,WheelZoomTool:WheelZoomTool,CrosshairTool:CrosshairTool,CustomJSHover:CustomJSHover,HoverTool:HoverTool,InspectTool:InspectTool,Tool:Tool,ToolProxy:ToolProxy,Toolbar:Toolbar,ToolbarBase:ToolbarBase,ProxyToolbar:ProxyToolbar,ToolbarBox:ToolbarBox});const overrides={},_all_models=new Map,Models=e=>{const t=Models.get(e);if(null!=t)return t;throw new Error(`Model '${e}' does not exist. This could be due to a widget or a custom model not being registered before first usage.`)};function is_HasProps(e){return isObject(e)&&e.prototype instanceof HasProps}Models.get=e=>{var t;return null!=(t=overrides[e])?t:_all_models.get(e)},Models.register=(e,t)=>{overrides[e]=t},Models.unregister=e=>{delete overrides[e]},Models.register_models=(e,t=!1,i)=>{if(null!=e)for(const n of isArray(e)?e:values(e))if(is_HasProps(n)){const e=n.__qualified__;t||!_all_models.has(e)?_all_models.set(e,n):null!=i?i(e):console.warn(`Model '${e}' was already registered`)}};const register_models=Models.register_models;Models.registered_names=()=>[..._all_models.keys()];class ModelResolver{constructor(){this._known_models=new Map}get(e,t){var i;const n=null!=(i=Models.get(e))?i:this._known_models.get(e);if(null!=n)return n;if(void 0!==t)return t;throw new Error(`Model '${e}' does not exist. This could be due to a widget or a custom model not being registered before first usage.`)}register(e){const t=e.__qualified__;null==this.get(t,null)?this._known_models.set(t,e):console.warn(`Model '${t}' was already registered with this resolver`)}}function resolve_defs(e,t){var i,n,o,r;function s(e){return null!=e.module?`${e.module}.${e.name}`:e.name}function a(e){if(isString(e))switch(e){case"Any":return Any$1;case"Unknown":return Unknown;case"Boolean":return Boolean$1;case"Number":return Number$2;case"Int":return Int$1;case"String":return String$2;case"Null":return Null}else switch(e[0]){case"Nullable":{const[,t]=e;return Nullable(a(t))}case"Or":{const[,...t]=e;return Or(...t.map(a))}case"Tuple":{const[,t,...i]=e;return Tuple(a(t),...i.map(a))}case"Array":{const[,t]=e;return Array$2(a(t))}case"Struct":{const[,...t]=e,i=t.map((([e,t])=>[e,a(t)]));return Struct(to_object(i))}case"Dict":{const[,t]=e;return Dict(a(t))}case"Map":{const[,t,i]=e;return Map$1(a(t),a(i))}case"Enum":{const[,...t]=e;return Enum(...t)}case"Ref":{const[,i]=e,n=t.get(s(i));if(null!=n)return Ref(n);throw new Error(`${s(i)} wasn't defined before referencing it`)}case"AnyRef":return AnyRef()}}for(const l of e){const e=(()=>{if(null==l.extends)return Model;{const e=t.get(s(l.extends));if(null!=e)return e;throw new Error(`base model ${s(l.extends)} of ${s(l)} is not defined`)}})(),c=((r=class extends e{}).__name__=l.name,r.__module__=l.module,r);for(const t of null!=(i=l.properties)?i:[]){const e=a(null!=(n=t.kind)?n:"Unknown");c.define({[t.name]:[e,t.default]})}for(const t of null!=(o=l.overrides)?o:[])c.override({[t.name]:t.default});t.register(c)}}ModelResolver.__name__="ModelResolver",register_models(AllModels);class EventManager{constructor(e){this.document=e,this.session=null,this.subscribed_models=new Set}send_event(e){const t=new MessageSentEvent(this.document,"bokeh_event",e.to_json());this.document._trigger_on_change(t)}trigger(e){for(const t of this.subscribed_models)null!=e.origin&&e.origin!=t||t._process_event(e)}}EventManager.__name__="EventManager";const documents=[],DEFAULT_TITLE="Bokeh Application";class Document{constructor(e){var t;documents.push(this),this._init_timestamp=Date.now(),this._resolver=null!=(t=null==e?void 0:e.resolver)?t:new ModelResolver,this._title=DEFAULT_TITLE,this._roots=[],this._all_models=new Map,this._all_models_freeze_count=0,this._callbacks=new Map,this._message_callbacks=new Map,this.event_manager=new EventManager(this),this.idle=new Signal0(this,"idle"),this._idle_roots=new WeakMap,this._interactive_timestamp=null,this._interactive_plot=null}get layoutables(){return this._roots.filter((e=>e instanceof LayoutDOM))}get is_idle(){for(const e of this.layoutables)if(!this._idle_roots.has(e))return!1;return!0}notify_idle(e){this._idle_roots.set(e,!0),this.is_idle&&(logger.info(`document idle at ${Date.now()-this._init_timestamp} ms`),this.event_manager.send_event(new DocumentReady),this.idle.emit())}clear(){this._push_all_models_freeze();try{for(;this._roots.length>0;)this.remove_root(this._roots[0])}finally{this._pop_all_models_freeze()}}interactive_start(e){null==this._interactive_plot&&(this._interactive_plot=e,this._interactive_plot.trigger_event(new LODStart)),this._interactive_timestamp=Date.now()}interactive_stop(){null!=this._interactive_plot&&this._interactive_plot.trigger_event(new LODEnd),this._interactive_plot=null,this._interactive_timestamp=null}interactive_duration(){return null==this._interactive_timestamp?-1:Date.now()-this._interactive_timestamp}destructively_move(e){if(e===this)throw new Error("Attempted to overwrite a document with itself");e.clear();const t=copy(this._roots);this.clear();for(const i of t)if(null!=i.document)throw new Error(`Somehow we didn't detach ${i}`);if(0!=this._all_models.size)throw new Error(`this._all_models still had stuff in it: ${this._all_models}`);for(const i of t)e.add_root(i);e.set_title(this._title)}_push_all_models_freeze(){this._all_models_freeze_count+=1}_pop_all_models_freeze(){this._all_models_freeze_count-=1,0===this._all_models_freeze_count&&this._recompute_all_models()}_invalidate_all_models(){logger.debug("invalidating document models"),0===this._all_models_freeze_count&&this._recompute_all_models()}_recompute_all_models(){let e=new Set;for(const r of this._roots)e=union(e,r.references());const t=new Set(this._all_models.values()),i=difference(t,e),n=difference(e,t),o=new Map;for(const r of e)o.set(r.id,r);for(const r of i)r.detach_document();for(const r of n)r.attach_document(this);this._all_models=o}roots(){return this._roots}add_root(e,t){if(logger.debug(`Adding root: ${e}`),!includes(this._roots,e)){this._push_all_models_freeze();try{this._roots.push(e)}finally{this._pop_all_models_freeze()}this._trigger_on_change(new RootAddedEvent(this,e,t))}}remove_root(e,t){const i=this._roots.indexOf(e);if(!(i<0)){this._push_all_models_freeze();try{this._roots.splice(i,1)}finally{this._pop_all_models_freeze()}this._trigger_on_change(new RootRemovedEvent(this,e,t))}}title(){return this._title}set_title(e,t){e!==this._title&&(this._title=e,this._trigger_on_change(new TitleChangedEvent(this,e,t)))}get_model_by_id(e){var t;return null!=(t=this._all_models.get(e))?t:null}get_model_by_name(e){const t=[];for(const i of this._all_models.values())i instanceof Model&&i.name==e&&t.push(i);switch(t.length){case 0:return null;case 1:return t[0];default:throw new Error(`Multiple models are named '${e}'`)}}on_message(e,t){const i=this._message_callbacks.get(e);null==i?this._message_callbacks.set(e,new Set([t])):i.add(t)}remove_on_message(e,t){var i;null==(i=this._message_callbacks.get(e))||i.delete(t)}_trigger_on_message(e,t){const i=this._message_callbacks.get(e);if(null!=i)for(const n of i)n(t)}on_change(e,t=!1){this._callbacks.has(e)||this._callbacks.set(e,t)}remove_on_change(e){this._callbacks.delete(e)}_trigger_on_change(e){for(const[t,i]of this._callbacks)if(!i&&e instanceof DocumentEventBatch)for(const n of e.events)t(n);else t(e)}_notify_change(e,t,i,n,o){this._trigger_on_change(new ModelChangedEvent(this,e,t,i,n,null==o?void 0:o.setter_id,null==o?void 0:o.hint))}static _instantiate_object(e,t,i,n){const o=__spreadProps(__spreadValues({},i),{id:e,__deferred__:!0});return new(n.get(t))(o)}static _instantiate_references_json(e,t,i){var n;const o=new Map;for(const r of e){const e=r.id,s=r.type,a=null!=(n=r.attributes)?n:{};let l=t.get(e);null==l&&(l=Document._instantiate_object(e,s,a,i),null!=r.subtype&&l.set_subtype(r.subtype)),o.set(l.id,l)}return o}static _resolve_refs(e,t,i,n){function o(e){var r;if(is_ref(e)){const n=null!=(r=t.get(e.id))?r:i.get(e.id);if(null!=n)return n;throw new Error(`reference ${JSON.stringify(e)} isn't known (not in Document?)`)}return is_NDArray_ref(e)?decode_NDArray(e,n):isArray(e)?function(e){const t=[];for(const i of e)t.push(o(i));return t}(e):isPlainObject(e)?function(e){const t={};for(const[i,n]of entries(e))t[i]=o(n);return t}(e):e}return o(e)}static _initialize_references_json(e,t,i,n){const o=new Map;for(const{id:l,attributes:c}of e){const e=!t.has(l),r=e?i.get(l):t.get(l),s=Document._resolve_refs(c,t,i,n);r.setv(s,{silent:!0}),o.set(l,{instance:r,is_new:e})}const r=[],s=new Set;function a(e){if(e instanceof HasProps){if(o.has(e.id)&&!s.has(e.id)){s.add(e.id);const{instance:t,is_new:i}=o.get(e.id),{attributes:n}=t;for(const e of values(n))a(e);i&&(t.finalize(),r.push(t))}}else if(isArray(e))for(const t of e)a(t);else if(isPlainObject(e))for(const t of values(e))a(t)}for(const l of o.values())a(l.instance);for(const l of r)l.connect_signals()}static _event_for_attribute_change(e,t,i,n,o){if(n.get_model_by_id(e.id).property(t).syncable){const r={kind:"ModelChanged",model:{id:e.id},attr:t,new:i};return HasProps._json_record_references(n,i,o,{recursive:!0}),r}return null}static _events_to_sync_objects(e,t,i,n){const o=Object.keys(e.attributes),r=Object.keys(t.attributes),s=difference$1(o,r),a=difference$1(r,o),l=intersection(o,r),c=[];for(const d of s)logger.warn(`Server sent key ${d} but we don't seem to have it in our JSON`);for(const d of a){const o=t.attributes[d];c.push(Document._event_for_attribute_change(e,d,o,i,n))}for(const d of l){const o=e.attributes[d],r=t.attributes[d];null==o&&null==r||(null==o||null==r?c.push(Document._event_for_attribute_change(e,d,r,i,n)):is_equal(o,r)||c.push(Document._event_for_attribute_change(e,d,r,i,n)))}return c.filter((e=>null!=e))}static _compute_patch_since_json(e,t){const i=t.to_json(!1);function n(e){const t=new Map;for(const i of e.roots.references)t.set(i.id,i);return t}const o=n(e),r=new Map,s=[];for(const p of e.roots.root_ids)r.set(p,o.get(p)),s.push(p);const a=n(i),l=new Map,c=[];for(const p of i.roots.root_ids)l.set(p,a.get(p)),c.push(p);if(s.sort(),c.sort(),difference$1(s,c).length>0||difference$1(c,s).length>0)throw new Error("Not implemented: computing add/remove of document roots");const d=new Set;let h=[];for(const p of t._all_models.keys())if(o.has(p)){const e=Document._events_to_sync_objects(o.get(p),a.get(p),t,d);h=h.concat(e)}const u=new Serializer({include_defaults:!1});return u.to_serializable([...d]),{references:[...u.definitions],events:h}}to_json_string(e=!0){return JSON.stringify(this.to_json(e))}to_json(e=!0){const t=new Serializer({include_defaults:e}),i=t.to_serializable(this._roots);return{version:version,title:this._title,roots:{root_ids:i.map((e=>e.id)),references:[...t.definitions]}}}static from_json_string(e){const t=JSON.parse(e);return Document.from_json(t)}static from_json(e){logger.debug("Creating Document from JSON");const t=e.version,i=-1!==t.indexOf("+")||-1!==t.indexOf("-"),n=`Library versions: JS (${version}) / Python (${t})`;i||version.replace(/-(dev|rc)\./,"$1")==t?logger.debug(n):(logger.warn("JS/Python version mismatch"),logger.warn(n));const o=new ModelResolver;null!=e.defs&&resolve_defs(e.defs,o);const r=e.roots,s=r.root_ids,a=r.references,l=Document._instantiate_references_json(a,new Map,o);Document._initialize_references_json(a,new Map,l,new Map);const c=new Document({resolver:o});for(const d of s){const e=l.get(d);null!=e&&c.add_root(e)}return c.set_title(e.title),c}replace_with_json(e){Document.from_json(e).destructively_move(this)}create_json_patch_string(e){return JSON.stringify(this.create_json_patch(e))}create_json_patch(e){for(const n of e)if(n.document!=this)throw new Error("Cannot create a patch using events from a different document");const t=new Serializer,i=t.to_serializable(e);for(const n of this._all_models.values())t.remove_def(n);return{events:i,references:[...t.definitions]}}apply_json_patch(e,t=new Map,i){const n=e.references,o=e.events,r=Document._instantiate_references_json(n,this._all_models,this._resolver);t instanceof Map||(t=new Map(t));for(const l of o)switch(l.kind){case"RootAdded":case"RootRemoved":case"ModelChanged":{const e=l.model.id,t=this._all_models.get(e);if(null!=t)r.set(e,t);else if(!r.has(e))throw logger.warn(`Got an event for unknown model ${l.model}"`),new Error("event model wasn't known");break}}const s=new Map(this._all_models),a=new Map;for(const[l,c]of r)s.has(l)||a.set(l,c);Document._initialize_references_json(n,s,a,t);for(const l of o)switch(l.kind){case"MessageSent":{const{msg_type:e,msg_data:i}=l;let n;if(void 0===i){if(1!=t.size)throw new Error("expected exactly one buffer");{const[[,e]]=t;n=e}}else n=Document._resolve_refs(i,s,a,t);this._trigger_on_message(e,n);break}case"ModelChanged":{const e=l.model.id,n=this._all_models.get(e);if(null==n)throw new Error(`Cannot apply patch to ${e} which is not in the document`);const o=l.attr,r=Document._resolve_refs(l.new,s,a,t);n.setv({[o]:r},{setter_id:i});break}case"ColumnDataChanged":{const e=l.column_source.id,n=this._all_models.get(e);if(null==n)throw new Error(`Cannot stream to ${e} which is not in the document`);const o=Document._resolve_refs(l.new,new Map,new Map,t);if(null!=l.cols)for(const t in n.data)t in o||(o[t]=n.data[t]);n.setv({data:o},{setter_id:i,check_eq:!1});break}case"ColumnsStreamed":{const e=l.column_source.id,t=this._all_models.get(e);if(null==t)throw new Error(`Cannot stream to ${e} which is not in the document`);if(!(t instanceof ColumnDataSource))throw new Error("Cannot stream to non-ColumnDataSource");const n=l.data,o=l.rollover;t.stream(n,o,i);break}case"ColumnsPatched":{const e=l.column_source.id,t=this._all_models.get(e);if(null==t)throw new Error(`Cannot patch ${e} which is not in the document`);if(!(t instanceof ColumnDataSource))throw new Error("Cannot patch non-ColumnDataSource");const n=l.patches;t.patch(n,i);break}case"RootAdded":{const e=l.model.id,t=r.get(e);this.add_root(t,i);break}case"RootRemoved":{const e=l.model.id,t=r.get(e);this.remove_root(t,i);break}case"TitleChanged":this.set_title(l.title,i);break;default:throw new Error("Unknown patch event "+JSON.stringify(l))}}}Document.__name__="Document";const BOKEH_ROOT=root$3;function _get_element(e){let t=document.getElementById(e);if(null==t)throw new Error(`Error rendering Bokeh model: could not find #${e} HTML tag`);if(!document.body.contains(t))throw new Error(`Error rendering Bokeh model: element #${e} must be under <body>`);if("SCRIPT"==t.tagName){const e=div({class:BOKEH_ROOT});replaceWith(t,e),t=e}return t}function _resolve_element(e){const{elementid:t}=e;return null!=t?_get_element(t):document.body}function _resolve_root_elements(e){const t=[];if(null!=e.root_ids&&null!=e.roots)for(const i of e.root_ids)t.push(_get_element(e.roots[i]));return t}const index$2={};async function add_document_standalone(e,t,i=[],n=!1){const o=new Map;async function r(n){let r;const s=e.roots().indexOf(n),a=i[s];null!=a?r=a:t.classList.contains(BOKEH_ROOT)?r=t:(r=div({class:BOKEH_ROOT}),t.appendChild(r));const l=await build_view(n,{parent:null});return l instanceof DOMView&&l.renderTo(r),o.set(n,l),index$2[n.id]=l,l}for(const s of e.roots())await r(s);return n&&(window.document.title=e.title()),e.on_change((e=>{e instanceof RootAddedEvent?r(e.model):e instanceof RootRemovedEvent?function(e){const t=o.get(e);null!=t&&(t.remove(),o.delete(e),delete index$2[e.id])}(e.model):n&&e instanceof TitleChangedEvent&&(window.document.title=e.title)})),[...o.values()]}class Message{constructor(e,t,i){this.header=e,this.metadata=t,this.content=i,this.buffers=new Map}static assemble(e,t,i){const n=JSON.parse(e),o=JSON.parse(t),r=JSON.parse(i);return new Message(n,o,r)}assemble_buffer(e,t){const i=null!=this.header.num_buffers?this.header.num_buffers:0;if(i<=this.buffers.size)throw new Error(`too many buffers received, expecting ${i}`);const{id:n}=JSON.parse(e);this.buffers.set(n,t)}static create(e,t,i={}){const n=Message.create_header(e);return new Message(n,t,i)}static create_header(e){return{msgid:uniqueId(),msgtype:e}}complete(){return null!=this.header&&null!=this.metadata&&null!=this.content&&(null==this.header.num_buffers||this.buffers.size==this.header.num_buffers)}send(e){if((null!=this.header.num_buffers?this.header.num_buffers:0)>0)throw new Error("BokehJS only supports receiving buffers, not sending");const t=JSON.stringify(this.header),i=JSON.stringify(this.metadata),n=JSON.stringify(this.content);e.send(t),e.send(i),e.send(n)}msgid(){return this.header.msgid}msgtype(){return this.header.msgtype}reqid(){return this.header.reqid}problem(){return"msgid"in this.header?"msgtype"in this.header?null:"No msgtype in header":"No msgid in header"}}Message.__name__="Message";class Receiver{constructor(){this.message=null,this._partial=null,this._fragments=[],this._buf_header=null,this._current_consumer=this._HEADER}consume(e){this._current_consumer(e)}_HEADER(e){this._assume_text(e),this.message=null,this._partial=null,this._fragments=[e],this._buf_header=null,this._current_consumer=this._METADATA}_METADATA(e){this._assume_text(e),this._fragments.push(e),this._current_consumer=this._CONTENT}_CONTENT(e){this._assume_text(e),this._fragments.push(e);const[t,i,n]=this._fragments.slice(0,3);this._partial=Message.assemble(t,i,n),this._check_complete()}_BUFFER_HEADER(e){this._assume_text(e),this._buf_header=e,this._current_consumer=this._BUFFER_PAYLOAD}_BUFFER_PAYLOAD(e){this._assume_binary(e),this._partial.assemble_buffer(this._buf_header,e),this._check_complete()}_assume_text(e){if(!isString(e))throw new Error("Expected text fragment but received binary fragment")}_assume_binary(e){if(!(e instanceof ArrayBuffer))throw new Error("Expected binary fragment but received text fragment")}_check_complete(){this._partial.complete()?(this.message=this._partial,this._current_consumer=this._HEADER):this._current_consumer=this._BUFFER_HEADER}}Receiver.__name__="Receiver";class ClientSession{constructor(e,t,i){this._connection=e,this.document=t,this.id=i,this._document_listener=e=>{this._document_changed(e)},this.document.on_change(this._document_listener,!0)}handle(e){const t=e.msgtype();"PATCH-DOC"===t?this._handle_patch(e):"OK"===t?this._handle_ok(e):"ERROR"===t?this._handle_error(e):logger.debug(`Doing nothing with message ${e.msgtype()}`)}close(){this._connection.close()}_connection_closed(){this.document.remove_on_change(this._document_listener)}async request_server_info(){const e=Message.create("SERVER-INFO-REQ",{});return(await this._connection.send_with_reply(e)).content}async force_roundtrip(){await this.request_server_info()}_document_changed(e){if(e.setter_id===this.id)return;const t=e instanceof DocumentEventBatch?e.events:[e],i=this.document.create_json_patch(t),n=Message.create("PATCH-DOC",{},i);this._connection.send(n)}_handle_patch(e){this.document.apply_json_patch(e.content,e.buffers,this.id)}_handle_ok(e){logger.trace(`Unhandled OK reply to ${e.reqid()}`)}_handle_error(e){logger.error(`Unhandled ERROR reply to ${e.reqid()}: ${e.content.text}`)}}ClientSession.__name__="ClientSession";const DEFAULT_SERVER_WEBSOCKET_URL="ws://localhost:5006/ws",DEFAULT_TOKEN="eyJzZXNzaW9uX2lkIjogImRlZmF1bHQifQ";let _connection_count=0;function parse_token(e){let t=e.split(".")[0];const i=t.length%4;return 0!=i&&(t+="=".repeat(4-i)),JSON.parse(atob(t.replace(/_/g,"/").replace(/-/g,"+")))}class ClientConnection{constructor(e=DEFAULT_SERVER_WEBSOCKET_URL,t=DEFAULT_TOKEN,i=null){this.url=e,this.token=t,this.args_string=i,this._number=_connection_count++,this.socket=null,this.session=null,this.closed_permanently=!1,this._current_handler=null,this._pending_replies=new Map,this._pending_messages=[],this._receiver=new Receiver,this.id=parse_token(t).session_id.split(".")[0],logger.debug(`Creating websocket ${this._number} to '${this.url}' session '${this.id}'`)}async connect(){if(this.closed_permanently)throw new Error("Cannot connect() a closed ClientConnection");if(null!=this.socket)throw new Error("Already connected");this._current_handler=null,this._pending_replies.clear(),this._pending_messages=[];try{let e=`${this.url}`;return null!=this.args_string&&this.args_string.length>0&&(e+=`?${this.args_string}`),this.socket=new WebSocket(e,["bokeh",this.token]),new Promise(((e,t)=>{this.socket.binaryType="arraybuffer",this.socket.onopen=()=>this._on_open(e,t),this.socket.onmessage=e=>this._on_message(e),this.socket.onclose=e=>this._on_close(e,t),this.socket.onerror=()=>this._on_error(t)}))}catch(e){throw logger.error(`websocket creation failed to url: ${this.url}`),logger.error(` - ${e}`),e}}close(){this.closed_permanently||(logger.debug(`Permanently closing websocket connection ${this._number}`),this.closed_permanently=!0,null!=this.socket&&this.socket.close(1e3,`close method called on ClientConnection ${this._number}`),this.session._connection_closed())}_schedule_reconnect(e){setTimeout((()=>{this.closed_permanently||logger.info(`Websocket connection ${this._number} disconnected, will not attempt to reconnect`)}),e)}send(e){if(null==this.socket)throw new Error(`not connected so cannot send ${e}`);e.send(this.socket)}async send_with_reply(e){const t=await new Promise(((t,i)=>{this._pending_replies.set(e.msgid(),{resolve:t,reject:i}),this.send(e)}));if("ERROR"===t.msgtype())throw new Error(`Error reply ${t.content.text}`);return t}async _pull_doc_json(){const e=Message.create("PULL-DOC-REQ",{}),t=await this.send_with_reply(e);if(!("doc"in t.content))throw new Error("No 'doc' field in PULL-DOC-REPLY");return t.content.doc}async _repull_session_doc(e,t){var i;logger.debug(this.session?"Repulling session":"Pulling session for first time");try{const i=await this._pull_doc_json();if(null==this.session)if(this.closed_permanently)logger.debug("Got new document after connection was already closed"),t(new Error("The connection has been closed"));else{const t=Document.from_json(i),n=Document._compute_patch_since_json(i,t);if(n.events.length>0){logger.debug(`Sending ${n.events.length} changes from model construction back to server`);const e=Message.create("PATCH-DOC",{},n);this.send(e)}this.session=new ClientSession(this,t,this.id);for(const e of this._pending_messages)this.session.handle(e);this._pending_messages=[],logger.debug("Created a new session from new pulled doc"),e(this.session)}else this.session.document.replace_with_json(i),logger.debug("Updated existing session with new pulled doc")}catch(n){null==(i=console.trace)||i.call(console,n),logger.error(`Failed to repull session ${n}`),t(n instanceof Error?n:`${n}`)}}_on_open(e,t){logger.info(`Websocket connection ${this._number} is now open`),this._current_handler=i=>{this._awaiting_ack_handler(i,e,t)}}_on_message(e){null==this._current_handler&&logger.error("Got a message with no current handler set");try{this._receiver.consume(e.data)}catch(i){this._close_bad_protocol(`${i}`)}const t=this._receiver.message;if(null!=t){const e=t.problem();null!=e&&this._close_bad_protocol(e),this._current_handler(t)}}_on_close(e,t){logger.info(`Lost websocket ${this._number} connection, ${e.code} (${e.reason})`),this.socket=null,this._pending_replies.forEach((e=>e.reject("Disconnected"))),this._pending_replies.clear(),this.closed_permanently||this._schedule_reconnect(2e3),t(new Error(`Lost websocket connection, ${e.code} (${e.reason})`))}_on_error(e){logger.debug(`Websocket error on socket ${this._number}`);const t="Could not open websocket";logger.error(`Failed to connect to Bokeh server: ${t}`),e(new Error(t))}_close_bad_protocol(e){logger.error(`Closing connection: ${e}`),null!=this.socket&&this.socket.close(1002,e)}_awaiting_ack_handler(e,t,i){"ACK"===e.msgtype()?(this._current_handler=e=>this._steady_state_handler(e),this._repull_session_doc(t,i)):this._close_bad_protocol("First message was not an ACK")}_steady_state_handler(e){const t=e.reqid(),i=this._pending_replies.get(t);i?(this._pending_replies.delete(t),i.resolve(e)):this.session?this.session.handle(e):"PATCH-DOC"!=e.msgtype()&&this._pending_messages.push(e)}}function pull_session(e,t,i){return new ClientConnection(e,t,i).connect()}function _get_ws_url(e,t){let i,n="ws:";return"https:"==window.location.protocol&&(n="wss:"),null!=t?(i=document.createElement("a"),i.href=t):i=window.location,null!=e?"/"==e&&(e=""):e=i.pathname.replace(/\/+$/,""),n+"//"+i.host+e+"/ws"}ClientConnection.__name__="ClientConnection";const _sessions={};function _get_session(e,t,i){const n=parse_token(t).session_id;e in _sessions||(_sessions[e]={});const o=_sessions[e];return n in o||(o[n]=pull_session(e,t,i)),o[n]}async function add_document_from_session(e,t,i,n=[],o=!1){const r=window.location.search.substr(1);let s;try{s=await _get_session(e,t,r)}catch(a){const e=parse_token(t).session_id;throw logger.error(`Failed to load Bokeh session ${e}: ${a}`),a}return add_document_standalone(s.document,i,n,o)}var notebook_css=".rendered_html .bk-root .bk-tooltip table,.rendered_html .bk-root .bk-tooltip tr,.rendered_html .bk-root .bk-tooltip th,.rendered_html .bk-root .bk-tooltip td{border:none;padding:1px;}";stylesheet.append(root_css),stylesheet.append(logo_css),stylesheet.append(notebook_css);const kernels={};function _handle_notebook_comms(e,t){t.buffers.length>0?e.consume(t.buffers[0].buffer):e.consume(t.content.data);const i=e.message;null!=i&&this.apply_json_patch(i.content,i.buffers)}function _init_comms(e,t){if("undefined"!=typeof Jupyter&&null!=Jupyter.notebook.kernel){logger.info(`Registering Jupyter comms for target ${e}`);const n=Jupyter.notebook.kernel.comm_manager;try{n.register_target(e,(i=>{logger.info(`Registering Jupyter comms for target ${e}`);const n=new Receiver;i.on_msg(_handle_notebook_comms.bind(t,n))}))}catch(i){logger.warn(`Jupyter comms failed to register. push_notebook() will not function. (exception reported: ${i})`)}}else if(t.roots()[0].id in kernels){logger.info(`Registering JupyterLab comms for target ${e}`);const n=kernels[t.roots()[0].id];try{n.registerCommTarget(e,(i=>{logger.info(`Registering JupyterLab comms for target ${e}`);const n=new Receiver;i.onMsg=_handle_notebook_comms.bind(t,n)}))}catch(i){logger.warn(`Jupyter comms failed to register. push_notebook() will not function. (exception reported: ${i})`)}}else if("undefined"!=typeof google&&null!=google.colab.kernel){logger.info(`Registering Google Colab comms for target ${e}`);const n=google.colab.kernel.comms;try{n.registerTarget(e,(async i=>{var n;logger.info(`Registering Google Colab comms for target ${e}`);const o=new Receiver;for await(const e of i.messages){const i={data:e.data},r=[];for(const t of null!=(n=e.buffers)?n:[])r.push(new DataView(t));const s={content:i,buffers:r};_handle_notebook_comms.bind(t)(o,s)}}))}catch(i){logger.warn(`Google Colab comms failed to register. push_notebook() will not function. (exception reported: ${i})`)}}else console.warn("Jupyter notebooks comms not available. push_notebook() will not function. If running JupyterLab ensure the latest @bokeh/jupyter_bokeh extension is installed. In an exported notebook this warning is expected.")}function embed_items_notebook(e,t){if(1!=size$1(e))throw new Error("embed_items_notebook expects exactly one document in docs_json");const i=Document.from_json(values(e)[0]);for(const n of t){null!=n.notebook_comms_target&&_init_comms(n.notebook_comms_target,i);add_document_standalone(i,_resolve_element(n),_resolve_root_elements(n))}}async function embed_item(e,t){const i={},n=uuid4();i[n]=e.doc,null==t&&(t=e.target_id);const o=document.getElementById(t);null!=o&&o.classList.add(BOKEH_ROOT);const r={roots:{[e.root_id]:t},root_ids:[e.root_id],docid:n};await defer();const[s]=await _embed_items(i,[r]);return s}async function embed_items(e,t,i,n){return await defer(),_embed_items(e,t,i,n)}async function _embed_items(e,t,i,n){isString(e)&&(e=JSON.parse(unescape(e)));const o={};for(const[a,l]of entries(e))o[a]=Document.from_json(l);const r=[];for(const a of t){const e=_resolve_element(a),t=_resolve_root_elements(a);if(null!=a.docid)r.push(await add_document_standalone(o[a.docid],e,t,a.use_for_title));else{if(null==a.token)throw new Error("Error rendering Bokeh items: either 'docid' or 'token' was expected.");{const o=_get_ws_url(i,n);logger.debug(`embed: computed ws url: ${o}`);try{r.push(await add_document_from_session(o,a.token,e,t,a.use_for_title)),console.log("Bokeh items were rendered successfully")}catch(s){console.log("Error rendering Bokeh items:",s)}}}}return r}var index$1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",embed_item:embed_item,embed_items:embed_items,add_document_standalone:add_document_standalone,index:index$2,add_document_from_session:add_document_from_session,embed_items_notebook:embed_items_notebook,kernels:kernels,BOKEH_ROOT:BOKEH_ROOT}),index=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Message:Message,Receiver:Receiver});const results={};function update_test_div(){const e=document.getElementsByTagName("body")[0],t=document.getElementsByClassName("bokeh-test-div");1==t.length&&(e.removeChild(t[0]),delete t[0]);const i=document.createElement("div");i.classList.add("bokeh-test-div"),i.style.display="none",e.insertBefore(i,e.firstChild)}function init(){update_test_div()}function record0(e,t){results[e]=t}function record(e,t){results[e]=t,update_test_div()}function count(e){null==results[e]&&(results[e]=0),results[e]+=1,update_test_div()}var testing=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",results:results,init:init,record0:record0,record:record,count:count});function _burst_into_flames(e){const t=document.createElement("div");t.style.backgroundColor="#f2dede",t.style.border="1px solid #a94442",t.style.borderRadius="4px",t.style.display="inline-block",t.style.fontFamily="sans-serif",t.style.marginTop="5px",t.style.minWidth="200px",t.style.padding="5px 5px 5px 10px",t.classList.add("bokeh-error-box-into-flames");const i=document.createElement("span");i.style.backgroundColor="#a94442",i.style.borderRadius="0px 4px 0px 0px",i.style.color="white",i.style.cursor="pointer",i.style.cssFloat="right",i.style.fontSize="0.8em",i.style.margin="-6px -6px 0px 0px",i.style.padding="2px 5px 4px 5px",i.title="close",i.setAttribute("aria-label","close"),i.appendChild(document.createTextNode("x")),i.addEventListener("click",(()=>r.removeChild(t)));const n=document.createElement("h3");n.style.color="#a94442",n.style.margin="8px 0px 0px 0px",n.style.padding="0px",n.appendChild(document.createTextNode("Bokeh Error"));const o=document.createElement("pre");o.style.whiteSpace="unset",o.style.overflowX="auto",o.appendChild(document.createTextNode(e)),t.appendChild(i),t.appendChild(n),t.appendChild(o);const r=document.getElementsByTagName("body")[0];r.insertBefore(t,r.firstChild)}function safely(e,t=!1){try{return e()}catch(i){if(_burst_into_flames(i instanceof Error&&i.stack?i.stack:`${i}`),t)return;throw i}}const MAX_INT32=2147483647;class Random{constructor(e){this.seed=e%MAX_INT32,this.seed<=0&&(this.seed+=MAX_INT32-1)}integer(){return this.seed=48271*this.seed%MAX_INT32,this.seed}float(){return(this.integer()-1)/(MAX_INT32-1)}floats(e,t=0,i=1){const n=new Array(e);for(let o=0;o<e;o++)n[o]=t+this.float()*(i-t);return n}choices(e,t){const i=t.length,n=new Array(e);for(let o=0;o<e;o++)n[o]=t[this.integer()%i];return n}}Random.__name__="Random";const random=new Random(Date.now());var linalg=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",keys:keys,values:values,entries:entries,extend:extend$1,clone:clone$1,merge:merge,size:size$1,isEmpty:isEmpty,to_object:to_object,map:map,reduce:reduce,min:min$6,min_by:min_by,max:max$7,max_by:max_by,sum:sum$1,cumsum:cumsum,every:every,some:some,find:find,find_last:find_last,find_index:find_index,find_last_index:find_last_index,sorted_index:sorted_index,is_empty:is_empty,head:head,tail:tail,last:last,copy:copy,concat:concat$1,includes:includes,contains:contains,nth:nth,zip:zip,unzip:unzip,range:range,linspace:linspace,transpose:transpose,argmin:argmin,argmax:argmax,sort_by:sort_by,uniq:uniq,uniq_by:uniq_by,union:union$2,intersection:intersection,difference:difference$1,remove_at:remove_at,remove_by:remove_by,shuffle:shuffle,pairwise:pairwise,reversed:reversed,repeat:repeat,startsWith:startsWith,uuid4:uuid4,uniqueId:uniqueId,escape:escape,unescape:unescape,use_strict:use_strict,to_fixed:to_fixed,Random:Random,random:random,isBoolean:isBoolean,isNumber:isNumber,isInteger:isInteger,isString:isString,isPrimitive:isPrimitive,isFunction:isFunction,isArray:isArray,isArrayOf:isArrayOf,isArrayableOf:isArrayableOf,isTypedArray:isTypedArray,isObject:isObject,isPlainObject:isPlainObject,isIterable:isIterable,isArrayable:isArrayable,equals:equals,wildcard:wildcard,Comparator:Comparator,SimilarComparator:SimilarComparator,is_equal:is_equal,is_similar:is_similar,isEqual:isEqual});const YlGn3=[832787711,2916978431,4160535039],YlGn4=[595870719,2026273279,3269892607,4294954239],YlGn5=[6830079,832787711,2026273279,3269892607,4294954239],YlGn6=[6830079,832787711,2026273279,2916978431,3656426495,4294954239],YlGn7=[5911295,595870719,1101749759,2026273279,2916978431,3656426495,4294954239],YlGn8=[5911295,595870719,1101749759,2026273279,2916978431,3656426495,4160535039,4294960639],YlGn9=[4532735,6830079,595870719,1101749759,2026273279,2916978431,3656426495,4160535039,4294960639],YlGnBu3=[746567935,2144189439,3992498687],YlGnBu4=[576628991,1102497023,2715464959,4294954239],YlGnBu5=[624203007,746567935,1102497023,2715464959,4294954239],YlGnBu6=[624203007,746567935,1102497023,2144189439,3353982207,4294954239],YlGnBu7=[204244223,576628991,496091391,1102497023,2144189439,3353982207,4294954239],YlGnBu8=[204244223,576628991,496091391,1102497023,2144189439,3353982207,3992498687,4294957567],YlGnBu9=[136141055,624203007,576628991,496091391,1102497023,2144189439,3353982207,3992498687,4294957567],GnBu3=[1134742271,2833102335,3774077951],GnBu4=[730644223,2077017343,3135552767,4042909951],GnBu5=[141077759,1134742271,2077017343,3135552767,4042909951],GnBu6=[141077759,1134742271,2077017343,2833102335,3438003711,4042909951],GnBu7=[140025599,730644223,1320408063,2077017343,2833102335,3438003711,4042909951],GnBu8=[140025599,730644223,1320408063,2077017343,2833102335,3438003711,3774077951,4160549119],GnBu9=[138445311,141077759,730644223,1320408063,2077017343,2833102335,3438003711,3774077951,4160549119],BuGn3=[748838911,2581121535,3858102783],BuGn4=[596329983,1724032255,3001213695,3992517631],BuGn5=[7154943,748838911,1724032255,3001213695,3992517631],BuGn6=[7154943,748838911,1724032255,2581121535,3438077695,3992517631],BuGn7=[5776639,596329983,1101952767,1724032255,2581121535,3438077695,3992517631],BuGn8=[5776639,596329983,1101952767,1724032255,2581121535,3438077695,3858102783,4160552447],BuGn9=[4463615,7154943,596329983,1101952767,1724032255,2581121535,3438077695,3858102783,4160552447],PuBuGn3=[479238655,2797460479,3974295807],PuBuGn4=[42044159,1739182079,3184124415,4142921727],PuBuGn5=[23878143,479238655,1739182079,3184124415,4142921727],PuBuGn6=[23878143,479238655,1739182079,2797460479,3503417087,4142921727],PuBuGn7=[23351551,42044159,915456255,1739182079,2797460479,3503417087,4142921727],PuBuGn8=[23351551,42044159,915456255,1739182079,2797460479,3503417087,3974295807,4294441983],PuBuGn9=[21378815,23878143,42044159,915456255,1739182079,2797460479,3503417087,3974295807,4294441983],PuBu3=[730644223,2797460479,3974623999],PuBu4=[91271423,1957285887,3184124415,4058969855],PuBu5=[73043455,730644223,1957285887,3184124415,4058969855],PuBu6=[73043455,730644223,1957285887,2797460479,3503417087,4058969855],PuBu7=[55475199,91271423,915456255,1957285887,2797460479,3503417087,4058969855],PuBu8=[55475199,91271423,915456255,1957285887,2797460479,3503417087,3974623999,4294441983],PuBu9=[37247231,73043455,91271423,915456255,1957285887,2797460479,3503417087,3974623999,4294441983],BuPu3=[2287380479,2663176959,3773625599],BuPu4=[2286001663,2358691583,3016614911,3992517631],BuPu5=[2165275903,2287380479,2358691583,3016614911,3992517631],BuPu6=[2165275903,2287380479,2358691583,2663176959,3218335487,3992517631],BuPu7=[1845586943,2286001663,2355868159,2358691583,2663176959,3218335487,3992517631],BuPu8=[1845586943,2286001663,2355868159,2358691583,2663176959,3218335487,3773625599,4160552447],BuPu9=[1291865087,2165275903,2286001663,2355868159,2358691583,2663176959,3218335487,3773625599,4160552447],RdPu3=[3306916607,4204770815,4259372543],RdPu4=[2919333631,4150829567,4222925311,4276871935],RdPu5=[2046916607,3306916607,4150829567,4222925311,4276871935],RdPu6=[2046916607,3306916607,4150829567,4204770815,4240818431,4276871935],RdPu7=[2046916607,2919333631,3711211519,4150829567,4204770815,4240818431,4276871935],RdPu8=[2046916607,2919333631,3711211519,4150829567,4204770815,4240818431,4259372543,4294439935],RdPu9=[1224764159,2046916607,2919333631,3711211519,4150829567,4204770815,4240818431,4259372543,4294439935],PuRd3=[3709630463,3381970943,3890343935],PuRd4=[3457308415,3747983615,3619019007,4058969855],PuRd5=[2550154239,3709630463,3747983615,3619019007,4058969855],PuRd6=[2550154239,3709630463,3747983615,3381970943,3568950015,4058969855],PuRd7=[2432712703,3457308415,3878259455,3747983615,3381970943,3568950015,4058969855],PuRd8=[2432712703,3457308415,3878259455,3747983615,3381970943,3568950015,3890343935,4160027135],PuRd9=[1728061439,2550154239,3457308415,3878259455,3747983615,3381970943,3568950015,3890343935,4160027135],OrRd3=[3813291007,4256924927,4276668671],OrRd4=[3610255359,4237122047,4258040575,4277197311],OrRd5=[3003121919,3813291007,4237122047,4258040575,4277197311],OrRd6=[3003121919,3813291007,4237122047,4256924927,4258569983,4277197311],OrRd7=[2566914303,3610255359,4016392447,4237122047,4256924927,4258569983,4277197311],OrRd8=[2566914303,3610255359,4016392447,4237122047,4256924927,4258569983,4276668671,4294438143],OrRd9=[2130706687,3003121919,3610255359,4016392447,4237122047,4256924927,4258569983,4276668671,4294438143],YlOrRd3=[4030406911,4273097983,4293763327],YlOrRd4=[3810139391,4253891839,4274806015,4294947583],YlOrRd5=[3170903807,4030406911,4253891839,4274806015,4294947583],YlOrRd6=[3170903807,4030406911,4253891839,4273097983,4275664639,4294947583],YlOrRd7=[2969577215,3810139391,4232981247,4253891839,4273097983,4275664639,4294947583],YlOrRd8=[2969577215,3810139391,4232981247,4253891839,4273097983,4275664639,4293763327,4294954239],YlOrRd9=[2147493631,3170903807,3810139391,4232981247,4253891839,4273097983,4275664639,4293763327,4294954239],YlOrBr3=[3646885631,4274278399,4294425855],YlOrBr4=[3427533567,4271450623,4275670783,4294956287],YlOrBr5=[2570323199,3646885631,4271450623,4275670783,4294956287],YlOrBr6=[2570323199,3646885631,4271450623,4274278399,4276326911,4294956287],YlOrBr7=[2351760639,3427533567,3966768383,4271450623,4274278399,4276326911,4294956287],YlOrBr8=[2351760639,3427533567,3966768383,4271450623,4274278399,4276326911,4294425855,4294960639],YlOrBr9=[1713702655,2570323199,3427533567,3966768383,4271450623,4274278399,4276326911,4294425855,4294960639],Purples3=[1969992191,3166559487,4025349631],Purples4=[1783735295,2660944127,3419005695,4075878399],Purples5=[1411878911,1969992191,2660944127,3419005695,4075878399],Purples6=[1411878911,1969992191,2660944127,3166559487,3671780351,4075878399],Purples7=[1242859263,1783735295,2155723519,2660944127,3166559487,3671780351,4075878399],Purples8=[1242859263,1783735295,2155723519,2660944127,3166559487,3671780351,4025349631,4244372991],Purples9=[1056996863,1411878911,1783735295,2155723519,2660944127,3166559487,3671780351,4025349631,4244372991],Blues3=[830651903,2664096255,3740006399],Blues4=[561100287,1806620415,3185043455,4025745407],Blues5=[139566335,830651903,1806620415,3185043455,4025745407],Blues6=[139566335,830651903,1806620415,2664096255,3336302591,4025745407],Blues7=[138777855,561100287,1116915455,1806620415,2664096255,3336302591,4025745407],Blues8=[138777855,561100287,1116915455,1806620415,2664096255,3336302591,3740006399,4160487423],Blues9=[137391103,139566335,561100287,1116915455,1806620415,2664096255,3336302591,3740006399,4160487423],Greens3=[832787711,2715393023,3858096383],Greens4=[596329983,1959032575,3135550463,3992513023],Greens5=[7154943,832787711,1959032575,3135550463,3992513023],Greens6=[7154943,832787711,1959032575,2715393023,3353985279,3992513023],Greens7=[5911295,596329983,1101749759,1959032575,2715393023,3353985279,3992513023],Greens8=[5911295,596329983,1101749759,1959032575,2715393023,3353985279,3858096383,4160550399],Greens9=[4463615,7154943,596329983,1101749759,1959032575,2715393023,3353985279,3858096383,4160550399],Oranges3=[3864333823,4256066559,4276539135],Oranges4=[3645309439,4253891839,4257121791,4277001983],Oranges5=[2788557823,3864333823,4253891839,4257121791,4277001983],Oranges6=[2788557823,3864333823,4253891839,4256066559,4258308863,4277001983],Oranges7=[2351760639,3645374975,4050195455,4253891839,4256066559,4258308863,4277001983],Oranges8=[2351760639,3645374975,4050195455,4253891839,4256066559,4258308863,4276539135,4294306815],Oranges9=[2133263615,2788557823,3645374975,4050195455,4253891839,4256066559,4258308863,4276539135,4294306815],Reds3=[3727501055,4237456127,4276146943],Reds4=[3407355391,4218047231,4239299071,4276476415],Reds5=[2769229311,3727501055,4218047231,4239299071,4276476415],Reds6=[2769229311,3727501055,4218047231,4237456127,4240155135,4276476415],Reds7=[2566917631,3407355391,4013632767,4218047231,4237456127,4240155135,4276476415],Reds8=[2566917631,3407355391,4013632767,4218047231,4237456127,4240155135,4276146943,4294308095],Reds9=[1728056831,2769229311,3407355391,4013632767,4218047231,4237456127,4240155135,4276146943,4294308095],Greys3=[1667458047,3183328767,4042322175],Greys4=[1381126911,2526451455,3435973887,4160223231],Greys5=[623191551,1667458047,2526451455,3435973887,4160223231],Greys6=[623191551,1667458047,2526451455,3183328767,3654932991,4160223231],Greys7=[623191551,1381126911,1936946175,2526451455,3183328767,3654932991,4160223231],Greys8=[623191551,1381126911,1936946175,2526451455,3183328767,3654932991,4042322175,4294967295],Greys9=[255,623191551,1381126911,1936946175,2526451455,3183328767,3654932991,4042322175,4294967295],Greys10=[255,471604479,943208703,1431655935,1903260159,2374864383,2863311615,3334915839,3806520063,4294967295],Greys11=[255,421075455,858993663,1280068863,1717987071,2139062271,2576980479,2998055679,3435973887,3857049087,4294967295],Greys256=[255,16843263,33686271,50529279,67372287,84215295,101058303,117901311,134744319,151587327,168430335,185273343,202116351,218959359,235802367,252645375,269488383,286331391,303174399,320017407,336860415,353703423,370546431,387389439,404232447,421075455,437918463,454761471,471604479,488447487,505290495,522133503,538976511,555819519,572662527,589505535,606348543,623191551,640034559,656877567,673720575,690563583,707406591,724249599,741092607,757935615,774778623,791621631,808464639,825307647,842150655,858993663,875836671,892679679,909522687,926365695,943208703,960051711,976894719,993737727,1010580735,1027423743,1044266751,1061109759,1077952767,1094795775,1111638783,1128481791,1145324799,1162167807,1179010815,1195853823,1212696831,1229539839,1246382847,1263225855,1280068863,1296911871,1313754879,1330597887,1347440895,1364283903,1381126911,1397969919,1414812927,1431655935,1448498943,1465341951,1482184959,1499027967,1515870975,1532713983,1549556991,1566399999,1583243007,1600086015,1616929023,1633772031,1650615039,1667458047,1684301055,1701144063,1717987071,1734830079,1751673087,1768516095,1785359103,1802202111,1819045119,1835888127,1852731135,1869574143,1886417151,1903260159,1920103167,1936946175,1953789183,1970632191,1987475199,2004318207,2021161215,2038004223,2054847231,2071690239,2088533247,2105376255,2122219263,2139062271,2155905279,2172748287,2189591295,2206434303,2223277311,2240120319,2256963327,2273806335,2290649343,2307492351,2324335359,2341178367,2358021375,2374864383,2391707391,2408550399,2425393407,2442236415,2459079423,2475922431,2492765439,2509608447,2526451455,2543294463,2560137471,2576980479,2593823487,2610666495,2627509503,2644352511,2661195519,2678038527,2694881535,2711724543,2728567551,2745410559,2762253567,2779096575,2795939583,2812782591,2829625599,2846468607,2863311615,2880154623,2896997631,2913840639,2930683647,2947526655,2964369663,2981212671,2998055679,3014898687,3031741695,3048584703,3065427711,3082270719,3099113727,3115956735,3132799743,3149642751,3166485759,3183328767,3200171775,3217014783,3233857791,3250700799,3267543807,3284386815,3301229823,3318072831,3334915839,3351758847,3368601855,3385444863,3402287871,3419130879,3435973887,3452816895,3469659903,3486502911,3503345919,3520188927,3537031935,3553874943,3570717951,3587560959,3604403967,3621246975,3638089983,3654932991,3671775999,3688619007,3705462015,3722305023,3739148031,3755991039,3772834047,3789677055,3806520063,3823363071,3840206079,3857049087,3873892095,3890735103,3907578111,3924421119,3941264127,3958107135,3974950143,3991793151,4008636159,4025479167,4042322175,4059165183,4076008191,4092851199,4109694207,4126537215,4143380223,4160223231,4177066239,4193909247,4210752255,4227595263,4244438271,4261281279,4278124287,4294967295],PuOr3=[2576270335,4160223231,4054008063],PuOr4=[1581029887,2997605119,4256719871,3865117183],PuOr5=[1581029887,2997605119,4160223231,4256719871,3865117183],PuOr6=[1411877119,2576270335,3638225919,4276139775,4054008063,3008890623],PuOr7=[1411877119,2576270335,3638225919,4160223231,4276139775,4054008063,3008890623],PuOr8=[1411877119,2155064575,2997605119,3638225919,4276139775,4256719871,3766621439,3008890623],PuOr9=[1411877119,2155064575,2997605119,3638225919,4160223231,4276139775,4256719871,3766621439,3008890623],PuOr10=[754994175,1411877119,2155064575,2997605119,3638225919,4276139775,4256719871,3766621439,3008890623,2134575359],PuOr11=[754994175,1411877119,2155064575,2997605119,3638225919,4160223231,4276139775,4256719871,3766621439,3008890623,2134575359],BrBG3=[1521790207,4126537215,3635635711],BrBG4=[25522687,2160968191,3754065407,2791381759],BrBG5=[25522687,2160968191,4126537215,3754065407,2791381759],BrBG6=[23486207,1521790207,3354060287,4142449663,3635635711,2354121471],BrBG7=[23486207,1521790207,3354060287,4126537215,4142449663,3635635711,2354121471],BrBG8=[23486207,899125247,2160968191,3354060287,4142449663,3754065407,3212914175,2354121471],BrBG9=[23486207,899125247,2160968191,3354060287,4126537215,4142449663,3754065407,3212914175,2354121471],BrBG10=[3944703,23486207,899125247,2160968191,3354060287,4142449663,3754065407,3212914175,2354121471,1412433407],BrBG11=[3944703,23486207,899125247,2160968191,3354060287,4126537215,4142449663,3754065407,3212914175,2354121471,1412433407],PRGn3=[2143255551,4160223231,2945303551],PRGn4=[8927231,2799411455,3265646591,2066912511],PRGn5=[8927231,2799411455,4160223231,3265646591,2066912511],PRGn6=[460863487,2143255551,3656438783,3889490175,2945303551,1982497791],PRGn7=[460863487,2143255551,3656438783,4160223231,3889490175,2945303551,1982497791],PRGn8=[460863487,1521377791,2799411455,3656438783,3889490175,3265646591,2574298111,1982497791],PRGn9=[460863487,1521377791,2799411455,3656438783,4160223231,3889490175,3265646591,2574298111,1982497791],PRGn10=[4463615,460863487,1521377791,2799411455,3656438783,3889490175,3265646591,2574298111,1982497791,1073761279],PRGn11=[4463615,460863487,1521377791,2799411455,3656438783,4160223231,3889490175,3265646591,2574298111,1982497791,1073761279],PiYG3=[2715249407,4160223231,3919825407],PiYG4=[1303127807,3101787903,4055292671,3491531775],PiYG5=[1303127807,3101787903,4160223231,4055292671,3491531775],PiYG6=[1301422591,2715249407,3874869503,4259377151,3919825407,3306913279],PiYG7=[1301422591,2715249407,3874869503,4160223231,4259377151,3919825407,3306913279],PiYG8=[1301422591,2143044095,3101787903,3874869503,4259377151,4055292671,3732385535,3306913279],PiYG9=[1301422591,2143044095,3101787903,3874869503,4160223231,4259377151,4055292671,3732385535,3306913279],PiYG10=[660871679,1301422591,2143044095,3101787903,3874869503,4259377151,4055292671,3732385535,3306913279,2382451455],PiYG11=[660871679,1301422591,2143044095,3101787903,3874869503,4160223231,4259377151,4055292671,3732385535,3306913279,2382451455],RdBu3=[1739182079,4160223231,4018823935],RdBu4=[91336959,2462441215,4104487679,3389006079],RdBu5=[91336959,2462441215,4160223231,4104487679,3389006079],RdBu6=[560377087,1739182079,3521507583,4259039231,4018823935,2987928575],RdBu7=[560377087,1739182079,3521507583,4160223231,4259039231,4018823935,2987928575],RdBu8=[560377087,1133757439,2462441215,3521507583,4259039231,4104487679,3596635647,2987928575],RdBu9=[560377087,1133757439,2462441215,3521507583,4160223231,4259039231,4104487679,3596635647,2987928575],RdBu10=[87056895,560377087,1133757439,2462441215,3521507583,4259039231,4104487679,3596635647,2987928575,1728061439],RdBu11=[87056895,560377087,1133757439,2462441215,3521507583,4160223231,4259039231,4104487679,3596635647,2987928575,1728061439],RdGy3=[2576980479,4294967295,4018823935],RdGy4=[1077952767,3132799743,4104487679,3389006079],RdGy5=[1077952767,3132799743,4294967295,4104487679,3389006079],RdGy6=[1296911871,2576980479,3772834047,4259039231,4018823935,2987928575],RdGy7=[1296911871,2576980479,3772834047,4294967295,4259039231,4018823935,2987928575],RdGy8=[1296911871,2273806335,3132799743,3772834047,4259039231,4104487679,3596635647,2987928575],RdGy9=[1296911871,2273806335,3132799743,3772834047,4294967295,4259039231,4104487679,3596635647,2987928575],RdGy10=[437918463,1296911871,2273806335,3132799743,3772834047,4259039231,4104487679,3596635647,2987928575,1728061439],RdGy11=[437918463,1296911871,2273806335,3132799743,3772834047,4294967295,4259039231,4104487679,3596635647,2987928575,1728061439],RdYlBu3=[2445270015,4294950911,4237122047],RdYlBu4=[746305279,2883185151,4256063999,3608747263],RdYlBu5=[746305279,2883185151,4294950911,4256063999,3608747263],RdYlBu6=[1165341951,2445270015,3774085375,4276130047,4237122047,3610257407],RdYlBu7=[1165341951,2445270015,3774085375,4294950911,4276130047,4237122047,3610257407],RdYlBu8=[1165341951,1957548543,2883185151,3774085375,4276130047,4256063999,4100801535,3610257407],RdYlBu9=[1165341951,1957548543,2883185151,3774085375,4294950911,4276130047,4256063999,4100801535,3610257407],RdYlBu10=[825660927,1165341951,1957548543,2883185151,3774085375,4276130047,4256063999,4100801535,3610257407,2768250623],RdYlBu11=[825660927,1165341951,1957548543,2883185151,3774085375,4294950911,4276130047,4256063999,4100801535,3610257407,2768250623],Spectral3=[2580911359,4294950911,4237122047],Spectral4=[730053375,2883429631,4256063999,3608747263],Spectral5=[730053375,2883429631,4294950911,4256063999,3608747263],Spectral6=[847822335,2580911359,3874855167,4276128767,4237122047,3577630719],Spectral7=[847822335,2580911359,3874855167,4294950911,4276128767,4237122047,3577630719],Spectral8=[847822335,1724032511,2883429631,3874855167,4276128767,4256063999,4100801535,3577630719],Spectral9=[847822335,1724032511,2883429631,3874855167,4294950911,4276128767,4256063999,4100801535,3577630719],Spectral10=[1582277375,847822335,1724032511,2883429631,3874855167,4276128767,4256063999,4100801535,3577630719,2650882815],Spectral11=[1582277375,847822335,1724032511,2883429631,3874855167,4294950911,4276128767,4256063999,4100801535,3577630719,2650882815],RdYlGn3=[2446287103,4294950911,4237122047],RdYlGn4=[446054911,2799266559,4256063999,3608747263],RdYlGn5=[446054911,2799266559,4294950911,4256063999,3608747263],RdYlGn6=[446189823,2446287103,3656354815,4276128767,4237122047,3610257407],RdYlGn7=[446189823,2446287103,3656354815,4294950911,4276128767,4237122047,3610257407],RdYlGn8=[446189823,1723687935,2799266559,3656354815,4276128767,4256063999,4100801535,3610257407],RdYlGn9=[446189823,1723687935,2799266559,3656354815,4294950911,4276128767,4256063999,4100801535,3610257407],RdYlGn10=[6830079,446189823,1723687935,2799266559,3656354815,4276128767,4256063999,4100801535,3610257407,2768250623],RdYlGn11=[6830079,446189823,1723687935,2799266559,3656354815,4294950911,4276128767,4256063999,4100801535,3610257407,2768250623],Inferno3=[1023,3124123135,4244546815],Inferno4=[1023,2015129087,3983025663,4244546815],Inferno5=[1023,1427074559,3124123135,4186704383,4244546815],Inferno6=[1023,1091135487,2468702207,3696245247,4221831935,4244546815],Inferno7=[1023,839474687,2015129087,3124123135,3983025663,4222818559,4244546815],Inferno8=[1023,655053567,1662283519,2653512703,3527885567,4118550015,4206831103,4244546815],Inferno9=[1023,520898559,1427074559,2283891455,3124123135,3814208255,4186704383,4173935103,4244546815],Inferno10=[1023,436945151,1242262271,2015129087,2754371839,3443673087,3983025663,4221110015,4157553407,4244546815],Inferno11=[1023,369834495,1091135487,1779920639,2468702207,3124123135,3696245247,4067760895,4221831935,4141171455,4244546815],Inferno256=[1023,1279,1791,16779263,16845311,16845823,33623807,33689855,50467583,67310847,67311359,84154623,100932607,117775871,134619135,151396863,168240127,185018111,218638591,235416319,252259839,269037567,302658303,319436031,336279295,369834495,386612223,420167423,436945151,470565887,487343615,520898559,537676543,571165951,604720895,638275839,655053567,688608511,722097919,755652863,772430591,805985535,839474687,873029631,889807103,923361791,956916479,990471423,1007248895,1040803583,1074358015,1091135487,1124755711,1158310399,1175087615,1208707839,1242262271,1259105279,1292659711,1326279935,1343057151,1376677119,1393454591,1427074559,1460628991,1477471743,1511091711,1527869183,1561489151,1595043583,1611886335,1645506303,1662283519,1695903487,1712680703,1746300671,1779920639,1796697855,1830317823,1847095039,1880715007,1914269183,1931111935,1964731903,1981509119,2015129087,2048683519,2065526015,2099080447,2115923199,2149542911,2166320127,2199940095,2233494271,2250337023,2283891455,2300733951,2334288383,2367908351,2384750847,2418305279,2435147775,2468702207,2502321919,2519099135,2552718847,2569561343,2603115775,2619958271,2653512703,2687132415,2703974911,2737529343,2754371839,2787926015,2804768767,2838388479,2871942655,2888785151,2922404863,2939247615,2972801791,2989644287,3023263999,3040040959,3073660671,3090503423,3124123135,3140965631,3174519807,3191362303,3208204799,3241824511,3258667007,3292286719,3309129215,3342748927,3359525887,3376368383,3409988095,3426830591,3443673087,3477358335,3494200575,3511043071,3527885567,3561505279,3578347775,3595190271,3612032767,3645718015,3662560255,3679402751,3696245247,3713153279,3729995775,3746838271,3763746047,3797365759,3814208255,3831116287,3847958783,3864801023,3864931839,3881774335,3898682367,3915524863,3932432639,3949275135,3966183167,3983025663,3983156223,4000064255,4016906751,4033814527,4033879807,4050787839,4067695871,4067760895,4084668927,4084799743,4101641983,4118550015,4118680831,4135588607,4135653887,4152561919,4152692479,4169600511,4169665791,4169796607,4186704383,4186835199,4186966271,4203808767,4203939583,4204070655,4204201727,4221110015,4221241087,4221372159,4221437951,4221569023,4221700351,4221831935,4221963263,4222094847,4222226175,4222357759,4222489343,4222620927,4222686975,4222818559,4222950143,4223081727,4223213311,4206567935,4206699519,4206831103,4206962943,4190317311,4190448895,4190580735,4173935103,4174066943,4174198783,4157553407,4157684991,4141039615,4141171455,4124526079,4124657919,4108012543,4108079103,4091433727,4091565823,4091697663,4075052543,4075184383,4058539263,4058605823,4058737919,4058870015,4058936575,4059068927,4059201023,4076044799,4076111359,4093020671,4109864447,4126708223,4143617535,4160461311,4194082303,4210925823,4244546815],Magma3=[1023,3040246271,4227645439],Magma4=[1023,1897890303,4032847359,4227645439],Magma5=[1023,1326545919,3040246271,4219887871,4227645439],Magma6=[1023,990867455,2351530239,3712575743,4255083775,4227645439],Magma7=[1023,722558719,1897890303,3040246271,4032847359,4272846591,4227645439],Magma8=[1023,571560191,1561820927,2536275967,3510791935,4168441087,4273569791,4227645439],Magma9=[1023,454051071,1326545919,2166718975,3040246271,3847250943,4219887871,4274161407,4227645439],Magma10=[1023,386874623,1125086719,1897890303,2653847295,3409867263,4032847359,4237518591,4274490367,4227645439],Magma11=[1023,336410111,990867455,1662615551,2351530239,3040246271,3712575743,4134427647,4255083775,4258107647,4227645439],Magma256=[1023,1279,1791,16779263,16845311,16845823,33689087,33689599,50532863,67310591,67376639,84154367,100997631,117775359,134618623,151461887,168239871,185083135,201926399,218769663,235547391,252390655,269234175,286011903,302855167,336410111,353253631,370031359,386874623,403652607,437273087,454051071,470828799,504383999,521227263,538004991,571560191,588337919,621893119,638670847,672225791,705780991,722558719,756048127,789603071,806381055,839935999,873490687,890202879,923757823,957312767,990867455,1007645183,1041199871,1074754559,1108309247,1125086719,1158641407,1192196095,1209039103,1242593791,1259371007,1292991231,1326545919,1343388671,1376943359,1393786111,1427340799,1460960767,1477803775,1511358207,1528200959,1561820927,1578598399,1612218367,1628995583,1662615551,1696235775,1713012991,1746632959,1763475711,1797030143,1813872895,1847493119,1864270335,1897890303,1931444735,1948287487,1981907455,1998684671,2032304639,2049081855,2082701823,2116321791,2133099007,2166718975,2183496191,2217116159,2233893375,2267513343,2301133311,2317910527,2351530239,2368307455,2401927423,2435481855,2452324607,2485879039,2502721791,2536275967,2569895935,2586673151,2620293119,2653847295,2670690047,2704244479,2737864447,2754641407,2788261375,2805038591,2838658303,2872278271,2889055231,2922675199,2956229631,2973072127,3006626559,3040246271,3057023487,3090643199,3107420415,3141040127,3174660095,3191437055,3225056767,3258611199,3275453695,3309073663,3325850623,3359470335,3393090303,3409867263,3443486975,3460329727,3493949439,3510791935,3544346111,3561188863,3594808575,3611651071,3645270783,3662113279,3695733247,3712575743,3729418239,3763037951,3779880703,3796723199,3830342911,3847250943,3864093439,3880936191,3897844223,3931463935,3948306687,3965214719,3982057471,3998965503,3999096319,4015939071,4032847359,4049689855,4066598143,4083506431,4083637247,4100479999,4117388287,4117519359,4134427647,4134558719,4151401471,4151532799,4168441087,4168572159,4185480447,4185611775,4185742847,4202651391,4202716927,4202848255,4219756799,4219887871,4220019199,4220150527,4237059071,4237190143,4237321471,4237452799,4237518591,4254427135,4254558463,4254689791,4254821119,4254952447,4255083775,4255215359,4255281151,4255412479,4272321023,4272452607,4272583935,4272715263,4272846591,4272912639,4273043967,4273175551,4273306879,4273438207,4273569791,4273701119,4273767167,4273898495,4274030079,4274161407,4274292991,4274424319,4274490367,4274621951,4274753279,4258107647,4258239231,4258370559,4258436607,4258568191,4258699519,4258831103,4258962687,4259094015,4259160063,4259291647,4259423231,4242777599,4242908927,4242974975,4243106559,4243238143,4243369727,4243501311,4243632639,4243698687,4243830271,4243961855,4227316223,4227447807,4227513855,4227645439],Plasma3=[201819903,3393616127,4026016255],Plasma4=[201819903,2602016511,3967308799,4026016255],Plasma5=[201819903,2080548863,3393616127,4153623039,4026016255],Plasma6=[201819903,1778427903,2955579391,3764675071,4238751231,4026016255],Plasma7=[201819903,1543546367,2602016511,3393616127,3967308799,4256313343,4026016255],Plasma8=[201819903,1375839231,2299045375,3090319871,3663358207,4085729535,4256902143,4026016255],Plasma9=[201819903,1241686271,2080548863,2820839167,3393616127,3849018623,4153623039,4257425663,4026016255],Plasma10=[201819903,1157865215,1912645887,2602016511,3157689855,3612765439,3967308799,4204608255,4240910079,4026016255],Plasma11=[201819903,1073978623,1778427903,2400035839,2955579391,3393616127,3764675071,4051848447,4238751231,4241237503,4026016255],Plasma256=[201819903,268929023,319195647,352750335,403082239,453414143,486968831,520457983,554012671,587567359,621122047,654676735,688231423,721786111,755275007,788829695,822384383,855939071,872716543,906270975,939825663,973380351,990092031,1023646719,1057201407,1073978623,1107533311,1141087999,1157865215,1191354367,1224908799,1241686271,1275240959,1308795391,1325572863,1359061759,1375839231,1409393663,1442948095,1459725567,1493279999,1509991935,1543546367,1577100799,1593878271,1627432703,1644209919,1677764607,1694541823,1728096255,1744873471,1778427903,1811982591,1828759807,1862314239,1879091455,1912645887,1929423103,1962977535,1979820287,2013374719,2030151935,2063771903,2080548863,2114168831,2130946047,2164566015,2181343231,2214962943,2231805695,2248648447,2282202623,2299045375,2332665087,2349507839,2383193343,2400035839,2416878591,2450498303,2467340799,2500960767,2517803263,2534646015,2568265727,2585108223,2602016511,2635636223,2652478719,2669321215,2686163967,2719783679,2736626175,2753468671,2770311167,2803996671,2820839167,2837681663,2854524159,2888143871,2904986367,2921828863,2938671359,2955579391,2972422143,2989264639,3022884351,3039726847,3056569343,3073411839,3090319871,3107162367,3124004863,3140847359,3157689855,3174532351,3191374847,3208217343,3225125375,3241967871,3258810623,3275653119,3292495615,3309338111,3326180607,3343023103,3359931135,3376773631,3393616127,3410458623,3427301119,3444143615,3460986367,3477828863,3494736895,3511579391,3511644671,3528487167,3545329663,3562172159,3579014655,3595922943,3612765439,3612830719,3629673215,3646515711,3663358207,3680200703,3697108735,3697174271,3714016767,3730859263,3747701759,3747767039,3764675071,3781517567,3798360319,3815202815,3815268095,3832176127,3849018623,3849083903,3865926399,3882769151,3899677183,3899742463,3916584959,3933427455,3933492735,3950400767,3967243519,3967308799,3984151295,3984282111,4001124607,4017967103,4018032383,4034940415,4035005951,4051848447,4068756479,4068821759,4085664255,4085729535,4102637567,4102703103,4119545599,4119676415,4136518911,4136584191,4136715007,4153557503,4153623039,4170531071,4170596351,4170727167,4187569663,4187634943,4204542975,4204608255,4204739327,4204804607,4221712639,4221777919,4221843199,4238751231,4238816767,4238947583,4239012863,4239143679,4239208959,4256117247,4256182527,4256313343,4256378623,4256509439,4256574975,4256705791,4256771071,4256902143,4256967423,4257098239,4257229311,4257294591,4257425663,4257490943,4257621759,4240910079,4241041151,4241171967,4241237503,4241368575,4224722175,4224787711,4224918783,4208272639,4208338175,4208469247,4191757567,4191888639,4175242495,4175373567,4158661887,4158793215,4142147071,4142212607,4125566719,4125697791,4108986111,4092339967,4092471039,4075824895,4075890431,4059244287,4042597887,4042662911,4026016255],Viridis3=[1140937983,546278655,4259783935],Viridis4=[1140937983,812092927,901216511,4259783935],Viridis5=[1140937983,995199743,546278655,1539859199,4259783935],Viridis6=[1140937983,1078167551,695766783,581403903,2043761151,4259783935],Viridis7=[1140937983,1144619775,812092927,546278655,901216511,2379629823,4259783935],Viridis8=[1140937983,1177648895,911903999,662605567,513837055,1237413375,2648259327,4259783935],Viridis9=[1140937983,1194031871,995199743,745639679,546278655,665682175,1539859199,2866492159,4259783935],Viridis10=[1140937983,1193768959,1045006847,812092927,629313279,513575423,901216511,1808620031,3000839423,4259783935],Viridis11=[1140937983,1210283263,1078167551,878611967,695766783,546278655,581403903,1119777279,2043761151,3135121407,4259783935],Viridis256=[1140937983,1141003775,1141069823,1157978367,1158044415,1158175743,1175018751,1175150335,1175216127,1175347711,1192190719,1192322047,1192388095,1192519423,1192585215,1192651263,1192782591,1209625599,1209691391,1209822975,1209888767,1209954559,1210085887,1210151679,1210217471,1210283263,1193637375,1193703167,1193768959,1193834751,1193966079,1194031871,1194097663,1177386239,1177517311,1177583103,1177648895,1160937471,1161068543,1161134335,1161200127,1144488447,1144619775,1127908351,1127973887,1128039679,1111327999,1111393791,1111524863,1094813439,1094878975,1078167551,1078233087,1061521407,1061652735,1044941055,1045006847,1028295167,1028360703,1028426239,1011714815,1011780351,995134207,995199743,978488319,978553855,961842175,961907711,945196031,945261823,928550143,928615679,911903999,911969535,895257855,895323391,878611967,878677503,861965823,862031359,845319679,845385215,828673535,828739071,828804607,812092927,812158463,795446783,795512319,778800895,778866431,778931967,762220287,762285823,745574143,745639679,745705215,728993535,729059071,712347391,712412927,712478463,695766783,695832319,679120639,679120639,679186175,662474495,662540031,662605567,645893887,645959423,646024959,629313279,629378559,612666879,612732415,612797951,596086271,596151807,596217343,579440127,579505663,579571199,562859519,562924799,562990335,546278655,546344191,546409727,529698047,529763327,529828863,529894399,529959935,513247999,513313535,513379071,513379071,513444351,513509887,513575423,513640703,513706239,513771775,513837055,530679807,530745087,530810623,547653119,547718655,564561407,564626687,581403903,598246399,598311679,615154431,631996927,648839679,665682175,682524671,699367423,716209919,733052415,749829631,783449343,800291839,817134335,850754303,867596799,901216511,918059007,951678719,968455935,1002075647,1035695359,1052537855,1086157567,1119777279,1153331455,1170173951,1203793663,1237413375,1271033087,1304587263,1338206719,1371826431,1405446143,1439065855,1472620031,1506239743,1539859199,1590256127,1623810303,1657430015,1691049471,1741446399,1775000575,1808620031,1842239743,1892570879,1926190591,1959810303,2010141439,2043761151,2094157823,2127711999,2178108671,2211662847,2262059519,2295678975,2346010367,2379629823,2429961215,2463580671,2513911807,2547531519,2597862655,2648259327,2681813247,2732210175,2782541311,2816160767,2866492159,2916888831,2950442751,3000839423,3051170815,3084724735,3135121407,3185452799,3219072255,3269403391,3319734783,3353354239,3403685631,3454017023,3487636735,3537968127,3571522303,3621919231,3672250623,3705805055,3756202239,3789756671,3840088319,3890485759,3924040191,3974372095,4007992319,4058324223,4091879167,4142276607,4175831551,4209386239,4259783935],Cividis3=[2116863,2071689471,16771397],Cividis4=[2116863,1448897791,2795271679,16771397],Cividis5=[2116863,1078750207,2071689471,3165548287,16771397],Cividis6=[2116863,826567679,1718120703,2509207807,3401148927,16771397],Cividis7=[2116863,574450943,1448897791,2071689471,2795271679,3552601599,16771397],Cividis8=[2116863,356085247,1230203903,1819112191,2374531327,2997252863,3653657087,16771397],Cividis9=[2116863,20279039,1078750207,1600351999,2071689471,2610132991,3165548287,3754647039,16771397],Cividis10=[2116863,3370751,927427583,1448897791,1869640703,2307225855,2795271679,3283381503,3821886463,16771397],Cividis11=[2116863,3239935,826567679,1297443839,1718120703,2071689471,2509207807,2929947647,3401148927,3872414207,16771397],Cividis256=[2116863,2117375,2183423,2249215,2315263,2315775,2381567,2447615,2513663,2513919,2579967,2646015,2646527,2712575,2778367,2778879,2844927,2910975,2977023,2977279,3043071,3043327,3108863,3108863,3174399,3239935,3239935,3305215,3370751,3436287,3436287,20279039,104230655,171404799,238513663,305688063,356085247,389639679,440036607,473656575,507276543,540830975,574450943,608070911,641625343,658468095,692087807,725707775,742484991,776104959,792947711,826567679,843344895,860187647,893807615,910584831,927427583,944270335,977890303,994667519,1011510271,1028353023,1045130239,1078750207,1095592959,1112435711,1129212927,1146055679,1162898431,1179675647,1196518399,1213361151,1230203903,1246981119,1263823871,1280666623,1297443839,1314286591,1331129599,1347972351,1364749567,1381592319,1398435071,1415212287,1432055039,1448897791,1465740799,1482518015,1499360767,1516203519,1532980735,1549823487,1566666495,1583509247,1600286463,1600351999,1617194751,1634037759,1650814975,1667657727,1684500479,1701277695,1718120703,1734963455,1751806207,1751806207,1768649215,1785491967,1802334719,1819112191,1835954943,1852797695,1869574911,1869640703,1886483455,1903326207,1920103679,1936946431,1953789439,1970632191,1970632191,1987475199,2004317951,2021160703,2037938175,2054780927,2071623679,2071689471,2088466687,2105309439,2122152191,2138994943,2155772159,2172614911,2189457663,2206300415,2223077631,2239920383,2256763135,2273605887,2290448639,2307225855,2324068607,2340911359,2357754111,2374531327,2391374079,2408216831,2425059583,2441902335,2458679551,2475522303,2492365055,2509207807,2525984767,2542827519,2559670271,2576513023,2593355775,2610132991,2626975743,2643818495,2660660991,2677503743,2694346495,2711123711,2727966463,2744808959,2761651711,2778494463,2795271679,2812114431,2828956927,2845799679,2862642431,2879485183,2896262143,2913104895,2929947647,2946790399,2963632895,2980475647,2997252863,3030872575,3047715327,3064558079,3081400575,3098243327,3115020543,3131863039,3148705791,3165548287,3182391039,3199233791,3216076287,3232853503,3249695999,3266538751,3283381503,3317001215,3333843967,3350686463,3367529215,3384306175,3401148927,3417991423,3434834175,3451676671,3468519423,3502139135,3518981887,3535824383,3552601599,3569444095,3586286591,3603129343,3619971839,3636814335,3653657087,3687276799,3704119551,3720962047,3737804543,3754647039,3771424255,3788266751,3821886463,3838729215,3855571711,3872414207,3889256703,3906099199,3922941695,3956561663,3973404159,3990246655,4007089151,4023931647,4040774143,4057616639,4091236351,4108078847,4124921343,4141763839,4158606335,4192225791,4209002751,4225845247,4242687743,4259530239,4293149695,4293214975,4293280511,4293346303,4293412095,4293477887],Turbo3=[806501375,2717662719,7996418],Turbo4=[806501375,451196671,4189731071,7996418],Turbo5=[806501375,716828159,2717662719,4219478783,7996418],Turbo6=[806501375,1050410751,1190626303,3789305855,4015657471,7996418],Turbo7=[806501375,1166342655,451196671,2717662719,4189731071,3846572799,7996418],Turbo8=[806501375,1182133759,483252223,1643932927,3488232703,4271582719,3678013439,7996418],Turbo9=[806501375,1181278463,716828159,804297471,2717662719,3973134847,4219478783,3526362623,7996418],Turbo10=[806501375,1163974399,917043711,451196671,1912430591,3320787967,4189731071,4134213887,3408593919,7996418],Turbo11=[806501375,1146670079,1050410751,416664831,1190626303,2717662719,3789305855,4255527423,4015657471,3307602687,7996418],Turbo256=[806501375,823476991,840452863,874205695,891181311,908156927,925066751,942042367,959017727,975993343,992968703,1009944063,1010142207,1027052031,1044027135,1061002495,1077977599,1078175487,1095085055,1095282943,1112258047,1129233151,1129365247,1129562879,1146537983,1146670079,1163644671,1163842303,1163974399,1164171775,1181146623,1181278463,1181475839,1181607679,1181804799,1182002175,1182133759,1182331135,1182462719,1182659839,1182791423,1182988543,1166342655,1166539775,1166671103,1150090751,1133444607,1116864255,1100218111,1083637503,1066991359,1050410751,1016987135,1000406271,966982911,950402047,917043711,883620095,866973439,833615359,800191487,766833151,733409279,716828159,683404287,649980415,633399039,599975167,566551039,549904383,516545791,499899135,483252223,466605311,449958655,433311743,416664831,416795391,400148479,400213247,400343807,400474111,417381887,417446655,434354431,451196671,468038911,501723647,518565887,552185087,585869823,619489023,669885439,703504639,753901055,804297471,854693887,905155839,955552255,1005882879,1073056511,1123452927,1190626303,1257799935,1308196095,1375304191,1442477823,1509651199,1576759295,1643932927,1711040767,1778214399,1845322495,1912430591,1962827007,2029935103,2097043199,2164151295,2231259391,2281590271,2348698623,2399029503,2466137855,2516468991,2566800127,2617065727,2667396863,2717662719,2767993855,2801482495,2851813887,2902079487,2935568383,2985834239,3019388415,3069654527,3119854847,3153343743,3203609855,3237098495,3287364607,3320787967,3371054079,3404542975,3454743807,3488232703,3521656063,3571922431,3605345791,3638769151,3672258303,3722458879,3755882239,3789305855,3822729215,3856152831,3889641727,3906287871,3939711487,3973134847,3989780991,4023204351,4039850751,4073208575,4089854719,4106500863,4139924223,4156570111,4173216255,4189862399,4189731071,4206311423,4222957567,4222826239,4239406591,4239275263,4255855615,4255724287,4255527423,4255330559,4271976447,4271779583,4271582719,4271385855,4254411775,4254214655,4254017791,4253820927,4236846847,4236649727,4219675647,4219478783,4202504447,4202307583,4185333503,4168359167,4151385087,4151188223,4134213887,4117239807,4100265727,4083357183,4066383103,4049409023,4015657471,3998748927,3981774847,3964800767,3931115007,3914141183,3897232639,3863546879,3846572799,3812887295,3795978751,3762292991,3728607487,3711698943,3678013439,3644327679,3610642175,3593733631,3560048127,3526362623,3492742399,3459056895,3408593919,3374908415,3341288447,3307602687,3273917183,3223519999,3189834495,3139371519,3105751551,3055288831,3021668863,2971206143,2920808959,2887123455,2836726271,2786329087,2735866367,2685469183,2635071999,2584609279,2534212095,2483814911,2433417727,2383020543,2332623359,2265448959,2215051775,2164654847,2097480447,2047083263],Accent3=[2143911935,3199128831,4257253119],Accent4=[2143911935,3199128831,4257253119,4294941183],Accent5=[2143911935,3199128831,4257253119,4294941183,946647295],Accent6=[2143911935,3199128831,4257253119,4294941183,946647295,4026695679],Accent7=[2143911935,3199128831,4257253119,4294941183,946647295,4026695679,3210418175],Accent8=[2143911935,3199128831,4257253119,4294941183,946647295,4026695679,3210418175,1717987071],Dark2_3=[463370239,3646882559,1970320383],Dark2_4=[463370239,3646882559,1970320383,3878259455],Dark2_5=[463370239,3646882559,1970320383,3878259455,1722162943],Dark2_6=[463370239,3646882559,1970320383,3878259455,1722162943,3869967103],Dark2_7=[463370239,3646882559,1970320383,3878259455,1722162943,3869967103,2792758783],Dark2_8=[463370239,3646882559,1970320383,3878259455,1722162943,3869967103,2792758783,1717987071],Paired3=[2798576639,528004351,3000994559],Paired4=[2798576639,528004351,3000994559,866135295],Paired5=[2798576639,528004351,3000994559,866135295,4221213183],Paired6=[2798576639,528004351,3000994559,866135295,4221213183,3810139391],Paired7=[2798576639,528004351,3000994559,866135295,4221213183,3810139391,4257181695],Paired8=[2798576639,528004351,3000994559,866135295,4221213183,3810139391,4257181695,4286513407],Paired9=[2798576639,528004351,3000994559,866135295,4221213183,3810139391,4257181695,4286513407,3400718079],Paired10=[2798576639,528004351,3000994559,866135295,4221213183,3810139391,4257181695,4286513407,3400718079,1782422271],Paired11=[2798576639,528004351,3000994559,866135295,4221213183,3810139391,4257181695,4286513407,3400718079,1782422271,4294941183],Paired12=[2798576639,528004351,3000994559,866135295,4221213183,3810139391,4257181695,4286513407,3400718079,1782422271,4294941183,2975410431],Pastel1_3=[4222922495,3016614911,3438003711],Pastel1_4=[4222922495,3016614911,3438003711,3737904383],Pastel1_5=[4222922495,3016614911,3438003711,3737904383,4275676927],Pastel1_6=[4222922495,3016614911,3438003711,3737904383,4275676927,4294954239],Pastel1_7=[4222922495,3016614911,3438003711,3737904383,4275676927,4294954239,3856186879],Pastel1_8=[4222922495,3016614911,3438003711,3737904383,4275676927,4294954239,3856186879,4258983167],Pastel1_9=[4222922495,3016614911,3438003711,3737904383,4275676927,4294954239,3856186879,4258983167,4076008191],Pastel2_3=[3017985535,4258114815,3419793663],Pastel2_4=[3017985535,4258114815,3419793663,4106937599],Pastel2_5=[3017985535,4258114815,3419793663,4106937599,3874867711],Pastel2_6=[3017985535,4258114815,3419793663,4106937599,3874867711,4294094591],Pastel2_7=[3017985535,4258114815,3419793663,4106937599,3874867711,4294094591,4058172671],Pastel2_8=[3017985535,4258114815,3419793663,4106937599,3874867711,4294094591,4058172671,3435973887],Set1_3=[3826916607,931051775,1303333631],Set1_4=[3826916607,931051775,1303333631,2555290623],Set1_5=[3826916607,931051775,1303333631,2555290623,4286513407],Set1_6=[3826916607,931051775,1303333631,2555290623,4286513407,4294915071],Set1_7=[3826916607,931051775,1303333631,2555290623,4286513407,4294915071,2790664447],Set1_8=[3826916607,931051775,1303333631,2555290623,4286513407,4294915071,2790664447,4152475647],Set1_9=[3826916607,931051775,1303333631,2555290623,4286513407,4294915071,2790664447,4152475647,2576980479],Set2_3=[1724032511,4237124351,2376125439],Set2_4=[1724032511,4237124351,2376125439,3884631039],Set2_5=[1724032511,4237124351,2376125439,3884631039,2799195391],Set2_6=[1724032511,4237124351,2376125439,3884631039,2799195391,4292423679],Set2_7=[1724032511,4237124351,2376125439,3884631039,2799195391,4292423679,3854865663],Set2_8=[1724032511,4237124351,2376125439,3884631039,2799195391,4292423679,3854865663,3014898687],Set3_3=[2379466751,4294947839,3199916799],Set3_4=[2379466751,4294947839,3199916799,4219499263],Set3_5=[2379466751,4294947839,3199916799,4219499263,2159137791],Set3_6=[2379466751,4294947839,3199916799,4219499263,2159137791,4256457471],Set3_7=[2379466751,4294947839,3199916799,4219499263,2159137791,4256457471,3017697791],Set3_8=[2379466751,4294947839,3199916799,4219499263,2159137791,4256457471,3017697791,4241352191],Set3_9=[2379466751,4294947839,3199916799,4219499263,2159137791,4256457471,3017697791,4241352191,3654932991],Set3_10=[2379466751,4294947839,3199916799,4219499263,2159137791,4256457471,3017697791,4241352191,3654932991,3162553855],Set3_11=[2379466751,4294947839,3199916799,4219499263,2159137791,4256457471,3017697791,4241352191,3654932991,3162553855,3438003711],Set3_12=[2379466751,4294947839,3199916799,4219499263,2159137791,4256457471,3017697791,4241352191,3654932991,3162553855,3438003711,4293750783],Category10_3=[527938815,4286516991,748694783],Category10_4=[527938815,4286516991,748694783,3592890623],Category10_5=[527938815,4286516991,748694783,3592890623,2489826815],Category10_6=[527938815,4286516991,748694783,3592890623,2489826815,2354465791],Category10_7=[527938815,4286516991,748694783,3592890623,2489826815,2354465791,3816276735],Category10_8=[527938815,4286516991,748694783,3592890623,2489826815,2354465791,3816276735,2139062271],Category10_9=[527938815,4286516991,748694783,3592890623,2489826815,2354465791,3816276735,2139062271,3166511871],Category10_10=[527938815,4286516991,748694783,3592890623,2489826815,2354465791,3816276735,2139062271,3166511871,398381055],Category20_3=[527938815,2932336895,4286516991],Category20_4=[527938815,2932336895,4286516991,4290476287],Category20_5=[527938815,2932336895,4286516991,4290476287,748694783],Category20_6=[527938815,2932336895,4286516991,4290476287,748694783,2564786943],Category20_7=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623],Category20_8=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207],Category20_9=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815],Category20_10=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671],Category20_11=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791],Category20_12=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095],Category20_13=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735],Category20_14=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735,4155953919],Category20_15=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735,4155953919,2139062271],Category20_16=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735,4155953919,2139062271,3351758847],Category20_17=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735,4155953919,2139062271,3351758847,3166511871],Category20_18=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735,4155953919,2139062271,3351758847,3166511871,3688599039],Category20_19=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735,4155953919,2139062271,3351758847,3166511871,3688599039,398381055],Category20_20=[527938815,2932336895,4286516991,4290476287,748694783,2564786943,3592890623,4288190207,2489826815,3316700671,2354465791,3298596095,3816276735,4155953919,2139062271,3351758847,3166511871,3688599039,398381055,2665145855],Category20b_3=[960199167,1381278719,1802424319],Category20b_4=[960199167,1381278719,1802424319,2627657471],Category20b_5=[960199167,1381278719,1802424319,2627657471,1668889087],Category20b_6=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319],Category20b_7=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695],Category20b_8=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071],Category20b_9=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463],Category20b_10=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359],Category20b_11=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839],Category20b_12=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847],Category20b_13=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519],Category20b_14=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519,2907261695],Category20b_15=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519,2907261695,3596708863],Category20b_16=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519,2907261695,3596708863,3885407487],Category20b_17=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519,2907261695,3596708863,3885407487,2067887103],Category20b_18=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519,2907261695,3596708863,3885407487,2067887103,2773587199],Category20b_19=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519,2907261695,3596708863,3885407487,2067887103,2773587199,3463298559],Category20b_20=[960199167,1381278719,1802424319,2627657471,1668889087,2359448319,3050269695,3470499071,2355966463,3181263359,3887747839,3888878847,2218539519,2907261695,3596708863,3885407487,2067887103,2773587199,3463298559,3734951679],Category20c_3=[830651903,1806620415,2664096255],Category20c_4=[830651903,1806620415,2664096255,3336302591],Category20c_5=[830651903,1806620415,2664096255,3336302591,3864333823],Category20c_6=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839],Category20c_7=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559],Category20c_8=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863],Category20c_9=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711],Category20c_10=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575],Category20c_11=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023],Category20c_12=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279],Category20c_13=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191],Category20c_14=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191,2660944127],Category20c_15=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191,2660944127,3166559487],Category20c_16=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191,2660944127,3166559487,3671780351],Category20c_17=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191,2660944127,3166559487,3671780351,1667458047],Category20c_18=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191,2660944127,3166559487,3671780351,1667458047,2526451455],Category20c_19=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191,2660944127,3166559487,3671780351,1667458047,2526451455,3183328767],Category20c_20=[830651903,1806620415,2664096255,3336302591,3864333823,4253891839,4256066559,4258308863,832787711,1959032575,2715393023,3353985279,1969992191,2660944127,3166559487,3671780351,1667458047,2526451455,3183328767,3654932991],Colorblind3=[7516927,3869180159,4041491199],Colorblind4=[7516927,3869180159,4041491199,10384383],Colorblind5=[7516927,3869180159,4041491199,10384383,1454696959],Colorblind6=[7516927,3869180159,4041491199,10384383,1454696959,3579707647],Colorblind7=[7516927,3869180159,4041491199,10384383,1454696959,3579707647,3430524927],Colorblind8=[7516927,3869180159,4041491199,10384383,1454696959,3579707647,3430524927,255],YlGn={YlGn3:YlGn3,YlGn4:YlGn4,YlGn5:YlGn5,YlGn6:YlGn6,YlGn7:YlGn7,YlGn8:YlGn8,YlGn9:YlGn9},YlGnBu={YlGnBu3:YlGnBu3,YlGnBu4:YlGnBu4,YlGnBu5:YlGnBu5,YlGnBu6:YlGnBu6,YlGnBu7:YlGnBu7,YlGnBu8:YlGnBu8,YlGnBu9:YlGnBu9},GnBu={GnBu3:GnBu3,GnBu4:GnBu4,GnBu5:GnBu5,GnBu6:GnBu6,GnBu7:GnBu7,GnBu8:GnBu8,GnBu9:GnBu9},BuGn={BuGn3:BuGn3,BuGn4:BuGn4,BuGn5:BuGn5,BuGn6:BuGn6,BuGn7:BuGn7,BuGn8:BuGn8,BuGn9:BuGn9},PuBuGn={PuBuGn3:PuBuGn3,PuBuGn4:PuBuGn4,PuBuGn5:PuBuGn5,PuBuGn6:PuBuGn6,PuBuGn7:PuBuGn7,PuBuGn8:PuBuGn8,PuBuGn9:PuBuGn9},PuBu={PuBu3:PuBu3,PuBu4:PuBu4,PuBu5:PuBu5,PuBu6:PuBu6,PuBu7:PuBu7,PuBu8:PuBu8,PuBu9:PuBu9},BuPu={BuPu3:BuPu3,BuPu4:BuPu4,BuPu5:BuPu5,BuPu6:BuPu6,BuPu7:BuPu7,BuPu8:BuPu8,BuPu9:BuPu9},RdPu={RdPu3:RdPu3,RdPu4:RdPu4,RdPu5:RdPu5,RdPu6:RdPu6,RdPu7:RdPu7,RdPu8:RdPu8,RdPu9:RdPu9},PuRd={PuRd3:PuRd3,PuRd4:PuRd4,PuRd5:PuRd5,PuRd6:PuRd6,PuRd7:PuRd7,PuRd8:PuRd8,PuRd9:PuRd9},OrRd={OrRd3:OrRd3,OrRd4:OrRd4,OrRd5:OrRd5,OrRd6:OrRd6,OrRd7:OrRd7,OrRd8:OrRd8,OrRd9:OrRd9},YlOrRd={YlOrRd3:YlOrRd3,YlOrRd4:YlOrRd4,YlOrRd5:YlOrRd5,YlOrRd6:YlOrRd6,YlOrRd7:YlOrRd7,YlOrRd8:YlOrRd8,YlOrRd9:YlOrRd9},YlOrBr={YlOrBr3:YlOrBr3,YlOrBr4:YlOrBr4,YlOrBr5:YlOrBr5,YlOrBr6:YlOrBr6,YlOrBr7:YlOrBr7,YlOrBr8:YlOrBr8,YlOrBr9:YlOrBr9},Purples={Purples3:Purples3,Purples4:Purples4,Purples5:Purples5,Purples6:Purples6,Purples7:Purples7,Purples8:Purples8,Purples9:Purples9},Blues={Blues3:Blues3,Blues4:Blues4,Blues5:Blues5,Blues6:Blues6,Blues7:Blues7,Blues8:Blues8,Blues9:Blues9},Greens={Greens3:Greens3,Greens4:Greens4,Greens5:Greens5,Greens6:Greens6,Greens7:Greens7,Greens8:Greens8,Greens9:Greens9},Oranges={Oranges3:Oranges3,Oranges4:Oranges4,Oranges5:Oranges5,Oranges6:Oranges6,Oranges7:Oranges7,Oranges8:Oranges8,Oranges9:Oranges9},Reds={Reds3:Reds3,Reds4:Reds4,Reds5:Reds5,Reds6:Reds6,Reds7:Reds7,Reds8:Reds8,Reds9:Reds9},Greys={Greys3:Greys3,Greys4:Greys4,Greys5:Greys5,Greys6:Greys6,Greys7:Greys7,Greys8:Greys8,Greys9:Greys9,Greys10:Greys10,Greys11:Greys11,Greys256:Greys256},PuOr={PuOr3:PuOr3,PuOr4:PuOr4,PuOr5:PuOr5,PuOr6:PuOr6,PuOr7:PuOr7,PuOr8:PuOr8,PuOr9:PuOr9,PuOr10:PuOr10,PuOr11:PuOr11},BrBG={BrBG3:BrBG3,BrBG4:BrBG4,BrBG5:BrBG5,BrBG6:BrBG6,BrBG7:BrBG7,BrBG8:BrBG8,BrBG9:BrBG9,BrBG10:BrBG10,BrBG11:BrBG11},PRGn={PRGn3:PRGn3,PRGn4:PRGn4,PRGn5:PRGn5,PRGn6:PRGn6,PRGn7:PRGn7,PRGn8:PRGn8,PRGn9:PRGn9,PRGn10:PRGn10,PRGn11:PRGn11},PiYG={PiYG3:PiYG3,PiYG4:PiYG4,PiYG5:PiYG5,PiYG6:PiYG6,PiYG7:PiYG7,PiYG8:PiYG8,PiYG9:PiYG9,PiYG10:PiYG10,PiYG11:PiYG11},RdBu={RdBu3:RdBu3,RdBu4:RdBu4,RdBu5:RdBu5,RdBu6:RdBu6,RdBu7:RdBu7,RdBu8:RdBu8,RdBu9:RdBu9,RdBu10:RdBu10,RdBu11:RdBu11},RdGy={RdGy3:RdGy3,RdGy4:RdGy4,RdGy5:RdGy5,RdGy6:RdGy6,RdGy7:RdGy7,RdGy8:RdGy8,RdGy9:RdGy9,RdGy10:RdGy10,RdGy11:RdGy11},RdYlBu={RdYlBu3:RdYlBu3,RdYlBu4:RdYlBu4,RdYlBu5:RdYlBu5,RdYlBu6:RdYlBu6,RdYlBu7:RdYlBu7,RdYlBu8:RdYlBu8,RdYlBu9:RdYlBu9,RdYlBu10:RdYlBu10,RdYlBu11:RdYlBu11},Spectral={Spectral3:Spectral3,Spectral4:Spectral4,Spectral5:Spectral5,Spectral6:Spectral6,Spectral7:Spectral7,Spectral8:Spectral8,Spectral9:Spectral9,Spectral10:Spectral10,Spectral11:Spectral11},RdYlGn={RdYlGn3:RdYlGn3,RdYlGn4:RdYlGn4,RdYlGn5:RdYlGn5,RdYlGn6:RdYlGn6,RdYlGn7:RdYlGn7,RdYlGn8:RdYlGn8,RdYlGn9:RdYlGn9,RdYlGn10:RdYlGn10,RdYlGn11:RdYlGn11},Inferno={Inferno3:Inferno3,Inferno4:Inferno4,Inferno5:Inferno5,Inferno6:Inferno6,Inferno7:Inferno7,Inferno8:Inferno8,Inferno9:Inferno9,Inferno10:Inferno10,Inferno11:Inferno11,Inferno256:Inferno256},Magma={Magma3:Magma3,Magma4:Magma4,Magma5:Magma5,Magma6:Magma6,Magma7:Magma7,Magma8:Magma8,Magma9:Magma9,Magma10:Magma10,Magma11:Magma11,Magma256:Magma256},Plasma={Plasma3:Plasma3,Plasma4:Plasma4,Plasma5:Plasma5,Plasma6:Plasma6,Plasma7:Plasma7,Plasma8:Plasma8,Plasma9:Plasma9,Plasma10:Plasma10,Plasma11:Plasma11,Plasma256:Plasma256},Viridis={Viridis3:Viridis3,Viridis4:Viridis4,Viridis5:Viridis5,Viridis6:Viridis6,Viridis7:Viridis7,Viridis8:Viridis8,Viridis9:Viridis9,Viridis10:Viridis10,Viridis11:Viridis11,Viridis256:Viridis256},Accent={Accent3:Accent3,Accent4:Accent4,Accent5:Accent5,Accent6:Accent6,Accent7:Accent7,Accent8:Accent8},Dark2={Dark2_3:Dark2_3,Dark2_4:Dark2_4,Dark2_5:Dark2_5,Dark2_6:Dark2_6,Dark2_7:Dark2_7,Dark2_8:Dark2_8},Paired={Paired3:Paired3,Paired4:Paired4,Paired5:Paired5,Paired6:Paired6,Paired7:Paired7,Paired8:Paired8,Paired9:Paired9,Paired10:Paired10,Paired11:Paired11,Paired12:Paired12},Pastel1={Pastel1_3:Pastel1_3,Pastel1_4:Pastel1_4,Pastel1_5:Pastel1_5,Pastel1_6:Pastel1_6,Pastel1_7:Pastel1_7,Pastel1_8:Pastel1_8,Pastel1_9:Pastel1_9},Pastel2={Pastel2_3:Pastel2_3,Pastel2_4:Pastel2_4,Pastel2_5:Pastel2_5,Pastel2_6:Pastel2_6,Pastel2_7:Pastel2_7,Pastel2_8:Pastel2_8},Set1={Set1_3:Set1_3,Set1_4:Set1_4,Set1_5:Set1_5,Set1_6:Set1_6,Set1_7:Set1_7,Set1_8:Set1_8,Set1_9:Set1_9},Set2={Set2_3:Set2_3,Set2_4:Set2_4,Set2_5:Set2_5,Set2_6:Set2_6,Set2_7:Set2_7,Set2_8:Set2_8},Set3={Set3_3:Set3_3,Set3_4:Set3_4,Set3_5:Set3_5,Set3_6:Set3_6,Set3_7:Set3_7,Set3_8:Set3_8,Set3_9:Set3_9,Set3_10:Set3_10,Set3_11:Set3_11,Set3_12:Set3_12},Category10={Category10_3:Category10_3,Category10_4:Category10_4,Category10_5:Category10_5,Category10_6:Category10_6,Category10_7:Category10_7,Category10_8:Category10_8,Category10_9:Category10_9,Category10_10:Category10_10},Category20={Category20_3:Category20_3,Category20_4:Category20_4,Category20_5:Category20_5,Category20_6:Category20_6,Category20_7:Category20_7,Category20_8:Category20_8,Category20_9:Category20_9,Category20_10:Category20_10,Category20_11:Category20_11,Category20_12:Category20_12,Category20_13:Category20_13,Category20_14:Category20_14,Category20_15:Category20_15,Category20_16:Category20_16,Category20_17:Category20_17,Category20_18:Category20_18,Category20_19:Category20_19,Category20_20:Category20_20},Category20b={Category20b_3:Category20b_3,Category20b_4:Category20b_4,Category20b_5:Category20b_5,Category20b_6:Category20b_6,Category20b_7:Category20b_7,Category20b_8:Category20b_8,Category20b_9:Category20b_9,Category20b_10:Category20b_10,Category20b_11:Category20b_11,Category20b_12:Category20b_12,Category20b_13:Category20b_13,Category20b_14:Category20b_14,Category20b_15:Category20b_15,Category20b_16:Category20b_16,Category20b_17:Category20b_17,Category20b_18:Category20b_18,Category20b_19:Category20b_19,Category20b_20:Category20b_20},Category20c={Category20c_3:Category20c_3,Category20c_4:Category20c_4,Category20c_5:Category20c_5,Category20c_6:Category20c_6,Category20c_7:Category20c_7,Category20c_8:Category20c_8,Category20c_9:Category20c_9,Category20c_10:Category20c_10,Category20c_11:Category20c_11,Category20c_12:Category20c_12,Category20c_13:Category20c_13,Category20c_14:Category20c_14,Category20c_15:Category20c_15,Category20c_16:Category20c_16,Category20c_17:Category20c_17,Category20c_18:Category20c_18,Category20c_19:Category20c_19,Category20c_20:Category20c_20},Colorblind={Colorblind3:Colorblind3,Colorblind4:Colorblind4,Colorblind5:Colorblind5,Colorblind6:Colorblind6,Colorblind7:Colorblind7,Colorblind8:Colorblind8};function linear_palette(e,t){if(t<=e.length)return linspace(0,e.length-1,t).map((t=>e[0|t]));throw new Error("too many color entries requested")}function magma(e){return linear_palette(Magma256,e)}function inferno(e){return linear_palette(Inferno256,e)}function plasma(e){return linear_palette(Plasma256,e)}function viridis(e){return linear_palette(Viridis256,e)}function cividis(e){return linear_palette(Cividis256,e)}function turbo(e){return linear_palette(Turbo256,e)}function grey(e){return linear_palette(Greys256,e)}var palettes=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",YlGn3:YlGn3,YlGn4:YlGn4,YlGn5:YlGn5,YlGn6:YlGn6,YlGn7:YlGn7,YlGn8:YlGn8,YlGn9:YlGn9,YlGnBu3:YlGnBu3,YlGnBu4:YlGnBu4,YlGnBu5:YlGnBu5,YlGnBu6:YlGnBu6,YlGnBu7:YlGnBu7,YlGnBu8:YlGnBu8,YlGnBu9:YlGnBu9,GnBu3:GnBu3,GnBu4:GnBu4,GnBu5:GnBu5,GnBu6:GnBu6,GnBu7:GnBu7,GnBu8:GnBu8,GnBu9:GnBu9,BuGn3:BuGn3,BuGn4:BuGn4,BuGn5:BuGn5,BuGn6:BuGn6,BuGn7:BuGn7,BuGn8:BuGn8,BuGn9:BuGn9,PuBuGn3:PuBuGn3,PuBuGn4:PuBuGn4,PuBuGn5:PuBuGn5,PuBuGn6:PuBuGn6,PuBuGn7:PuBuGn7,PuBuGn8:PuBuGn8,PuBuGn9:PuBuGn9,PuBu3:PuBu3,PuBu4:PuBu4,PuBu5:PuBu5,PuBu6:PuBu6,PuBu7:PuBu7,PuBu8:PuBu8,PuBu9:PuBu9,BuPu3:BuPu3,BuPu4:BuPu4,BuPu5:BuPu5,BuPu6:BuPu6,BuPu7:BuPu7,BuPu8:BuPu8,BuPu9:BuPu9,RdPu3:RdPu3,RdPu4:RdPu4,RdPu5:RdPu5,RdPu6:RdPu6,RdPu7:RdPu7,RdPu8:RdPu8,RdPu9:RdPu9,PuRd3:PuRd3,PuRd4:PuRd4,PuRd5:PuRd5,PuRd6:PuRd6,PuRd7:PuRd7,PuRd8:PuRd8,PuRd9:PuRd9,OrRd3:OrRd3,OrRd4:OrRd4,OrRd5:OrRd5,OrRd6:OrRd6,OrRd7:OrRd7,OrRd8:OrRd8,OrRd9:OrRd9,YlOrRd3:YlOrRd3,YlOrRd4:YlOrRd4,YlOrRd5:YlOrRd5,YlOrRd6:YlOrRd6,YlOrRd7:YlOrRd7,YlOrRd8:YlOrRd8,YlOrRd9:YlOrRd9,YlOrBr3:YlOrBr3,YlOrBr4:YlOrBr4,YlOrBr5:YlOrBr5,YlOrBr6:YlOrBr6,YlOrBr7:YlOrBr7,YlOrBr8:YlOrBr8,YlOrBr9:YlOrBr9,Purples3:Purples3,Purples4:Purples4,Purples5:Purples5,Purples6:Purples6,Purples7:Purples7,Purples8:Purples8,Purples9:Purples9,Blues3:Blues3,Blues4:Blues4,Blues5:Blues5,Blues6:Blues6,Blues7:Blues7,Blues8:Blues8,Blues9:Blues9,Greens3:Greens3,Greens4:Greens4,Greens5:Greens5,Greens6:Greens6,Greens7:Greens7,Greens8:Greens8,Greens9:Greens9,Oranges3:Oranges3,Oranges4:Oranges4,Oranges5:Oranges5,Oranges6:Oranges6,Oranges7:Oranges7,Oranges8:Oranges8,Oranges9:Oranges9,Reds3:Reds3,Reds4:Reds4,Reds5:Reds5,Reds6:Reds6,Reds7:Reds7,Reds8:Reds8,Reds9:Reds9,Greys3:Greys3,Greys4:Greys4,Greys5:Greys5,Greys6:Greys6,Greys7:Greys7,Greys8:Greys8,Greys9:Greys9,Greys10:Greys10,Greys11:Greys11,Greys256:Greys256,PuOr3:PuOr3,PuOr4:PuOr4,PuOr5:PuOr5,PuOr6:PuOr6,PuOr7:PuOr7,PuOr8:PuOr8,PuOr9:PuOr9,PuOr10:PuOr10,PuOr11:PuOr11,BrBG3:BrBG3,BrBG4:BrBG4,BrBG5:BrBG5,BrBG6:BrBG6,BrBG7:BrBG7,BrBG8:BrBG8,BrBG9:BrBG9,BrBG10:BrBG10,BrBG11:BrBG11,PRGn3:PRGn3,PRGn4:PRGn4,PRGn5:PRGn5,PRGn6:PRGn6,PRGn7:PRGn7,PRGn8:PRGn8,PRGn9:PRGn9,PRGn10:PRGn10,PRGn11:PRGn11,PiYG3:PiYG3,PiYG4:PiYG4,PiYG5:PiYG5,PiYG6:PiYG6,PiYG7:PiYG7,PiYG8:PiYG8,PiYG9:PiYG9,PiYG10:PiYG10,PiYG11:PiYG11,RdBu3:RdBu3,RdBu4:RdBu4,RdBu5:RdBu5,RdBu6:RdBu6,RdBu7:RdBu7,RdBu8:RdBu8,RdBu9:RdBu9,RdBu10:RdBu10,RdBu11:RdBu11,RdGy3:RdGy3,RdGy4:RdGy4,RdGy5:RdGy5,RdGy6:RdGy6,RdGy7:RdGy7,RdGy8:RdGy8,RdGy9:RdGy9,RdGy10:RdGy10,RdGy11:RdGy11,RdYlBu3:RdYlBu3,RdYlBu4:RdYlBu4,RdYlBu5:RdYlBu5,RdYlBu6:RdYlBu6,RdYlBu7:RdYlBu7,RdYlBu8:RdYlBu8,RdYlBu9:RdYlBu9,RdYlBu10:RdYlBu10,RdYlBu11:RdYlBu11,Spectral3:Spectral3,Spectral4:Spectral4,Spectral5:Spectral5,Spectral6:Spectral6,Spectral7:Spectral7,Spectral8:Spectral8,Spectral9:Spectral9,Spectral10:Spectral10,Spectral11:Spectral11,RdYlGn3:RdYlGn3,RdYlGn4:RdYlGn4,RdYlGn5:RdYlGn5,RdYlGn6:RdYlGn6,RdYlGn7:RdYlGn7,RdYlGn8:RdYlGn8,RdYlGn9:RdYlGn9,RdYlGn10:RdYlGn10,RdYlGn11:RdYlGn11,Inferno3:Inferno3,Inferno4:Inferno4,Inferno5:Inferno5,Inferno6:Inferno6,Inferno7:Inferno7,Inferno8:Inferno8,Inferno9:Inferno9,Inferno10:Inferno10,Inferno11:Inferno11,Inferno256:Inferno256,Magma3:Magma3,Magma4:Magma4,Magma5:Magma5,Magma6:Magma6,Magma7:Magma7,Magma8:Magma8,Magma9:Magma9,Magma10:Magma10,Magma11:Magma11,Magma256:Magma256,Plasma3:Plasma3,Plasma4:Plasma4,Plasma5:Plasma5,Plasma6:Plasma6,Plasma7:Plasma7,Plasma8:Plasma8,Plasma9:Plasma9,Plasma10:Plasma10,Plasma11:Plasma11,Plasma256:Plasma256,Viridis3:Viridis3,Viridis4:Viridis4,Viridis5:Viridis5,Viridis6:Viridis6,Viridis7:Viridis7,Viridis8:Viridis8,Viridis9:Viridis9,Viridis10:Viridis10,Viridis11:Viridis11,Viridis256:Viridis256,Cividis3:Cividis3,Cividis4:Cividis4,Cividis5:Cividis5,Cividis6:Cividis6,Cividis7:Cividis7,Cividis8:Cividis8,Cividis9:Cividis9,Cividis10:Cividis10,Cividis11:Cividis11,Cividis256:Cividis256,Turbo3:Turbo3,Turbo4:Turbo4,Turbo5:Turbo5,Turbo6:Turbo6,Turbo7:Turbo7,Turbo8:Turbo8,Turbo9:Turbo9,Turbo10:Turbo10,Turbo11:Turbo11,Turbo256:Turbo256,Accent3:Accent3,Accent4:Accent4,Accent5:Accent5,Accent6:Accent6,Accent7:Accent7,Accent8:Accent8,Dark2_3:Dark2_3,Dark2_4:Dark2_4,Dark2_5:Dark2_5,Dark2_6:Dark2_6,Dark2_7:Dark2_7,Dark2_8:Dark2_8,Paired3:Paired3,Paired4:Paired4,Paired5:Paired5,Paired6:Paired6,Paired7:Paired7,Paired8:Paired8,Paired9:Paired9,Paired10:Paired10,Paired11:Paired11,Paired12:Paired12,Pastel1_3:Pastel1_3,Pastel1_4:Pastel1_4,Pastel1_5:Pastel1_5,Pastel1_6:Pastel1_6,Pastel1_7:Pastel1_7,Pastel1_8:Pastel1_8,Pastel1_9:Pastel1_9,Pastel2_3:Pastel2_3,Pastel2_4:Pastel2_4,Pastel2_5:Pastel2_5,Pastel2_6:Pastel2_6,Pastel2_7:Pastel2_7,Pastel2_8:Pastel2_8,Set1_3:Set1_3,Set1_4:Set1_4,Set1_5:Set1_5,Set1_6:Set1_6,Set1_7:Set1_7,Set1_8:Set1_8,Set1_9:Set1_9,Set2_3:Set2_3,Set2_4:Set2_4,Set2_5:Set2_5,Set2_6:Set2_6,Set2_7:Set2_7,Set2_8:Set2_8,Set3_3:Set3_3,Set3_4:Set3_4,Set3_5:Set3_5,Set3_6:Set3_6,Set3_7:Set3_7,Set3_8:Set3_8,Set3_9:Set3_9,Set3_10:Set3_10,Set3_11:Set3_11,Set3_12:Set3_12,Category10_3:Category10_3,Category10_4:Category10_4,Category10_5:Category10_5,Category10_6:Category10_6,Category10_7:Category10_7,Category10_8:Category10_8,Category10_9:Category10_9,Category10_10:Category10_10,Category20_3:Category20_3,Category20_4:Category20_4,Category20_5:Category20_5,Category20_6:Category20_6,Category20_7:Category20_7,Category20_8:Category20_8,Category20_9:Category20_9,Category20_10:Category20_10,Category20_11:Category20_11,Category20_12:Category20_12,Category20_13:Category20_13,Category20_14:Category20_14,Category20_15:Category20_15,Category20_16:Category20_16,Category20_17:Category20_17,Category20_18:Category20_18,Category20_19:Category20_19,Category20_20:Category20_20,Category20b_3:Category20b_3,Category20b_4:Category20b_4,Category20b_5:Category20b_5,Category20b_6:Category20b_6,Category20b_7:Category20b_7,Category20b_8:Category20b_8,Category20b_9:Category20b_9,Category20b_10:Category20b_10,Category20b_11:Category20b_11,Category20b_12:Category20b_12,Category20b_13:Category20b_13,Category20b_14:Category20b_14,Category20b_15:Category20b_15,Category20b_16:Category20b_16,Category20b_17:Category20b_17,Category20b_18:Category20b_18,Category20b_19:Category20b_19,Category20b_20:Category20b_20,Category20c_3:Category20c_3,Category20c_4:Category20c_4,Category20c_5:Category20c_5,Category20c_6:Category20c_6,Category20c_7:Category20c_7,Category20c_8:Category20c_8,Category20c_9:Category20c_9,Category20c_10:Category20c_10,Category20c_11:Category20c_11,Category20c_12:Category20c_12,Category20c_13:Category20c_13,Category20c_14:Category20c_14,Category20c_15:Category20c_15,Category20c_16:Category20c_16,Category20c_17:Category20c_17,Category20c_18:Category20c_18,Category20c_19:Category20c_19,Category20c_20:Category20c_20,Colorblind3:Colorblind3,Colorblind4:Colorblind4,Colorblind5:Colorblind5,Colorblind6:Colorblind6,Colorblind7:Colorblind7,Colorblind8:Colorblind8,YlGn:YlGn,YlGnBu:YlGnBu,GnBu:GnBu,BuGn:BuGn,PuBuGn:PuBuGn,PuBu:PuBu,BuPu:BuPu,RdPu:RdPu,PuRd:PuRd,OrRd:OrRd,YlOrRd:YlOrRd,YlOrBr:YlOrBr,Purples:Purples,Blues:Blues,Greens:Greens,Oranges:Oranges,Reds:Reds,Greys:Greys,PuOr:PuOr,BrBG:BrBG,PRGn:PRGn,PiYG:PiYG,RdBu:RdBu,RdGy:RdGy,RdYlBu:RdYlBu,Spectral:Spectral,RdYlGn:RdYlGn,Inferno:Inferno,Magma:Magma,Plasma:Plasma,Viridis:Viridis,Accent:Accent,Dark2:Dark2,Paired:Paired,Pastel1:Pastel1,Pastel2:Pastel2,Set1:Set1,Set2:Set2,Set3:Set3,Category10:Category10,Category20:Category20,Category20b:Category20b,Category20c:Category20c,Colorblind:Colorblind,linear_palette:linear_palette,magma:magma,inferno:inferno,plasma:plasma,viridis:viridis,cividis:cividis,turbo:turbo,grey:grey});function resolve_palette(e="Spectral11"){return isArray(e)?e:palettes[e]}function pie(e,t={}){var i;const n=[],o=[];for(let B=0;B<Math.min(e.labels.length,e.values.length);B++)e.values[B]>0&&(n.push(e.labels[B]),o.push(e.values[B]));const r=null!=t.start_angle?t.start_angle:0,s=null!=t.end_angle?t.end_angle:r+2*Math.PI,a=Math.abs(s-r),l=sum$1(o),c=o.map((e=>e/l)),d=cumsum(c).map((e=>r+a*e)),h=[r].concat(d.slice(0,-1)),u=zip(h,d).map((([e,t])=>(e+t)/2));let p,_;null==t.center?(p=0,_=0):isArray(t.center)?(p=t.center[0],_=t.center[1]):(p=t.center.x,_=t.center.y);const f=null!=t.inner_radius?t.inner_radius:0,g=null!=t.outer_radius?t.outer_radius:1,m=resolve_palette(t.palette),v=[];for(let B=0;B<c.length;B++)v.push(m[B%m.length]);const b=v.map((e=>is_dark(color2rgba(e))?"white":"black"));const y=(f+g)/2;let[w,A]=unzip(u.map((e=>{return i=e,[(t=y)*Math.cos(i),t*Math.sin(i)];var t,i})));w=w.map((e=>e+p)),A=A.map((e=>e+_));const x=u.map((e=>e>=Math.PI/2&&e<=3*Math.PI/2?e+Math.PI:e)),k=new ColumnDataSource({data:{labels:n,values:o,percentages:c.map((e=>sprintf("%.2f%%",100*e))),start_angles:h,end_angles:d,text_angles:x,colors:v,text_colors:b,text_cx:w,text_cy:A}}),C=new AnnularWedge({x:p,y:_,inner_radius:f,outer_radius:g,start_angle:{field:"start_angles"},end_angle:{field:"end_angles"},line_color:null,line_width:1,fill_color:{field:"colors"}}),S=new AnnularWedge({x:p,y:_,inner_radius:f,outer_radius:g,start_angle:{field:"start_angles"},end_angle:{field:"end_angles"},line_color:null,line_width:1,fill_color:{field:"colors"},fill_alpha:.8}),T=new GlyphRenderer({data_source:k,glyph:C,hover_glyph:S}),R=new Text({x:{field:"text_cx"},y:{field:"text_cy"},text:{field:null!=(i=t.slice_labels)?i:"labels"},angle:{field:"text_angles"},text_align:"center",text_baseline:"middle",text_color:{field:"text_colors"},text_font_size:"12px"}),E=new GlyphRenderer({data_source:k,glyph:R}),P=new DataRange1d({renderers:[T],range_padding:.2}),M=new DataRange1d({renderers:[T],range_padding:.2}),D=new Plot({x_range:P,y_range:M});D.add_renderers(T,E);const I=new HoverTool({renderers:[T],tooltips:"<div>@labels</div><div><b>@values</b> (@percentages)</div>"});return D.add_tools(I),D}function bar(e,t={}){const i=e[0],n=transpose(e.slice(1)),o=n[0].map((e=>e.toString())),r=n.slice(1);let s,a=new CategoricalAxis,l=new FactorRange({factors:o}),c=new CategoricalScale;s=null!=t.axis_number_format?new NumeralTickFormatter({format:t.axis_number_format}):new BasicTickFormatter;let d=new LinearAxis({formatter:s}),h=new DataRange1d({start:0}),u=new LinearScale;const p=resolve_palette(t.palette),_=null!=t.stacked&&t.stacked,f=null!=t.orientation?t.orientation:"horizontal",g=[];if(_){const e=[],t=[];for(let n=0;n<r.length;n++){const s=[],a=[];for(let i=0;i<o.length;i++){const l=o[i];0==n?(e.push(0),t.push(r[n][i])):(e[i]+=r[n-1][i],t[i]+=r[n][i]),s.push([l,-.5]),a.push([l,.5])}const l=new ColumnDataSource({data:{left:copy(e),right:copy(t),top:a,bottom:s,labels:o,values:r[n],columns:r[n].map((e=>i[n+1]))}}),c=new Quad({left:{field:"left"},bottom:{field:"bottom"},right:{field:"right"},top:{field:"top"},line_color:null,fill_color:p[n%p.length]}),d=new GlyphRenderer({data_source:l,glyph:c});g.push(d)}}else{const e=1/r.length;for(let t=0;t<r.length;t++){const n=[],s=[],a=[],l=[];for(let i=0;i<o.length;i++){const c=o[i];n.push(0),s.push(r[t][i]),a.push([c,t*e-.5]),l.push([c,(t+1)*e-.5])}const c=new ColumnDataSource({data:{left:n,right:s,top:l,bottom:a,labels:o,values:r[t],columns:r[t].map((e=>i[t+1]))}}),d=new Quad({left:{field:"left"},bottom:{field:"bottom"},right:{field:"right"},top:{field:"top"},line_color:null,fill_color:p[t%p.length]}),h=new GlyphRenderer({data_source:c,glyph:d});g.push(h)}}if("vertical"==f){[h,l]=[l,h],[d,a]=[a,d],[u,c]=[c,u];for(const e of g){const t=e.data_source.data;[t.left,t.bottom]=[t.bottom,t.left],[t.right,t.top]=[t.top,t.right]}}const m=new Plot({x_range:h,y_range:l,x_scale:u,y_scale:c});m.add_renderers(...g),m.add_layout(a,"left"),m.add_layout(d,"below");let v,b;"horizontal"==f?(v="center_right",b="horizontal"):(v="top_center",b="vertical");const y=new HoverTool({renderers:g,tooltips:"<div>@labels</div><div>@columns:&nbsp<b>@values</b></div>",point_policy:"snap_to_data",anchor:v,attachment:b});return m.add_tools(y),m}var charts=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",pie:pie,bar:bar});class Matrix{constructor(e,t,i){this.nrows=e,this.ncols=t,this._matrix=new Array(e);for(let n=0;n<e;n++){this._matrix[n]=new Array(t);for(let e=0;e<t;e++)this._matrix[n][e]=i(n,e)}}at(e,t){return this._matrix[e][t]}*[Symbol.iterator](){for(let e=0;e<this.nrows;e++)for(let t=0;t<this.ncols;t++){const i=this._matrix[e][t];yield[i,e,t]}}*values(){for(const[e]of this)yield e}map(e){return new Matrix(this.nrows,this.ncols,((t,i)=>e(this.at(t,i),t,i)))}apply(e){const t=Matrix.from(e),{nrows:i,ncols:n}=this;if(i==t.nrows&&n==t.ncols)return new Matrix(i,n,((e,i)=>t.at(e,i)(this.at(e,i),e,i)));throw new Error("dimensions don't match")}to_sparse(){return[...this]}static from(e,t){if(e instanceof Matrix)return e;if(null!=t){const i=e,n=Math.floor(i.length/t);return new Matrix(n,t,((e,n)=>i[e*t+n]))}{const t=e,i=e.length,n=min$6(t.map((e=>e.length)));return new Matrix(i,n,((e,i)=>t[e][i]))}}}function or_else(e,t){return void 0===e?t:e}function gridplot(e,t={}){const i=or_else(t.toolbar_location,"above"),n=or_else(t.merge_tools,!0),o=or_else(t.sizing_mode,null),r=Matrix.from(e),s=[],a=[];for(const[h,u,p]of r)null!=h&&(n&&(a.push(h.toolbar),h.toolbar_location=null),null!=t.plot_width&&(h.plot_width=t.plot_width),null!=t.plot_height&&(h.plot_height=t.plot_height),s.push([h,u,p]));const l=new GridBox({children:s,sizing_mode:o});if(!n||null==i)return l;const c=[];for(const h of a)c.push(...h.tools);const d=new ToolbarBox({toolbar:new ProxyToolbar({toolbars:a,tools:c}),toolbar_location:i});switch(i){case"above":return new Column({children:[d,l],sizing_mode:o});case"below":return new Column({children:[l,d],sizing_mode:o});case"left":return new Row({children:[d,l],sizing_mode:o});case"right":return new Row({children:[l,d],sizing_mode:o});default:throw new Error("unexpected")}}Matrix.__name__="Matrix";const{hasOwnProperty:hasOwnProperty$1}=Object.prototype,_default_tools=["pan","wheel_zoom","box_zoom","save","reset","help"],_default_color="#1f77b4",_default_alpha=1;function _with_default(e,t){return void 0===e?t:e}class Figure extends Plot{constructor(e={}){const t=_with_default((e=__spreadValues({},e)).tools,_default_tools);delete e.tools;const i=_with_default(e.x_axis_type,"auto"),n=_with_default(e.y_axis_type,"auto");delete e.x_axis_type,delete e.y_axis_type;const o=null!=e.x_minor_ticks?e.x_minor_ticks:"auto",r=null!=e.y_minor_ticks?e.y_minor_ticks:"auto";delete e.x_minor_ticks,delete e.y_minor_ticks;const s=null!=e.x_axis_location?e.x_axis_location:"below",a=null!=e.y_axis_location?e.y_axis_location:"left";delete e.x_axis_location,delete e.y_axis_location;const l=null!=e.x_axis_label?e.x_axis_label:"",c=null!=e.y_axis_label?e.y_axis_label:"";delete e.x_axis_label,delete e.y_axis_label;const d=Figure._get_range(e.x_range),h=Figure._get_range(e.y_range);delete e.x_range,delete e.y_range;const u=null!=e.x_scale?e.x_scale:Figure._get_scale(d,i),p=null!=e.y_scale?e.y_scale:Figure._get_scale(h,n);delete e.x_scale,delete e.y_scale,super(__spreadProps(__spreadValues({},e),{x_range:d,y_range:h,x_scale:u,y_scale:p})),this._process_axis_and_grid(i,s,o,l,d,0),this._process_axis_and_grid(n,a,r,c,h,1),this.add_tools(...this._process_tools(t))}get xgrid(){return this.center.filter((e=>e instanceof Grid&&0==e.dimension))}get ygrid(){return this.center.filter((e=>e instanceof Grid&&1==e.dimension))}get xaxis(){return this.below.concat(this.above).filter((e=>e instanceof Axis))}get yaxis(){return this.left.concat(this.right).filter((e=>e instanceof Axis))}get legend(){const e=this.panels.filter((e=>e instanceof Legend));if(0==e.length){const e=new Legend;return this.add_layout(e),e}{const[t]=e;return t}}annular_wedge(...e){return this._glyph(AnnularWedge,"x,y,inner_radius,outer_radius,start_angle,end_angle",e)}annulus(...e){return this._glyph(Annulus,"x,y,inner_radius,outer_radius",e)}arc(...e){return this._glyph(Arc,"x,y,radius,start_angle,end_angle",e)}bezier(...e){return this._glyph(Bezier,"x0,y0,x1,y1,cx0,cy0,cx1,cy1",e)}circle(...e){return this._glyph(Circle,"x,y",e)}ellipse(...e){return this._glyph(Ellipse,"x,y,width,height",e)}harea(...e){return this._glyph(HArea,"x1,x2,y",e)}hbar(...e){return this._glyph(HBar,"y,height,right,left",e)}hex_tile(...e){return this._glyph(HexTile,"q,r",e)}image(...e){return this._glyph(Image$1,"color_mapper,image,rows,cols,x,y,dw,dh",e)}image_rgba(...e){return this._glyph(ImageRGBA,"image,rows,cols,x,y,dw,dh",e)}image_url(...e){return this._glyph(ImageURL,"url,x,y,w,h",e)}line(...e){return this._glyph(Line,"x,y",e)}multi_line(...e){return this._glyph(MultiLine,"xs,ys",e)}multi_polygons(...e){return this._glyph(MultiPolygons,"xs,ys",e)}oval(...e){return this._glyph(Oval,"x,y,width,height",e)}patch(...e){return this._glyph(Patch,"x,y",e)}patches(...e){return this._glyph(Patches,"xs,ys",e)}quad(...e){return this._glyph(Quad,"left,right,bottom,top",e)}quadratic(...e){return this._glyph(Quadratic,"x0,y0,x1,y1,cx,cy",e)}ray(...e){return this._glyph(Ray,"x,y,length",e)}rect(...e){return this._glyph(Rect,"x,y,width,height",e)}segment(...e){return this._glyph(Segment,"x0,y0,x1,y1",e)}spline(...e){return this._glyph(Spline,"x,y",e)}step(...e){return this._glyph(Step,"x,y,mode",e)}text(...e){return this._glyph(Text,"x,y,text",e)}varea(...e){return this._glyph(VArea,"x,y1,y2",e)}vbar(...e){return this._glyph(VBar,"x,width,top,bottom",e)}wedge(...e){return this._glyph(Wedge,"x,y,radius,start_angle,end_angle",e)}_scatter(e,t){return this._glyph(Scatter,"x,y",e,null!=t?{marker:t}:void 0)}scatter(...e){return this._scatter(e)}asterisk(...e){return this._scatter(e,"asterisk")}circle_cross(...e){return this._scatter(e,"circle_cross")}circle_dot(...e){return this._scatter(e,"circle_dot")}circle_x(...e){return this._scatter(e,"circle_x")}circle_y(...e){return this._scatter(e,"circle_y")}cross(...e){return this._scatter(e,"cross")}dash(...e){return this._scatter(e,"dash")}diamond(...e){return this._scatter(e,"diamond")}diamond_cross(...e){return this._scatter(e,"diamond_cross")}diamond_dot(...e){return this._scatter(e,"diamond_dot")}dot(...e){return this._scatter(e,"dot")}hex(...e){return this._scatter(e,"hex")}hex_dot(...e){return this._scatter(e,"hex_dot")}inverted_triangle(...e){return this._scatter(e,"inverted_triangle")}plus(...e){return this._scatter(e,"plus")}square(...e){return this._scatter(e,"square")}square_cross(...e){return this._scatter(e,"square_cross")}square_dot(...e){return this._scatter(e,"square_dot")}square_pin(...e){return this._scatter(e,"square_pin")}square_x(...e){return this._scatter(e,"square_x")}star(...e){return this._scatter(e,"star")}star_dot(...e){return this._scatter(e,"star_dot")}triangle(...e){return this._scatter(e,"triangle")}triangle_dot(...e){return this._scatter(e,"triangle_dot")}triangle_pin(...e){return this._scatter(e,"triangle_pin")}x(...e){return this._scatter(e,"x")}y(...e){return this._scatter(e,"y")}_pop_visuals(e,t,i="",n={},o={}){const r=function(e){const t=e.split("_",2);return 2==t.length?t:t.concat([""])},s=function(e){const[t,i]=r(e);return includes(["line","fill","text","global"],t)&&""!==i};n=__spreadValues({},n),hasOwnProperty$1.call(n,"text_color")||(n.text_color="black");const a={};hasOwnProperty$1.call(a,"color")||(a.color=_default_color),hasOwnProperty$1.call(a,"alpha")||(a.alpha=_default_alpha);const l={},c=new Set;for(const d of keys(e.prototype._props))if(s(d)){const s=r(d)[1];hasOwnProperty$1.call(t,i+d)?(l[d]=t[i+d],delete t[i+d]):!hasOwnProperty$1.call(e.prototype._props,s)&&hasOwnProperty$1.call(t,i+s)?l[d]=t[i+s]:hasOwnProperty$1.call(o,s)?l[d]=o[s]:hasOwnProperty$1.call(n,d)?l[d]=n[d]:hasOwnProperty$1.call(a,s)&&(l[d]=a[s]),hasOwnProperty$1.call(e.prototype._props,s)||c.add(s)}return c.forEach((function(e,n,o){delete t[i+n]})),l}_find_uniq_name(e,t){let i=1;for(;;){const n=`${t}__${i}`;if(null==e[n])return n;i+=1}}_fixup_values(e,t,i){for(const[n,o]of entries(i)){const r=e.prototype._props[n];if(null!=r&&r.type.prototype instanceof VectorSpec&&null!=o)if(isArray(o)||is_NDArray(o)){let e;null!=t[n]?t[n]!==o?(e=this._find_uniq_name(t,n),t[e]=o):e=n:(e=n,t[e]=o),i[n]={field:e}}else(isNumber(o)||isString(o))&&(i[n]={value:o})}}_glyph(e,t,i,n){const o=t.split(",");let r;if(0==i.length)r={};else if(1==i.length)r=__spreadValues({},i[0]);else{r=i.length==o.length?{}:__spreadValues({},i[i.length-1]);for(const[e,t]of enumerate(o))r[e]=i[t]}null!=n&&(r=__spreadValues(__spreadValues({},r),n));const s=(()=>{const{source:e}=r;return null==e?new ColumnDataSource:e instanceof ColumnarDataSource?e:new ColumnDataSource({data:e})})(),a=clone$1(s.data);delete r.source;const l=null!=r.view?r.view:new CDSView({source:s});delete r.view;const c=this._process_legend(r.legend,s);delete r.legend;const d=r.level;delete r.level;const h=some(Object.keys(r),(e=>startsWith(e,"selection_"))),u=some(Object.keys(r),(e=>startsWith(e,"hover_"))),p=this._pop_visuals(e,r),_=this._pop_visuals(e,r,"nonselection_",p,{alpha:.1}),f=h?this._pop_visuals(e,r,"selection_",p):{},g=u?this._pop_visuals(e,r,"hover_",p):{};this._fixup_values(e,a,p),this._fixup_values(e,a,_),this._fixup_values(e,a,f),this._fixup_values(e,a,g),this._fixup_values(e,a,r),s.data=a;const m=(e,t,i)=>new e(__spreadValues(__spreadValues({},t),i)),v=m(e,r,p),b=m(e,r,_),y=h?m(e,r,f):void 0,w=u?m(e,r,g):void 0,A=new GlyphRenderer({data_source:s,view:l,glyph:v,nonselection_glyph:b,selection_glyph:y,hover_glyph:w,level:d});return null!=c&&this._update_legend(c,A),this.add_renderers(A),A}static _get_range(e){if(null==e)return new DataRange1d;if(e instanceof Range$1)return e;if(isArray(e)){if(isArrayOf(e,isString)){return new FactorRange({factors:e})}{const[t,i]=e;return new Range1d({start:t,end:i})}}throw new Error(`unable to determine proper range for: '${e}'`)}static _get_scale(e,t){if(e instanceof DataRange1d||e instanceof Range1d)switch(t){case null:case"auto":case"linear":case"datetime":case"mercator":return new LinearScale;case"log":return new LogScale}if(e instanceof FactorRange)return new CategoricalScale;throw new Error(`unable to determine proper scale for: '${e}'`)}_process_axis_and_grid(e,t,i,n,o,r){const s=this._get_axis(e,o,r);if(null!=s){s instanceof LogAxis&&(0==r?this.x_scale=new LogScale:this.y_scale=new LogScale),s.ticker instanceof ContinuousTicker&&(s.ticker.num_minor_ticks=this._get_num_minor_ticks(s,i)),0!==n.length&&(s.axis_label=n);const e=new Grid({dimension:r,ticker:s.ticker});null!==t&&this.add_layout(s,t),this.add_layout(e)}}_get_axis(e,t,i){switch(e){case null:return null;case"linear":return new LinearAxis;case"log":return new LogAxis;case"datetime":return new DatetimeAxis;case"mercator":{const e=new MercatorAxis,t=0==i?"lon":"lat";return e.ticker.dimension=t,e.formatter.dimension=t,e}case"auto":return t instanceof FactorRange?new CategoricalAxis:new LinearAxis;default:throw new Error("shouldn't have happened")}}_get_num_minor_ticks(e,t){if(isNumber(t)){if(t<=1)throw new Error("num_minor_ticks must be > 1");return t}if(null==t)return 0;if("auto"===t)return e instanceof LogAxis?10:5;throw new Error("shouldn't have happened")}_process_tools(e){return isString(e)&&(e=e.split(/\s*,\s*/).filter((e=>e.length>0))),e.map((e=>isString(e)?Tool.from_string(e):e))}_process_legend(e,t){let i=null;return null!=e&&(isString(e)?(i={value:e},null!=t.columns()&&includes(t.columns(),e)&&(i={field:e})):i=e),i}_update_legend(e,t){const{legend:i}=this;let n=!1;for(const o of i.items)if(null!=o.label&&is_equal(o.label,e)){const e=o.label;if("value"in e){o.renderers.push(t),n=!0;break}if("field"in e&&t.data_source==o.renderers[0].data_source){o.renderers.push(t),n=!0;break}}if(!n){const n=new LegendItem({label:e,renderers:[t]});i.items.push(n)}}}function figure(e){return new Figure(e)}async function show(e,t){const i=new Document;for(const r of isArray(e)?e:[e])i.add_root(r);let n;if(await dom_ready(),null==t)n=document.body;else if(isString(t)){const e=document.querySelector(t);if(!(null!=e&&e instanceof HTMLElement))throw new Error(`'${t}' selector didn't match any elements`);n=e}else if(t instanceof HTMLElement)n=t;else{if(!("undefined"!=typeof $&&t instanceof $))throw new Error("target should be HTMLElement, string selector, $ or null");n=t[0]}const o=await add_document_standalone(i,n);return new Promise(((t,n)=>{const r=isArray(e)?o:o[0];i.is_idle?t(r):i.idle.connect((()=>t(r)))}))}Figure.__name__="Plot";var plotting=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Figure:Figure,figure:figure,show:show,gridplot:gridplot,color:color2css});class WidgetView extends HTMLBoxView{_width_policy(){return"horizontal"==this.model.orientation?super._width_policy():"fixed"}_height_policy(){return"horizontal"==this.model.orientation?"fixed":super._height_policy()}box_sizing(){const e=super.box_sizing();return"horizontal"==this.model.orientation?null==e.width&&(e.width=this.model.default_size):null==e.height&&(e.height=this.model.default_size),e}}WidgetView.__name__="WidgetView";class Widget extends HTMLBox{constructor(e){super(e)}static init_Widget(){this.define((({Number:e})=>({orientation:[Orientation,"horizontal"],default_size:[e,300]}))),this.override({margin:[5,5,5,5]})}}Widget.__name__="Widget",Widget.init_Widget();class ControlView extends WidgetView{connect_signals(){super.connect_signals();const e=this.model.properties;this.on_change(e.disabled,(()=>{for(const e of this.controls())toggle_attribute(e,"disabled",this.model.disabled)}))}}ControlView.__name__="ControlView";class Control extends Widget{constructor(e){super(e)}}Control.__name__="Control";class AbstractIconView extends DOMView{}AbstractIconView.__name__="AbstractIconView";class AbstractIcon extends Model{constructor(e){super(e)}}AbstractIcon.__name__="AbstractIcon";class AbstractButtonView extends ControlView{*controls(){yield this.button_el}async lazy_initialize(){await super.lazy_initialize();const{icon:e}=this.model;null!=e&&(this.icon_view=await build_view(e,{parent:this}))}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.render()))}remove(){null!=this.icon_view&&this.icon_view.remove(),super.remove()}styles(){return[...super.styles(),buttons_css]}_render_button(...e){return button({type:"button",disabled:this.model.disabled,class:[btn,buttons[`btn_${this.model.button_type}`]]},...e)}render(){super.render(),this.button_el=this._render_button(this.model.label),this.button_el.addEventListener("click",(()=>this.click())),null!=this.icon_view&&(""!=this.model.label?prepend(this.button_el,this.icon_view.el,nbsp()):prepend(this.button_el,this.icon_view.el),this.icon_view.render()),this.group_el=div({class:btn_group},this.button_el),this.el.appendChild(this.group_el)}click(){}}AbstractButtonView.__name__="AbstractButtonView";class AbstractButton extends Control{constructor(e){super(e)}static init_AbstractButton(){this.define((({String:e,Ref:t,Nullable:i})=>({label:[e,"Button"],icon:[i(t(AbstractIcon)),null],button_type:[ButtonType,"default"]})))}}AbstractButton.__name__="AbstractButton",AbstractButton.init_AbstractButton();const input="bk-input",input_group="bk-input-group",inline="bk-inline";var inputs_css='.bk-root .bk-input{display:inline-block;width:100%;flex-grow:1;-webkit-flex-grow:1;min-height:31px;padding:0 12px;background-color:#fff;border:1px solid #ccc;border-radius:4px;}.bk-root .bk-input:focus{border-color:#66afe9;outline:0;box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6);}.bk-root .bk-input::placeholder,.bk-root .bk-input:-ms-input-placeholder,.bk-root .bk-input::-moz-placeholder,.bk-root .bk-input::-webkit-input-placeholder{color:#999;opacity:1;}.bk-root .bk-input[disabled]{cursor:not-allowed;background-color:#eee;opacity:1;}.bk-root select:not([multiple]).bk-input,.bk-root select:not([size]).bk-input{height:auto;appearance:none;-webkit-appearance:none;background-image:url(\'data:image/svg+xml;utf8,<svg version="1.1" viewBox="0 0 25 20" xmlns="http://www.w3.org/2000/svg"><path d="M 0,0 25,0 12.5,20 Z" fill="black" /></svg>\');background-position:right 0.5em center;background-size:8px 6px;background-repeat:no-repeat;}.bk-root select[multiple].bk-input,.bk-root select[size].bk-input,.bk-root textarea.bk-input{height:auto;}.bk-root .bk-input-group{width:100%;height:100%;display:inline-flex;display:-webkit-inline-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:start;-webkit-align-items:start;flex-direction:column;-webkit-flex-direction:column;white-space:nowrap;}.bk-root .bk-input-group.bk-inline{flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-input-group.bk-inline > *:not(:first-child){margin-left:5px;}.bk-root .bk-input-group input[type="checkbox"] + span,.bk-root .bk-input-group input[type="radio"] + span{position:relative;top:-2px;margin-left:3px;}.bk-root .bk-input-group > .bk-spin-wrapper{display:inherit;width:inherit;height:inherit;position:relative;overflow:hidden;padding:0;vertical-align:middle;}.bk-root .bk-input-group > .bk-spin-wrapper input{padding-right:20px;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn{position:absolute;display:block;height:50%;min-height:0;min-width:0;width:30px;padding:0;margin:0;right:0;border:none;background:none;cursor:pointer;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn:before{content:"";display:inline-block;transform:translateY(-50%);border-left:5px solid transparent;border-right:5px solid transparent;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn.bk-spin-btn-up{top:0;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn.bk-spin-btn-up:before{border-bottom:5px solid black;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn.bk-spin-btn-up:disabled:before{border-bottom-color:grey;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn.bk-spin-btn-down{bottom:0;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn.bk-spin-btn-down:before{border-top:5px solid black;}.bk-root .bk-input-group > .bk-spin-wrapper > .bk-spin-btn.bk-spin-btn-down:disabled:before{border-top-color:grey;}';class InputWidgetView extends ControlView{*controls(){yield this.input_el}connect_signals(){super.connect_signals(),this.connect(this.model.properties.title.change,(()=>{this.label_el.textContent=this.model.title}))}styles(){return[...super.styles(),inputs_css]}render(){super.render();const{title:e}=this.model;this.label_el=label({style:{display:0==e.length?"none":""}},e),this.group_el=div({class:input_group},this.label_el),this.el.appendChild(this.group_el)}change_input(){}}InputWidgetView.__name__="InputWidgetView";class InputWidget extends Control{constructor(e){super(e)}static init_InputWidget(){this.define((({String:e})=>({title:[e,""]})))}}InputWidget.__name__="InputWidget",InputWidget.init_InputWidget();class TextLikeInputView extends InputWidgetView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.name.change,(()=>{var e;return this.input_el.name=null!=(e=this.model.name)?e:""})),this.connect(this.model.properties.value.change,(()=>this.input_el.value=this.model.value)),this.connect(this.model.properties.value_input.change,(()=>this.input_el.value=this.model.value_input)),this.connect(this.model.properties.disabled.change,(()=>this.input_el.disabled=this.model.disabled)),this.connect(this.model.properties.placeholder.change,(()=>this.input_el.placeholder=this.model.placeholder)),this.connect(this.model.properties.max_length.change,(()=>{const{max_length:e}=this.model;null!=e?this.input_el.maxLength=e:this.input_el.removeAttribute("maxLength")}))}render(){var e;super.render(),this._render_input();const{input_el:t}=this;t.name=null!=(e=this.model.name)?e:"",t.value=this.model.value,t.disabled=this.model.disabled,t.placeholder=this.model.placeholder,null!=this.model.max_length&&(t.maxLength=this.model.max_length),t.addEventListener("change",(()=>this.change_input())),t.addEventListener("input",(()=>this.change_input_value())),this.group_el.appendChild(t)}change_input(){this.model.value=this.input_el.value,super.change_input()}change_input_value(){this.model.value_input=this.input_el.value,super.change_input()}}TextLikeInputView.__name__="TextLikeInputView";class TextLikeInput extends InputWidget{constructor(e){super(e)}static init_TextLikeInput(){this.define((({Int:e,String:t,Nullable:i})=>({value:[t,""],value_input:[t,""],placeholder:[t,""],max_length:[i(e),null]})))}}TextLikeInput.__name__="TextLikeInput",TextLikeInput.init_TextLikeInput();class TextInputView extends TextLikeInputView{_render_input(){this.input_el=input$1({type:"text",class:input})}}TextInputView.__name__="TextInputView";class TextInput extends TextLikeInput{constructor(e){super(e)}static init_TextInput(){this.prototype.default_view=TextInputView}}TextInput.__name__="TextInput",TextInput.init_TextInput();class AutocompleteInputView extends TextInputView{constructor(){super(...arguments),this._open=!1,this._last_value="",this._hover_index=0}styles(){return[...super.styles(),menus_css]}render(){super.render(),this.input_el.addEventListener("keydown",(e=>this._keydown(e))),this.input_el.addEventListener("keyup",(e=>this._keyup(e))),this.menu=div({class:[menu,below$2]}),this.menu.addEventListener("click",(e=>this._menu_click(e))),this.menu.addEventListener("mouseover",(e=>this._menu_hover(e))),this.el.appendChild(this.menu),undisplay(this.menu)}change_input(){this._open&&this.menu.children.length>0&&(this.model.value=this.menu.children[this._hover_index].textContent,this.input_el.focus(),this._hide_menu()),this.model.restrict||super.change_input()}_update_completions(e){empty$1(this.menu);for(const t of e){const e=div({},t);this.menu.appendChild(e)}e.length>0&&this.menu.children[0].classList.add(active$2)}_show_menu(){if(!this._open){this._open=!0,this._hover_index=0,this._last_value=this.model.value,display(this.menu);const e=t=>{const{target:i}=t;i instanceof HTMLElement&&!this.el.contains(i)&&(document.removeEventListener("click",e),this._hide_menu())};document.addEventListener("click",e)}}_hide_menu(){this._open&&(this._open=!1,undisplay(this.menu))}_menu_click(e){e.target!=e.currentTarget&&e.target instanceof Element&&(this.model.value=e.target.textContent,this.input_el.focus(),this._hide_menu())}_menu_hover(e){if(e.target!=e.currentTarget&&e.target instanceof Element){let t=0;for(t=0;t<this.menu.children.length&&this.menu.children[t].textContent!=e.target.textContent;t++);this._bump_hover(t)}}_bump_hover(e){const t=this.menu.children.length;this._open&&t>0&&(this.menu.children[this._hover_index].classList.remove(active$2),this._hover_index=clamp(e,0,t-1),this.menu.children[this._hover_index].classList.add(active$2))}_keydown(e){}_keyup(e){switch(e.keyCode){case Keys.Enter:this.change_input();break;case Keys.Esc:this._hide_menu();break;case Keys.Up:this._bump_hover(this._hover_index-1);break;case Keys.Down:this._bump_hover(this._hover_index+1);break;default:{const e=this.input_el.value;if(e.length<this.model.min_characters)return void this._hide_menu();const t=[],{case_sensitive:i}=this.model;let n;n=i?e=>e:e=>e.toLowerCase();for(const o of this.model.completions)n(o).startsWith(n(e))&&t.push(o);this._update_completions(t),0==t.length?this._hide_menu():this._show_menu()}}}}AutocompleteInputView.__name__="AutocompleteInputView";class AutocompleteInput extends TextInput{constructor(e){super(e)}static init_AutocompleteInput(){this.prototype.default_view=AutocompleteInputView,this.define((({Boolean:e,Int:t,String:i,Array:n})=>({completions:[n(i),[]],min_characters:[t,2],case_sensitive:[e,!0],restrict:[e,!0]})))}}AutocompleteInput.__name__="AutocompleteInput",AutocompleteInput.init_AutocompleteInput();class ButtonView extends AbstractButtonView{click(){this.model.trigger_event(new ButtonClick),super.click()}}ButtonView.__name__="ButtonView";class Button extends AbstractButton{constructor(e){super(e)}static init_Button(){this.prototype.default_view=ButtonView,this.override({label:"Button"})}}Button.__name__="Button",Button.init_Button();class ButtonGroupView extends ControlView{*controls(){yield*this._buttons}connect_signals(){super.connect_signals();const e=this.model.properties;this.on_change(e.button_type,(()=>this.render())),this.on_change(e.labels,(()=>this.render())),this.on_change(e.active,(()=>this._update_active()))}styles(){return[...super.styles(),buttons_css]}render(){super.render(),this._buttons=this.model.labels.map(((e,t)=>{const i=div({class:[btn,buttons[`btn_${this.model.button_type}`]],disabled:this.model.disabled},e);return i.addEventListener("click",(()=>this.change_active(t))),i})),this._update_active();const e=div({class:btn_group},this._buttons);this.el.appendChild(e)}}ButtonGroupView.__name__="ButtonGroupView";class ButtonGroup extends Control{constructor(e){super(e)}static init_ButtonGroup(){this.define((({String:e,Array:t})=>({labels:[t(e),[]],button_type:[ButtonType,"default"]})))}}ButtonGroup.__name__="ButtonGroup",ButtonGroup.init_ButtonGroup();class CheckboxButtonGroupView extends ButtonGroupView{get active(){return new Set(this.model.active)}change_active(e){const{active:t}=this;t.has(e)?t.delete(e):t.add(e),this.model.active=[...t].sort()}_update_active(){const{active:e}=this;this._buttons.forEach(((t,i)=>{classes(t).toggle(active,e.has(i))}))}}CheckboxButtonGroupView.__name__="CheckboxButtonGroupView";class CheckboxButtonGroup extends ButtonGroup{constructor(e){super(e)}static init_CheckboxButtonGroup(){this.prototype.default_view=CheckboxButtonGroupView,this.define((({Int:e,Array:t})=>({active:[t(e),[]]})))}}CheckboxButtonGroup.__name__="CheckboxButtonGroup",CheckboxButtonGroup.init_CheckboxButtonGroup();class InputGroupView extends ControlView{*controls(){yield*this._inputs}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.render()))}styles(){return[...super.styles(),inputs_css]}}InputGroupView.__name__="InputGroupView";class InputGroup extends Control{constructor(e){super(e)}}InputGroup.__name__="InputGroup";class CheckboxGroupView extends InputGroupView{render(){super.render();const e=div({class:[input_group,this.model.inline?inline:null]});this.el.appendChild(e);const{active:t,labels:i}=this.model;this._inputs=[];for(let n=0;n<i.length;n++){const o=input$1({type:"checkbox",value:`${n}`});o.addEventListener("change",(()=>this.change_active(n))),this._inputs.push(o),this.model.disabled&&(o.disabled=!0),includes(t,n)&&(o.checked=!0);const r=label({},o,span({},i[n]));e.appendChild(r)}}change_active(e){const t=new Set(this.model.active);t.has(e)?t.delete(e):t.add(e),this.model.active=[...t].sort()}}CheckboxGroupView.__name__="CheckboxGroupView";class CheckboxGroup extends InputGroup{constructor(e){super(e)}static init_CheckboxGroup(){this.prototype.default_view=CheckboxGroupView,this.define((({Boolean:e,Int:t,String:i,Array:n})=>({active:[n(t),[]],labels:[n(i),[]],inline:[e,!1]})))}}CheckboxGroup.__name__="CheckboxGroup",CheckboxGroup.init_CheckboxGroup();class ColorPickerView extends InputWidgetView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.name.change,(()=>{var e;return this.input_el.name=null!=(e=this.model.name)?e:""})),this.connect(this.model.properties.color.change,(()=>this.input_el.value=color2hexrgb(this.model.color))),this.connect(this.model.properties.disabled.change,(()=>this.input_el.disabled=this.model.disabled))}render(){super.render(),this.input_el=input$1({type:"color",class:input,name:this.model.name,value:this.model.color,disabled:this.model.disabled}),this.input_el.addEventListener("change",(()=>this.change_input())),this.group_el.appendChild(this.input_el)}change_input(){this.model.color=this.input_el.value,super.change_input()}}ColorPickerView.__name__="ColorPickerView";class ColorPicker extends InputWidget{constructor(e){super(e)}static init_ColorPicker(){this.prototype.default_view=ColorPickerView,this.define((({Color:e})=>({color:[e,"#000000"]})))}}ColorPicker.__name__="ColorPicker",ColorPicker.init_ColorPicker();const HOOKS=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],defaults={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>"undefined"!=typeof console&&console.warn(e),getWeek:e=>{const t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var i=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-i.getTime())/864e5-3+(i.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},english={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{const t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},pad=(e,t=2)=>`000${e}`.slice(-1*t),int=e=>!0===e?1:0;function debounce$1(e,t){let i;return function(){clearTimeout(i),i=setTimeout((()=>e.apply(this,arguments)),t)}}const arrayify=e=>e instanceof Array?e:[e];function toggleClass(e,t,i){if(!0===i)return e.classList.add(t);e.classList.remove(t)}function createElement(e,t,i){const n=window.document.createElement(e);return t=t||"",i=i||"",n.className=t,void 0!==i&&(n.textContent=i),n}function clearNode(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function findParent(e,t){return t(e)?e:e.parentNode?findParent(e.parentNode,t):void 0}function createNumberInput(e,t){const i=createElement("div","numInputWrapper"),n=createElement("input","numInput "+e),o=createElement("span","arrowUp"),r=createElement("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?n.type="number":(n.type="text",n.pattern="\\d*"),void 0!==t)for(const s in t)n.setAttribute(s,t[s]);return i.appendChild(n),i.appendChild(o),i.appendChild(r),i}function getEventTarget(e){try{if("function"==typeof e.composedPath){return e.composedPath()[0]}return e.target}catch(t){return e.target}}const doNothing=()=>{},monthToStr=(e,t,i)=>i.months[t?"shorthand":"longhand"][e],revFormat={D:doNothing,F:function(e,t,i){e.setMonth(i.months.longhand.indexOf(t))},G:(e,t)=>{e.setHours(parseFloat(t))},H:(e,t)=>{e.setHours(parseFloat(t))},J:(e,t)=>{e.setDate(parseFloat(t))},K:(e,t,i)=>{e.setHours(e.getHours()%12+12*int(new RegExp(i.amPM[1],"i").test(t)))},M:function(e,t,i){e.setMonth(i.months.shorthand.indexOf(t))},S:(e,t)=>{e.setSeconds(parseFloat(t))},U:(e,t)=>new Date(1e3*parseFloat(t)),W:function(e,t,i){const n=parseInt(t),o=new Date(e.getFullYear(),0,2+7*(n-1),0,0,0,0);return o.setDate(o.getDate()-o.getDay()+i.firstDayOfWeek),o},Y:(e,t)=>{e.setFullYear(parseFloat(t))},Z:(e,t)=>new Date(t),d:(e,t)=>{e.setDate(parseFloat(t))},h:(e,t)=>{e.setHours(parseFloat(t))},i:(e,t)=>{e.setMinutes(parseFloat(t))},j:(e,t)=>{e.setDate(parseFloat(t))},l:doNothing,m:(e,t)=>{e.setMonth(parseFloat(t)-1)},n:(e,t)=>{e.setMonth(parseFloat(t)-1)},s:(e,t)=>{e.setSeconds(parseFloat(t))},u:(e,t)=>new Date(parseFloat(t)),w:doNothing,y:(e,t)=>{e.setFullYear(2e3+parseFloat(t))}},tokenRegex={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},formats={Z:e=>e.toISOString(),D:function(e,t,i){return t.weekdays.shorthand[formats.w(e,t,i)]},F:function(e,t,i){return monthToStr(formats.n(e,t,i)-1,!1,t)},G:function(e,t,i){return pad(formats.h(e,t,i))},H:e=>pad(e.getHours()),J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:(e,t)=>t.amPM[int(e.getHours()>11)],M:function(e,t){return monthToStr(e.getMonth(),!0,t)},S:e=>pad(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,t,i){return i.getWeek(e)},Y:e=>pad(e.getFullYear(),4),d:e=>pad(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>pad(e.getMinutes()),j:e=>e.getDate(),l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:e=>pad(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)},createDateFormatter=({config:e=defaults,l10n:t=english,isMobile:i=!1})=>(n,o,r)=>{const s=r||t;return void 0===e.formatDate||i?o.split("").map(((t,i,o)=>formats[t]&&"\\"!==o[i-1]?formats[t](n,s,e):"\\"!==t?t:"")).join(""):e.formatDate(n,o,s)},createDateParser=({config:e=defaults,l10n:t=english})=>(i,n,o,r)=>{if(0!==i&&!i)return;const s=r||t;let a;const l=i;if(i instanceof Date)a=new Date(i.getTime());else if("string"!=typeof i&&void 0!==i.toFixed)a=new Date(i);else if("string"==typeof i){const t=n||(e||defaults).dateFormat,r=String(i).trim();if("today"===r)a=new Date,o=!0;else if(/Z$/.test(r)||/GMT$/.test(r))a=new Date(i);else if(e&&e.parseDate)a=e.parseDate(i,t);else{a=e&&e.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);let n,o=[];for(let e=0,r=0,l="";e<t.length;e++){const c=t[e],d="\\"===c,h="\\"===t[e-1]||d;if(tokenRegex[c]&&!h){l+=tokenRegex[c];const e=new RegExp(l).exec(i);e&&(n=!0)&&o["Y"!==c?"push":"unshift"]({fn:revFormat[c],val:e[++r]})}else d||(l+=".");o.forEach((({fn:e,val:t})=>a=e(a,t,s)||a))}a=n?a:void 0}}if(a instanceof Date&&!isNaN(a.getTime()))return!0===o&&a.setHours(0,0,0,0),a;e.errorHandler(new Error(`Invalid date provided: ${l}`))};function compareDates(e,t,i=!0){return!1!==i?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}const isBetween=(e,t,i)=>e>Math.min(t,i)&&e<Math.max(t,i),duration={DAY:864e5};function getDefaultHours(e){let t=e.defaultHour,i=e.defaultMinute,n=e.defaultSeconds;if(void 0!==e.minDate){const o=e.minDate.getHours(),r=e.minDate.getMinutes(),s=e.minDate.getSeconds();t<o&&(t=o),t===o&&i<r&&(i=r),t===o&&i===r&&n<s&&(n=e.minDate.getSeconds())}if(void 0!==e.maxDate){const o=e.maxDate.getHours(),r=e.maxDate.getMinutes();t=Math.min(t,o),t===o&&(i=Math.min(r,i)),t===o&&i===r&&(n=e.maxDate.getSeconds())}return{hours:t,minutes:i,seconds:n}}"function"!=typeof Object.assign&&(Object.assign=function(e,...t){if(!e)throw TypeError("Cannot convert undefined or null to object");for(const i of t)i&&Object.keys(i).forEach((t=>e[t]=i[t]));return e});const DEBOUNCED_CHANGE_MS=300;function FlatpickrInstance(e,t){const i={config:Object.assign(Object.assign({},defaults),flatpickr.defaultConfig),l10n:english};function n(e){return e.bind(i)}function o(){const e=i.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==i.calendarContainer&&(i.calendarContainer.style.visibility="hidden",i.calendarContainer.style.display="block"),void 0!==i.daysContainer){const t=(i.days.offsetWidth+1)*e.showMonths;i.daysContainer.style.width=t+"px",i.calendarContainer.style.width=t+(void 0!==i.weekWrapper?i.weekWrapper.offsetWidth:0)+"px",i.calendarContainer.style.removeProperty("visibility"),i.calendarContainer.style.removeProperty("display")}}))}function r(e){if(0===i.selectedDates.length){const e=void 0===i.config.minDate||compareDates(new Date,i.config.minDate)>=0?new Date:new Date(i.config.minDate.getTime()),t=getDefaultHours(i.config);e.setHours(t.hours,t.minutes,t.seconds,e.getMilliseconds()),i.selectedDates=[e],i.latestSelectedDateObj=e}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();const t="keydown"===e.type,n=getEventTarget(e),o=n;void 0!==i.amPM&&n===i.amPM&&(i.amPM.textContent=i.l10n.amPM[int(i.amPM.textContent===i.l10n.amPM[0])]);const r=parseFloat(o.getAttribute("min")),s=parseFloat(o.getAttribute("max")),a=parseFloat(o.getAttribute("step")),l=parseInt(o.value,10),c=e.delta||(t?38===e.which?1:-1:0);let d=l+a*c;if(void 0!==o.value&&2===o.value.length){const e=o===i.hourElement,t=o===i.minuteElement;d<r?(d=s+d+int(!e)+(int(e)&&int(!i.amPM)),t&&_(void 0,-1,i.hourElement)):d>s&&(d=o===i.hourElement?d-s-int(!i.amPM):r,t&&_(void 0,1,i.hourElement)),i.amPM&&e&&(1===a?d+l===23:Math.abs(d-l)>a)&&(i.amPM.textContent=i.l10n.amPM[int(i.amPM.textContent===i.l10n.amPM[0])]),o.value=pad(d)}}(e);const t=i._input.value;s(),J(),i._input.value!==t&&i._debouncedChange()}function s(){if(void 0===i.hourElement||void 0===i.minuteElement)return;let e=(parseInt(i.hourElement.value.slice(-2),10)||0)%24,t=(parseInt(i.minuteElement.value,10)||0)%60,n=void 0!==i.secondElement?(parseInt(i.secondElement.value,10)||0)%60:0;var o,r;void 0!==i.amPM&&(o=e,r=i.amPM.textContent,e=o%12+12*int(r===i.l10n.amPM[1]));const s=void 0!==i.config.minTime||i.config.minDate&&i.minDateHasTime&&i.latestSelectedDateObj&&0===compareDates(i.latestSelectedDateObj,i.config.minDate,!0);if(void 0!==i.config.maxTime||i.config.maxDate&&i.maxDateHasTime&&i.latestSelectedDateObj&&0===compareDates(i.latestSelectedDateObj,i.config.maxDate,!0)){const o=void 0!==i.config.maxTime?i.config.maxTime:i.config.maxDate;e=Math.min(e,o.getHours()),e===o.getHours()&&(t=Math.min(t,o.getMinutes())),t===o.getMinutes()&&(n=Math.min(n,o.getSeconds()))}if(s){const o=void 0!==i.config.minTime?i.config.minTime:i.config.minDate;e=Math.max(e,o.getHours()),e===o.getHours()&&t<o.getMinutes()&&(t=o.getMinutes()),t===o.getMinutes()&&(n=Math.max(n,o.getSeconds()))}l(e,t,n)}function a(e){const t=e||i.latestSelectedDateObj;t&&l(t.getHours(),t.getMinutes(),t.getSeconds())}function l(e,t,n){void 0!==i.latestSelectedDateObj&&i.latestSelectedDateObj.setHours(e%24,t,n||0,0),i.hourElement&&i.minuteElement&&!i.isMobile&&(i.hourElement.value=pad(i.config.time_24hr?e:(12+e)%12+12*int(e%12==0)),i.minuteElement.value=pad(t),void 0!==i.amPM&&(i.amPM.textContent=i.l10n.amPM[int(e>=12)]),void 0!==i.secondElement&&(i.secondElement.value=pad(n)))}function c(e){const t=getEventTarget(e),i=parseInt(t.value)+(e.delta||0);(i/1e3>1||"Enter"===e.key&&!/[^\d]/.test(i.toString()))&&E(i)}function d(e,t,n,o){return t instanceof Array?t.forEach((t=>d(e,t,n,o))):e instanceof Array?e.forEach((e=>d(e,t,n,o))):(e.addEventListener(t,n,o),void i._handlers.push({remove:()=>e.removeEventListener(t,n)}))}function h(){W("onChange")}function u(e,t){const n=void 0!==e?i.parseDate(e):i.latestSelectedDateObj||(i.config.minDate&&i.config.minDate>i.now?i.config.minDate:i.config.maxDate&&i.config.maxDate<i.now?i.config.maxDate:i.now),o=i.currentYear,r=i.currentMonth;try{void 0!==n&&(i.currentYear=n.getFullYear(),i.currentMonth=n.getMonth())}catch(s){s.message="Invalid date supplied: "+n,i.config.errorHandler(s)}t&&i.currentYear!==o&&(W("onYearChange"),w()),!t||i.currentYear===o&&i.currentMonth===r||W("onMonthChange"),i.redraw()}function p(e){const t=getEventTarget(e);~t.className.indexOf("arrow")&&_(e,t.classList.contains("arrowUp")?1:-1)}function _(e,t,i){const n=e&&getEventTarget(e),o=i||n&&n.parentNode&&n.parentNode.firstChild,r=Y("increment");r.delta=t,o&&o.dispatchEvent(r)}function f(e,t,n,o){const r=P(t,!0),s=createElement("span","flatpickr-day "+e,t.getDate().toString());return s.dateObj=t,s.$i=o,s.setAttribute("aria-label",i.formatDate(t,i.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===compareDates(t,i.now)&&(i.todayDateElem=s,s.classList.add("today"),s.setAttribute("aria-current","date")),r?(s.tabIndex=-1,q(t)&&(s.classList.add("selected"),i.selectedDateElem=s,"range"===i.config.mode&&(toggleClass(s,"startRange",i.selectedDates[0]&&0===compareDates(t,i.selectedDates[0],!0)),toggleClass(s,"endRange",i.selectedDates[1]&&0===compareDates(t,i.selectedDates[1],!0)),"nextMonthDay"===e&&s.classList.add("inRange")))):s.classList.add("flatpickr-disabled"),"range"===i.config.mode&&function(e){return!("range"!==i.config.mode||i.selectedDates.length<2)&&(compareDates(e,i.selectedDates[0])>=0&&compareDates(e,i.selectedDates[1])<=0)}(t)&&!q(t)&&s.classList.add("inRange"),i.weekNumbers&&1===i.config.showMonths&&"prevMonthDay"!==e&&n%7==1&&i.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+i.config.getWeek(t)+"</span>"),W("onDayCreate",s),s}function g(e){e.focus(),"range"===i.config.mode&&B(e)}function m(e){const t=e>0?0:i.config.showMonths-1,n=e>0?i.config.showMonths:-1;for(let o=t;o!=n;o+=e){const t=i.daysContainer.children[o],n=e>0?0:t.children.length-1,r=e>0?t.children.length:-1;for(let i=n;i!=r;i+=e){const e=t.children[i];if(-1===e.className.indexOf("hidden")&&P(e.dateObj))return e}}}function v(e,t){const n=M(document.activeElement||document.body),o=void 0!==e?e:n?document.activeElement:void 0!==i.selectedDateElem&&M(i.selectedDateElem)?i.selectedDateElem:void 0!==i.todayDateElem&&M(i.todayDateElem)?i.todayDateElem:m(t>0?1:-1);void 0===o?i._input.focus():n?function(e,t){const n=-1===e.className.indexOf("Month")?e.dateObj.getMonth():i.currentMonth,o=t>0?i.config.showMonths:-1,r=t>0?1:-1;for(let s=n-i.currentMonth;s!=o;s+=r){const o=i.daysContainer.children[s],a=n-i.currentMonth===s?e.$i+t:t<0?o.children.length-1:0,l=o.children.length;for(let i=a;i>=0&&i<l&&i!=(t>0?l:-1);i+=r){const n=o.children[i];if(-1===n.className.indexOf("hidden")&&P(n.dateObj)&&Math.abs(e.$i-i)>=Math.abs(t))return g(n)}}i.changeMonth(r),v(m(r),0)}(o,t):g(o)}function b(e,t){const n=(new Date(e,t,1).getDay()-i.l10n.firstDayOfWeek+7)%7,o=i.utils.getDaysInMonth((t-1+12)%12,e),r=i.utils.getDaysInMonth(t,e),s=window.document.createDocumentFragment(),a=i.config.showMonths>1,l=a?"prevMonthDay hidden":"prevMonthDay",c=a?"nextMonthDay hidden":"nextMonthDay";let d=o+1-n,h=0;for(;d<=o;d++,h++)s.appendChild(f(l,new Date(e,t-1,d),d,h));for(d=1;d<=r;d++,h++)s.appendChild(f("",new Date(e,t,d),d,h));for(let p=r+1;p<=42-n&&(1===i.config.showMonths||h%7!=0);p++,h++)s.appendChild(f(c,new Date(e,t+1,p%r),p,h));const u=createElement("div","dayContainer");return u.appendChild(s),u}function y(){if(void 0===i.daysContainer)return;clearNode(i.daysContainer),i.weekNumbers&&clearNode(i.weekNumbers);const e=document.createDocumentFragment();for(let t=0;t<i.config.showMonths;t++){const n=new Date(i.currentYear,i.currentMonth,1);n.setMonth(i.currentMonth+t),e.appendChild(b(n.getFullYear(),n.getMonth()))}i.daysContainer.appendChild(e),i.days=i.daysContainer.firstChild,"range"===i.config.mode&&1===i.selectedDates.length&&B()}function w(){if(i.config.showMonths>1||"dropdown"!==i.config.monthSelectorType)return;const e=function(e){return!(void 0!==i.config.minDate&&i.currentYear===i.config.minDate.getFullYear()&&e<i.config.minDate.getMonth())&&!(void 0!==i.config.maxDate&&i.currentYear===i.config.maxDate.getFullYear()&&e>i.config.maxDate.getMonth())};i.monthsDropdownContainer.tabIndex=-1,i.monthsDropdownContainer.innerHTML="";for(let t=0;t<12;t++){if(!e(t))continue;const n=createElement("option","flatpickr-monthDropdown-month");n.value=new Date(i.currentYear,t).getMonth().toString(),n.textContent=monthToStr(t,i.config.shorthandCurrentMonth,i.l10n),n.tabIndex=-1,i.currentMonth===t&&(n.selected=!0),i.monthsDropdownContainer.appendChild(n)}}function A(){const e=createElement("div","flatpickr-month"),t=window.document.createDocumentFragment();let n;i.config.showMonths>1||"static"===i.config.monthSelectorType?n=createElement("span","cur-month"):(i.monthsDropdownContainer=createElement("select","flatpickr-monthDropdown-months"),i.monthsDropdownContainer.setAttribute("aria-label",i.l10n.monthAriaLabel),d(i.monthsDropdownContainer,"change",(e=>{const t=getEventTarget(e),n=parseInt(t.value,10);i.changeMonth(n-i.currentMonth),W("onMonthChange")})),w(),n=i.monthsDropdownContainer);const o=createNumberInput("cur-year",{tabindex:"-1"}),r=o.getElementsByTagName("input")[0];r.setAttribute("aria-label",i.l10n.yearAriaLabel),i.config.minDate&&r.setAttribute("min",i.config.minDate.getFullYear().toString()),i.config.maxDate&&(r.setAttribute("max",i.config.maxDate.getFullYear().toString()),r.disabled=!!i.config.minDate&&i.config.minDate.getFullYear()===i.config.maxDate.getFullYear());const s=createElement("div","flatpickr-current-month");return s.appendChild(n),s.appendChild(o),t.appendChild(s),e.appendChild(t),{container:e,yearElement:r,monthElement:n}}function x(){clearNode(i.monthNav),i.monthNav.appendChild(i.prevMonthNav),i.config.showMonths&&(i.yearElements=[],i.monthElements=[]);for(let e=i.config.showMonths;e--;){const e=A();i.yearElements.push(e.yearElement),i.monthElements.push(e.monthElement),i.monthNav.appendChild(e.container)}i.monthNav.appendChild(i.nextMonthNav)}function k(){i.weekdayContainer?clearNode(i.weekdayContainer):i.weekdayContainer=createElement("div","flatpickr-weekdays");for(let e=i.config.showMonths;e--;){const e=createElement("div","flatpickr-weekdaycontainer");i.weekdayContainer.appendChild(e)}return C(),i.weekdayContainer}function C(){if(!i.weekdayContainer)return;const e=i.l10n.firstDayOfWeek;let t=[...i.l10n.weekdays.shorthand];e>0&&e<t.length&&(t=[...t.splice(e,t.length),...t.splice(0,e)]);for(let n=i.config.showMonths;n--;)i.weekdayContainer.children[n].innerHTML=`\n      <span class='flatpickr-weekday'>\n        ${t.join("</span><span class='flatpickr-weekday'>")}\n      </span>\n      `}function S(e,t=!0){const n=t?e:e-i.currentMonth;n<0&&!0===i._hidePrevMonthArrow||n>0&&!0===i._hideNextMonthArrow||(i.currentMonth+=n,(i.currentMonth<0||i.currentMonth>11)&&(i.currentYear+=i.currentMonth>11?1:-1,i.currentMonth=(i.currentMonth+12)%12,W("onYearChange"),w()),y(),W("onMonthChange"),X())}function T(e){return!(!i.config.appendTo||!i.config.appendTo.contains(e))||i.calendarContainer.contains(e)}function R(e){if(i.isOpen&&!i.config.inline){const t=getEventTarget(e),n=T(t),o=t===i.input||t===i.altInput||i.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(i.input)||~e.path.indexOf(i.altInput)),s="blur"===e.type?o&&e.relatedTarget&&!T(e.relatedTarget):!o&&!n&&!T(e.relatedTarget),a=!i.config.ignoredFocusElements.some((e=>e.contains(t)));s&&a&&(void 0!==i.timeContainer&&void 0!==i.minuteElement&&void 0!==i.hourElement&&""!==i.input.value&&void 0!==i.input.value&&r(),i.close(),i.config&&"range"===i.config.mode&&1===i.selectedDates.length&&(i.clear(!1),i.redraw()))}}function E(e){if(!e||i.config.minDate&&e<i.config.minDate.getFullYear()||i.config.maxDate&&e>i.config.maxDate.getFullYear())return;const t=e,n=i.currentYear!==t;i.currentYear=t||i.currentYear,i.config.maxDate&&i.currentYear===i.config.maxDate.getFullYear()?i.currentMonth=Math.min(i.config.maxDate.getMonth(),i.currentMonth):i.config.minDate&&i.currentYear===i.config.minDate.getFullYear()&&(i.currentMonth=Math.max(i.config.minDate.getMonth(),i.currentMonth)),n&&(i.redraw(),W("onYearChange"),w())}function P(e,t=!0){var n;const o=i.parseDate(e,void 0,t);if(i.config.minDate&&o&&compareDates(o,i.config.minDate,void 0!==t?t:!i.minDateHasTime)<0||i.config.maxDate&&o&&compareDates(o,i.config.maxDate,void 0!==t?t:!i.maxDateHasTime)>0)return!1;if(!i.config.enable&&0===i.config.disable.length)return!0;if(void 0===o)return!1;const r=!!i.config.enable,s=null!==(n=i.config.enable)&&void 0!==n?n:i.config.disable;for(let a,l=0;l<s.length;l++){if(a=s[l],"function"==typeof a&&a(o))return r;if(a instanceof Date&&void 0!==o&&a.getTime()===o.getTime())return r;if("string"==typeof a){const e=i.parseDate(a,void 0,!0);return e&&e.getTime()===o.getTime()?r:!r}if("object"==typeof a&&void 0!==o&&a.from&&a.to&&o.getTime()>=a.from.getTime()&&o.getTime()<=a.to.getTime())return r}return!r}function M(e){return void 0!==i.daysContainer&&(-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&i.daysContainer.contains(e))}function D(e){!(e.target===i._input)||!(i.selectedDates.length>0||i._input.value.length>0)||e.relatedTarget&&T(e.relatedTarget)||i.setDate(i._input.value,!0,e.target===i.altInput?i.config.altFormat:i.config.dateFormat)}function I(t){const n=getEventTarget(t),o=i.config.wrap?e.contains(n):n===i._input,a=i.config.allowInput,l=i.isOpen&&(!a||!o),c=i.config.inline&&o&&!a;if(13===t.keyCode&&o){if(a)return i.setDate(i._input.value,!0,n===i.altInput?i.config.altFormat:i.config.dateFormat),n.blur();i.open()}else if(T(n)||l||c){const e=!!i.timeContainer&&i.timeContainer.contains(n);switch(t.keyCode){case 13:e?(t.preventDefault(),r(),F()):G(t);break;case 27:t.preventDefault(),F();break;case 8:case 46:o&&!i.config.allowInput&&(t.preventDefault(),i.clear());break;case 37:case 39:if(e||o)i.hourElement&&i.hourElement.focus();else if(t.preventDefault(),void 0!==i.daysContainer&&(!1===a||document.activeElement&&M(document.activeElement))){const e=39===t.keyCode?1:-1;t.ctrlKey?(t.stopPropagation(),S(e),v(m(1),0)):v(void 0,e)}break;case 38:case 40:t.preventDefault();const s=40===t.keyCode?1:-1;i.daysContainer&&void 0!==n.$i||n===i.input||n===i.altInput?t.ctrlKey?(t.stopPropagation(),E(i.currentYear-s),v(m(1),0)):e||v(void 0,7*s):n===i.currentYearElement?E(i.currentYear-s):i.config.enableTime&&(!e&&i.hourElement&&i.hourElement.focus(),r(t),i._debouncedChange());break;case 9:if(e){const e=[i.hourElement,i.minuteElement,i.secondElement,i.amPM].concat(i.pluginElements).filter((e=>e)),o=e.indexOf(n);if(-1!==o){const n=e[o+(t.shiftKey?-1:1)];t.preventDefault(),(n||i._input).focus()}}else!i.config.noCalendar&&i.daysContainer&&i.daysContainer.contains(n)&&t.shiftKey&&(t.preventDefault(),i._input.focus())}}if(void 0!==i.amPM&&n===i.amPM)switch(t.key){case i.l10n.amPM[0].charAt(0):case i.l10n.amPM[0].charAt(0).toLowerCase():i.amPM.textContent=i.l10n.amPM[0],s(),J();break;case i.l10n.amPM[1].charAt(0):case i.l10n.amPM[1].charAt(0).toLowerCase():i.amPM.textContent=i.l10n.amPM[1],s(),J()}(o||T(n))&&W("onKeyDown",t)}function B(e){if(1!==i.selectedDates.length||e&&(!e.classList.contains("flatpickr-day")||e.classList.contains("flatpickr-disabled")))return;const t=e?e.dateObj.getTime():i.days.firstElementChild.dateObj.getTime(),n=i.parseDate(i.selectedDates[0],void 0,!0).getTime(),o=Math.min(t,i.selectedDates[0].getTime()),r=Math.max(t,i.selectedDates[0].getTime());let s=!1,a=0,l=0;for(let i=o;i<r;i+=duration.DAY)P(new Date(i),!0)||(s=s||i>o&&i<r,i<n&&(!a||i>a)?a=i:i>n&&(!l||i<l)&&(l=i));for(let c=0;c<i.config.showMonths;c++){const o=i.daysContainer.children[c];for(let r=0,c=o.children.length;r<c;r++){const c=o.children[r],d=c.dateObj.getTime(),h=a>0&&d<a||l>0&&d>l;h?(c.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((e=>{c.classList.remove(e)}))):s&&!h||(["startRange","inRange","endRange","notAllowed"].forEach((e=>{c.classList.remove(e)})),void 0!==e&&(e.classList.add(t<=i.selectedDates[0].getTime()?"startRange":"endRange"),n<t&&d===n?c.classList.add("startRange"):n>t&&d===n&&c.classList.add("endRange"),d>=a&&(0===l||d<=l)&&isBetween(d,n,t)&&c.classList.add("inRange")))}}}function z(){!i.isOpen||i.config.static||i.config.inline||V()}function L(e){return t=>{const n=i.config[`_${e}Date`]=i.parseDate(t,i.config.dateFormat),o=i.config[`_${"min"===e?"max":"min"}Date`];void 0!==n&&(i["min"===e?"minDateHasTime":"maxDateHasTime"]=n.getHours()>0||n.getMinutes()>0||n.getSeconds()>0),i.selectedDates&&(i.selectedDates=i.selectedDates.filter((e=>P(e))),i.selectedDates.length||"min"!==e||a(n),J()),i.daysContainer&&(O(),void 0!==n?i.currentYearElement[e]=n.getFullYear().toString():i.currentYearElement.removeAttribute(e),i.currentYearElement.disabled=!!o&&void 0!==n&&o.getFullYear()===n.getFullYear())}}function N(){return i.config.wrap?e.querySelector("[data-input]"):e}function $(){"object"!=typeof i.config.locale&&void 0===flatpickr.l10ns[i.config.locale]&&i.config.errorHandler(new Error(`flatpickr: invalid locale ${i.config.locale}`)),i.l10n=Object.assign(Object.assign({},flatpickr.l10ns.default),"object"==typeof i.config.locale?i.config.locale:"default"!==i.config.locale?flatpickr.l10ns[i.config.locale]:void 0),tokenRegex.K=`(${i.l10n.amPM[0]}|${i.l10n.amPM[1]}|${i.l10n.amPM[0].toLowerCase()}|${i.l10n.amPM[1].toLowerCase()})`;void 0===Object.assign(Object.assign({},t),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr&&void 0===flatpickr.defaultConfig.time_24hr&&(i.config.time_24hr=i.l10n.time_24hr),i.formatDate=createDateFormatter(i),i.parseDate=createDateParser({config:i.config,l10n:i.l10n})}function V(e){if("function"==typeof i.config.position)return void i.config.position(i,e);if(void 0===i.calendarContainer)return;W("onPreCalendarPosition");const t=e||i._positionElement,n=Array.prototype.reduce.call(i.calendarContainer.children,((e,t)=>e+t.offsetHeight),0),o=i.calendarContainer.offsetWidth,r=i.config.position.split(" "),s=r[0],a=r.length>1?r[1]:null,l=t.getBoundingClientRect(),c=window.innerHeight-l.bottom,d="above"===s||"below"!==s&&c<n&&l.top>n,h=window.pageYOffset+l.top+(d?-n-2:t.offsetHeight+2);if(toggleClass(i.calendarContainer,"arrowTop",!d),toggleClass(i.calendarContainer,"arrowBottom",d),i.config.inline)return;let u=window.pageXOffset+l.left,p=!1,_=!1;"center"===a?(u-=(o-l.width)/2,p=!0):"right"===a&&(u-=o-l.width,_=!0),toggleClass(i.calendarContainer,"arrowLeft",!p&&!_),toggleClass(i.calendarContainer,"arrowCenter",p),toggleClass(i.calendarContainer,"arrowRight",_);const f=window.document.body.offsetWidth-(window.pageXOffset+l.right),g=u+o>window.document.body.offsetWidth,m=f+o>window.document.body.offsetWidth;if(toggleClass(i.calendarContainer,"rightMost",g),!i.config.static)if(i.calendarContainer.style.top=`${h}px`,g)if(m){const e=function(){let e=null;for(let i=0;i<document.styleSheets.length;i++){const n=document.styleSheets[i];try{n.cssRules}catch(t){continue}e=n;break}return null!=e?e:function(){const e=document.createElement("style");return document.head.appendChild(e),e.sheet}()}();if(void 0===e)return;const t=window.document.body.offsetWidth,n=Math.max(0,t/2-o/2),r=".flatpickr-calendar.centerMost:before",s=".flatpickr-calendar.centerMost:after",a=e.cssRules.length,c=`{left:${l.left}px;right:auto;}`;toggleClass(i.calendarContainer,"rightMost",!1),toggleClass(i.calendarContainer,"centerMost",!0),e.insertRule(`${r},${s}${c}`,a),i.calendarContainer.style.left=`${n}px`,i.calendarContainer.style.right="auto"}else i.calendarContainer.style.left="auto",i.calendarContainer.style.right=`${f}px`;else i.calendarContainer.style.left=`${u}px`,i.calendarContainer.style.right="auto"}function O(){i.config.noCalendar||i.isMobile||(w(),X(),y())}function F(){i._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(i.close,0):i.close()}function G(e){e.preventDefault(),e.stopPropagation();const t=findParent(getEventTarget(e),(e=>e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")));if(void 0===t)return;const n=t,o=i.latestSelectedDateObj=new Date(n.dateObj.getTime()),r=(o.getMonth()<i.currentMonth||o.getMonth()>i.currentMonth+i.config.showMonths-1)&&"range"!==i.config.mode;if(i.selectedDateElem=n,"single"===i.config.mode)i.selectedDates=[o];else if("multiple"===i.config.mode){const e=q(o);e?i.selectedDates.splice(parseInt(e),1):i.selectedDates.push(o)}else"range"===i.config.mode&&(2===i.selectedDates.length&&i.clear(!1,!1),i.latestSelectedDateObj=o,i.selectedDates.push(o),0!==compareDates(o,i.selectedDates[0],!0)&&i.selectedDates.sort(((e,t)=>e.getTime()-t.getTime())));if(s(),r){const e=i.currentYear!==o.getFullYear();i.currentYear=o.getFullYear(),i.currentMonth=o.getMonth(),e&&(W("onYearChange"),w()),W("onMonthChange")}if(X(),y(),J(),r||"range"===i.config.mode||1!==i.config.showMonths?void 0!==i.selectedDateElem&&void 0===i.hourElement&&i.selectedDateElem&&i.selectedDateElem.focus():g(n),void 0!==i.hourElement&&void 0!==i.hourElement&&i.hourElement.focus(),i.config.closeOnSelect){const e="single"===i.config.mode&&!i.config.enableTime,t="range"===i.config.mode&&2===i.selectedDates.length&&!i.config.enableTime;(e||t)&&F()}h()}i.parseDate=createDateParser({config:i.config,l10n:i.l10n}),i._handlers=[],i.pluginElements=[],i.loadedPlugins=[],i._bind=d,i._setHoursFromDate=a,i._positionCalendar=V,i.changeMonth=S,i.changeYear=E,i.clear=function(e=!0,t=!0){i.input.value="",void 0!==i.altInput&&(i.altInput.value="");void 0!==i.mobileInput&&(i.mobileInput.value="");i.selectedDates=[],i.latestSelectedDateObj=void 0,!0===t&&(i.currentYear=i._initialDate.getFullYear(),i.currentMonth=i._initialDate.getMonth());if(!0===i.config.enableTime){const{hours:e,minutes:t,seconds:n}=getDefaultHours(i.config);l(e,t,n)}i.redraw(),e&&W("onChange")},i.close=function(){i.isOpen=!1,i.isMobile||(void 0!==i.calendarContainer&&i.calendarContainer.classList.remove("open"),void 0!==i._input&&i._input.classList.remove("active"));W("onClose")},i._createElement=createElement,i.destroy=function(){void 0!==i.config&&W("onDestroy");for(let e=i._handlers.length;e--;)i._handlers[e].remove();if(i._handlers=[],i.mobileInput)i.mobileInput.parentNode&&i.mobileInput.parentNode.removeChild(i.mobileInput),i.mobileInput=void 0;else if(i.calendarContainer&&i.calendarContainer.parentNode)if(i.config.static&&i.calendarContainer.parentNode){const e=i.calendarContainer.parentNode;if(e.lastChild&&e.removeChild(e.lastChild),e.parentNode){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}}else i.calendarContainer.parentNode.removeChild(i.calendarContainer);i.altInput&&(i.input.type="text",i.altInput.parentNode&&i.altInput.parentNode.removeChild(i.altInput),delete i.altInput);i.input&&(i.input.type=i.input._type,i.input.classList.remove("flatpickr-input"),i.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((e=>{try{delete i[e]}catch(t){}}))},i.isEnabled=P,i.jumpToDate=u,i.open=function(e,t=i._positionElement){if(!0===i.isMobile){if(e){e.preventDefault();const t=getEventTarget(e);t&&t.blur()}return void 0!==i.mobileInput&&(i.mobileInput.focus(),i.mobileInput.click()),void W("onOpen")}if(i._input.disabled||i.config.inline)return;const n=i.isOpen;i.isOpen=!0,n||(i.calendarContainer.classList.add("open"),i._input.classList.add("active"),W("onOpen"),V(t));!0===i.config.enableTime&&!0===i.config.noCalendar&&(!1!==i.config.allowInput||void 0!==e&&i.timeContainer.contains(e.relatedTarget)||setTimeout((()=>i.hourElement.select()),50))},i.redraw=O,i.set=function(e,t){if(null!==e&&"object"==typeof e){Object.assign(i.config,e);for(const t in e)void 0!==H[t]&&H[t].forEach((e=>e()))}else i.config[e]=t,void 0!==H[e]?H[e].forEach((e=>e())):HOOKS.indexOf(e)>-1&&(i.config[e]=arrayify(t));i.redraw(),J(!0)},i.setDate=function(e,t=!1,n=i.config.dateFormat){if(0!==e&&!e||e instanceof Array&&0===e.length)return i.clear(t);j(e,n),i.latestSelectedDateObj=i.selectedDates[i.selectedDates.length-1],i.redraw(),u(void 0,t),a(),0===i.selectedDates.length&&i.clear(!1);J(t),t&&W("onChange")},i.toggle=function(e){if(!0===i.isOpen)return i.close();i.open(e)};const H={locale:[$,C],showMonths:[x,o,k],minDate:[u],maxDate:[u],clickOpens:[()=>{!0===i.config.clickOpens?(d(i._input,"focus",i.open),d(i._input,"click",i.open)):(i._input.removeEventListener("focus",i.open),i._input.removeEventListener("click",i.open))}]};function j(e,t){let n=[];if(e instanceof Array)n=e.map((e=>i.parseDate(e,t)));else if(e instanceof Date||"number"==typeof e)n=[i.parseDate(e,t)];else if("string"==typeof e)switch(i.config.mode){case"single":case"time":n=[i.parseDate(e,t)];break;case"multiple":n=e.split(i.config.conjunction).map((e=>i.parseDate(e,t)));break;case"range":n=e.split(i.l10n.rangeSeparator).map((e=>i.parseDate(e,t)))}else i.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(e)}`));i.selectedDates=i.config.allowInvalidPreload?n:n.filter((e=>e instanceof Date&&P(e,!1))),"range"===i.config.mode&&i.selectedDates.sort(((e,t)=>e.getTime()-t.getTime()))}function U(e){return e.slice().map((e=>"string"==typeof e||"number"==typeof e||e instanceof Date?i.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:i.parseDate(e.from,void 0),to:i.parseDate(e.to,void 0)}:e)).filter((e=>e))}function W(e,t){if(void 0===i.config)return;const n=i.config[e];if(void 0!==n&&n.length>0)for(let o=0;n[o]&&o<n.length;o++)n[o](i.selectedDates,i.input.value,i,t);"onChange"===e&&(i.input.dispatchEvent(Y("change")),i.input.dispatchEvent(Y("input")))}function Y(e){const t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function q(e){for(let t=0;t<i.selectedDates.length;t++)if(0===compareDates(i.selectedDates[t],e))return""+t;return!1}function X(){i.config.noCalendar||i.isMobile||!i.monthNav||(i.yearElements.forEach(((e,t)=>{const n=new Date(i.currentYear,i.currentMonth,1);n.setMonth(i.currentMonth+t),i.config.showMonths>1||"static"===i.config.monthSelectorType?i.monthElements[t].textContent=monthToStr(n.getMonth(),i.config.shorthandCurrentMonth,i.l10n)+" ":i.monthsDropdownContainer.value=n.getMonth().toString(),e.value=n.getFullYear().toString()})),i._hidePrevMonthArrow=void 0!==i.config.minDate&&(i.currentYear===i.config.minDate.getFullYear()?i.currentMonth<=i.config.minDate.getMonth():i.currentYear<i.config.minDate.getFullYear()),i._hideNextMonthArrow=void 0!==i.config.maxDate&&(i.currentYear===i.config.maxDate.getFullYear()?i.currentMonth+1>i.config.maxDate.getMonth():i.currentYear>i.config.maxDate.getFullYear()))}function K(e){return i.selectedDates.map((t=>i.formatDate(t,e))).filter(((e,t,n)=>"range"!==i.config.mode||i.config.enableTime||n.indexOf(e)===t)).join("range"!==i.config.mode?i.config.conjunction:i.l10n.rangeSeparator)}function J(e=!0){void 0!==i.mobileInput&&i.mobileFormatStr&&(i.mobileInput.value=void 0!==i.latestSelectedDateObj?i.formatDate(i.latestSelectedDateObj,i.mobileFormatStr):""),i.input.value=K(i.config.dateFormat),void 0!==i.altInput&&(i.altInput.value=K(i.config.altFormat)),!1!==e&&W("onValueUpdate")}function Q(e){const t=getEventTarget(e),n=i.prevMonthNav.contains(t),o=i.nextMonthNav.contains(t);n||o?S(n?-1:1):i.yearElements.indexOf(t)>=0?t.select():t.classList.contains("arrowUp")?i.changeYear(i.currentYear+1):t.classList.contains("arrowDown")&&i.changeYear(i.currentYear-1)}return function(){i.element=i.input=e,i.isOpen=!1,function(){const o=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],r=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),t),s={};i.config.parseDate=r.parseDate,i.config.formatDate=r.formatDate,Object.defineProperty(i.config,"enable",{get:()=>i.config._enable,set:e=>{i.config._enable=U(e)}}),Object.defineProperty(i.config,"disable",{get:()=>i.config._disable,set:e=>{i.config._disable=U(e)}});const a="time"===r.mode;if(!r.dateFormat&&(r.enableTime||a)){const e=flatpickr.defaultConfig.dateFormat||defaults.dateFormat;s.dateFormat=r.noCalendar||a?"H:i"+(r.enableSeconds?":S":""):e+" H:i"+(r.enableSeconds?":S":"")}if(r.altInput&&(r.enableTime||a)&&!r.altFormat){const e=flatpickr.defaultConfig.altFormat||defaults.altFormat;s.altFormat=r.noCalendar||a?"h:i"+(r.enableSeconds?":S K":" K"):e+` h:i${r.enableSeconds?":S":""} K`}Object.defineProperty(i.config,"minDate",{get:()=>i.config._minDate,set:L("min")}),Object.defineProperty(i.config,"maxDate",{get:()=>i.config._maxDate,set:L("max")});const l=e=>t=>{i.config["min"===e?"_minTime":"_maxTime"]=i.parseDate(t,"H:i:S")};Object.defineProperty(i.config,"minTime",{get:()=>i.config._minTime,set:l("min")}),Object.defineProperty(i.config,"maxTime",{get:()=>i.config._maxTime,set:l("max")}),"time"===r.mode&&(i.config.noCalendar=!0,i.config.enableTime=!0);Object.assign(i.config,s,r);for(let e=0;e<o.length;e++)i.config[o[e]]=!0===i.config[o[e]]||"true"===i.config[o[e]];HOOKS.filter((e=>void 0!==i.config[e])).forEach((e=>{i.config[e]=arrayify(i.config[e]||[]).map(n)})),i.isMobile=!i.config.disableMobile&&!i.config.inline&&"single"===i.config.mode&&!i.config.disable.length&&!i.config.enable&&!i.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let e=0;e<i.config.plugins.length;e++){const t=i.config.plugins[e](i)||{};for(const e in t)HOOKS.indexOf(e)>-1?i.config[e]=arrayify(t[e]).map(n).concat(i.config[e]):void 0===r[e]&&(i.config[e]=t[e])}r.altInputClass||(i.config.altInputClass=N().className+" "+i.config.altInputClass);W("onParseConfig")}(),$(),function(){if(i.input=N(),!i.input)return void i.config.errorHandler(new Error("Invalid input element specified"));i.input._type=i.input.type,i.input.type="text",i.input.classList.add("flatpickr-input"),i._input=i.input,i.config.altInput&&(i.altInput=createElement(i.input.nodeName,i.config.altInputClass),i._input=i.altInput,i.altInput.placeholder=i.input.placeholder,i.altInput.disabled=i.input.disabled,i.altInput.required=i.input.required,i.altInput.tabIndex=i.input.tabIndex,i.altInput.type="text",i.input.setAttribute("type","hidden"),!i.config.static&&i.input.parentNode&&i.input.parentNode.insertBefore(i.altInput,i.input.nextSibling));i.config.allowInput||i._input.setAttribute("readonly","readonly");i._positionElement=i.config.positionElement||i._input}(),function(){i.selectedDates=[],i.now=i.parseDate(i.config.now)||new Date;const e=i.config.defaultDate||("INPUT"!==i.input.nodeName&&"TEXTAREA"!==i.input.nodeName||!i.input.placeholder||i.input.value!==i.input.placeholder?i.input.value:null);e&&j(e,i.config.dateFormat);i._initialDate=i.selectedDates.length>0?i.selectedDates[0]:i.config.minDate&&i.config.minDate.getTime()>i.now.getTime()?i.config.minDate:i.config.maxDate&&i.config.maxDate.getTime()<i.now.getTime()?i.config.maxDate:i.now,i.currentYear=i._initialDate.getFullYear(),i.currentMonth=i._initialDate.getMonth(),i.selectedDates.length>0&&(i.latestSelectedDateObj=i.selectedDates[0]);void 0!==i.config.minTime&&(i.config.minTime=i.parseDate(i.config.minTime,"H:i"));void 0!==i.config.maxTime&&(i.config.maxTime=i.parseDate(i.config.maxTime,"H:i"));i.minDateHasTime=!!i.config.minDate&&(i.config.minDate.getHours()>0||i.config.minDate.getMinutes()>0||i.config.minDate.getSeconds()>0),i.maxDateHasTime=!!i.config.maxDate&&(i.config.maxDate.getHours()>0||i.config.maxDate.getMinutes()>0||i.config.maxDate.getSeconds()>0)}(),i.utils={getDaysInMonth:(e=i.currentMonth,t=i.currentYear)=>1===e&&(t%4==0&&t%100!=0||t%400==0)?29:i.l10n.daysInMonth[e]},i.isMobile||function(){const e=window.document.createDocumentFragment();if(i.calendarContainer=createElement("div","flatpickr-calendar"),i.calendarContainer.tabIndex=-1,!i.config.noCalendar){if(e.appendChild((i.monthNav=createElement("div","flatpickr-months"),i.yearElements=[],i.monthElements=[],i.prevMonthNav=createElement("span","flatpickr-prev-month"),i.prevMonthNav.innerHTML=i.config.prevArrow,i.nextMonthNav=createElement("span","flatpickr-next-month"),i.nextMonthNav.innerHTML=i.config.nextArrow,x(),Object.defineProperty(i,"_hidePrevMonthArrow",{get:()=>i.__hidePrevMonthArrow,set(e){i.__hidePrevMonthArrow!==e&&(toggleClass(i.prevMonthNav,"flatpickr-disabled",e),i.__hidePrevMonthArrow=e)}}),Object.defineProperty(i,"_hideNextMonthArrow",{get:()=>i.__hideNextMonthArrow,set(e){i.__hideNextMonthArrow!==e&&(toggleClass(i.nextMonthNav,"flatpickr-disabled",e),i.__hideNextMonthArrow=e)}}),i.currentYearElement=i.yearElements[0],X(),i.monthNav)),i.innerContainer=createElement("div","flatpickr-innerContainer"),i.config.weekNumbers){const{weekWrapper:e,weekNumbers:t}=function(){i.calendarContainer.classList.add("hasWeeks");const e=createElement("div","flatpickr-weekwrapper");e.appendChild(createElement("span","flatpickr-weekday",i.l10n.weekAbbreviation));const t=createElement("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}();i.innerContainer.appendChild(e),i.weekNumbers=t,i.weekWrapper=e}i.rContainer=createElement("div","flatpickr-rContainer"),i.rContainer.appendChild(k()),i.daysContainer||(i.daysContainer=createElement("div","flatpickr-days"),i.daysContainer.tabIndex=-1),y(),i.rContainer.appendChild(i.daysContainer),i.innerContainer.appendChild(i.rContainer),e.appendChild(i.innerContainer)}i.config.enableTime&&e.appendChild(function(){i.calendarContainer.classList.add("hasTime"),i.config.noCalendar&&i.calendarContainer.classList.add("noCalendar");const e=getDefaultHours(i.config);i.timeContainer=createElement("div","flatpickr-time"),i.timeContainer.tabIndex=-1;const t=createElement("span","flatpickr-time-separator",":"),n=createNumberInput("flatpickr-hour",{"aria-label":i.l10n.hourAriaLabel});i.hourElement=n.getElementsByTagName("input")[0];const o=createNumberInput("flatpickr-minute",{"aria-label":i.l10n.minuteAriaLabel});i.minuteElement=o.getElementsByTagName("input")[0],i.hourElement.tabIndex=i.minuteElement.tabIndex=-1,i.hourElement.value=pad(i.latestSelectedDateObj?i.latestSelectedDateObj.getHours():i.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),i.minuteElement.value=pad(i.latestSelectedDateObj?i.latestSelectedDateObj.getMinutes():e.minutes),i.hourElement.setAttribute("step",i.config.hourIncrement.toString()),i.minuteElement.setAttribute("step",i.config.minuteIncrement.toString()),i.hourElement.setAttribute("min",i.config.time_24hr?"0":"1"),i.hourElement.setAttribute("max",i.config.time_24hr?"23":"12"),i.hourElement.setAttribute("maxlength","2"),i.minuteElement.setAttribute("min","0"),i.minuteElement.setAttribute("max","59"),i.minuteElement.setAttribute("maxlength","2"),i.timeContainer.appendChild(n),i.timeContainer.appendChild(t),i.timeContainer.appendChild(o),i.config.time_24hr&&i.timeContainer.classList.add("time24hr");if(i.config.enableSeconds){i.timeContainer.classList.add("hasSeconds");const t=createNumberInput("flatpickr-second");i.secondElement=t.getElementsByTagName("input")[0],i.secondElement.value=pad(i.latestSelectedDateObj?i.latestSelectedDateObj.getSeconds():e.seconds),i.secondElement.setAttribute("step",i.minuteElement.getAttribute("step")),i.secondElement.setAttribute("min","0"),i.secondElement.setAttribute("max","59"),i.secondElement.setAttribute("maxlength","2"),i.timeContainer.appendChild(createElement("span","flatpickr-time-separator",":")),i.timeContainer.appendChild(t)}i.config.time_24hr||(i.amPM=createElement("span","flatpickr-am-pm",i.l10n.amPM[int((i.latestSelectedDateObj?i.hourElement.value:i.config.defaultHour)>11)]),i.amPM.title=i.l10n.toggleTitle,i.amPM.tabIndex=-1,i.timeContainer.appendChild(i.amPM));return i.timeContainer}());toggleClass(i.calendarContainer,"rangeMode","range"===i.config.mode),toggleClass(i.calendarContainer,"animate",!0===i.config.animate),toggleClass(i.calendarContainer,"multiMonth",i.config.showMonths>1),i.calendarContainer.appendChild(e);const t=void 0!==i.config.appendTo&&void 0!==i.config.appendTo.nodeType;if((i.config.inline||i.config.static)&&(i.calendarContainer.classList.add(i.config.inline?"inline":"static"),i.config.inline&&(!t&&i.element.parentNode?i.element.parentNode.insertBefore(i.calendarContainer,i._input.nextSibling):void 0!==i.config.appendTo&&i.config.appendTo.appendChild(i.calendarContainer)),i.config.static)){const e=createElement("div","flatpickr-wrapper");i.element.parentNode&&i.element.parentNode.insertBefore(e,i.element),e.appendChild(i.element),i.altInput&&e.appendChild(i.altInput),e.appendChild(i.calendarContainer)}i.config.static||i.config.inline||(void 0!==i.config.appendTo?i.config.appendTo:window.document.body).appendChild(i.calendarContainer)}(),function(){i.config.wrap&&["open","close","toggle","clear"].forEach((e=>{Array.prototype.forEach.call(i.element.querySelectorAll(`[data-${e}]`),(t=>d(t,"click",i[e])))}));if(i.isMobile)return void function(){const e=i.config.enableTime?i.config.noCalendar?"time":"datetime-local":"date";i.mobileInput=createElement("input",i.input.className+" flatpickr-mobile"),i.mobileInput.tabIndex=1,i.mobileInput.type=e,i.mobileInput.disabled=i.input.disabled,i.mobileInput.required=i.input.required,i.mobileInput.placeholder=i.input.placeholder,i.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",i.selectedDates.length>0&&(i.mobileInput.defaultValue=i.mobileInput.value=i.formatDate(i.selectedDates[0],i.mobileFormatStr));i.config.minDate&&(i.mobileInput.min=i.formatDate(i.config.minDate,"Y-m-d"));i.config.maxDate&&(i.mobileInput.max=i.formatDate(i.config.maxDate,"Y-m-d"));i.input.getAttribute("step")&&(i.mobileInput.step=String(i.input.getAttribute("step")));i.input.type="hidden",void 0!==i.altInput&&(i.altInput.type="hidden");try{i.input.parentNode&&i.input.parentNode.insertBefore(i.mobileInput,i.input.nextSibling)}catch(t){}d(i.mobileInput,"change",(e=>{i.setDate(getEventTarget(e).value,!1,i.mobileFormatStr),W("onChange"),W("onClose")}))}();const e=debounce$1(z,50);i._debouncedChange=debounce$1(h,DEBOUNCED_CHANGE_MS),i.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&d(i.daysContainer,"mouseover",(e=>{"range"===i.config.mode&&B(getEventTarget(e))}));d(window.document.body,"keydown",I),i.config.inline||i.config.static||d(window,"resize",e);void 0!==window.ontouchstart?d(window.document,"touchstart",R):d(window.document,"mousedown",R);d(window.document,"focus",R,{capture:!0}),!0===i.config.clickOpens&&(d(i._input,"focus",i.open),d(i._input,"click",i.open));void 0!==i.daysContainer&&(d(i.monthNav,"click",Q),d(i.monthNav,["keyup","increment"],c),d(i.daysContainer,"click",G));if(void 0!==i.timeContainer&&void 0!==i.minuteElement&&void 0!==i.hourElement){const e=e=>getEventTarget(e).select();d(i.timeContainer,["increment"],r),d(i.timeContainer,"blur",r,{capture:!0}),d(i.timeContainer,"click",p),d([i.hourElement,i.minuteElement],["focus","click"],e),void 0!==i.secondElement&&d(i.secondElement,"focus",(()=>i.secondElement&&i.secondElement.select())),void 0!==i.amPM&&d(i.amPM,"click",(e=>{r(e),h()}))}i.config.allowInput&&d(i._input,"blur",D)}(),(i.selectedDates.length||i.config.noCalendar)&&(i.config.enableTime&&a(i.config.noCalendar?i.latestSelectedDateObj:void 0),J(!1)),o();const s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!i.isMobile&&s&&V(),W("onReady")}(),i}function _flatpickr(e,t){const i=Array.prototype.slice.call(e).filter((e=>e instanceof HTMLElement)),n=[];for(let r=0;r<i.length;r++){const e=i[r];try{if(null!==e.getAttribute("data-fp-omit"))continue;void 0!==e._flatpickr&&(e._flatpickr.destroy(),e._flatpickr=void 0),e._flatpickr=FlatpickrInstance(e,t||{}),n.push(e._flatpickr)}catch(o){console.error(o)}}return 1===n.length?n[0]:n}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return _flatpickr(this,e)},HTMLElement.prototype.flatpickr=function(e){return _flatpickr([this],e)});var flatpickr=function(e,t){return"string"==typeof e?_flatpickr(window.document.querySelectorAll(e),t):e instanceof Node?_flatpickr([e],t):_flatpickr(e,t)};flatpickr.defaultConfig={},flatpickr.l10ns={en:Object.assign({},english),default:Object.assign({},english)},flatpickr.localize=e=>{flatpickr.l10ns.default=Object.assign(Object.assign({},flatpickr.l10ns.default),e)},flatpickr.setDefaults=e=>{flatpickr.defaultConfig=Object.assign(Object.assign({},flatpickr.defaultConfig),e)},flatpickr.parseDate=createDateParser({}),flatpickr.formatDate=createDateFormatter({}),flatpickr.compareDates=compareDates,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return _flatpickr(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=flatpickr);var flatpickr_css='.flatpickr-calendar{background:transparent;opacity:0;display:none;text-align:center;visibility:hidden;padding:0;-webkit-animation:none;animation:none;direction:ltr;border:0;font-size:14px;line-height:24px;border-radius:5px;position:absolute;width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-touch-action:manipulation;touch-action:manipulation;background:#fff;-webkit-box-shadow:1px 0 0 #e6e6e6, -1px 0 0 #e6e6e6, 0 1px 0 #e6e6e6, 0 -1px 0 #e6e6e6, 0 3px 13px rgba(0, 0, 0, 0.08);box-shadow:1px 0 0 #e6e6e6, -1px 0 0 #e6e6e6, 0 1px 0 #e6e6e6, 0 -1px 0 #e6e6e6, 0 3px 13px rgba(0, 0, 0, 0.08);}.flatpickr-calendar.open,.flatpickr-calendar.inline{opacity:1;max-height:640px;visibility:visible;}.flatpickr-calendar.open{display:inline-block;z-index:99999;}.flatpickr-calendar.animate.open{-webkit-animation:fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);animation:fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);}.flatpickr-calendar.inline{display:block;position:relative;top:2px;}.flatpickr-calendar.static{position:absolute;top:calc(100% + 2px);}.flatpickr-calendar.static.open{z-index:999;display:block;}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+1) .flatpickr-day.inRange:nth-child(7n+7){-webkit-box-shadow:none !important;box-shadow:none !important;}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+2) .flatpickr-day.inRange:nth-child(7n+1){-webkit-box-shadow:-2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;box-shadow:-2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;}.flatpickr-calendar .hasWeeks .dayContainer,.flatpickr-calendar .hasTime .dayContainer{border-bottom:0;border-bottom-right-radius:0;border-bottom-left-radius:0;}.flatpickr-calendar .hasWeeks .dayContainer{border-left:0;}.flatpickr-calendar.hasTime .flatpickr-time{height:40px;border-top:1px solid #e6e6e6;}.flatpickr-calendar.noCalendar.hasTime .flatpickr-time{height:auto;}.flatpickr-calendar:before,.flatpickr-calendar:after{position:absolute;display:block;pointer-events:none;border:solid transparent;content:\'\';height:0;width:0;left:22px;}.flatpickr-calendar.rightMost:before,.flatpickr-calendar.arrowRight:before,.flatpickr-calendar.rightMost:after,.flatpickr-calendar.arrowRight:after{left:auto;right:22px;}.flatpickr-calendar.arrowCenter:before,.flatpickr-calendar.arrowCenter:after{left:50%;right:50%;}.flatpickr-calendar:before{border-width:5px;margin:0 -5px;}.flatpickr-calendar:after{border-width:4px;margin:0 -4px;}.flatpickr-calendar.arrowTop:before,.flatpickr-calendar.arrowTop:after{bottom:100%;}.flatpickr-calendar.arrowTop:before{border-bottom-color:#e6e6e6;}.flatpickr-calendar.arrowTop:after{border-bottom-color:#fff;}.flatpickr-calendar.arrowBottom:before,.flatpickr-calendar.arrowBottom:after{top:100%;}.flatpickr-calendar.arrowBottom:before{border-top-color:#e6e6e6;}.flatpickr-calendar.arrowBottom:after{border-top-color:#fff;}.flatpickr-calendar:focus{outline:0;}.flatpickr-wrapper{position:relative;display:inline-block;}.flatpickr-months{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.flatpickr-months .flatpickr-month{background:transparent;color:rgba(0, 0, 0, 0.9);fill:rgba(0, 0, 0, 0.9);height:34px;line-height:1;text-align:center;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;}.flatpickr-months .flatpickr-prev-month,.flatpickr-months .flatpickr-next-month{text-decoration:none;cursor:pointer;position:absolute;top:0;height:34px;padding:10px;z-index:3;color:rgba(0, 0, 0, 0.9);fill:rgba(0, 0, 0, 0.9);}.flatpickr-months .flatpickr-prev-month.flatpickr-disabled,.flatpickr-months .flatpickr-next-month.flatpickr-disabled{display:none;}.flatpickr-months .flatpickr-prev-month i,.flatpickr-months .flatpickr-next-month i{position:relative;}.flatpickr-months .flatpickr-prev-month.flatpickr-prev-month,.flatpickr-months .flatpickr-next-month.flatpickr-prev-month{left:0;}.flatpickr-months .flatpickr-prev-month.flatpickr-next-month,.flatpickr-months .flatpickr-next-month.flatpickr-next-month{right:0;}.flatpickr-months .flatpickr-prev-month:hover,.flatpickr-months .flatpickr-next-month:hover{color:#959ea9;}.flatpickr-months .flatpickr-prev-month:hover svg,.flatpickr-months .flatpickr-next-month:hover svg{fill:#f64747;}.flatpickr-months .flatpickr-prev-month svg,.flatpickr-months .flatpickr-next-month svg{width:14px;height:14px;}.flatpickr-months .flatpickr-prev-month svg path,.flatpickr-months .flatpickr-next-month svg path{-webkit-transition:fill 0.1s;transition:fill 0.1s;fill:inherit;}.numInputWrapper{position:relative;height:auto;}.numInputWrapper input,.numInputWrapper span{display:inline-block;}.numInputWrapper input{width:100%;}.numInputWrapper input::-ms-clear{display:none;}.numInputWrapper input::-webkit-outer-spin-button,.numInputWrapper input::-webkit-inner-spin-button{margin:0;-webkit-appearance:none;}.numInputWrapper span{position:absolute;right:0;width:14px;padding:0 4px 0 2px;height:50%;line-height:50%;opacity:0;cursor:pointer;border:1px solid rgba(57, 57, 57, 0.15);-webkit-box-sizing:border-box;box-sizing:border-box;}.numInputWrapper span:hover{background:rgba(0, 0, 0, 0.1);}.numInputWrapper span:active{background:rgba(0, 0, 0, 0.2);}.numInputWrapper span:after{display:block;content:"";position:absolute;}.numInputWrapper span.arrowUp{top:0;border-bottom:0;}.numInputWrapper span.arrowUp:after{border-left:4px solid transparent;border-right:4px solid transparent;border-bottom:4px solid rgba(57, 57, 57, 0.6);top:26%;}.numInputWrapper span.arrowDown{top:50%;}.numInputWrapper span.arrowDown:after{border-left:4px solid transparent;border-right:4px solid transparent;border-top:4px solid rgba(57, 57, 57, 0.6);top:40%;}.numInputWrapper span svg{width:inherit;height:auto;}.numInputWrapper span svg path{fill:rgba(0, 0, 0, 0.5);}.numInputWrapper:hover{background:rgba(0, 0, 0, 0.05);}.numInputWrapper:hover span{opacity:1;}.flatpickr-current-month{font-size:135%;line-height:inherit;font-weight:300;color:inherit;position:absolute;width:75%;left:12.5%;padding:7.48px 0 0 0;line-height:1;height:34px;display:inline-block;text-align:center;-webkit-transform:translate3d(0px, 0px, 0px);transform:translate3d(0px, 0px, 0px);}.flatpickr-current-month span.cur-month{font-family:inherit;font-weight:700;color:inherit;display:inline-block;margin-left:0.5ch;padding:0;}.flatpickr-current-month span.cur-month:hover{background:rgba(0, 0, 0, 0.05);}.flatpickr-current-month .numInputWrapper{width:6ch;width:7ch\0;display:inline-block;}.flatpickr-current-month .numInputWrapper span.arrowUp:after{border-bottom-color:rgba(0, 0, 0, 0.9);}.flatpickr-current-month .numInputWrapper span.arrowDown:after{border-top-color:rgba(0, 0, 0, 0.9);}.flatpickr-current-month input.cur-year{background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;cursor:text;padding:0 0 0 0.5ch;margin:0;display:inline-block;font-size:inherit;font-family:inherit;font-weight:300;line-height:inherit;height:auto;border:0;border-radius:0;vertical-align:initial;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;}.flatpickr-current-month input.cur-year:focus{outline:0;}.flatpickr-current-month input.cur-year[disabled],.flatpickr-current-month input.cur-year[disabled]:hover{font-size:100%;color:rgba(0, 0, 0, 0.5);background:transparent;pointer-events:none;}.flatpickr-current-month .flatpickr-monthDropdown-months{appearance:menulist;background:transparent;border:none;border-radius:0;box-sizing:border-box;color:inherit;cursor:pointer;font-size:inherit;font-family:inherit;font-weight:300;height:auto;line-height:inherit;margin:-1px 0 0 0;outline:none;padding:0 0 0 0.5ch;position:relative;vertical-align:initial;-webkit-box-sizing:border-box;-webkit-appearance:menulist;-moz-appearance:menulist;width:auto;}.flatpickr-current-month .flatpickr-monthDropdown-months:focus,.flatpickr-current-month .flatpickr-monthDropdown-months:active{outline:none;}.flatpickr-current-month .flatpickr-monthDropdown-months:hover{background:rgba(0, 0, 0, 0.05);}.flatpickr-current-month .flatpickr-monthDropdown-months .flatpickr-monthDropdown-month{background-color:transparent;outline:none;padding:0;}.flatpickr-weekdays{background:transparent;text-align:center;overflow:hidden;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;height:28px;}.flatpickr-weekdays .flatpickr-weekdaycontainer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;}span.flatpickr-weekday{cursor:default;font-size:90%;background:transparent;color:rgba(0, 0, 0, 0.54);line-height:1;margin:0;text-align:center;display:block;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;font-weight:bolder;}.dayContainer,.flatpickr-weeks{padding:1px 0 0 0;}.flatpickr-days{position:relative;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;width:307.875px;}.flatpickr-days:focus{outline:0;}.dayContainer{padding:0;outline:0;text-align:left;width:307.875px;min-width:307.875px;max-width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-wrap:wrap;-ms-flex-pack:justify;-webkit-justify-content:space-around;justify-content:space-around;-webkit-transform:translate3d(0px, 0px, 0px);transform:translate3d(0px, 0px, 0px);opacity:1;}.dayContainer + .dayContainer{-webkit-box-shadow:-1px 0 0 #e6e6e6;box-shadow:-1px 0 0 #e6e6e6;}.flatpickr-day{background:none;border:1px solid transparent;border-radius:150px;-webkit-box-sizing:border-box;box-sizing:border-box;color:#393939;cursor:pointer;font-weight:400;width:14.2857143%;-webkit-flex-basis:14.2857143%;-ms-flex-preferred-size:14.2857143%;flex-basis:14.2857143%;max-width:39px;height:39px;line-height:39px;margin:0;display:inline-block;position:relative;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center;}.flatpickr-day.inRange,.flatpickr-day.prevMonthDay.inRange,.flatpickr-day.nextMonthDay.inRange,.flatpickr-day.today.inRange,.flatpickr-day.prevMonthDay.today.inRange,.flatpickr-day.nextMonthDay.today.inRange,.flatpickr-day:hover,.flatpickr-day.prevMonthDay:hover,.flatpickr-day.nextMonthDay:hover,.flatpickr-day:focus,.flatpickr-day.prevMonthDay:focus,.flatpickr-day.nextMonthDay:focus{cursor:pointer;outline:0;background:#e6e6e6;border-color:#e6e6e6;}.flatpickr-day.today{border-color:#959ea9;}.flatpickr-day.today:hover,.flatpickr-day.today:focus{border-color:#959ea9;background:#959ea9;color:#fff;}.flatpickr-day.selected,.flatpickr-day.startRange,.flatpickr-day.endRange,.flatpickr-day.selected.inRange,.flatpickr-day.startRange.inRange,.flatpickr-day.endRange.inRange,.flatpickr-day.selected:focus,.flatpickr-day.startRange:focus,.flatpickr-day.endRange:focus,.flatpickr-day.selected:hover,.flatpickr-day.startRange:hover,.flatpickr-day.endRange:hover,.flatpickr-day.selected.prevMonthDay,.flatpickr-day.startRange.prevMonthDay,.flatpickr-day.endRange.prevMonthDay,.flatpickr-day.selected.nextMonthDay,.flatpickr-day.startRange.nextMonthDay,.flatpickr-day.endRange.nextMonthDay{background:#569ff7;-webkit-box-shadow:none;box-shadow:none;color:#fff;border-color:#569ff7;}.flatpickr-day.selected.startRange,.flatpickr-day.startRange.startRange,.flatpickr-day.endRange.startRange{border-radius:50px 0 0 50px;}.flatpickr-day.selected.endRange,.flatpickr-day.startRange.endRange,.flatpickr-day.endRange.endRange{border-radius:0 50px 50px 0;}.flatpickr-day.selected.startRange + .endRange:not(:nth-child(7n+1)),.flatpickr-day.startRange.startRange + .endRange:not(:nth-child(7n+1)),.flatpickr-day.endRange.startRange + .endRange:not(:nth-child(7n+1)){-webkit-box-shadow:-10px 0 0 #569ff7;box-shadow:-10px 0 0 #569ff7;}.flatpickr-day.selected.startRange.endRange,.flatpickr-day.startRange.startRange.endRange,.flatpickr-day.endRange.startRange.endRange{border-radius:50px;}.flatpickr-day.inRange{border-radius:0;-webkit-box-shadow:-5px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;box-shadow:-5px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover,.flatpickr-day.prevMonthDay,.flatpickr-day.nextMonthDay,.flatpickr-day.notAllowed,.flatpickr-day.notAllowed.prevMonthDay,.flatpickr-day.notAllowed.nextMonthDay{color:rgba(57, 57, 57, 0.3);background:transparent;border-color:transparent;cursor:default;}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover{cursor:not-allowed;color:rgba(57, 57, 57, 0.1);}.flatpickr-day.week.selected{border-radius:0;-webkit-box-shadow:-5px 0 0 #569ff7, 5px 0 0 #569ff7;box-shadow:-5px 0 0 #569ff7, 5px 0 0 #569ff7;}.flatpickr-day.hidden{visibility:hidden;}.rangeMode .flatpickr-day{margin-top:1px;}.flatpickr-weekwrapper{float:left;}.flatpickr-weekwrapper .flatpickr-weeks{padding:0 12px;-webkit-box-shadow:1px 0 0 #e6e6e6;box-shadow:1px 0 0 #e6e6e6;}.flatpickr-weekwrapper .flatpickr-weekday{float:none;width:100%;line-height:28px;}.flatpickr-weekwrapper span.flatpickr-day,.flatpickr-weekwrapper span.flatpickr-day:hover{display:block;width:100%;max-width:none;color:rgba(57, 57, 57, 0.3);background:transparent;cursor:default;border:none;}.flatpickr-innerContainer{display:block;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;}.flatpickr-rContainer{display:inline-block;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box;}.flatpickr-time{text-align:center;outline:0;display:block;height:0;line-height:40px;max-height:40px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.flatpickr-time:after{content:"";display:table;clear:both;}.flatpickr-time .numInputWrapper{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;width:40%;height:40px;float:left;}.flatpickr-time .numInputWrapper span.arrowUp:after{border-bottom-color:#393939;}.flatpickr-time .numInputWrapper span.arrowDown:after{border-top-color:#393939;}.flatpickr-time.hasSeconds .numInputWrapper{width:26%;}.flatpickr-time.time24hr .numInputWrapper{width:49%;}.flatpickr-time input{background:transparent;-webkit-box-shadow:none;box-shadow:none;border:0;border-radius:0;text-align:center;margin:0;padding:0;height:inherit;line-height:inherit;color:#393939;font-size:14px;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;}.flatpickr-time input.flatpickr-hour{font-weight:bold;}.flatpickr-time input.flatpickr-minute,.flatpickr-time input.flatpickr-second{font-weight:400;}.flatpickr-time input:focus{outline:0;border:0;}.flatpickr-time .flatpickr-time-separator,.flatpickr-time .flatpickr-am-pm{height:inherit;float:left;line-height:inherit;color:#393939;font-weight:bold;width:2%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;}.flatpickr-time .flatpickr-am-pm{outline:0;width:18%;cursor:pointer;text-align:center;font-weight:400;}.flatpickr-time input:hover,.flatpickr-time .flatpickr-am-pm:hover,.flatpickr-time input:focus,.flatpickr-time .flatpickr-am-pm:focus{background:#eee;}.flatpickr-input[readonly]{cursor:pointer;}@-webkit-keyframes fpFadeInDown{from{opacity:0;-webkit-transform:translate3d(0, -20px, 0);transform:translate3d(0, -20px, 0);}to{opacity:1;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);}}@keyframes fpFadeInDown{from{opacity:0;-webkit-transform:translate3d(0, -20px, 0);transform:translate3d(0, -20px, 0);}to{opacity:1;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);}}.flatpickr-calendar{background:transparent;opacity:0;display:none;text-align:center;visibility:hidden;padding:0;-webkit-animation:none;animation:none;direction:ltr;border:0;font-size:14px;line-height:24px;border-radius:5px;position:absolute;width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-touch-action:manipulation;touch-action:manipulation;-webkit-box-shadow:0 3px 13px rgba(0, 0, 0, 0.08);box-shadow:0 3px 13px rgba(0, 0, 0, 0.08);}.flatpickr-calendar.open,.flatpickr-calendar.inline{opacity:1;max-height:640px;visibility:visible;}.flatpickr-calendar.open{display:inline-block;z-index:99999;}.flatpickr-calendar.animate.open{-webkit-animation:fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);animation:fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);}.flatpickr-calendar.inline{display:block;position:relative;top:2px;}.flatpickr-calendar.static{position:absolute;top:calc(100% + 2px);}.flatpickr-calendar.static.open{z-index:999;display:block;}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+1) .flatpickr-day.inRange:nth-child(7n+7){-webkit-box-shadow:none !important;box-shadow:none !important;}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+2) .flatpickr-day.inRange:nth-child(7n+1){-webkit-box-shadow:-2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;box-shadow:-2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;}.flatpickr-calendar .hasWeeks .dayContainer,.flatpickr-calendar .hasTime .dayContainer{border-bottom:0;border-bottom-right-radius:0;border-bottom-left-radius:0;}.flatpickr-calendar .hasWeeks .dayContainer{border-left:0;}.flatpickr-calendar.hasTime .flatpickr-time{height:40px;border-top:1px solid #eceef1;}.flatpickr-calendar.hasTime .flatpickr-innerContainer{border-bottom:0;}.flatpickr-calendar.hasTime .flatpickr-time{border:1px solid #eceef1;}.flatpickr-calendar.noCalendar.hasTime .flatpickr-time{height:auto;}.flatpickr-calendar:before,.flatpickr-calendar:after{position:absolute;display:block;pointer-events:none;border:solid transparent;content:\'\';height:0;width:0;left:22px;}.flatpickr-calendar.rightMost:before,.flatpickr-calendar.arrowRight:before,.flatpickr-calendar.rightMost:after,.flatpickr-calendar.arrowRight:after{left:auto;right:22px;}.flatpickr-calendar.arrowCenter:before,.flatpickr-calendar.arrowCenter:after{left:50%;right:50%;}.flatpickr-calendar:before{border-width:5px;margin:0 -5px;}.flatpickr-calendar:after{border-width:4px;margin:0 -4px;}.flatpickr-calendar.arrowTop:before,.flatpickr-calendar.arrowTop:after{bottom:100%;}.flatpickr-calendar.arrowTop:before{border-bottom-color:#eceef1;}.flatpickr-calendar.arrowTop:after{border-bottom-color:#eceef1;}.flatpickr-calendar.arrowBottom:before,.flatpickr-calendar.arrowBottom:after{top:100%;}.flatpickr-calendar.arrowBottom:before{border-top-color:#eceef1;}.flatpickr-calendar.arrowBottom:after{border-top-color:#eceef1;}.flatpickr-calendar:focus{outline:0;}.flatpickr-wrapper{position:relative;display:inline-block;}.flatpickr-months{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.flatpickr-months .flatpickr-month{border-radius:5px 5px 0 0;background:#eceef1;color:#5a6171;fill:#5a6171;height:34px;line-height:1;text-align:center;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;}.flatpickr-months .flatpickr-prev-month,.flatpickr-months .flatpickr-next-month{text-decoration:none;cursor:pointer;position:absolute;top:0;height:34px;padding:10px;z-index:3;color:#5a6171;fill:#5a6171;}.flatpickr-months .flatpickr-prev-month.flatpickr-disabled,.flatpickr-months .flatpickr-next-month.flatpickr-disabled{display:none;}.flatpickr-months .flatpickr-prev-month i,.flatpickr-months .flatpickr-next-month i{position:relative;}.flatpickr-months .flatpickr-prev-month.flatpickr-prev-month,.flatpickr-months .flatpickr-next-month.flatpickr-prev-month{left:0;}.flatpickr-months .flatpickr-prev-month.flatpickr-next-month,.flatpickr-months .flatpickr-next-month.flatpickr-next-month{right:0;}.flatpickr-months .flatpickr-prev-month:hover,.flatpickr-months .flatpickr-next-month:hover{color:#bbb;}.flatpickr-months .flatpickr-prev-month:hover svg,.flatpickr-months .flatpickr-next-month:hover svg{fill:#f64747;}.flatpickr-months .flatpickr-prev-month svg,.flatpickr-months .flatpickr-next-month svg{width:14px;height:14px;}.flatpickr-months .flatpickr-prev-month svg path,.flatpickr-months .flatpickr-next-month svg path{-webkit-transition:fill 0.1s;transition:fill 0.1s;fill:inherit;}.numInputWrapper{position:relative;height:auto;}.numInputWrapper input,.numInputWrapper span{display:inline-block;}.numInputWrapper input{width:100%;}.numInputWrapper input::-ms-clear{display:none;}.numInputWrapper input::-webkit-outer-spin-button,.numInputWrapper input::-webkit-inner-spin-button{margin:0;-webkit-appearance:none;}.numInputWrapper span{position:absolute;right:0;width:14px;padding:0 4px 0 2px;height:50%;line-height:50%;opacity:0;cursor:pointer;border:1px solid rgba(72, 72, 72, 0.15);-webkit-box-sizing:border-box;box-sizing:border-box;}.numInputWrapper span:hover{background:rgba(0, 0, 0, 0.1);}.numInputWrapper span:active{background:rgba(0, 0, 0, 0.2);}.numInputWrapper span:after{display:block;content:"";position:absolute;}.numInputWrapper span.arrowUp{top:0;border-bottom:0;}.numInputWrapper span.arrowUp:after{border-left:4px solid transparent;border-right:4px solid transparent;border-bottom:4px solid rgba(72, 72, 72, 0.6);top:26%;}.numInputWrapper span.arrowDown{top:50%;}.numInputWrapper span.arrowDown:after{border-left:4px solid transparent;border-right:4px solid transparent;border-top:4px solid rgba(72, 72, 72, 0.6);top:40%;}.numInputWrapper span svg{width:inherit;height:auto;}.numInputWrapper span svg path{fill:rgba(90, 97, 113, 0.5);}.numInputWrapper:hover{background:rgba(0, 0, 0, 0.05);}.numInputWrapper:hover span{opacity:1;}.flatpickr-current-month{font-size:135%;line-height:inherit;font-weight:300;color:inherit;position:absolute;width:75%;left:12.5%;padding:7.48px 0 0 0;line-height:1;height:34px;display:inline-block;text-align:center;-webkit-transform:translate3d(0px, 0px, 0px);transform:translate3d(0px, 0px, 0px);}.flatpickr-current-month span.cur-month{font-family:inherit;font-weight:700;color:inherit;display:inline-block;margin-left:0.5ch;padding:0;}.flatpickr-current-month span.cur-month:hover{background:rgba(0, 0, 0, 0.05);}.flatpickr-current-month .numInputWrapper{width:6ch;width:7ch\0;display:inline-block;}.flatpickr-current-month .numInputWrapper span.arrowUp:after{border-bottom-color:#5a6171;}.flatpickr-current-month .numInputWrapper span.arrowDown:after{border-top-color:#5a6171;}.flatpickr-current-month input.cur-year{background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;cursor:text;padding:0 0 0 0.5ch;margin:0;display:inline-block;font-size:inherit;font-family:inherit;font-weight:300;line-height:inherit;height:auto;border:0;border-radius:0;vertical-align:initial;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;}.flatpickr-current-month input.cur-year:focus{outline:0;}.flatpickr-current-month input.cur-year[disabled],.flatpickr-current-month input.cur-year[disabled]:hover{font-size:100%;color:rgba(90, 97, 113, 0.5);background:transparent;pointer-events:none;}.flatpickr-current-month .flatpickr-monthDropdown-months{appearance:menulist;background:#eceef1;border:none;border-radius:0;box-sizing:border-box;color:inherit;cursor:pointer;font-size:inherit;font-family:inherit;font-weight:300;height:auto;line-height:inherit;margin:-1px 0 0 0;outline:none;padding:0 0 0 0.5ch;position:relative;vertical-align:initial;-webkit-box-sizing:border-box;-webkit-appearance:menulist;-moz-appearance:menulist;width:auto;}.flatpickr-current-month .flatpickr-monthDropdown-months:focus,.flatpickr-current-month .flatpickr-monthDropdown-months:active{outline:none;}.flatpickr-current-month .flatpickr-monthDropdown-months:hover{background:rgba(0, 0, 0, 0.05);}.flatpickr-current-month .flatpickr-monthDropdown-months .flatpickr-monthDropdown-month{background-color:#eceef1;outline:none;padding:0;}.flatpickr-weekdays{background:#eceef1;text-align:center;overflow:hidden;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;height:28px;}.flatpickr-weekdays .flatpickr-weekdaycontainer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;}span.flatpickr-weekday{cursor:default;font-size:90%;background:#eceef1;color:#5a6171;line-height:1;margin:0;text-align:center;display:block;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;font-weight:bolder;}.dayContainer,.flatpickr-weeks{padding:1px 0 0 0;}.flatpickr-days{position:relative;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;width:307.875px;border-left:1px solid #eceef1;border-right:1px solid #eceef1;}.flatpickr-days:focus{outline:0;}.dayContainer{padding:0;outline:0;text-align:left;width:307.875px;min-width:307.875px;max-width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-wrap:wrap;-ms-flex-pack:justify;-webkit-justify-content:space-around;justify-content:space-around;-webkit-transform:translate3d(0px, 0px, 0px);transform:translate3d(0px, 0px, 0px);opacity:1;}.dayContainer + .dayContainer{-webkit-box-shadow:-1px 0 0 #eceef1;box-shadow:-1px 0 0 #eceef1;}.flatpickr-day{background:none;border:1px solid transparent;border-radius:150px;-webkit-box-sizing:border-box;box-sizing:border-box;color:#484848;cursor:pointer;font-weight:400;width:14.2857143%;-webkit-flex-basis:14.2857143%;-ms-flex-preferred-size:14.2857143%;flex-basis:14.2857143%;max-width:39px;height:39px;line-height:39px;margin:0;display:inline-block;position:relative;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center;}.flatpickr-day.inRange,.flatpickr-day.prevMonthDay.inRange,.flatpickr-day.nextMonthDay.inRange,.flatpickr-day.today.inRange,.flatpickr-day.prevMonthDay.today.inRange,.flatpickr-day.nextMonthDay.today.inRange,.flatpickr-day:hover,.flatpickr-day.prevMonthDay:hover,.flatpickr-day.nextMonthDay:hover,.flatpickr-day:focus,.flatpickr-day.prevMonthDay:focus,.flatpickr-day.nextMonthDay:focus{cursor:pointer;outline:0;background:#e2e2e2;border-color:#e2e2e2;}.flatpickr-day.today{border-color:#bbb;}.flatpickr-day.today:hover,.flatpickr-day.today:focus{border-color:#bbb;background:#bbb;color:#fff;}.flatpickr-day.selected,.flatpickr-day.startRange,.flatpickr-day.endRange,.flatpickr-day.selected.inRange,.flatpickr-day.startRange.inRange,.flatpickr-day.endRange.inRange,.flatpickr-day.selected:focus,.flatpickr-day.startRange:focus,.flatpickr-day.endRange:focus,.flatpickr-day.selected:hover,.flatpickr-day.startRange:hover,.flatpickr-day.endRange:hover,.flatpickr-day.selected.prevMonthDay,.flatpickr-day.startRange.prevMonthDay,.flatpickr-day.endRange.prevMonthDay,.flatpickr-day.selected.nextMonthDay,.flatpickr-day.startRange.nextMonthDay,.flatpickr-day.endRange.nextMonthDay{background:#ff5a5f;-webkit-box-shadow:none;box-shadow:none;color:#fff;border-color:#ff5a5f;}.flatpickr-day.selected.startRange,.flatpickr-day.startRange.startRange,.flatpickr-day.endRange.startRange{border-radius:50px 0 0 50px;}.flatpickr-day.selected.endRange,.flatpickr-day.startRange.endRange,.flatpickr-day.endRange.endRange{border-radius:0 50px 50px 0;}.flatpickr-day.selected.startRange + .endRange:not(:nth-child(7n+1)),.flatpickr-day.startRange.startRange + .endRange:not(:nth-child(7n+1)),.flatpickr-day.endRange.startRange + .endRange:not(:nth-child(7n+1)){-webkit-box-shadow:-10px 0 0 #ff5a5f;box-shadow:-10px 0 0 #ff5a5f;}.flatpickr-day.selected.startRange.endRange,.flatpickr-day.startRange.startRange.endRange,.flatpickr-day.endRange.startRange.endRange{border-radius:50px;}.flatpickr-day.inRange{border-radius:0;-webkit-box-shadow:-5px 0 0 #e2e2e2, 5px 0 0 #e2e2e2;box-shadow:-5px 0 0 #e2e2e2, 5px 0 0 #e2e2e2;}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover,.flatpickr-day.prevMonthDay,.flatpickr-day.nextMonthDay,.flatpickr-day.notAllowed,.flatpickr-day.notAllowed.prevMonthDay,.flatpickr-day.notAllowed.nextMonthDay{color:rgba(72, 72, 72, 0.3);background:transparent;border-color:transparent;cursor:default;}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover{cursor:not-allowed;color:rgba(72, 72, 72, 0.1);}.flatpickr-day.week.selected{border-radius:0;-webkit-box-shadow:-5px 0 0 #ff5a5f, 5px 0 0 #ff5a5f;box-shadow:-5px 0 0 #ff5a5f, 5px 0 0 #ff5a5f;}.flatpickr-day.hidden{visibility:hidden;}.rangeMode .flatpickr-day{margin-top:1px;}.flatpickr-weekwrapper{float:left;}.flatpickr-weekwrapper .flatpickr-weeks{padding:0 12px;border-left:1px solid #eceef1;}.flatpickr-weekwrapper .flatpickr-weekday{float:none;width:100%;line-height:28px;}.flatpickr-weekwrapper span.flatpickr-day,.flatpickr-weekwrapper span.flatpickr-day:hover{display:block;width:100%;max-width:none;color:rgba(72, 72, 72, 0.3);background:transparent;cursor:default;border:none;}.flatpickr-innerContainer{display:block;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;background:#fff;border-bottom:1px solid #eceef1;}.flatpickr-rContainer{display:inline-block;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box;}.flatpickr-time{text-align:center;outline:0;display:block;height:0;line-height:40px;max-height:40px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background:#fff;border-radius:0 0 5px 5px;}.flatpickr-time:after{content:"";display:table;clear:both;}.flatpickr-time .numInputWrapper{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;width:40%;height:40px;float:left;}.flatpickr-time .numInputWrapper span.arrowUp:after{border-bottom-color:#484848;}.flatpickr-time .numInputWrapper span.arrowDown:after{border-top-color:#484848;}.flatpickr-time.hasSeconds .numInputWrapper{width:26%;}.flatpickr-time.time24hr .numInputWrapper{width:49%;}.flatpickr-time input{background:transparent;-webkit-box-shadow:none;box-shadow:none;border:0;border-radius:0;text-align:center;margin:0;padding:0;height:inherit;line-height:inherit;color:#484848;font-size:14px;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;}.flatpickr-time input.flatpickr-hour{font-weight:bold;}.flatpickr-time input.flatpickr-minute,.flatpickr-time input.flatpickr-second{font-weight:400;}.flatpickr-time input:focus{outline:0;border:0;}.flatpickr-time .flatpickr-time-separator,.flatpickr-time .flatpickr-am-pm{height:inherit;float:left;line-height:inherit;color:#484848;font-weight:bold;width:2%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;}.flatpickr-time .flatpickr-am-pm{outline:0;width:18%;cursor:pointer;text-align:center;font-weight:400;}.flatpickr-time input:hover,.flatpickr-time .flatpickr-am-pm:hover,.flatpickr-time input:focus,.flatpickr-time .flatpickr-am-pm:focus{background:#eaeaea;}.flatpickr-input[readonly]{cursor:pointer;}@-webkit-keyframes fpFadeInDown{from{opacity:0;-webkit-transform:translate3d(0, -20px, 0);transform:translate3d(0, -20px, 0);}to{opacity:1;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);}}@keyframes fpFadeInDown{from{opacity:0;-webkit-transform:translate3d(0, -20px, 0);transform:translate3d(0, -20px, 0);}to{opacity:1;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);}}span.flatpickr-day.selected{font-weight:bold;}';function _convert_date_list(e){const t=[];for(const i of e)if(isString(i))t.push(i);else{const[e,n]=i;t.push({from:e,to:n})}return t}class DatePickerView extends InputWidgetView{connect_signals(){super.connect_signals();const{value:e,min_date:t,max_date:i,disabled_dates:n,enabled_dates:o,position:r,inline:s}=this.model.properties;this.connect(e.change,(()=>{var e;return null==(e=this._picker)?void 0:e.setDate(this.model.value)})),this.connect(t.change,(()=>{var e;return null==(e=this._picker)?void 0:e.set("minDate",this.model.min_date)})),this.connect(i.change,(()=>{var e;return null==(e=this._picker)?void 0:e.set("maxDate",this.model.max_date)})),this.connect(n.change,(()=>{var e;return null==(e=this._picker)?void 0:e.set("disable",this.model.disabled_dates)})),this.connect(o.change,(()=>{var e;return null==(e=this._picker)?void 0:e.set("enable",this.model.enabled_dates)})),this.connect(r.change,(()=>{var e;return null==(e=this._picker)?void 0:e.set("position",this.model.position)})),this.connect(s.change,(()=>{var e;return null==(e=this._picker)?void 0:e.set("inline",this.model.inline)}))}remove(){var e;null==(e=this._picker)||e.destroy(),super.remove()}styles(){return[...super.styles(),flatpickr_css]}render(){var e,t;null==this._picker&&(super.render(),this.input_el=input$1({type:"text",class:input,disabled:this.model.disabled}),this.group_el.appendChild(this.input_el),this._picker=flatpickr(this.input_el,{defaultDate:this.model.value,minDate:null!=(e=this.model.min_date)?e:void 0,maxDate:null!=(t=this.model.max_date)?t:void 0,inline:this.model.inline,position:this.model.position,disable:_convert_date_list(this.model.disabled_dates),enable:_convert_date_list(this.model.enabled_dates),onChange:(e,t,i)=>this._on_change(e,t,i)}))}_on_change(e,t,i){this.model.value=t,this.change_input()}}DatePickerView.__name__="DatePickerView";class DatePicker extends InputWidget{constructor(e){super(e)}static init_DatePicker(){this.prototype.default_view=DatePickerView,this.define((({Boolean:e,String:t,Array:i,Tuple:n,Or:o,Nullable:r})=>{const s=i(o(t,n(t,t)));return{value:[t],min_date:[r(t),null],max_date:[r(t),null],disabled_dates:[s,[]],enabled_dates:[s,[]],position:[CalendarPosition,"auto"],inline:[e,!1]}}))}}DatePicker.__name__="DatePicker",DatePicker.init_DatePicker();var nouislider={exports:{}};
/*! nouislider - 14.7.0 - 4/6/2021 */nouislider.exports=function(){var e="14.7.0";function t(e){return"object"==typeof e&&"function"==typeof e.to&&"function"==typeof e.from}function i(e){e.parentElement.removeChild(e)}function n(e){return null!=e}function o(e){e.preventDefault()}function r(e){return e.filter((function(e){return!this[e]&&(this[e]=!0)}),{})}function s(e,t){return Math.round(e/t)*t}function a(e,t){var i=e.getBoundingClientRect(),n=e.ownerDocument,o=n.documentElement,r=g(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(r.x=0),t?i.top+r.y-o.clientTop:i.left+r.x-o.clientLeft}function l(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function c(e,t,i){i>0&&(p(e,t),setTimeout((function(){_(e,t)}),i))}function d(e){return Math.max(Math.min(e,100),0)}function h(e){return Array.isArray(e)?e:[e]}function u(e){var t=(e=String(e)).split(".");return t.length>1?t[1].length:0}function p(e,t){e.classList&&!/\s/.test(t)?e.classList.add(t):e.className+=" "+t}function _(e,t){e.classList&&!/\s/.test(t)?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function f(e,t){return e.classList?e.classList.contains(t):new RegExp("\\b"+t+"\\b").test(e.className)}function g(e){var t=void 0!==window.pageXOffset,i="CSS1Compat"===(e.compatMode||"");return{x:t?window.pageXOffset:i?e.documentElement.scrollLeft:e.body.scrollLeft,y:t?window.pageYOffset:i?e.documentElement.scrollTop:e.body.scrollTop}}function m(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function v(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(i){}return e}function b(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function y(e,t){return 100/(t-e)}function w(e,t,i){return 100*t/(e[i+1]-e[i])}function A(e,t){return w(e,e[0]<0?t+Math.abs(e[0]):t-e[0],0)}function x(e,t){return t*(e[1]-e[0])/100+e[0]}function k(e,t){for(var i=1;e>=t[i];)i+=1;return i}function C(e,t,i){if(i>=e.slice(-1)[0])return 100;var n=k(i,e),o=e[n-1],r=e[n],s=t[n-1],a=t[n];return s+A([o,r],i)/y(s,a)}function S(e,t,i){if(i>=100)return e.slice(-1)[0];var n=k(i,t),o=e[n-1],r=e[n],s=t[n-1];return x([o,r],(i-s)*y(s,t[n]))}function T(e,t,i,n){if(100===n)return n;var o=k(n,e),r=e[o-1],a=e[o];return i?n-r>(a-r)/2?a:r:t[o-1]?e[o-1]+s(n-e[o-1],t[o-1]):n}function R(t,i,n){var o;if("number"==typeof i&&(i=[i]),!Array.isArray(i))throw new Error("noUiSlider ("+e+"): 'range' contains invalid value.");if(!l(o="min"===t?0:"max"===t?100:parseFloat(t))||!l(i[0]))throw new Error("noUiSlider ("+e+"): 'range' value isn't numeric.");n.xPct.push(o),n.xVal.push(i[0]),o?n.xSteps.push(!isNaN(i[1])&&i[1]):isNaN(i[1])||(n.xSteps[0]=i[1]),n.xHighestCompleteStep.push(0)}function E(e,t,i){if(t)if(i.xVal[e]!==i.xVal[e+1]){i.xSteps[e]=w([i.xVal[e],i.xVal[e+1]],t,0)/y(i.xPct[e],i.xPct[e+1]);var n=(i.xVal[e+1]-i.xVal[e])/i.xNumSteps[e],o=Math.ceil(Number(n.toFixed(3))-1),r=i.xVal[e]+i.xNumSteps[e]*o;i.xHighestCompleteStep[e]=r}else i.xSteps[e]=i.xHighestCompleteStep[e]=i.xVal[e]}function P(e,t,i){var n;this.xPct=[],this.xVal=[],this.xSteps=[i||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=t;var o=[];for(n in e)e.hasOwnProperty(n)&&o.push([e[n],n]);for(o.length&&"object"==typeof o[0][0]?o.sort((function(e,t){return e[0][0]-t[0][0]})):o.sort((function(e,t){return e[0]-t[0]})),n=0;n<o.length;n++)R(o[n][1],o[n][0],this);for(this.xNumSteps=this.xSteps.slice(0),n=0;n<this.xNumSteps.length;n++)E(n,this.xNumSteps[n],this)}P.prototype.getDistance=function(t){var i,n=[];for(i=0;i<this.xNumSteps.length-1;i++){var o=this.xNumSteps[i];if(o&&t/o%1!=0)throw new Error("noUiSlider ("+e+"): 'limit', 'margin' and 'padding' of "+this.xPct[i]+"% range must be divisible by step.");n[i]=w(this.xVal,t,i)}return n},P.prototype.getAbsoluteDistance=function(e,t,i){var n,o=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[o+1];)o++;else e===this.xPct[this.xPct.length-1]&&(o=this.xPct.length-2);i||e!==this.xPct[o+1]||o++;var r=1,s=t[o],a=0,l=0,c=0,d=0;for(n=i?(e-this.xPct[o])/(this.xPct[o+1]-this.xPct[o]):(this.xPct[o+1]-e)/(this.xPct[o+1]-this.xPct[o]);s>0;)a=this.xPct[o+1+d]-this.xPct[o+d],t[o+d]*r+100-100*n>100?(l=a*n,r=(s-100*n)/t[o+d],n=1):(l=t[o+d]*a/100*r,r=0),i?(c-=l,this.xPct.length+d>=1&&d--):(c+=l,this.xPct.length-d>=1&&d++),s=t[o+d]*r;return e+c},P.prototype.toStepping=function(e){return e=C(this.xVal,this.xPct,e)},P.prototype.fromStepping=function(e){return S(this.xVal,this.xPct,e)},P.prototype.getStep=function(e){return e=T(this.xPct,this.xSteps,this.snap,e)},P.prototype.getDefaultStep=function(e,t,i){var n=k(e,this.xPct);return(100===e||t&&e===this.xPct[n-1])&&(n=Math.max(n-1,1)),(this.xVal[n]-this.xVal[n-1])/i},P.prototype.getNearbySteps=function(e){var t=k(e,this.xPct);return{stepBefore:{startValue:this.xVal[t-2],step:this.xNumSteps[t-2],highestStep:this.xHighestCompleteStep[t-2]},thisStep:{startValue:this.xVal[t-1],step:this.xNumSteps[t-1],highestStep:this.xHighestCompleteStep[t-1]},stepAfter:{startValue:this.xVal[t],step:this.xNumSteps[t],highestStep:this.xHighestCompleteStep[t]}}},P.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(u);return Math.max.apply(null,e)},P.prototype.convert=function(e){return this.getStep(this.toStepping(e))};var M={to:function(e){return void 0!==e&&e.toFixed(2)},from:Number},D={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},I={tooltips:".__tooltips",aria:".__aria"};function B(i){if(t(i))return!0;throw new Error("noUiSlider ("+e+"): 'format' requires 'to' and 'from' methods.")}function z(t,i){if(!l(i))throw new Error("noUiSlider ("+e+"): 'step' is not numeric.");t.singleStep=i}function L(t,i){if(!l(i))throw new Error("noUiSlider ("+e+"): 'keyboardPageMultiplier' is not numeric.");t.keyboardPageMultiplier=i}function N(t,i){if(!l(i))throw new Error("noUiSlider ("+e+"): 'keyboardDefaultStep' is not numeric.");t.keyboardDefaultStep=i}function $(t,i){if("object"!=typeof i||Array.isArray(i))throw new Error("noUiSlider ("+e+"): 'range' is not an object.");if(void 0===i.min||void 0===i.max)throw new Error("noUiSlider ("+e+"): Missing 'min' or 'max' in 'range'.");if(i.min===i.max)throw new Error("noUiSlider ("+e+"): 'range' 'min' and 'max' cannot be equal.");t.spectrum=new P(i,t.snap,t.singleStep)}function V(t,i){if(i=h(i),!Array.isArray(i)||!i.length)throw new Error("noUiSlider ("+e+"): 'start' option is incorrect.");t.handles=i.length,t.start=i}function O(t,i){if(t.snap=i,"boolean"!=typeof i)throw new Error("noUiSlider ("+e+"): 'snap' option must be a boolean.")}function F(t,i){if(t.animate=i,"boolean"!=typeof i)throw new Error("noUiSlider ("+e+"): 'animate' option must be a boolean.")}function G(t,i){if(t.animationDuration=i,"number"!=typeof i)throw new Error("noUiSlider ("+e+"): 'animationDuration' option must be a number.")}function H(t,i){var n,o=[!1];if("lower"===i?i=[!0,!1]:"upper"===i&&(i=[!1,!0]),!0===i||!1===i){for(n=1;n<t.handles;n++)o.push(i);o.push(!1)}else{if(!Array.isArray(i)||!i.length||i.length!==t.handles+1)throw new Error("noUiSlider ("+e+"): 'connect' option doesn't match handle count.");o=i}t.connect=o}function j(t,i){switch(i){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider ("+e+"): 'orientation' option is invalid.")}}function U(t,i){if(!l(i))throw new Error("noUiSlider ("+e+"): 'margin' option must be numeric.");0!==i&&(t.margin=t.spectrum.getDistance(i))}function W(t,i){if(!l(i))throw new Error("noUiSlider ("+e+"): 'limit' option must be numeric.");if(t.limit=t.spectrum.getDistance(i),!t.limit||t.handles<2)throw new Error("noUiSlider ("+e+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function Y(t,i){var n;if(!l(i)&&!Array.isArray(i))throw new Error("noUiSlider ("+e+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(i)&&2!==i.length&&!l(i[0])&&!l(i[1]))throw new Error("noUiSlider ("+e+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==i){for(Array.isArray(i)||(i=[i,i]),t.padding=[t.spectrum.getDistance(i[0]),t.spectrum.getDistance(i[1])],n=0;n<t.spectrum.xNumSteps.length-1;n++)if(t.padding[0][n]<0||t.padding[1][n]<0)throw new Error("noUiSlider ("+e+"): 'padding' option must be a positive number(s).");var o=i[0]+i[1],r=t.spectrum.xVal[0];if(o/(t.spectrum.xVal[t.spectrum.xVal.length-1]-r)>1)throw new Error("noUiSlider ("+e+"): 'padding' option must not exceed 100% of the range.")}}function q(t,i){switch(i){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider ("+e+"): 'direction' option was not recognized.")}}function X(t,i){if("string"!=typeof i)throw new Error("noUiSlider ("+e+"): 'behaviour' must be a string containing options.");var n=i.indexOf("tap")>=0,o=i.indexOf("drag")>=0,r=i.indexOf("fixed")>=0,s=i.indexOf("snap")>=0,a=i.indexOf("hover")>=0,l=i.indexOf("unconstrained")>=0;if(r){if(2!==t.handles)throw new Error("noUiSlider ("+e+"): 'fixed' behaviour must be used with 2 handles");U(t,t.start[1]-t.start[0])}if(l&&(t.margin||t.limit))throw new Error("noUiSlider ("+e+"): 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:n||s,drag:o,fixed:r,snap:s,hover:a,unconstrained:l}}function K(t,i){if(!1!==i)if(!0===i){t.tooltips=[];for(var n=0;n<t.handles;n++)t.tooltips.push(!0)}else{if(t.tooltips=h(i),t.tooltips.length!==t.handles)throw new Error("noUiSlider ("+e+"): must pass a formatter for all handles.");t.tooltips.forEach((function(t){if("boolean"!=typeof t&&("object"!=typeof t||"function"!=typeof t.to))throw new Error("noUiSlider ("+e+"): 'tooltips' must be passed a formatter or 'false'.")}))}}function J(e,t){e.ariaFormat=t,B(t)}function Q(e,t){e.format=t,B(t)}function Z(t,i){if(t.keyboardSupport=i,"boolean"!=typeof i)throw new Error("noUiSlider ("+e+"): 'keyboardSupport' option must be a boolean.")}function ee(e,t){e.documentElement=t}function te(t,i){if("string"!=typeof i&&!1!==i)throw new Error("noUiSlider ("+e+"): 'cssPrefix' must be a string or `false`.");t.cssPrefix=i}function ie(t,i){if("object"!=typeof i)throw new Error("noUiSlider ("+e+"): 'cssClasses' must be an object.");if("string"==typeof t.cssPrefix)for(var n in t.cssClasses={},i)i.hasOwnProperty(n)&&(t.cssClasses[n]=t.cssPrefix+i[n]);else t.cssClasses=i}function ne(t){var i={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:M,format:M},o={step:{r:!1,t:z},keyboardPageMultiplier:{r:!1,t:L},keyboardDefaultStep:{r:!1,t:N},start:{r:!0,t:V},connect:{r:!0,t:H},direction:{r:!0,t:q},snap:{r:!1,t:O},animate:{r:!1,t:F},animationDuration:{r:!1,t:G},range:{r:!0,t:$},orientation:{r:!1,t:j},margin:{r:!1,t:U},limit:{r:!1,t:W},padding:{r:!1,t:Y},behaviour:{r:!0,t:X},ariaFormat:{r:!1,t:J},format:{r:!1,t:Q},tooltips:{r:!1,t:K},keyboardSupport:{r:!0,t:Z},documentElement:{r:!1,t:ee},cssPrefix:{r:!0,t:te},cssClasses:{r:!0,t:ie}},r={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:D,keyboardPageMultiplier:5,keyboardDefaultStep:10};t.format&&!t.ariaFormat&&(t.ariaFormat=t.format),Object.keys(o).forEach((function(s){if(!n(t[s])&&void 0===r[s]){if(o[s].r)throw new Error("noUiSlider ("+e+"): '"+s+"' is required.");return!0}o[s].t(i,n(t[s])?t[s]:r[s])})),i.pips=t.pips;var s=document.createElement("div"),a=void 0!==s.style.msTransform,l=void 0!==s.style.transform;i.transformRule=l?"transform":a?"msTransform":"webkitTransform";var c=[["left","top"],["right","bottom"]];return i.style=c[i.dir][i.ort],i}function oe(t,s,l){var u,y,w,A,x,k,C=m(),S=b()&&v(),T=t,R=s.spectrum,E=[],P=[],M=[],D=0,B={},z=t.ownerDocument,L=s.documentElement||z.documentElement,N=z.body,$=-1,V=0,O=1,F=2,G="rtl"===z.dir||1===s.ort?0:100;function H(e,t){var i=z.createElement("div");return t&&p(i,t),e.appendChild(i),i}function j(e,t){var i=H(e,s.cssClasses.origin),n=H(i,s.cssClasses.handle);return H(n,s.cssClasses.touchArea),n.setAttribute("data-handle",t),s.keyboardSupport&&(n.setAttribute("tabindex","0"),n.addEventListener("keydown",(function(e){return me(e,t)}))),n.setAttribute("role","slider"),n.setAttribute("aria-orientation",s.ort?"vertical":"horizontal"),0===t?p(n,s.cssClasses.handleLower):t===s.handles-1&&p(n,s.cssClasses.handleUpper),i}function U(e,t){return!!t&&H(e,s.cssClasses.connect)}function W(e,t){var i=H(t,s.cssClasses.connects);y=[],(w=[]).push(U(i,e[0]));for(var n=0;n<s.handles;n++)y.push(j(t,n)),M[n]=n,w.push(U(i,e[n+1]))}function Y(e){return p(e,s.cssClasses.target),0===s.dir?p(e,s.cssClasses.ltr):p(e,s.cssClasses.rtl),0===s.ort?p(e,s.cssClasses.horizontal):p(e,s.cssClasses.vertical),p(e,"rtl"===getComputedStyle(e).direction?s.cssClasses.textDirectionRtl:s.cssClasses.textDirectionLtr),H(e,s.cssClasses.base)}function q(e,t){return!!s.tooltips[t]&&H(e.firstChild,s.cssClasses.tooltip)}function X(){return T.hasAttribute("disabled")}function K(e){return y[e].hasAttribute("disabled")}function J(){x&&(we("update"+I.tooltips),x.forEach((function(e){e&&i(e)})),x=null)}function Q(){J(),x=y.map(q),be("update"+I.tooltips,(function(e,t,i){if(x[t]){var n=e[t];!0!==s.tooltips[t]&&(n=s.tooltips[t].to(i[t])),x[t].innerHTML=n}}))}function Z(){we("update"+I.aria),be("update"+I.aria,(function(e,t,i,n,o){M.forEach((function(e){var t=y[e],n=xe(P,e,0,!0,!0,!0),r=xe(P,e,100,!0,!0,!0),a=o[e],l=s.ariaFormat.to(i[e]);n=R.fromStepping(n).toFixed(1),r=R.fromStepping(r).toFixed(1),a=R.fromStepping(a).toFixed(1),t.children[0].setAttribute("aria-valuemin",n),t.children[0].setAttribute("aria-valuemax",r),t.children[0].setAttribute("aria-valuenow",a),t.children[0].setAttribute("aria-valuetext",l)}))}))}function ee(t,i,n){if("range"===t||"steps"===t)return R.xVal;if("count"===t){if(i<2)throw new Error("noUiSlider ("+e+"): 'values' (>= 2) required for mode 'count'.");var o=i-1,r=100/o;for(i=[];o--;)i[o]=o*r;i.push(100),t="positions"}return"positions"===t?i.map((function(e){return R.fromStepping(n?R.getStep(e):e)})):"values"===t?n?i.map((function(e){return R.fromStepping(R.getStep(R.toStepping(e)))})):i:void 0}function te(e,t,i){function n(e,t){return(e+t).toFixed(7)/1}var o={},s=R.xVal[0],a=R.xVal[R.xVal.length-1],l=!1,c=!1,d=0;return(i=r(i.slice().sort((function(e,t){return e-t}))))[0]!==s&&(i.unshift(s),l=!0),i[i.length-1]!==a&&(i.push(a),c=!0),i.forEach((function(r,s){var a,h,u,p,_,f,g,m,v,b,y=r,w=i[s+1],A="steps"===t;if(A&&(a=R.xNumSteps[s]),a||(a=w-y),!1!==y)for(void 0===w&&(w=y),a=Math.max(a,1e-7),h=y;h<=w;h=n(h,a)){for(m=(_=(p=R.toStepping(h))-d)/e,b=_/(v=Math.round(m)),u=1;u<=v;u+=1)o[(f=d+u*b).toFixed(5)]=[R.fromStepping(f),0];g=i.indexOf(h)>-1?O:A?F:V,!s&&l&&h!==w&&(g=0),h===w&&c||(o[p.toFixed(5)]=[h,g]),d=p}})),o}function ie(e,t,i){var n=z.createElement("div"),o=[];o[V]=s.cssClasses.valueNormal,o[O]=s.cssClasses.valueLarge,o[F]=s.cssClasses.valueSub;var r=[];r[V]=s.cssClasses.markerNormal,r[O]=s.cssClasses.markerLarge,r[F]=s.cssClasses.markerSub;var a=[s.cssClasses.valueHorizontal,s.cssClasses.valueVertical],l=[s.cssClasses.markerHorizontal,s.cssClasses.markerVertical];function c(e,t){var i=t===s.cssClasses.value,n=i?o:r;return t+" "+(i?a:l)[s.ort]+" "+n[e]}function d(e,o,r){if((r=t?t(o,r):r)!==$){var a=H(n,!1);a.className=c(r,s.cssClasses.marker),a.style[s.style]=e+"%",r>V&&((a=H(n,!1)).className=c(r,s.cssClasses.value),a.setAttribute("data-value",o),a.style[s.style]=e+"%",a.innerHTML=i.to(o))}}return p(n,s.cssClasses.pips),p(n,0===s.ort?s.cssClasses.pipsHorizontal:s.cssClasses.pipsVertical),Object.keys(e).forEach((function(t){d(t,e[t][0],e[t][1])})),n}function oe(){A&&(i(A),A=null)}function re(e){oe();var t=e.mode,i=e.density||1,n=e.filter||!1,o=te(i,t,ee(t,e.values||!1,e.stepped||!1)),r=e.format||{to:Math.round};return A=T.appendChild(ie(o,n,r))}function se(){var e=u.getBoundingClientRect(),t="offset"+["Width","Height"][s.ort];return 0===s.ort?e.width||u[t]:e.height||u[t]}function ae(e,t,i,n){var o=function(o){return!!(o=le(o,n.pageOffset,n.target||t))&&!(X()&&!n.doNotReject)&&!(f(T,s.cssClasses.tap)&&!n.doNotReject)&&!(e===C.start&&void 0!==o.buttons&&o.buttons>1)&&(!n.hover||!o.buttons)&&(S||o.preventDefault(),o.calcPoint=o.points[s.ort],void i(o,n))},r=[];return e.split(" ").forEach((function(e){t.addEventListener(e,o,!!S&&{passive:!0}),r.push([e,o])})),r}function le(e,t,i){var n,o,r=0===e.type.indexOf("touch"),s=0===e.type.indexOf("mouse"),a=0===e.type.indexOf("pointer");if(0===e.type.indexOf("MSPointer")&&(a=!0),"mousedown"===e.type&&!e.buttons&&!e.touches)return!1;if(r){var l=function(e){return e.target===i||i.contains(e.target)||e.target.shadowRoot&&e.target.shadowRoot.contains(i)};if("touchstart"===e.type){var c=Array.prototype.filter.call(e.touches,l);if(c.length>1)return!1;n=c[0].pageX,o=c[0].pageY}else{var d=Array.prototype.find.call(e.changedTouches,l);if(!d)return!1;n=d.pageX,o=d.pageY}}return t=t||g(z),(s||a)&&(n=e.clientX+t.x,o=e.clientY+t.y),e.pageOffset=t,e.points=[n,o],e.cursor=s||a,e}function ce(e){var t=100*(e-a(u,s.ort))/se();return t=d(t),s.dir?100-t:t}function de(e){var t=100,i=!1;return y.forEach((function(n,o){if(!K(o)){var r=P[o],s=Math.abs(r-e);(s<t||s<=t&&e>r||100===s&&100===t)&&(i=o,t=s)}})),i}function he(e,t){"mouseout"===e.type&&"HTML"===e.target.nodeName&&null===e.relatedTarget&&pe(e,t)}function ue(e,t){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===e.buttons&&0!==t.buttonsProperty)return pe(e,t);var i=(s.dir?-1:1)*(e.calcPoint-t.startCalcPoint);Ce(i>0,100*i/t.baseSize,t.locations,t.handleNumbers)}function pe(e,t){t.handle&&(_(t.handle,s.cssClasses.active),D-=1),t.listeners.forEach((function(e){L.removeEventListener(e[0],e[1])})),0===D&&(_(T,s.cssClasses.drag),Re(),e.cursor&&(N.style.cursor="",N.removeEventListener("selectstart",o))),t.handleNumbers.forEach((function(e){Ae("change",e),Ae("set",e),Ae("end",e)}))}function _e(e,t){if(t.handleNumbers.some(K))return!1;var i;1===t.handleNumbers.length&&(i=y[t.handleNumbers[0]].children[0],D+=1,p(i,s.cssClasses.active)),e.stopPropagation();var n=[],r=ae(C.move,L,ue,{target:e.target,handle:i,listeners:n,startCalcPoint:e.calcPoint,baseSize:se(),pageOffset:e.pageOffset,handleNumbers:t.handleNumbers,buttonsProperty:e.buttons,locations:P.slice()}),a=ae(C.end,L,pe,{target:e.target,handle:i,listeners:n,doNotReject:!0,handleNumbers:t.handleNumbers}),l=ae("mouseout",L,he,{target:e.target,handle:i,listeners:n,doNotReject:!0,handleNumbers:t.handleNumbers});n.push.apply(n,r.concat(a,l)),e.cursor&&(N.style.cursor=getComputedStyle(e.target).cursor,y.length>1&&p(T,s.cssClasses.drag),N.addEventListener("selectstart",o,!1)),t.handleNumbers.forEach((function(e){Ae("start",e)}))}function fe(e){e.stopPropagation();var t=ce(e.calcPoint),i=de(t);if(!1===i)return!1;s.events.snap||c(T,s.cssClasses.tap,s.animationDuration),Ee(i,t,!0,!0),Re(),Ae("slide",i,!0),Ae("update",i,!0),Ae("change",i,!0),Ae("set",i,!0),s.events.snap&&_e(e,{handleNumbers:[i]})}function ge(e){var t=ce(e.calcPoint),i=R.getStep(t),n=R.fromStepping(i);Object.keys(B).forEach((function(e){"hover"===e.split(".")[0]&&B[e].forEach((function(e){e.call(k,n)}))}))}function me(e,t){if(X()||K(t))return!1;var i=["Left","Right"],n=["Down","Up"],o=["PageDown","PageUp"],r=["Home","End"];s.dir&&!s.ort?i.reverse():s.ort&&!s.dir&&(n.reverse(),o.reverse());var a,l=e.key.replace("Arrow",""),c=l===o[0],d=l===o[1],h=l===n[0]||l===i[0]||c,u=l===n[1]||l===i[1]||d,p=l===r[0],_=l===r[1];if(!(h||u||p||_))return!0;if(e.preventDefault(),u||h){var f=s.keyboardPageMultiplier,g=h?0:1,m=Ne(t)[g];if(null===m)return!1;!1===m&&(m=R.getDefaultStep(P[t],h,s.keyboardDefaultStep)),(d||c)&&(m*=f),m=Math.max(m,1e-7),m*=h?-1:1,a=E[t]+m}else a=_?s.spectrum.xVal[s.spectrum.xVal.length-1]:s.spectrum.xVal[0];return Ee(t,R.toStepping(a),!0,!0),Ae("slide",t),Ae("update",t),Ae("change",t),Ae("set",t),!1}function ve(e){e.fixed||y.forEach((function(e,t){ae(C.start,e.children[0],_e,{handleNumbers:[t]})})),e.tap&&ae(C.start,u,fe,{}),e.hover&&ae(C.move,u,ge,{hover:!0}),e.drag&&w.forEach((function(t,i){if(!1!==t&&0!==i&&i!==w.length-1){var n=y[i-1],o=y[i],r=[t];p(t,s.cssClasses.draggable),e.fixed&&(r.push(n.children[0]),r.push(o.children[0])),r.forEach((function(e){ae(C.start,e,_e,{handles:[n,o],handleNumbers:[i-1,i]})}))}}))}function be(e,t){B[e]=B[e]||[],B[e].push(t),"update"===e.split(".")[0]&&y.forEach((function(e,t){Ae("update",t)}))}function ye(e){return e===I.aria||e===I.tooltips}function we(e){var t=e&&e.split(".")[0],i=t?e.substring(t.length):e;Object.keys(B).forEach((function(e){var n=e.split(".")[0],o=e.substring(n.length);t&&t!==n||i&&i!==o||ye(o)&&i!==o||delete B[e]}))}function Ae(e,t,i){Object.keys(B).forEach((function(n){var o=n.split(".")[0];e===o&&B[n].forEach((function(e){e.call(k,E.map(s.format.to),t,E.slice(),i||!1,P.slice(),k)}))}))}function xe(e,t,i,n,o,r){var a;return y.length>1&&!s.events.unconstrained&&(n&&t>0&&(a=R.getAbsoluteDistance(e[t-1],s.margin,0),i=Math.max(i,a)),o&&t<y.length-1&&(a=R.getAbsoluteDistance(e[t+1],s.margin,1),i=Math.min(i,a))),y.length>1&&s.limit&&(n&&t>0&&(a=R.getAbsoluteDistance(e[t-1],s.limit,0),i=Math.min(i,a)),o&&t<y.length-1&&(a=R.getAbsoluteDistance(e[t+1],s.limit,1),i=Math.max(i,a))),s.padding&&(0===t&&(a=R.getAbsoluteDistance(0,s.padding[0],0),i=Math.max(i,a)),t===y.length-1&&(a=R.getAbsoluteDistance(100,s.padding[1],1),i=Math.min(i,a))),!((i=d(i=R.getStep(i)))===e[t]&&!r)&&i}function ke(e,t){var i=s.ort;return(i?t:e)+", "+(i?e:t)}function Ce(e,t,i,n){var o=i.slice(),r=[!e,e],s=[e,!e];n=n.slice(),e&&n.reverse(),n.length>1?n.forEach((function(e,i){var n=xe(o,e,o[e]+t,r[i],s[i],!1);!1===n?t=0:(t=n-o[e],o[e]=n)})):r=s=[!0];var a=!1;n.forEach((function(e,n){a=Ee(e,i[e]+t,r[n],s[n])||a})),a&&n.forEach((function(e){Ae("update",e),Ae("slide",e)}))}function Se(e,t){return s.dir?100-e-t:e}function Te(e,t){P[e]=t,E[e]=R.fromStepping(t);var i="translate("+ke(10*(Se(t,0)-G)+"%","0")+")";y[e].style[s.transformRule]=i,Pe(e),Pe(e+1)}function Re(){M.forEach((function(e){var t=P[e]>50?-1:1,i=3+(y.length+t*e);y[e].style.zIndex=i}))}function Ee(e,t,i,n,o){return o||(t=xe(P,e,t,i,n,!1)),!1!==t&&(Te(e,t),!0)}function Pe(e){if(w[e]){var t=0,i=100;0!==e&&(t=P[e-1]),e!==w.length-1&&(i=P[e]);var n=i-t,o="translate("+ke(Se(t,n)+"%","0")+")",r="scale("+ke(n/100,"1")+")";w[e].style[s.transformRule]=o+" "+r}}function Me(e,t){return null===e||!1===e||void 0===e?P[t]:("number"==typeof e&&(e=String(e)),e=s.format.from(e),!1===(e=R.toStepping(e))||isNaN(e)?P[t]:e)}function De(e,t,i){var n=h(e),o=void 0===P[0];t=void 0===t||!!t,s.animate&&!o&&c(T,s.cssClasses.tap,s.animationDuration),M.forEach((function(e){Ee(e,Me(n[e],e),!0,!1,i)}));for(var r=1===M.length?0:1;r<M.length;++r)M.forEach((function(e){Ee(e,P[e],!0,!0,i)}));Re(),M.forEach((function(e){Ae("update",e),null!==n[e]&&t&&Ae("set",e)}))}function Ie(e){De(s.start,e)}function Be(t,i,n,o){if(!((t=Number(t))>=0&&t<M.length))throw new Error("noUiSlider ("+e+"): invalid handle number, got: "+t);Ee(t,Me(i,t),!0,!0,o),Ae("update",t),n&&Ae("set",t)}function ze(){var e=E.map(s.format.to);return 1===e.length?e[0]:e}function Le(){for(var e in we(I.aria),we(I.tooltips),s.cssClasses)s.cssClasses.hasOwnProperty(e)&&_(T,s.cssClasses[e]);for(;T.firstChild;)T.removeChild(T.firstChild);delete T.noUiSlider}function Ne(e){var t=P[e],i=R.getNearbySteps(t),n=E[e],o=i.thisStep.step,r=null;if(s.snap)return[n-i.stepBefore.startValue||null,i.stepAfter.startValue-n||null];!1!==o&&n+o>i.stepAfter.startValue&&(o=i.stepAfter.startValue-n),r=n>i.thisStep.startValue?i.thisStep.step:!1!==i.stepBefore.step&&n-i.stepBefore.highestStep,100===t?o=null:0===t&&(r=null);var a=R.countStepDecimals();return null!==o&&!1!==o&&(o=Number(o.toFixed(a))),null!==r&&!1!==r&&(r=Number(r.toFixed(a))),[r,o]}function $e(){return M.map(Ne)}function Ve(e,t){var i=ze(),o=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];o.forEach((function(t){void 0!==e[t]&&(l[t]=e[t])}));var r=ne(l);o.forEach((function(t){void 0!==e[t]&&(s[t]=r[t])})),R=r.spectrum,s.margin=r.margin,s.limit=r.limit,s.padding=r.padding,s.pips?re(s.pips):oe(),s.tooltips?Q():J(),P=[],De(n(e.start)?e.start:i,t)}function Oe(){u=Y(T),W(s.connect,u),ve(s.events),De(s.start),s.pips&&re(s.pips),s.tooltips&&Q(),Z()}return Oe(),k={destroy:Le,steps:$e,on:be,off:we,get:ze,set:De,setHandle:Be,reset:Ie,__moveHandles:function(e,t,i){Ce(e,t,P,i)},options:l,updateOptions:Ve,target:T,removePips:oe,removeTooltips:J,getTooltips:function(){return x},getOrigins:function(){return y},pips:re}}function re(t,i){if(!t||!t.nodeName)throw new Error("noUiSlider ("+e+"): create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider ("+e+"): Slider was already initialized.");var n=oe(t,ne(i),i);return t.noUiSlider=n,n}return{__spectrum:P,version:e,cssClasses:D,create:re}}();const slider_title="bk-slider-title",slider_value="bk-slider-value";var sliders_css=".bk-root .bk-slider-title{white-space:nowrap;}.bk-root .bk-slider-value{font-weight:600;}",nouislider_css='.bk-root{}.bk-root .noUi-target,.bk-root .noUi-target *{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-user-select:none;-ms-touch-action:none;touch-action:none;-ms-user-select:none;-moz-user-select:none;user-select:none;-moz-box-sizing:border-box;box-sizing:border-box;}.bk-root .noUi-target{position:relative;}.bk-root .noUi-base,.bk-root .noUi-connects{width:100%;height:100%;position:relative;z-index:1;}.bk-root .noUi-connects{overflow:hidden;z-index:0;}.bk-root .noUi-connect,.bk-root .noUi-origin{will-change:transform;position:absolute;z-index:1;top:0;right:0;-ms-transform-origin:0 0;-webkit-transform-origin:0 0;-webkit-transform-style:preserve-3d;transform-origin:0 0;transform-style:flat;}.bk-root .noUi-connect{height:100%;width:100%;}.bk-root .noUi-origin{height:10%;width:10%;}.bk-root .noUi-txt-dir-rtl.noUi-horizontal .noUi-origin{left:0;right:auto;}.bk-root .noUi-vertical .noUi-origin{width:0;}.bk-root .noUi-horizontal .noUi-origin{height:0;}.bk-root .noUi-handle{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;}.bk-root .noUi-touch-area{height:100%;width:100%;}.bk-root .noUi-state-tap .noUi-connect,.bk-root .noUi-state-tap .noUi-origin{-webkit-transition:transform 0.3s;transition:transform 0.3s;}.bk-root .noUi-state-drag *{cursor:inherit !important;}.bk-root .noUi-horizontal{height:18px;}.bk-root .noUi-horizontal .noUi-handle{width:34px;height:28px;right:-17px;top:-6px;}.bk-root .noUi-vertical{width:18px;}.bk-root .noUi-vertical .noUi-handle{width:28px;height:34px;right:-6px;top:-17px;}.bk-root .noUi-txt-dir-rtl.noUi-horizontal .noUi-handle{left:-17px;right:auto;}.bk-root .noUi-target{background:#FAFAFA;border-radius:4px;border:1px solid #D3D3D3;box-shadow:inset 0 1px 1px #F0F0F0, 0 3px 6px -5px #BBB;}.bk-root .noUi-connects{border-radius:3px;}.bk-root .noUi-connect{background:#3FB8AF;}.bk-root .noUi-draggable{cursor:ew-resize;}.bk-root .noUi-vertical .noUi-draggable{cursor:ns-resize;}.bk-root .noUi-handle{border:1px solid #D9D9D9;border-radius:3px;background:#FFF;cursor:default;box-shadow:inset 0 0 1px #FFF, inset 0 1px 7px #EBEBEB, 0 3px 6px -3px #BBB;}.bk-root .noUi-active{box-shadow:inset 0 0 1px #FFF, inset 0 1px 7px #DDD, 0 3px 6px -3px #BBB;}.bk-root .noUi-handle:before,.bk-root .noUi-handle:after{content:"";display:block;position:absolute;height:14px;width:1px;background:#E8E7E6;left:14px;top:6px;}.bk-root .noUi-handle:after{left:17px;}.bk-root .noUi-vertical .noUi-handle:before,.bk-root .noUi-vertical .noUi-handle:after{width:14px;height:1px;left:6px;top:14px;}.bk-root .noUi-vertical .noUi-handle:after{top:17px;}.bk-root [disabled] .noUi-connect{background:#B8B8B8;}.bk-root [disabled].noUi-target,.bk-root [disabled].noUi-handle,.bk-root [disabled] .noUi-handle{cursor:not-allowed;}.bk-root .noUi-pips,.bk-root .noUi-pips *{-moz-box-sizing:border-box;box-sizing:border-box;}.bk-root .noUi-pips{position:absolute;color:#999;}.bk-root .noUi-value{position:absolute;white-space:nowrap;text-align:center;}.bk-root .noUi-value-sub{color:#ccc;font-size:10px;}.bk-root .noUi-marker{position:absolute;background:#CCC;}.bk-root .noUi-marker-sub{background:#AAA;}.bk-root .noUi-marker-large{background:#AAA;}.bk-root .noUi-pips-horizontal{padding:10px 0;height:80px;top:100%;left:0;width:100%;}.bk-root .noUi-value-horizontal{-webkit-transform:translate(-50%, 50%);transform:translate(-50%, 50%);}.bk-root .noUi-rtl .noUi-value-horizontal{-webkit-transform:translate(50%, 50%);transform:translate(50%, 50%);}.bk-root .noUi-marker-horizontal.noUi-marker{margin-left:-1px;width:2px;height:5px;}.bk-root .noUi-marker-horizontal.noUi-marker-sub{height:10px;}.bk-root .noUi-marker-horizontal.noUi-marker-large{height:15px;}.bk-root .noUi-pips-vertical{padding:0 10px;height:100%;top:0;left:100%;}.bk-root .noUi-value-vertical{-webkit-transform:translate(0, -50%);transform:translate(0, -50%);padding-left:25px;}.bk-root .noUi-rtl .noUi-value-vertical{-webkit-transform:translate(0, 50%);transform:translate(0, 50%);}.bk-root .noUi-marker-vertical.noUi-marker{width:5px;height:2px;margin-top:-1px;}.bk-root .noUi-marker-vertical.noUi-marker-sub{width:10px;}.bk-root .noUi-marker-vertical.noUi-marker-large{width:15px;}.bk-root .noUi-tooltip{display:block;position:absolute;border:1px solid #D9D9D9;border-radius:3px;background:#fff;color:#000;padding:5px;text-align:center;white-space:nowrap;}.bk-root .noUi-horizontal .noUi-tooltip{-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);left:50%;bottom:120%;}.bk-root .noUi-vertical .noUi-tooltip{-webkit-transform:translate(0, -50%);transform:translate(0, -50%);top:50%;right:120%;}.bk-root .noUi-horizontal .noUi-origin > .noUi-tooltip{-webkit-transform:translate(50%, 0);transform:translate(50%, 0);left:auto;bottom:10px;}.bk-root .noUi-vertical .noUi-origin > .noUi-tooltip{-webkit-transform:translate(0, -18px);transform:translate(0, -18px);top:auto;right:28px;}.bk-root .noUi-handle{cursor:grab;cursor:-webkit-grab;}.bk-root .noUi-handle.noUi-active{cursor:grabbing;cursor:-webkit-grabbing;}.bk-root .noUi-handle:after,.bk-root .noUi-handle:before{display:none;}.bk-root .noUi-tooltip{display:none;white-space:nowrap;}.bk-root .noUi-handle:hover .noUi-tooltip{display:block;}.bk-root .noUi-horizontal{width:100%;height:10px;}.bk-root .noUi-vertical{width:10px;height:100%;}.bk-root .noUi-horizontal .noUi-handle{width:14px;height:18px;right:-7px;top:-5px;}.bk-root .noUi-vertical .noUi-handle{width:18px;height:14px;right:-5px;top:-7px;}.bk-root .noUi-target.noUi-horizontal{margin:5px 0px;}.bk-root .noUi-target.noUi-vertical{margin:0px 5px;}';class AbstractBaseSliderView extends ControlView{*controls(){yield this.slider_el}get noUiSlider(){return this.slider_el.noUiSlider}connect_signals(){super.connect_signals();const{direction:e,orientation:t,tooltips:i}=this.model.properties;this.on_change([e,t,i],(()=>this.render()));const{start:n,end:o,value:r,step:s,title:a}=this.model.properties;this.on_change([n,o,r,s],(()=>{const{start:e,end:t,value:i,step:n}=this._calc_to();this.noUiSlider.updateOptions({range:{min:e,max:t},start:i,step:n})}));const{bar_color:l}=this.model.properties;this.on_change(l,(()=>{this._set_bar_color()}));const{show_value:c}=this.model.properties;this.on_change([r,a,c],(()=>this._update_title()))}styles(){return[...super.styles(),nouislider_css,sliders_css]}_update_title(){var e;empty$1(this.title_el);const t=null==this.model.title||0==this.model.title.length&&!this.model.show_value;if(this.title_el.style.display=t?"none":"",!t&&(0!=(null==(e=this.model.title)?void 0:e.length)&&(this.title_el.textContent=`${this.model.title}: `),this.model.show_value)){const{value:e}=this._calc_to(),t=e.map((e=>this.model.pretty(e))).join(" .. ");this.title_el.appendChild(span({class:slider_value},t))}}_set_bar_color(){if(!this.model.disabled){this.slider_el.querySelector(".noUi-connect").style.backgroundColor=color2css(this.model.bar_color)}}render(){super.render();const{start:e,end:t,value:i,step:n}=this._calc_to();let o;if(this.model.tooltips){o=repeat({to:e=>this.model.pretty(e)},i.length)}else o=!1;if(null==this.slider_el){this.slider_el=div(),nouislider.exports.create(this.slider_el,{range:{min:e,max:t},start:i,step:n,behaviour:this.model.behaviour,connect:this.model.connected,tooltips:o,orientation:this.model.orientation,direction:this.model.direction}),this.noUiSlider.on("slide",((e,t,i)=>this._slide(i))),this.noUiSlider.on("change",((e,t,i)=>this._change(i)));const r=(e,t)=>{if(!o)return;this.slider_el.querySelectorAll(".noUi-handle")[e].querySelector(".noUi-tooltip").style.display=t?"block":""};this.noUiSlider.on("start",((e,t)=>r(t,!0))),this.noUiSlider.on("end",((e,t)=>r(t,!1)))}else this.noUiSlider.updateOptions({range:{min:e,max:t},start:i,step:n});this._set_bar_color(),this.model.disabled?this.slider_el.setAttribute("disabled","true"):this.slider_el.removeAttribute("disabled"),this.title_el=div({class:slider_title}),this._update_title(),this.group_el=div({class:input_group},this.title_el,this.slider_el),this.el.appendChild(this.group_el)}_slide(e){this.model.value=this._calc_from(e)}_change(e){const t=this._calc_from(e);this.model.setv({value:t,value_throttled:t})}}AbstractBaseSliderView.__name__="AbstractBaseSliderView";class AbstractSliderView extends AbstractBaseSliderView{_calc_to(){return{start:this.model.start,end:this.model.end,value:[this.model.value],step:this.model.step}}_calc_from([e]){return Number.isInteger(this.model.start)&&Number.isInteger(this.model.end)&&Number.isInteger(this.model.step)?Math.round(e):e}}AbstractSliderView.__name__="AbstractSliderView";class AbstractRangeSliderView extends AbstractBaseSliderView{_calc_to(){return{start:this.model.start,end:this.model.end,value:this.model.value,step:this.model.step}}_calc_from(e){return e}}AbstractRangeSliderView.__name__="AbstractRangeSliderView";class AbstractSlider extends Control{constructor(e){super(e),this.connected=!1}static init_AbstractSlider(){this.define((({Any:e,Boolean:t,Number:i,String:n,Color:o,Or:r,Enum:s,Ref:a,Nullable:l})=>({title:[l(n),""],show_value:[t,!0],start:[e],end:[e],value:[e],value_throttled:[e],step:[i,1],format:[r(n,a(TickFormatter))],direction:[s("ltr","rtl"),"ltr"],tooltips:[t,!0],bar_color:[o,"#e6e6e6"]})))}pretty(e){return this._formatter(e,this.format)}}AbstractSlider.__name__="AbstractSlider",AbstractSlider.init_AbstractSlider();class DateRangeSliderView extends AbstractRangeSliderView{}DateRangeSliderView.__name__="DateRangeSliderView";class DateRangeSlider extends AbstractSlider{constructor(e){super(e),this.behaviour="drag",this.connected=[!1,!0,!1]}static init_DateRangeSlider(){this.prototype.default_view=DateRangeSliderView,this.override({format:"%d %b %Y"})}_formatter(e,t){return isString(t)?tz(e,t):t.compute(e)}}DateRangeSlider.__name__="DateRangeSlider",DateRangeSlider.init_DateRangeSlider();class DateSliderView extends AbstractSliderView{}DateSliderView.__name__="DateSliderView";class DateSlider extends AbstractSlider{constructor(e){super(e),this.behaviour="tap",this.connected=[!0,!1]}static init_DateSlider(){this.prototype.default_view=DateSliderView,this.override({format:"%d %b %Y"})}_formatter(e,t){return isString(t)?tz(e,t):t.compute(e)}}DateSlider.__name__="DateSlider",DateSlider.init_DateSlider();const clearfix="bk-clearfix";var clearfix_css='.bk-root .bk-clearfix:before,.bk-root .bk-clearfix:after{content:"";display:table;}.bk-root .bk-clearfix:after{clear:both;}';class MarkupView extends WidgetView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>{this.layout.invalidate_cache(),this.render(),this.root.compute_layout()}))}styles(){return[...super.styles(),clearfix_css]}_update_layout(){this.layout=new CachedVariadicBox(this.el),this.layout.set_sizing(this.box_sizing())}render(){super.render();const e=__spreadProps(__spreadValues({},this.model.style),{display:"inline-block"});this.markup_el=div({class:clearfix,style:e}),this.el.appendChild(this.markup_el)}}MarkupView.__name__="MarkupView";class Markup extends Widget{constructor(e){super(e)}static init_Markup(){this.define((({String:e,Dict:t})=>({text:[e,""],style:[t(e),{}]})))}}Markup.__name__="Markup",Markup.init_Markup();class DivView extends MarkupView{render(){super.render(),this.model.render_as_text?this.markup_el.textContent=this.model.text:this.markup_el.innerHTML=this.model.text}}DivView.__name__="DivView";class Div extends Markup{constructor(e){super(e)}static init_Div(){this.prototype.default_view=DivView,this.define((({Boolean:e})=>({render_as_text:[e,!1]})))}}Div.__name__="Div",Div.init_Div();class DropdownView extends AbstractButtonView{constructor(){super(...arguments),this._open=!1}styles(){return[...super.styles(),menus_css]}render(){super.render();const e=div({class:[caret,down]});if(this.model.is_split){const t=this._render_button(e);t.classList.add(dropdown_toggle),t.addEventListener("click",(()=>this._toggle_menu())),this.group_el.appendChild(t)}else this.button_el.appendChild(e);const t=this.model.menu.map(((e,t)=>{if(null==e)return div({class:divider});{const i=isString(e)?e:e[0],n=div({},i);return n.addEventListener("click",(()=>this._item_click(t))),n}}));this.menu=div({class:[menu,below$2]},t),this.el.appendChild(this.menu),undisplay(this.menu)}_show_menu(){if(!this._open){this._open=!0,display(this.menu);const e=t=>{const{target:i}=t;i instanceof HTMLElement&&!this.el.contains(i)&&(document.removeEventListener("click",e),this._hide_menu())};document.addEventListener("click",e)}}_hide_menu(){this._open&&(this._open=!1,undisplay(this.menu))}_toggle_menu(){this._open?this._hide_menu():this._show_menu()}click(){this.model.is_split?(this._hide_menu(),this.model.trigger_event(new ButtonClick),super.click()):this._toggle_menu()}_item_click(e){this._hide_menu();const t=this.model.menu[e];if(null!=t){const i=isString(t)?t:t[1];isString(i)?this.model.trigger_event(new MenuItemClick(i)):i.execute(this.model,{index:e})}}}DropdownView.__name__="DropdownView";class Dropdown extends AbstractButton{constructor(e){super(e)}static init_Dropdown(){this.prototype.default_view=DropdownView,this.define((({Null:e,Boolean:t,String:i,Array:n,Tuple:o,Or:r})=>({split:[t,!1],menu:[n(r(i,o(i,r(i)),e)),[]]}))),this.override({label:"Dropdown"})}get is_split(){return this.split}}Dropdown.__name__="Dropdown",Dropdown.init_Dropdown();class FileInputView extends WidgetView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.render()))}render(){const{multiple:e,accept:t,disabled:i,width:n}=this.model;null==this.dialog_el&&(this.dialog_el=input$1({type:"file",multiple:e}),this.dialog_el.onchange=()=>{const{files:e}=this.dialog_el;null!=e&&this.load_files(e)},this.el.appendChild(this.dialog_el)),null!=t&&""!=t&&(this.dialog_el.accept=t),this.dialog_el.style.width=`${n}px`,this.dialog_el.disabled=i}async load_files(e){const t=[],i=[],n=[];for(const o of e){const e=await this._read_file(o),[,r="",,s=""]=e.split(/[:;,]/,4);t.push(s),i.push(o.name),n.push(r)}this.model.multiple?(this.model.value=t,this.model.filename=i,this.model.mime_type=n):(this.model.value=t[0],this.model.filename=i[0],this.model.mime_type=n[0])}_read_file(e){return new Promise(((t,i)=>{const n=new FileReader;n.onload=()=>{var o;const{result:r}=n;null!=r?t(r):i(null!=(o=n.error)?o:new Error(`unable to read '${e.name}'`))},n.readAsDataURL(e)}))}}FileInputView.__name__="FileInputView";class FileInput extends Widget{constructor(e){super(e)}static init_FileInput(){this.prototype.default_view=FileInputView,this.define((({Boolean:e,String:t,Array:i,Or:n})=>({value:[n(t,i(t)),""],mime_type:[n(t,i(t)),""],filename:[n(t,i(t)),""],accept:[t,""],multiple:[e,!1]})))}}FileInput.__name__="FileInput",FileInput.init_FileInput();class MultiSelectView extends InputWidgetView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.value.change,(()=>this.render_selection())),this.connect(this.model.properties.options.change,(()=>this.render())),this.connect(this.model.properties.name.change,(()=>this.render())),this.connect(this.model.properties.title.change,(()=>this.render())),this.connect(this.model.properties.size.change,(()=>this.render())),this.connect(this.model.properties.disabled.change,(()=>this.render()))}render(){super.render();const e=this.model.options.map((e=>{let t,i;return isString(e)?t=i=e:[t,i]=e,option({value:t},i)}));this.input_el=select({multiple:!0,class:input,name:this.model.name,disabled:this.model.disabled},e),this.input_el.addEventListener("change",(()=>this.change_input())),this.group_el.appendChild(this.input_el),this.render_selection()}render_selection(){const e=new Set(this.model.value);for(const t of this.el.querySelectorAll("option"))t.selected=e.has(t.value);this.input_el.size=this.model.size}change_input(){const e=null!=this.el.querySelector("select:focus"),t=[];for(const i of this.el.querySelectorAll("option"))i.selected&&t.push(i.value);this.model.value=t,super.change_input(),e&&this.input_el.focus()}}MultiSelectView.__name__="MultiSelectView";class MultiSelect extends InputWidget{constructor(e){super(e)}static init_MultiSelect(){this.prototype.default_view=MultiSelectView,this.define((({Int:e,String:t,Array:i,Tuple:n,Or:o})=>({value:[i(t),[]],options:[i(o(t,n(t,t))),[]],size:[e,4]})))}}MultiSelect.__name__="MultiSelect",MultiSelect.init_MultiSelect();class ParagraphView extends MarkupView{render(){super.render();const e=p({style:{margin:0}},this.model.text);this.markup_el.appendChild(e)}}ParagraphView.__name__="ParagraphView";class Paragraph extends Markup{constructor(e){super(e)}static init_Paragraph(){this.prototype.default_view=ParagraphView}}Paragraph.__name__="Paragraph",Paragraph.init_Paragraph();class PasswordInputView extends TextInputView{render(){super.render(),this.input_el.type="password"}}PasswordInputView.__name__="PasswordInputView";class PasswordInput extends TextInput{constructor(e){super(e)}static init_PasswordInput(){this.prototype.default_view=PasswordInputView}}PasswordInput.__name__="PasswordInput",PasswordInput.init_PasswordInput();var choices={exports:{}},factory;
/*! choices.js v9.0.1 |  2019 Josh Johnson | https://github.com/jshjohnson/Choices#readme */window,factory=function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/public/assets/scripts/",i(i.s=4)}([function(e,t,i){var n=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===o}(e)}(e)},o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((i=e,Array.isArray(i)?[]:{}),e,t):e;var i}function s(e,t,i){return e.concat(t).map((function(e){return r(e,i)}))}function a(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function l(e,t,i){var n={};return i.isMergeableObject(e)&&a(e).forEach((function(t){n[t]=r(e[t],i)})),a(t).forEach((function(o){(function(e,t){try{return t in e&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}catch(i){return!1}})(e,o)||(i.isMergeableObject(t[o])&&e[o]?n[o]=function(e,t){if(!t.customMerge)return c;var i=t.customMerge(e);return"function"==typeof i?i:c}(o,i)(e[o],t[o],i):n[o]=r(t[o],i))})),n}function c(e,t,i){(i=i||{}).arrayMerge=i.arrayMerge||s,i.isMergeableObject=i.isMergeableObject||n,i.cloneUnlessOtherwiseSpecified=r;var o=Array.isArray(t);return o===Array.isArray(e)?o?i.arrayMerge(e,t,i):l(e,t,i):r(t,i)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,i){return c(e,i,t)}),{})};var d=c;e.exports=d},function(e,t,i){(function(e,n){var o,r=i(3);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var s=Object(r.a)(o);t.a=s}).call(this,i(5),i(6)(e))},function(e,t,i){
/*!
         * Fuse.js v3.4.5 - Lightweight fuzzy-search (http://fusejs.io)
         * 
         * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
         * All Rights Reserved. Apache Software License 2.0
         * 
         * http://www.apache.org/licenses/LICENSE-2.0
         */
e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t){e.exports=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=i(2),s=i(8),a=i(0),l=function(){function e(t,i){var n=i.location,o=void 0===n?0:n,r=i.distance,a=void 0===r?100:r,l=i.threshold,c=void 0===l?.6:l,d=i.maxPatternLength,h=void 0===d?32:d,u=i.caseSensitive,p=void 0!==u&&u,_=i.tokenSeparator,f=void 0===_?/ +/g:_,g=i.findAllMatches,m=void 0!==g&&g,v=i.minMatchCharLength,b=void 0===v?1:v,y=i.id,w=void 0===y?null:y,A=i.keys,x=void 0===A?[]:A,k=i.shouldSort,C=void 0===k||k,S=i.getFn,T=void 0===S?s:S,R=i.sortFn,E=void 0===R?function(e,t){return e.score-t.score}:R,P=i.tokenize,M=void 0!==P&&P,D=i.matchAllTokens,I=void 0!==D&&D,B=i.includeMatches,z=void 0!==B&&B,L=i.includeScore,N=void 0!==L&&L,$=i.verbose,V=void 0!==$&&$;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:o,distance:a,threshold:c,maxPatternLength:h,isCaseSensitive:p,tokenSeparator:f,findAllMatches:m,minMatchCharLength:b,id:w,keys:x,includeMatches:z,includeScore:N,shouldSort:C,getFn:T,sortFn:E,verbose:V,tokenize:M,matchAllTokens:I},this.setCollection(t)}var t;return(t=[{key:"setCollection",value:function(e){return this.list=e,e}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var i=this._prepareSearchers(e),n=i.tokenSearchers,o=i.fullSearcher,r=this._search(n,o),s=r.weights,a=r.results;return this._computeScore(s,a),this.options.shouldSort&&this._sort(a),t.limit&&"number"==typeof t.limit&&(a=a.slice(0,t.limit)),this._format(a)}},{key:"_prepareSearchers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];if(this.options.tokenize)for(var i=e.split(this.options.tokenSeparator),n=0,o=i.length;n<o;n+=1)t.push(new r(i[n],this.options));return{tokenSearchers:t,fullSearcher:new r(e,this.options)}}},{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,i=this.list,n={},o=[];if("string"==typeof i[0]){for(var r=0,s=i.length;r<s;r+=1)this._analyze({key:"",value:i[r],record:r,index:r},{resultMap:n,results:o,tokenSearchers:e,fullSearcher:t});return{weights:null,results:o}}for(var a={},l=0,c=i.length;l<c;l+=1)for(var d=i[l],h=0,u=this.options.keys.length;h<u;h+=1){var p=this.options.keys[h];if("string"!=typeof p){if(a[p.name]={weight:1-p.weight||1},p.weight<=0||p.weight>1)throw new Error("Key weight has to be > 0 and <= 1");p=p.name}else a[p]={weight:1};this._analyze({key:p,value:this.options.getFn(d,p),record:d,index:l},{resultMap:n,results:o,tokenSearchers:e,fullSearcher:t})}return{weights:a,results:o}}},{key:"_analyze",value:function(e,t){var i=e.key,n=e.arrayIndex,o=void 0===n?-1:n,r=e.value,s=e.record,l=e.index,c=t.tokenSearchers,d=void 0===c?[]:c,h=t.fullSearcher,u=void 0===h?[]:h,p=t.resultMap,_=void 0===p?{}:p,f=t.results,g=void 0===f?[]:f;if(null!=r){var m=!1,v=-1,b=0;if("string"==typeof r){this._log("\nKey: ".concat(""===i?"-":i));var y=u.search(r);if(this._log('Full text: "'.concat(r,'", score: ').concat(y.score)),this.options.tokenize){for(var w=r.split(this.options.tokenSeparator),A=[],x=0;x<d.length;x+=1){var k=d[x];this._log('\nPattern: "'.concat(k.pattern,'"'));for(var C=!1,S=0;S<w.length;S+=1){var T=w[S],R=k.search(T),E={};R.isMatch?(E[T]=R.score,m=!0,C=!0,A.push(R.score)):(E[T]=1,this.options.matchAllTokens||A.push(1)),this._log('Token: "'.concat(T,'", score: ').concat(E[T]))}C&&(b+=1)}v=A[0];for(var P=A.length,M=1;M<P;M+=1)v+=A[M];v/=P,this._log("Token score average:",v)}var D=y.score;v>-1&&(D=(D+v)/2),this._log("Score average:",D);var I=!this.options.tokenize||!this.options.matchAllTokens||b>=d.length;if(this._log("\nCheck Matches: ".concat(I)),(m||y.isMatch)&&I){var B=_[l];B?B.output.push({key:i,arrayIndex:o,value:r,score:D,matchedIndices:y.matchedIndices}):(_[l]={item:s,output:[{key:i,arrayIndex:o,value:r,score:D,matchedIndices:y.matchedIndices}]},g.push(_[l]))}}else if(a(r))for(var z=0,L=r.length;z<L;z+=1)this._analyze({key:i,arrayIndex:z,value:r[z],record:s,index:l},{resultMap:_,results:g,tokenSearchers:d,fullSearcher:u})}}},{key:"_computeScore",value:function(e,t){this._log("\n\nComputing score:\n");for(var i=0,n=t.length;i<n;i+=1){for(var o=t[i].output,r=o.length,s=1,a=1,l=0;l<r;l+=1){var c=e?e[o[l].key].weight:1,d=(1===c?o[l].score:o[l].score||.001)*c;1!==c?a=Math.min(a,d):(o[l].nScore=d,s*=d)}t[i].score=1===a?s:a,this._log(t[i])}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var t=[];if(this.options.verbose){var i=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,(function(e,t){if("object"===n(t)&&null!==t){if(-1!==i.indexOf(t))return;i.push(t)}return t}))),i=null}var o=[];this.options.includeMatches&&o.push((function(e,t){var i=e.output;t.matches=[];for(var n=0,o=i.length;n<o;n+=1){var r=i[n];if(0!==r.matchedIndices.length){var s={indices:r.matchedIndices,value:r.value};r.key&&(s.key=r.key),r.hasOwnProperty("arrayIndex")&&r.arrayIndex>-1&&(s.arrayIndex=r.arrayIndex),t.matches.push(s)}}})),this.options.includeScore&&o.push((function(e,t){t.score=e.score}));for(var r=0,s=e.length;r<s;r+=1){var a=e[r];if(this.options.id&&(a.item=this.options.getFn(a.item,this.options.id)[0]),o.length){for(var l={item:a.item},c=0,d=o.length;c<d;c+=1)o[c](a,l);t.push(l)}else t.push(a.item)}return t}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&o(e.prototype,t),e}();e.exports=l},function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=i(3),r=i(4),s=i(7),a=function(){function e(t,i){var n=i.location,o=void 0===n?0:n,r=i.distance,a=void 0===r?100:r,l=i.threshold,c=void 0===l?.6:l,d=i.maxPatternLength,h=void 0===d?32:d,u=i.isCaseSensitive,p=void 0!==u&&u,_=i.tokenSeparator,f=void 0===_?/ +/g:_,g=i.findAllMatches,m=void 0!==g&&g,v=i.minMatchCharLength,b=void 0===v?1:v;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:o,distance:a,threshold:c,maxPatternLength:h,isCaseSensitive:p,tokenSeparator:f,findAllMatches:m,minMatchCharLength:b},this.pattern=this.options.isCaseSensitive?t:t.toLowerCase(),this.pattern.length<=h&&(this.patternAlphabet=s(this.pattern))}var t;return(t=[{key:"search",value:function(e){if(this.options.isCaseSensitive||(e=e.toLowerCase()),this.pattern===e)return{isMatch:!0,score:0,matchedIndices:[[0,e.length-1]]};var t=this.options,i=t.maxPatternLength,n=t.tokenSeparator;if(this.pattern.length>i)return o(e,this.pattern,n);var s=this.options,a=s.location,l=s.distance,c=s.threshold,d=s.findAllMatches,h=s.minMatchCharLength;return r(e,this.pattern,this.patternAlphabet,{location:a,distance:l,threshold:c,findAllMatches:d,minMatchCharLength:h})}}])&&n(e.prototype,t),e}();e.exports=a},function(e,t){var i=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,o=new RegExp(t.replace(i,"\\$&").replace(n,"|")),r=e.match(o),s=!!r,a=[];if(s)for(var l=0,c=r.length;l<c;l+=1){var d=r[l];a.push([e.indexOf(d),d.length-1])}return{score:s?.5:1,isMatch:s,matchedIndices:a}}},function(e,t,i){var n=i(5),o=i(6);e.exports=function(e,t,i,r){for(var s=r.location,a=void 0===s?0:s,l=r.distance,c=void 0===l?100:l,d=r.threshold,h=void 0===d?.6:d,u=r.findAllMatches,p=void 0!==u&&u,_=r.minMatchCharLength,f=void 0===_?1:_,g=a,m=e.length,v=h,b=e.indexOf(t,g),y=t.length,w=[],A=0;A<m;A+=1)w[A]=0;if(-1!==b){var x=n(t,{errors:0,currentLocation:b,expectedLocation:g,distance:c});if(v=Math.min(x,v),-1!==(b=e.lastIndexOf(t,g+y))){var k=n(t,{errors:0,currentLocation:b,expectedLocation:g,distance:c});v=Math.min(k,v)}}b=-1;for(var C=[],S=1,T=y+m,R=1<<y-1,E=0;E<y;E+=1){for(var P=0,M=T;P<M;)n(t,{errors:E,currentLocation:g+M,expectedLocation:g,distance:c})<=v?P=M:T=M,M=Math.floor((T-P)/2+P);T=M;var D=Math.max(1,g-M+1),I=p?m:Math.min(g+M,m)+y,B=Array(I+2);B[I+1]=(1<<E)-1;for(var z=I;z>=D;z-=1){var L=z-1,N=i[e.charAt(L)];if(N&&(w[L]=1),B[z]=(B[z+1]<<1|1)&N,0!==E&&(B[z]|=(C[z+1]|C[z])<<1|1|C[z+1]),B[z]&R&&(S=n(t,{errors:E,currentLocation:L,expectedLocation:g,distance:c}))<=v){if(v=S,(b=L)<=g)break;D=Math.max(1,2*g-b)}}if(n(t,{errors:E+1,currentLocation:g,expectedLocation:g,distance:c})>v)break;C=B}return{isMatch:b>=0,score:0===S?.001:S,matchedIndices:o(w,f)}}},function(e,t){e.exports=function(e,t){var i=t.errors,n=void 0===i?0:i,o=t.currentLocation,r=void 0===o?0:o,s=t.expectedLocation,a=void 0===s?0:s,l=t.distance,c=void 0===l?100:l,d=n/e.length,h=Math.abs(a-r);return c?d+h/c:h?1:d}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=[],n=-1,o=-1,r=0,s=e.length;r<s;r+=1){var a=e[r];a&&-1===n?n=r:a||-1===n||((o=r-1)-n+1>=t&&i.push([n,o]),n=-1)}return e[r-1]&&r-n>=t&&i.push([n,r-1]),i}},function(e,t){e.exports=function(e){for(var t={},i=e.length,n=0;n<i;n+=1)t[e.charAt(n)]=0;for(var o=0;o<i;o+=1)t[e.charAt(o)]|=1<<i-o-1;return t}},function(e,t,i){var n=i(0);e.exports=function(e,t){return function e(t,i,o){if(i){var r=i.indexOf("."),s=i,a=null;-1!==r&&(s=i.slice(0,r),a=i.slice(r+1));var l=t[s];if(null!=l)if(a||"string"!=typeof l&&"number"!=typeof l)if(n(l))for(var c=0,d=l.length;c<d;c+=1)e(l[c],a,o);else a&&e(l,a,o);else o.push(l.toString())}else o.push(t);return o}(e,t,[])}}])},function(e,t,i){function n(e){var t,i=e.Symbol;return"function"==typeof i?i.observable?t=i.observable:(t=i("observable"),i.observable=t):t="@@observable",t}i.d(t,"a",(function(){return n}))},function(e,t,i){e.exports=i(7)},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(n){"object"==typeof window&&(i=window)}e.exports=i},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,i){i.r(t);var n=i(2),o=i.n(n),r=i(0),s=i.n(r),a=i(1),l=function(){return Math.random().toString(36).substring(7).split("").join(".")},c={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function d(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function h(e,t,i){var n;if("function"==typeof t&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===i&&(i=t,t=void 0),void 0!==i){if("function"!=typeof i)throw new Error("Expected the enhancer to be a function.");return i(h)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,r=t,s=[],l=s,u=!1;function p(){l===s&&(l=s.slice())}function _(){if(u)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return r}function f(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(u)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return p(),l.push(e),function(){if(t){if(u)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,p();var i=l.indexOf(e);l.splice(i,1)}}}function g(e){if(!d(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,r=o(r,e)}finally{u=!1}for(var t=s=l,i=0;i<t.length;i++)(0,t[i])();return e}function m(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,g({type:c.REPLACE})}function v(){var e,t=f;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function i(){e.next&&e.next(_())}return i(),{unsubscribe:t(i)}}})[a.a]=function(){return this},e}return g({type:c.INIT}),(n={dispatch:g,subscribe:f,getState:_,replaceReducer:m})[a.a]=v,n}function u(e,t){var i=t&&t.type;return"Given "+(i&&'action "'+String(i)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}var p,_=[],f=[],g=[],m={loading:!1},v=function(e,t){switch(void 0===e&&(e=m),t.type){case"SET_IS_LOADING":return{loading:t.isLoading};default:return e}},b=function(e){return Array.from({length:e},(function(){return(e=0,t=36,Math.floor(Math.random()*(t-e)+e)).toString(36);var e,t})).join("")},y=function(e){return Object.prototype.toString.call(e).slice(8,-1)},w=function(e,t){return null!=t&&y(t)===e},A=function(e){return"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/>/g,"&rt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},x=(p=document.createElement("div"),function(e){var t=e.trim();p.innerHTML=t;for(var i=p.children[0];p.firstChild;)p.removeChild(p.firstChild);return i}),k=function(e,t){return e.score-t.score},C=function(e){return JSON.parse(JSON.stringify(e))},S=function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++){var o=t[n];"function"==typeof e[o]&&(i[o]=e[o])}var r,s=Object.keys(i);try{!function(e){Object.keys(e).forEach((function(t){var i=e[t];if(void 0===i(void 0,{type:c.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===i(void 0,{type:c.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+c.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(i)}catch(a){r=a}return function(e,t){if(void 0===e&&(e={}),r)throw r;for(var n=!1,o={},a=0;a<s.length;a++){var l=s[a],c=i[l],d=e[l],h=c(d,t);if(void 0===h){var p=u(l,t);throw new Error(p)}o[l]=h,n=n||h!==d}return n?o:e}}({items:function(e,t){switch(void 0===e&&(e=_),t.type){case"ADD_ITEM":return[].concat(e,[{id:t.id,choiceId:t.choiceId,groupId:t.groupId,value:t.value,label:t.label,active:!0,highlighted:!1,customProperties:t.customProperties,placeholder:t.placeholder||!1,keyCode:null}]).map((function(e){var t=e;return t.highlighted=!1,t}));case"REMOVE_ITEM":return e.map((function(e){var i=e;return i.id===t.id&&(i.active=!1),i}));case"HIGHLIGHT_ITEM":return e.map((function(e){var i=e;return i.id===t.id&&(i.highlighted=t.highlighted),i}));default:return e}},groups:function(e,t){switch(void 0===e&&(e=f),t.type){case"ADD_GROUP":return[].concat(e,[{id:t.id,value:t.value,active:t.active,disabled:t.disabled}]);case"CLEAR_CHOICES":return[];default:return e}},choices:function(e,t){switch(void 0===e&&(e=g),t.type){case"ADD_CHOICE":return[].concat(e,[{id:t.id,elementId:t.elementId,groupId:t.groupId,value:t.value,label:t.label||t.value,disabled:t.disabled||!1,selected:!1,active:!0,score:9999,customProperties:t.customProperties,placeholder:t.placeholder||!1,keyCode:null}]);case"ADD_ITEM":return t.activateOptions?e.map((function(e){var i=e;return i.active=t.active,i})):t.choiceId>-1?e.map((function(e){var i=e;return i.id===parseInt(t.choiceId,10)&&(i.selected=!0),i})):e;case"REMOVE_ITEM":return t.choiceId>-1?e.map((function(e){var i=e;return i.id===parseInt(t.choiceId,10)&&(i.selected=!1),i})):e;case"FILTER_CHOICES":return e.map((function(e){var i=e;return i.active=t.results.some((function(e){var t=e.item,n=e.score;return t.id===i.id&&(i.score=n,!0)})),i}));case"ACTIVATE_CHOICES":return e.map((function(e){var i=e;return i.active=t.active,i}));case"CLEAR_CHOICES":return g;default:return e}},general:v}),T=function(e,t){var i=e;if("CLEAR_ALL"===t.type)i=void 0;else if("RESET_TO"===t.type)return C(t.state);return S(i,t)};function R(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var E=function(){function e(){this._store=h(T,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())}var t,i,n,o=e.prototype;return o.subscribe=function(e){this._store.subscribe(e)},o.dispatch=function(e){this._store.dispatch(e)},o.isLoading=function(){return this.state.general.loading},o.getChoiceById=function(e){return this.activeChoices.find((function(t){return t.id===parseInt(e,10)}))},o.getGroupById=function(e){return this.groups.find((function(t){return t.id===e}))},t=e,(i=[{key:"state",get:function(){return this._store.getState()}},{key:"items",get:function(){return this.state.items}},{key:"activeItems",get:function(){return this.items.filter((function(e){return!0===e.active}))}},{key:"highlightedActiveItems",get:function(){return this.items.filter((function(e){return e.active&&e.highlighted}))}},{key:"choices",get:function(){return this.state.choices}},{key:"activeChoices",get:function(){return this.choices.filter((function(e){return!0===e.active}))}},{key:"selectableChoices",get:function(){return this.choices.filter((function(e){return!0!==e.disabled}))}},{key:"searchableChoices",get:function(){return this.selectableChoices.filter((function(e){return!0!==e.placeholder}))}},{key:"placeholderChoice",get:function(){return[].concat(this.choices).reverse().find((function(e){return!0===e.placeholder}))}},{key:"groups",get:function(){return this.state.groups}},{key:"activeGroups",get:function(){var e=this.groups,t=this.choices;return e.filter((function(e){var i=!0===e.active&&!1===e.disabled,n=t.some((function(e){return!0===e.active&&!1===e.disabled}));return i&&n}),[])}}])&&R(t.prototype,i),n&&R(t,n),e}();function P(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var M=function(){function e(e){var t=e.element,i=e.type,n=e.classNames;this.element=t,this.classNames=n,this.type=i,this.isActive=!1}var t,i,n,o=e.prototype;return o.getChild=function(e){return this.element.querySelector(e)},o.show=function(){return this.element.classList.add(this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},o.hide=function(){return this.element.classList.remove(this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},t=e,(i=[{key:"distanceFromTopWindow",get:function(){return this.element.getBoundingClientRect().bottom}}])&&P(t.prototype,i),n&&P(t,n),e}(),D={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,addItems:!0,addItemFilter:null,removeItems:!0,removeItemButton:!1,editItems:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:function(e,t){var i=e.value,n=e.label,o=void 0===n?i:n,r=t.value,s=t.label,a=void 0===s?r:s;return o.localeCompare(a,[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(e){return'Press Enter to add <b>"'+A(e)+'"</b>'},maxItemText:function(e){return"Only "+e+" values can be added"},valueComparer:function(e,t){return e===t},fuseOptions:{includeScore:!0},callbackOnInit:null,callbackOnCreateTemplates:null,classNames:{containerOuter:"choices",containerInner:"choices__inner",input:"choices__input",inputCloned:"choices__input--cloned",list:"choices__list",listItems:"choices__list--multiple",listSingle:"choices__list--single",listDropdown:"choices__list--dropdown",item:"choices__item",itemSelectable:"choices__item--selectable",itemDisabled:"choices__item--disabled",itemChoice:"choices__item--choice",placeholder:"choices__placeholder",group:"choices__group",groupHeading:"choices__heading",button:"choices__button",activeState:"is-active",focusState:"is-focused",openState:"is-open",disabledState:"is-disabled",highlightedState:"is-highlighted",selectedState:"is-selected",flippedState:"is-flipped",loadingState:"is-loading",noResults:"has-no-results",noChoices:"has-no-choices"}},I="showDropdown",B="hideDropdown",z="change",L="choice",N="search",$="addItem",V="removeItem",O="highlightItem",F="highlightChoice",G="ADD_CHOICE",H="FILTER_CHOICES",j="ACTIVATE_CHOICES",U="CLEAR_CHOICES",W="ADD_GROUP",Y="ADD_ITEM",q="REMOVE_ITEM",X="HIGHLIGHT_ITEM",K=46,J=8,Q=13,Z=65,ee=27,te=38,ie=40,ne=33,oe=34,re="text",se="select-one",ae="select-multiple",le=function(){function e(e){var t=e.element,i=e.type,n=e.classNames,o=e.position;this.element=t,this.classNames=n,this.type=i,this.position=o,this.isOpen=!1,this.isFlipped=!1,this.isFocussed=!1,this.isDisabled=!1,this.isLoading=!1,this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}var t=e.prototype;return t.addEventListeners=function(){this.element.addEventListener("focus",this._onFocus),this.element.addEventListener("blur",this._onBlur)},t.removeEventListeners=function(){this.element.removeEventListener("focus",this._onFocus),this.element.removeEventListener("blur",this._onBlur)},t.shouldFlip=function(e){if("number"!=typeof e)return!1;var t=!1;return"auto"===this.position?t=!window.matchMedia("(min-height: "+(e+1)+"px)").matches:"top"===this.position&&(t=!0),t},t.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.open=function(e){this.element.classList.add(this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e)&&(this.element.classList.add(this.classNames.flippedState),this.isFlipped=!0)},t.close=function(){this.element.classList.remove(this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(this.element.classList.remove(this.classNames.flippedState),this.isFlipped=!1)},t.focus=function(){this.isFocussed||this.element.focus()},t.addFocusState=function(){this.element.classList.add(this.classNames.focusState)},t.removeFocusState=function(){this.element.classList.remove(this.classNames.focusState)},t.enable=function(){this.element.classList.remove(this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===se&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},t.disable=function(){this.element.classList.add(this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===se&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},t.wrap=function(e){!function(e,t){void 0===t&&(t=document.createElement("div")),e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t.appendChild(e)}(e,this.element)},t.unwrap=function(e){this.element.parentNode.insertBefore(e,this.element),this.element.parentNode.removeChild(this.element)},t.addLoadingState=function(){this.element.classList.add(this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},t.removeLoadingState=function(){this.element.classList.remove(this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},t._onFocus=function(){this.isFocussed=!0},t._onBlur=function(){this.isFocussed=!1},e}();function ce(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var de=function(){function e(e){var t=e.element,i=e.type,n=e.classNames,o=e.preventPaste;this.element=t,this.type=i,this.classNames=n,this.preventPaste=o,this.isFocussed=this.element===document.activeElement,this.isDisabled=t.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}var t,i,n,o=e.prototype;return o.addEventListeners=function(){this.element.addEventListener("paste",this._onPaste),this.element.addEventListener("input",this._onInput,{passive:!0}),this.element.addEventListener("focus",this._onFocus,{passive:!0}),this.element.addEventListener("blur",this._onBlur,{passive:!0})},o.removeEventListeners=function(){this.element.removeEventListener("input",this._onInput,{passive:!0}),this.element.removeEventListener("paste",this._onPaste),this.element.removeEventListener("focus",this._onFocus,{passive:!0}),this.element.removeEventListener("blur",this._onBlur,{passive:!0})},o.enable=function(){this.element.removeAttribute("disabled"),this.isDisabled=!1},o.disable=function(){this.element.setAttribute("disabled",""),this.isDisabled=!0},o.focus=function(){this.isFocussed||this.element.focus()},o.blur=function(){this.isFocussed&&this.element.blur()},o.clear=function(e){return void 0===e&&(e=!0),this.element.value&&(this.element.value=""),e&&this.setWidth(),this},o.setWidth=function(){var e=this.element,t=e.style,i=e.value,n=e.placeholder;t.minWidth=n.length+1+"ch",t.width=i.length+1+"ch"},o.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},o.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},o._onInput=function(){this.type!==se&&this.setWidth()},o._onPaste=function(e){this.preventPaste&&e.preventDefault()},o._onFocus=function(){this.isFocussed=!0},o._onBlur=function(){this.isFocussed=!1},t=e,(i=[{key:"placeholder",set:function(e){this.element.placeholder=e}},{key:"value",get:function(){return A(this.element.value)},set:function(e){this.element.value=e}}])&&ce(t.prototype,i),n&&ce(t,n),e}(),he=function(){function e(e){var t=e.element;this.element=t,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}var t=e.prototype;return t.clear=function(){this.element.innerHTML=""},t.append=function(e){this.element.appendChild(e)},t.getChild=function(e){return this.element.querySelector(e)},t.hasChildren=function(){return this.element.hasChildNodes()},t.scrollToTop=function(){this.element.scrollTop=0},t.scrollToChildElement=function(e,t){var i=this;if(e){var n=this.element.offsetHeight,o=this.element.scrollTop+n,r=e.offsetHeight,s=e.offsetTop+r,a=t>0?this.element.scrollTop+s-o:e.offsetTop;requestAnimationFrame((function(){i._animateScroll(a,t)}))}},t._scrollDown=function(e,t,i){var n=(i-e)/t,o=n>1?n:1;this.element.scrollTop=e+o},t._scrollUp=function(e,t,i){var n=(e-i)/t,o=n>1?n:1;this.element.scrollTop=e-o},t._animateScroll=function(e,t){var i=this,n=this.element.scrollTop,o=!1;t>0?(this._scrollDown(n,4,e),n<e&&(o=!0)):(this._scrollUp(n,4,e),n>e&&(o=!0)),o&&requestAnimationFrame((function(){i._animateScroll(e,t)}))},e}();function ue(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pe=function(){function e(e){var t=e.element,i=e.classNames;if(this.element=t,this.classNames=i,!(t instanceof HTMLInputElement||t instanceof HTMLSelectElement))throw new TypeError("Invalid element passed");this.isDisabled=!1}var t,i,n,o=e.prototype;return o.conceal=function(){this.element.classList.add(this.classNames.input),this.element.hidden=!0,this.element.tabIndex=-1;var e=this.element.getAttribute("style");e&&this.element.setAttribute("data-choice-orig-style",e),this.element.setAttribute("data-choice","active")},o.reveal=function(){this.element.classList.remove(this.classNames.input),this.element.hidden=!1,this.element.removeAttribute("tabindex");var e=this.element.getAttribute("data-choice-orig-style");e?(this.element.removeAttribute("data-choice-orig-style"),this.element.setAttribute("style",e)):this.element.removeAttribute("style"),this.element.removeAttribute("data-choice"),this.element.value=this.element.value},o.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},o.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},o.triggerEvent=function(e,t){!function(e,t,i){void 0===i&&(i=null);var n=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0});e.dispatchEvent(n)}(this.element,e,t)},t=e,(i=[{key:"isActive",get:function(){return"active"===this.element.dataset.choice}},{key:"dir",get:function(){return this.element.dir}},{key:"value",get:function(){return this.element.value},set:function(e){this.element.value=e}}])&&ue(t.prototype,i),n&&ue(t,n),e}();function _e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var fe=function(e){var t,i,n,o,r;function s(t){var i,n=t.element,o=t.classNames,r=t.delimiter;return(i=e.call(this,{element:n,classNames:o})||this).delimiter=r,i}return i=e,(t=s).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n=s,(o=[{key:"value",get:function(){return this.element.value},set:function(e){var t=e.map((function(e){return e.value})).join(this.delimiter);this.element.setAttribute("value",t),this.element.value=t}}])&&_e(n.prototype,o),r&&_e(n,r),s}(pe);function ge(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var me=function(e){var t,i,n,o,r;function s(t){var i,n=t.element,o=t.classNames,r=t.template;return(i=e.call(this,{element:n,classNames:o})||this).template=r,i}return i=e,(t=s).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,s.prototype.appendDocFragment=function(e){this.element.innerHTML="",this.element.appendChild(e)},n=s,(o=[{key:"placeholderOption",get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")}},{key:"optionGroups",get:function(){return Array.from(this.element.getElementsByTagName("OPTGROUP"))}},{key:"options",get:function(){return Array.from(this.element.options)},set:function(e){var t=this,i=document.createDocumentFragment();e.forEach((function(e){return n=e,o=t.template(n),void i.appendChild(o);var n,o})),this.appendDocFragment(i)}}])&&ge(n.prototype,o),r&&ge(n,r),s}(pe),ve={containerOuter:function(e,t,i,n,o,r){var s=e.containerOuter,a=Object.assign(document.createElement("div"),{className:s});return a.dataset.type=r,t&&(a.dir=t),n&&(a.tabIndex=0),i&&(a.setAttribute("role",o?"combobox":"listbox"),o&&a.setAttribute("aria-autocomplete","list")),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false"),a},containerInner:function(e){var t=e.containerInner;return Object.assign(document.createElement("div"),{className:t})},itemList:function(e,t){var i=e.list,n=e.listSingle,o=e.listItems;return Object.assign(document.createElement("div"),{className:i+" "+(t?n:o)})},placeholder:function(e,t){var i=e.placeholder;return Object.assign(document.createElement("div"),{className:i,innerHTML:t})},item:function(e,t,i){var n=e.item,o=e.button,r=e.highlightedState,s=e.itemSelectable,a=e.placeholder,l=t.id,c=t.value,d=t.label,h=t.customProperties,u=t.active,p=t.disabled,_=t.highlighted,f=t.placeholder,g=Object.assign(document.createElement("div"),{className:n,innerHTML:d});if(Object.assign(g.dataset,{item:"",id:l,value:c,customProperties:h}),u&&g.setAttribute("aria-selected","true"),p&&g.setAttribute("aria-disabled","true"),f&&g.classList.add(a),g.classList.add(_?r:s),i){p&&g.classList.remove(s),g.dataset.deletable="";var m="Remove item",v=Object.assign(document.createElement("button"),{type:"button",className:o,innerHTML:m});v.setAttribute("aria-label","Remove item: '"+c+"'"),v.dataset.button="",g.appendChild(v)}return g},choiceList:function(e,t){var i=e.list,n=Object.assign(document.createElement("div"),{className:i});return t||n.setAttribute("aria-multiselectable","true"),n.setAttribute("role","listbox"),n},choiceGroup:function(e,t){var i=e.group,n=e.groupHeading,o=e.itemDisabled,r=t.id,s=t.value,a=t.disabled,l=Object.assign(document.createElement("div"),{className:i+" "+(a?o:"")});return l.setAttribute("role","group"),Object.assign(l.dataset,{group:"",id:r,value:s}),a&&l.setAttribute("aria-disabled","true"),l.appendChild(Object.assign(document.createElement("div"),{className:n,innerHTML:s})),l},choice:function(e,t,i){var n=e.item,o=e.itemChoice,r=e.itemSelectable,s=e.selectedState,a=e.itemDisabled,l=e.placeholder,c=t.id,d=t.value,h=t.label,u=t.groupId,p=t.elementId,_=t.disabled,f=t.selected,g=t.placeholder,m=Object.assign(document.createElement("div"),{id:p,innerHTML:h,className:n+" "+o});return f&&m.classList.add(s),g&&m.classList.add(l),m.setAttribute("role",u>0?"treeitem":"option"),Object.assign(m.dataset,{choice:"",id:c,value:d,selectText:i}),_?(m.classList.add(a),m.dataset.choiceDisabled="",m.setAttribute("aria-disabled","true")):(m.classList.add(r),m.dataset.choiceSelectable=""),m},input:function(e,t){var i=e.input,n=e.inputCloned,o=Object.assign(document.createElement("input"),{type:"text",className:i+" "+n,autocomplete:"off",autocapitalize:"off",spellcheck:!1});return o.setAttribute("role","textbox"),o.setAttribute("aria-autocomplete","list"),o.setAttribute("aria-label",t),o},dropdown:function(e){var t=e.list,i=e.listDropdown,n=document.createElement("div");return n.classList.add(t,i),n.setAttribute("aria-expanded","false"),n},notice:function(e,t,i){var n=e.item,o=e.itemChoice,r=e.noResults,s=e.noChoices;void 0===i&&(i="");var a=[n,o];return"no-choices"===i?a.push(s):"no-results"===i&&a.push(r),Object.assign(document.createElement("div"),{innerHTML:t,className:a.join(" ")})},option:function(e){var t=e.label,i=e.value,n=e.customProperties,o=e.active,r=e.disabled,s=new Option(t,i,!1,o);return n&&(s.dataset.customProperties=n),s.disabled=r,s}},be=function(e){return void 0===e&&(e=!0),{type:j,active:e}},ye=function(e,t){return{type:X,id:e,highlighted:t}},we=function(e){var t=e.value,i=e.id,n=e.active,o=e.disabled;return{type:W,value:t,id:i,active:n,disabled:o}},Ae=function(e){return{type:"SET_IS_LOADING",isLoading:e}};function xe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ke="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,Ce={},Se=function(){var e,t,i;function n(e,t){var i=this;void 0===e&&(e="[data-choice]"),void 0===t&&(t={}),this.config=s.a.all([D,n.defaults.options,t],{arrayMerge:function(e,t){return[].concat(t)}});var o,r,a,l,c=(o=this.config,r=D,a=Object.keys(o).sort(),l=Object.keys(r).sort(),a.filter((function(e){return l.indexOf(e)<0})));c.length&&console.warn("Unknown config option(s) passed",c.join(", "));var d="string"==typeof e?document.querySelector(e):e;if(!(d instanceof HTMLInputElement||d instanceof HTMLSelectElement))throw TypeError("Expected one of the following types text|select-one|select-multiple");if(this._isTextElement=d.type===re,this._isSelectOneElement=d.type===se,this._isSelectMultipleElement=d.type===ae,this._isSelectElement=this._isSelectOneElement||this._isSelectMultipleElement,this.config.searchEnabled=this._isSelectMultipleElement||this.config.searchEnabled,["auto","always"].includes(this.config.renderSelectedChoices)||(this.config.renderSelectedChoices="auto"),t.addItemFilter&&"function"!=typeof t.addItemFilter){var h=t.addItemFilter instanceof RegExp?t.addItemFilter:new RegExp(t.addItemFilter);this.config.addItemFilter=h.test.bind(h)}if(this._isTextElement?this.passedElement=new fe({element:d,classNames:this.config.classNames,delimiter:this.config.delimiter}):this.passedElement=new me({element:d,classNames:this.config.classNames,template:function(e){return i._templates.option(e)}}),this.initialised=!1,this._store=new E,this._initialState={},this._currentState={},this._prevState={},this._currentValue="",this._canSearch=this.config.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=function(e,t){var i=e.id||e.name&&e.name+"-"+b(2)||b(4);return t+"-"+i.replace(/(:|\.|\[|\]|,)/g,"")}(this.passedElement.element,"choices-"),this._direction=this.passedElement.dir,!this._direction){var u=window.getComputedStyle(this.passedElement.element).direction;u!==window.getComputedStyle(document.documentElement).direction&&(this._direction=u)}if(this._idNames={itemChoice:"item-choice"},this._presetGroups=this.passedElement.optionGroups,this._presetOptions=this.passedElement.options,this._presetChoices=this.config.choices,this._presetItems=this.config.items,this.passedElement.value&&(this._presetItems=this._presetItems.concat(this.passedElement.value.split(this.config.delimiter))),this.passedElement.options&&this.passedElement.options.forEach((function(e){i._presetChoices.push({value:e.value,label:e.innerHTML,selected:e.selected,disabled:e.disabled||e.parentNode.disabled,placeholder:""===e.value||e.hasAttribute("placeholder"),customProperties:e.getAttribute("data-custom-properties")})})),this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onAKey=this._onAKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive)return this.config.silent||console.warn("Trying to initialise Choices on element already initialised"),void(this.initialised=!0);this.init()}e=n,i=[{key:"defaults",get:function(){return Object.preventExtensions({get options(){return Ce},get templates(){return ve}})}}],(t=null)&&xe(e.prototype,t),i&&xe(e,i);var r=n.prototype;return r.init=function(){if(!this.initialised){this._createTemplates(),this._createElements(),this._createStructure(),this._initialState=C(this._store.state),this._store.subscribe(this._render),this._render(),this._addEventListeners(),(!this.config.addItems||this.passedElement.element.hasAttribute("disabled"))&&this.disable(),this.initialised=!0;var e=this.config.callbackOnInit;e&&"function"==typeof e&&e.call(this)}},r.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this.clearStore(),this._isSelectElement&&(this.passedElement.options=this._presetOptions),this._templates=null,this.initialised=!1)},r.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},r.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},r.highlightItem=function(e,t){if(void 0===t&&(t=!0),!e)return this;var i=e.id,n=e.groupId,o=void 0===n?-1:n,r=e.value,s=void 0===r?"":r,a=e.label,l=void 0===a?"":a,c=o>=0?this._store.getGroupById(o):null;return this._store.dispatch(ye(i,!0)),t&&this.passedElement.triggerEvent(O,{id:i,value:s,label:l,groupValue:c&&c.value?c.value:null}),this},r.unhighlightItem=function(e){if(!e)return this;var t=e.id,i=e.groupId,n=void 0===i?-1:i,o=e.value,r=void 0===o?"":o,s=e.label,a=void 0===s?"":s,l=n>=0?this._store.getGroupById(n):null;return this._store.dispatch(ye(t,!1)),this.passedElement.triggerEvent(O,{id:t,value:r,label:a,groupValue:l&&l.value?l.value:null}),this},r.highlightAll=function(){var e=this;return this._store.items.forEach((function(t){return e.highlightItem(t)})),this},r.unhighlightAll=function(){var e=this;return this._store.items.forEach((function(t){return e.unhighlightItem(t)})),this},r.removeActiveItemsByValue=function(e){var t=this;return this._store.activeItems.filter((function(t){return t.value===e})).forEach((function(e){return t._removeItem(e)})),this},r.removeActiveItems=function(e){var t=this;return this._store.activeItems.filter((function(t){return t.id!==e})).forEach((function(e){return t._removeItem(e)})),this},r.removeHighlightedItems=function(e){var t=this;return void 0===e&&(e=!1),this._store.highlightedActiveItems.forEach((function(i){t._removeItem(i),e&&t._triggerChange(i.value)})),this},r.showDropdown=function(e){var t=this;return this.dropdown.isActive||requestAnimationFrame((function(){t.dropdown.show(),t.containerOuter.open(t.dropdown.distanceFromTopWindow),!e&&t._canSearch&&t.input.focus(),t.passedElement.triggerEvent(I,{})})),this},r.hideDropdown=function(e){var t=this;return this.dropdown.isActive?(requestAnimationFrame((function(){t.dropdown.hide(),t.containerOuter.close(),!e&&t._canSearch&&(t.input.removeActiveDescendant(),t.input.blur()),t.passedElement.triggerEvent(B,{})})),this):this},r.getValue=function(e){void 0===e&&(e=!1);var t=this._store.activeItems.reduce((function(t,i){var n=e?i.value:i;return t.push(n),t}),[]);return this._isSelectOneElement?t[0]:t},r.setValue=function(e){var t=this;return this.initialised?(e.forEach((function(e){return t._setChoiceOrItem(e)})),this):this},r.setChoiceByValue=function(e){var t=this;return!this.initialised||this._isTextElement||(Array.isArray(e)?e:[e]).forEach((function(e){return t._findAndSelectChoiceByValue(e)})),this},r.setChoices=function(e,t,i,n){var o=this;if(void 0===e&&(e=[]),void 0===t&&(t="value"),void 0===i&&(i="label"),void 0===n&&(n=!1),!this.initialised)throw new ReferenceError("setChoices was called on a non-initialized instance of Choices");if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if("string"!=typeof t||!t)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(n&&this.clearChoices(),"function"==typeof e){var r=e(this);if("function"==typeof Promise&&r instanceof Promise)return new Promise((function(e){return requestAnimationFrame(e)})).then((function(){return o._handleLoadingState(!0)})).then((function(){return r})).then((function(e){return o.setChoices(e,t,i,n)})).catch((function(e){o.config.silent||console.error(e)})).then((function(){return o._handleLoadingState(!1)})).then((function(){return o}));if(!Array.isArray(r))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: "+typeof r);return this.setChoices(r,t,i,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._startLoading(),e.forEach((function(e){e.choices?o._addGroup({id:parseInt(e.id,10)||null,group:e,valueKey:t,labelKey:i}):o._addChoice({value:e[t],label:e[i],isSelected:e.selected,isDisabled:e.disabled,customProperties:e.customProperties,placeholder:e.placeholder})})),this._stopLoading(),this},r.clearChoices=function(){return this._store.dispatch({type:U}),this},r.clearStore=function(){return this._store.dispatch({type:"CLEAR_ALL"}),this},r.clearInput=function(){var e=!this._isSelectOneElement;return this.input.clear(e),!this._isTextElement&&this._canSearch&&(this._isSearching=!1,this._store.dispatch(be(!0))),this},r._render=function(){if(!this._store.isLoading()){this._currentState=this._store.state;var e=this._currentState.choices!==this._prevState.choices||this._currentState.groups!==this._prevState.groups||this._currentState.items!==this._prevState.items,t=this._isSelectElement,i=this._currentState.items!==this._prevState.items;e&&(t&&this._renderChoices(),i&&this._renderItems(),this._prevState=this._currentState)}},r._renderChoices=function(){var e=this,t=this._store,i=t.activeGroups,n=t.activeChoices,o=document.createDocumentFragment();if(this.choiceList.clear(),this.config.resetScrollPosition&&requestAnimationFrame((function(){return e.choiceList.scrollToTop()})),i.length>=1&&!this._isSearching){var r=n.filter((function(e){return!0===e.placeholder&&-1===e.groupId}));r.length>=1&&(o=this._createChoicesFragment(r,o)),o=this._createGroupsFragment(i,n,o)}else n.length>=1&&(o=this._createChoicesFragment(n,o));if(o.childNodes&&o.childNodes.length>0){var s=this._store.activeItems,a=this._canAddItem(s,this.input.value);a.response?(this.choiceList.append(o),this._highlightChoice()):this.choiceList.append(this._getTemplate("notice",a.notice))}else{var l,c;this._isSearching?(c="function"==typeof this.config.noResultsText?this.config.noResultsText():this.config.noResultsText,l=this._getTemplate("notice",c,"no-results")):(c="function"==typeof this.config.noChoicesText?this.config.noChoicesText():this.config.noChoicesText,l=this._getTemplate("notice",c,"no-choices")),this.choiceList.append(l)}},r._renderItems=function(){var e=this._store.activeItems||[];this.itemList.clear();var t=this._createItemsFragment(e);t.childNodes&&this.itemList.append(t)},r._createGroupsFragment=function(e,t,i){var n=this;return void 0===i&&(i=document.createDocumentFragment()),this.config.shouldSort&&e.sort(this.config.sorter),e.forEach((function(e){var o=function(e){return t.filter((function(t){return n._isSelectOneElement?t.groupId===e.id:t.groupId===e.id&&("always"===n.config.renderSelectedChoices||!t.selected)}))}(e);if(o.length>=1){var r=n._getTemplate("choiceGroup",e);i.appendChild(r),n._createChoicesFragment(o,i,!0)}})),i},r._createChoicesFragment=function(e,t,i){var n=this;void 0===t&&(t=document.createDocumentFragment()),void 0===i&&(i=!1);var o=this.config,r=o.renderSelectedChoices,s=o.searchResultLimit,a=o.renderChoiceLimit,l=this._isSearching?k:this.config.sorter,c=function(e){if("auto"!==r||n._isSelectOneElement||!e.selected){var i=n._getTemplate("choice",e,n.config.itemSelectText);t.appendChild(i)}},d=e;"auto"!==r||this._isSelectOneElement||(d=e.filter((function(e){return!e.selected})));var h=d.reduce((function(e,t){return t.placeholder?e.placeholderChoices.push(t):e.normalChoices.push(t),e}),{placeholderChoices:[],normalChoices:[]}),u=h.placeholderChoices,p=h.normalChoices;(this.config.shouldSort||this._isSearching)&&p.sort(l);var _=d.length,f=this._isSelectOneElement?[].concat(u,p):p;this._isSearching?_=s:a&&a>0&&!i&&(_=a);for(var g=0;g<_;g+=1)f[g]&&c(f[g]);return t},r._createItemsFragment=function(e,t){var i=this;void 0===t&&(t=document.createDocumentFragment());var n=this.config,o=n.shouldSortItems,r=n.sorter,s=n.removeItemButton;return o&&!this._isSelectOneElement&&e.sort(r),this._isTextElement?this.passedElement.value=e:this.passedElement.options=e,e.forEach((function(e){var n=i._getTemplate("item",e,s);t.appendChild(n)})),t},r._triggerChange=function(e){null!=e&&this.passedElement.triggerEvent(z,{value:e})},r._selectPlaceholderChoice=function(){var e=this._store.placeholderChoice;e&&(this._addItem({value:e.value,label:e.label,choiceId:e.id,groupId:e.groupId,placeholder:e.placeholder}),this._triggerChange(e.value))},r._handleButtonAction=function(e,t){if(e&&t&&this.config.removeItems&&this.config.removeItemButton){var i=t.parentNode.getAttribute("data-id"),n=e.find((function(e){return e.id===parseInt(i,10)}));this._removeItem(n),this._triggerChange(n.value),this._isSelectOneElement&&this._selectPlaceholderChoice()}},r._handleItemAction=function(e,t,i){var n=this;if(void 0===i&&(i=!1),e&&t&&this.config.removeItems&&!this._isSelectOneElement){var o=t.getAttribute("data-id");e.forEach((function(e){e.id!==parseInt(o,10)||e.highlighted?!i&&e.highlighted&&n.unhighlightItem(e):n.highlightItem(e)})),this.input.focus()}},r._handleChoiceAction=function(e,t){if(e&&t){var i=t.dataset.id,n=this._store.getChoiceById(i);if(n){var o=e[0]&&e[0].keyCode?e[0].keyCode:null,r=this.dropdown.isActive;n.keyCode=o,this.passedElement.triggerEvent(L,{choice:n}),n.selected||n.disabled||this._canAddItem(e,n.value).response&&(this._addItem({value:n.value,label:n.label,choiceId:n.id,groupId:n.groupId,customProperties:n.customProperties,placeholder:n.placeholder,keyCode:n.keyCode}),this._triggerChange(n.value)),this.clearInput(),r&&this._isSelectOneElement&&(this.hideDropdown(!0),this.containerOuter.focus())}}},r._handleBackspace=function(e){if(this.config.removeItems&&e){var t=e[e.length-1],i=e.some((function(e){return e.highlighted}));this.config.editItems&&!i&&t?(this.input.value=t.value,this.input.setWidth(),this._removeItem(t),this._triggerChange(t.value)):(i||this.highlightItem(t,!1),this.removeHighlightedItems(!0))}},r._startLoading=function(){this._store.dispatch(Ae(!0))},r._stopLoading=function(){this._store.dispatch(Ae(!1))},r._handleLoadingState=function(e){void 0===e&&(e=!0);var t=this.itemList.getChild("."+this.config.classNames.placeholder);e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?t?t.innerHTML=this.config.loadingText:(t=this._getTemplate("placeholder",this.config.loadingText),this.itemList.append(t)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?t.innerHTML=this._placeholderValue||"":this.input.placeholder=this._placeholderValue||"")},r._handleSearch=function(e){if(e&&this.input.isFocussed){var t=this._store.choices,i=this.config,n=i.searchFloor,o=i.searchChoices,r=t.some((function(e){return!e.active}));if(e&&e.length>=n){var s=o?this._searchChoices(e):0;this.passedElement.triggerEvent(N,{value:e,resultCount:s})}else r&&(this._isSearching=!1,this._store.dispatch(be(!0)))}},r._canAddItem=function(e,t){var i=!0,n="function"==typeof this.config.addItemText?this.config.addItemText(t):this.config.addItemText;if(!this._isSelectOneElement){var o=function(e,t,i){return void 0===i&&(i="value"),e.some((function(e){return"string"==typeof t?e[i]===t.trim():e[i]===t}))}(e,t);this.config.maxItemCount>0&&this.config.maxItemCount<=e.length&&(i=!1,n="function"==typeof this.config.maxItemText?this.config.maxItemText(this.config.maxItemCount):this.config.maxItemText),!this.config.duplicateItemsAllowed&&o&&i&&(i=!1,n="function"==typeof this.config.uniqueItemText?this.config.uniqueItemText(t):this.config.uniqueItemText),this._isTextElement&&this.config.addItems&&i&&"function"==typeof this.config.addItemFilter&&!this.config.addItemFilter(t)&&(i=!1,n="function"==typeof this.config.customAddItemText?this.config.customAddItemText(t):this.config.customAddItemText)}return{response:i,notice:n}},r._searchChoices=function(e){var t="string"==typeof e?e.trim():e,i="string"==typeof this._currentValue?this._currentValue.trim():this._currentValue;if(t.length<1&&t===i+" ")return 0;var n=this._store.searchableChoices,r=t,s=[].concat(this.config.searchFields),a=Object.assign(this.config.fuseOptions,{keys:s}),l=new o.a(n,a).search(r);return this._currentValue=t,this._highlightPosition=0,this._isSearching=!0,this._store.dispatch(function(e){return{type:H,results:e}}(l)),l.length},r._addEventListeners=function(){var e=document.documentElement;e.addEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.addEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(this.containerOuter.element.addEventListener("focus",this._onFocus,{passive:!0}),this.containerOuter.element.addEventListener("blur",this._onBlur,{passive:!0})),this.input.element.addEventListener("keyup",this._onKeyUp,{passive:!0}),this.input.element.addEventListener("focus",this._onFocus,{passive:!0}),this.input.element.addEventListener("blur",this._onBlur,{passive:!0}),this.input.element.form&&this.input.element.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},r._removeEventListeners=function(){var e=document.documentElement;e.removeEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.removeEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(this.containerOuter.element.removeEventListener("focus",this._onFocus),this.containerOuter.element.removeEventListener("blur",this._onBlur)),this.input.element.removeEventListener("keyup",this._onKeyUp),this.input.element.removeEventListener("focus",this._onFocus),this.input.element.removeEventListener("blur",this._onBlur),this.input.element.form&&this.input.element.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},r._onKeyDown=function(e){var t,i=e.target,n=e.keyCode,o=e.ctrlKey,r=e.metaKey,s=this._store.activeItems,a=this.input.isFocussed,l=this.dropdown.isActive,c=this.itemList.hasChildren(),d=String.fromCharCode(n),h=K,u=J,p=Q,_=Z,f=ee,g=te,m=ie,v=ne,b=oe,y=o||r;!this._isTextElement&&/[a-zA-Z0-9-_ ]/.test(d)&&this.showDropdown();var w=((t={})[_]=this._onAKey,t[p]=this._onEnterKey,t[f]=this._onEscapeKey,t[g]=this._onDirectionKey,t[v]=this._onDirectionKey,t[m]=this._onDirectionKey,t[b]=this._onDirectionKey,t[u]=this._onDeleteKey,t[h]=this._onDeleteKey,t);w[n]&&w[n]({event:e,target:i,keyCode:n,metaKey:r,activeItems:s,hasFocusedInput:a,hasActiveDropdown:l,hasItems:c,hasCtrlDownKeyPressed:y})},r._onKeyUp=function(e){var t=e.target,i=e.keyCode,n=this.input.value,o=this._store.activeItems,r=this._canAddItem(o,n),s=K,a=J;if(this._isTextElement)if(r.notice&&n){var l=this._getTemplate("notice",r.notice);this.dropdown.element.innerHTML=l.outerHTML,this.showDropdown(!0)}else this.hideDropdown(!0);else{var c=(i===s||i===a)&&!t.value,d=!this._isTextElement&&this._isSearching,h=this._canSearch&&r.response;c&&d?(this._isSearching=!1,this._store.dispatch(be(!0))):h&&this._handleSearch(this.input.value)}this._canSearch=this.config.searchEnabled},r._onAKey=function(e){var t=e.hasItems;e.hasCtrlDownKeyPressed&&t&&(this._canSearch=!1,this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement&&this.highlightAll())},r._onEnterKey=function(e){var t=e.event,i=e.target,n=e.activeItems,o=e.hasActiveDropdown,r=Q,s=i.hasAttribute("data-button");if(this._isTextElement&&i.value){var a=this.input.value;this._canAddItem(n,a).response&&(this.hideDropdown(!0),this._addItem({value:a}),this._triggerChange(a),this.clearInput())}if(s&&(this._handleButtonAction(n,i),t.preventDefault()),o){var l=this.dropdown.getChild("."+this.config.classNames.highlightedState);l&&(n[0]&&(n[0].keyCode=r),this._handleChoiceAction(n,l)),t.preventDefault()}else this._isSelectOneElement&&(this.showDropdown(),t.preventDefault())},r._onEscapeKey=function(e){e.hasActiveDropdown&&(this.hideDropdown(!0),this.containerOuter.focus())},r._onDirectionKey=function(e){var t,i,n,o=e.event,r=e.hasActiveDropdown,s=e.keyCode,a=e.metaKey,l=ie,c=ne,d=oe;if(r||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var h,u=s===l||s===d?1:-1,p="[data-choice-selectable]";if(a||s===d||s===c)h=u>0?this.dropdown.element.querySelector("[data-choice-selectable]:last-of-type"):this.dropdown.element.querySelector(p);else{var _=this.dropdown.element.querySelector("."+this.config.classNames.highlightedState);h=_?function(e,t,i){if(void 0===i&&(i=1),e instanceof Element&&"string"==typeof t){for(var n=(i>0?"next":"previous")+"ElementSibling",o=e[n];o;){if(o.matches(t))return o;o=o[n]}return o}}(_,p,u):this.dropdown.element.querySelector(p)}h&&(t=h,i=this.choiceList.element,void 0===(n=u)&&(n=1),t&&(n>0?i.scrollTop+i.offsetHeight>=t.offsetTop+t.offsetHeight:t.offsetTop>=i.scrollTop)||this.choiceList.scrollToChildElement(h,u),this._highlightChoice(h)),o.preventDefault()}},r._onDeleteKey=function(e){var t=e.event,i=e.target,n=e.hasFocusedInput,o=e.activeItems;!n||i.value||this._isSelectOneElement||(this._handleBackspace(o),t.preventDefault())},r._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},r._onTouchEnd=function(e){var t=(e||e.touches[0]).target;this._wasTap&&this.containerOuter.element.contains(t)&&((t===this.containerOuter.element||t===this.containerInner.element)&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()),this._wasTap=!0},r._onMouseDown=function(e){var t=e.target;if(t instanceof HTMLElement){if(ke&&this.choiceList.element.contains(t)){var i=this.choiceList.element.firstElementChild,n="ltr"===this._direction?e.offsetX>=i.offsetWidth:e.offsetX<i.offsetLeft;this._isScrollingOnIe=n}if(t!==this.input.element){var o=t.closest("[data-button],[data-item],[data-choice]");if(o instanceof HTMLElement){var r=e.shiftKey,s=this._store.activeItems,a=o.dataset;"button"in a?this._handleButtonAction(s,o):"item"in a?this._handleItemAction(s,o,r):"choice"in a&&this._handleChoiceAction(s,o)}e.preventDefault()}}},r._onMouseOver=function(e){var t=e.target;t instanceof HTMLElement&&"choice"in t.dataset&&this._highlightChoice(t)},r._onClick=function(e){var t=e.target;this.containerOuter.element.contains(t)?this.dropdown.isActive||this.containerOuter.isDisabled?this._isSelectOneElement&&t!==this.input.element&&!this.dropdown.element.contains(t)&&this.hideDropdown():this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),this.containerOuter.focus()):(this._store.highlightedActiveItems.length>0&&this.unhighlightAll(),this.containerOuter.removeFocusState(),this.hideDropdown(!0))},r._onFocus=function(e){var t,i=this,n=e.target;this.containerOuter.element.contains(n)&&((t={}).text=function(){n===i.input.element&&i.containerOuter.addFocusState()},t["select-one"]=function(){i.containerOuter.addFocusState(),n===i.input.element&&i.showDropdown(!0)},t["select-multiple"]=function(){n===i.input.element&&(i.showDropdown(!0),i.containerOuter.addFocusState())},t)[this.passedElement.element.type]()},r._onBlur=function(e){var t=this,i=e.target;if(this.containerOuter.element.contains(i)&&!this._isScrollingOnIe){var n,o=this._store.activeItems.some((function(e){return e.highlighted}));((n={}).text=function(){i===t.input.element&&(t.containerOuter.removeFocusState(),o&&t.unhighlightAll(),t.hideDropdown(!0))},n["select-one"]=function(){t.containerOuter.removeFocusState(),(i===t.input.element||i===t.containerOuter.element&&!t._canSearch)&&t.hideDropdown(!0)},n["select-multiple"]=function(){i===t.input.element&&(t.containerOuter.removeFocusState(),t.hideDropdown(!0),o&&t.unhighlightAll())},n)[this.passedElement.element.type]()}else this._isScrollingOnIe=!1,this.input.element.focus()},r._onFormReset=function(){this._store.dispatch({type:"RESET_TO",state:this._initialState})},r._highlightChoice=function(e){var t=this;void 0===e&&(e=null);var i=Array.from(this.dropdown.element.querySelectorAll("[data-choice-selectable]"));if(i.length){var n=e;Array.from(this.dropdown.element.querySelectorAll("."+this.config.classNames.highlightedState)).forEach((function(e){e.classList.remove(t.config.classNames.highlightedState),e.setAttribute("aria-selected","false")})),n?this._highlightPosition=i.indexOf(n):(n=i.length>this._highlightPosition?i[this._highlightPosition]:i[i.length-1])||(n=i[0]),n.classList.add(this.config.classNames.highlightedState),n.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(F,{el:n}),this.dropdown.isActive&&(this.input.setActiveDescendant(n.id),this.containerOuter.setActiveDescendant(n.id))}},r._addItem=function(e){var t=e.value,i=e.label,n=void 0===i?null:i,o=e.choiceId,r=void 0===o?-1:o,s=e.groupId,a=void 0===s?-1:s,l=e.customProperties,c=void 0===l?null:l,d=e.placeholder,h=void 0!==d&&d,u=e.keyCode,p=void 0===u?null:u,_="string"==typeof t?t.trim():t,f=p,g=c,m=this._store.items,v=n||_,b=r||-1,y=a>=0?this._store.getGroupById(a):null,w=m?m.length+1:1;return this.config.prependValue&&(_=this.config.prependValue+_.toString()),this.config.appendValue&&(_+=this.config.appendValue.toString()),this._store.dispatch(function(e){var t=e.value,i=e.label,n=e.id,o=e.choiceId,r=e.groupId,s=e.customProperties,a=e.placeholder,l=e.keyCode;return{type:Y,value:t,label:i,id:n,choiceId:o,groupId:r,customProperties:s,placeholder:a,keyCode:l}}({value:_,label:v,id:w,choiceId:b,groupId:a,customProperties:c,placeholder:h,keyCode:f})),this._isSelectOneElement&&this.removeActiveItems(w),this.passedElement.triggerEvent($,{id:w,value:_,label:v,customProperties:g,groupValue:y&&y.value?y.value:void 0,keyCode:f}),this},r._removeItem=function(e){if(!e||!w("Object",e))return this;var t=e.id,i=e.value,n=e.label,o=e.choiceId,r=e.groupId,s=r>=0?this._store.getGroupById(r):null;return this._store.dispatch(function(e,t){return{type:q,id:e,choiceId:t}}(t,o)),s&&s.value?this.passedElement.triggerEvent(V,{id:t,value:i,label:n,groupValue:s.value}):this.passedElement.triggerEvent(V,{id:t,value:i,label:n}),this},r._addChoice=function(e){var t=e.value,i=e.label,n=void 0===i?null:i,o=e.isSelected,r=void 0!==o&&o,s=e.isDisabled,a=void 0!==s&&s,l=e.groupId,c=void 0===l?-1:l,d=e.customProperties,h=void 0===d?null:d,u=e.placeholder,p=void 0!==u&&u,_=e.keyCode,f=void 0===_?null:_;if(null!=t){var g=this._store.choices,m=n||t,v=g?g.length+1:1,b=this._baseId+"-"+this._idNames.itemChoice+"-"+v;this._store.dispatch(function(e){var t=e.value,i=e.label,n=e.id,o=e.groupId,r=e.disabled,s=e.elementId,a=e.customProperties,l=e.placeholder,c=e.keyCode;return{type:G,value:t,label:i,id:n,groupId:o,disabled:r,elementId:s,customProperties:a,placeholder:l,keyCode:c}}({id:v,groupId:c,elementId:b,value:t,label:m,disabled:a,customProperties:h,placeholder:p,keyCode:f})),r&&this._addItem({value:t,label:m,choiceId:v,customProperties:h,placeholder:p,keyCode:f})}},r._addGroup=function(e){var t=this,i=e.group,n=e.id,o=e.valueKey,r=void 0===o?"value":o,s=e.labelKey,a=void 0===s?"label":s,l=w("Object",i)?i.choices:Array.from(i.getElementsByTagName("OPTION")),c=n||Math.floor((new Date).valueOf()*Math.random()),d=!!i.disabled&&i.disabled;l?(this._store.dispatch(we({value:i.label,id:c,active:!0,disabled:d})),l.forEach((function(e){var i=e.disabled||e.parentNode&&e.parentNode.disabled;t._addChoice({value:e[r],label:w("Object",e)?e[a]:e.innerHTML,isSelected:e.selected,isDisabled:i,groupId:c,customProperties:e.customProperties,placeholder:e.placeholder})}))):this._store.dispatch(we({value:i.label,id:i.id,active:!1,disabled:i.disabled}))},r._getTemplate=function(e){var t;if(!e)return null;for(var i=this.config.classNames,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return(t=this._templates[e]).call.apply(t,[this,i].concat(o))},r._createTemplates=function(){var e=this.config.callbackOnCreateTemplates,t={};e&&"function"==typeof e&&(t=e.call(this,x)),this._templates=s()(ve,t)},r._createElements=function(){this.containerOuter=new le({element:this._getTemplate("containerOuter",this._direction,this._isSelectElement,this._isSelectOneElement,this.config.searchEnabled,this.passedElement.element.type),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.containerInner=new le({element:this._getTemplate("containerInner"),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.input=new de({element:this._getTemplate("input",this._placeholderValue),classNames:this.config.classNames,type:this.passedElement.element.type,preventPaste:!this.config.paste}),this.choiceList=new he({element:this._getTemplate("choiceList",this._isSelectOneElement)}),this.itemList=new he({element:this._getTemplate("itemList",this._isSelectOneElement)}),this.dropdown=new M({element:this._getTemplate("dropdown"),classNames:this.config.classNames,type:this.passedElement.element.type})},r._createStructure=function(){this.passedElement.conceal(),this.containerInner.wrap(this.passedElement.element),this.containerOuter.wrap(this.containerInner.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":this._placeholderValue&&(this.input.placeholder=this._placeholderValue,this.input.setWidth()),this.containerOuter.element.appendChild(this.containerInner.element),this.containerOuter.element.appendChild(this.dropdown.element),this.containerInner.element.appendChild(this.itemList.element),this._isTextElement||this.dropdown.element.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&this.dropdown.element.insertBefore(this.input.element,this.dropdown.element.firstChild):this.containerInner.element.appendChild(this.input.element),this._isSelectElement&&(this._highlightPosition=0,this._isSearching=!1,this._startLoading(),this._presetGroups.length?this._addPredefinedGroups(this._presetGroups):this._addPredefinedChoices(this._presetChoices),this._stopLoading()),this._isTextElement&&this._addPredefinedItems(this._presetItems)},r._addPredefinedGroups=function(e){var t=this,i=this.passedElement.placeholderOption;i&&"SELECT"===i.parentNode.tagName&&this._addChoice({value:i.value,label:i.innerHTML,isSelected:i.selected,isDisabled:i.disabled,placeholder:!0}),e.forEach((function(e){return t._addGroup({group:e,id:e.id||null})}))},r._addPredefinedChoices=function(e){var t=this;this.config.shouldSort&&e.sort(this.config.sorter);var i=e.some((function(e){return e.selected})),n=e.findIndex((function(e){return void 0===e.disabled||!e.disabled}));e.forEach((function(e,o){var r=e.value,s=e.label,a=e.customProperties,l=e.placeholder;if(t._isSelectElement)if(e.choices)t._addGroup({group:e,id:e.id||null});else{var c=!(!t._isSelectOneElement||i||o!==n)||e.selected,d=e.disabled;t._addChoice({value:r,label:s,isSelected:c,isDisabled:d,customProperties:a,placeholder:l})}else t._addChoice({value:r,label:s,isSelected:e.selected,isDisabled:e.disabled,customProperties:a,placeholder:l})}))},r._addPredefinedItems=function(e){var t=this;e.forEach((function(e){"object"==typeof e&&e.value&&t._addItem({value:e.value,label:e.label,choiceId:e.id,customProperties:e.customProperties,placeholder:e.placeholder}),"string"==typeof e&&t._addItem({value:e})}))},r._setChoiceOrItem=function(e){var t=this;({object:function(){e.value&&(t._isTextElement?t._addItem({value:e.value,label:e.label,choiceId:e.id,customProperties:e.customProperties,placeholder:e.placeholder}):t._addChoice({value:e.value,label:e.label,isSelected:!0,isDisabled:!1,customProperties:e.customProperties,placeholder:e.placeholder}))},string:function(){t._isTextElement?t._addItem({value:e}):t._addChoice({value:e,label:e,isSelected:!0,isDisabled:!1})}})[y(e).toLowerCase()]()},r._findAndSelectChoiceByValue=function(e){var t=this,i=this._store.choices.find((function(i){return t.config.valueComparer(i.value,e)}));i&&!i.selected&&this._addItem({value:i.value,label:i.label,choiceId:i.id,groupId:i.groupId,customProperties:i.customProperties,placeholder:i.placeholder,keyCode:i.keyCode})},r._generatePlaceholderValue=function(){if(this._isSelectElement){var e=this.passedElement.placeholderOption;return!!e&&e.text}var t=this.config,i=t.placeholder,n=t.placeholderValue,o=this.passedElement.element.dataset;if(i){if(n)return n;if(o.placeholder)return o.placeholder}return!1},n}();t.default=Se}]).default},choices.exports=factory();var Choices=getDefaultExportFromCjs(choices.exports),choices_css=".bk-root{}.bk-root .choices{position:relative;margin-bottom:24px;font-size:16px;}.bk-root .choices:focus{outline:none;}.bk-root .choices:last-child{margin-bottom:0;}.bk-root .choices.is-disabled .choices__inner,.bk-root .choices.is-disabled .choices__input{background-color:#eaeaea;cursor:not-allowed;-webkit-user-select:none;-ms-user-select:none;user-select:none;}.bk-root .choices.is-disabled .choices__item{cursor:not-allowed;}.bk-root .choices [hidden]{display:none !important;}.bk-root .choices[data-type*='select-one']{cursor:pointer;}.bk-root .choices[data-type*='select-one'] .choices__inner{padding-bottom:7.5px;}.bk-root .choices[data-type*='select-one'] .choices__input{display:block;width:100%;padding:10px;border-bottom:1px solid #dddddd;background-color:#ffffff;margin:0;}.bk-root .choices[data-type*='select-one'] .choices__button{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMSAyMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjU5Mi4wNDRsMTguMzY0IDE4LjM2NC0yLjU0OCAyLjU0OEwuMDQ0IDIuNTkyeiIvPjxwYXRoIGQ9Ik0wIDE4LjM2NEwxOC4zNjQgMGwyLjU0OCAyLjU0OEwyLjU0OCAyMC45MTJ6Ii8+PC9nPjwvc3ZnPg==);padding:0;background-size:8px;position:absolute;top:50%;right:0;margin-top:-10px;margin-right:25px;height:20px;width:20px;border-radius:10em;opacity:0.5;}.bk-root .choices[data-type*='select-one'] .choices__button:hover,.bk-root .choices[data-type*='select-one'] .choices__button:focus{opacity:1;}.bk-root .choices[data-type*='select-one'] .choices__button:focus{box-shadow:0px 0px 0px 2px #00bcd4;}.bk-root .choices[data-type*='select-one'] .choices__item[data-value=''] .choices__button{display:none;}.bk-root .choices[data-type*='select-one']:after{content:'';height:0;width:0;border-style:solid;border-color:#333333 transparent transparent transparent;border-width:5px;position:absolute;right:11.5px;top:50%;margin-top:-2.5px;pointer-events:none;}.bk-root .choices[data-type*='select-one'].is-open:after{border-color:transparent transparent #333333 transparent;margin-top:-7.5px;}.bk-root .choices[data-type*='select-one'][dir='rtl']:after{left:11.5px;right:auto;}.bk-root .choices[data-type*='select-one'][dir='rtl'] .choices__button{right:auto;left:0;margin-left:25px;margin-right:0;}.bk-root .choices[data-type*='select-multiple'] .choices__inner,.bk-root .choices[data-type*='text'] .choices__inner{cursor:text;}.bk-root .choices[data-type*='select-multiple'] .choices__button,.bk-root .choices[data-type*='text'] .choices__button{position:relative;display:inline-block;margin-top:0;margin-right:-4px;margin-bottom:0;margin-left:8px;padding-left:16px;border-left:1px solid #008fa1;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMSAyMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjRkZGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjU5Mi4wNDRsMTguMzY0IDE4LjM2NC0yLjU0OCAyLjU0OEwuMDQ0IDIuNTkyeiIvPjxwYXRoIGQ9Ik0wIDE4LjM2NEwxOC4zNjQgMGwyLjU0OCAyLjU0OEwyLjU0OCAyMC45MTJ6Ii8+PC9nPjwvc3ZnPg==);background-size:8px;width:8px;line-height:1;opacity:0.75;border-radius:0;}.bk-root .choices[data-type*='select-multiple'] .choices__button:hover,.bk-root .choices[data-type*='select-multiple'] .choices__button:focus,.bk-root .choices[data-type*='text'] .choices__button:hover,.bk-root .choices[data-type*='text'] .choices__button:focus{opacity:1;}.bk-root .choices__inner{display:inline-block;vertical-align:top;width:100%;background-color:#f9f9f9;padding:7.5px 7.5px 3.75px;border:1px solid #dddddd;border-radius:2.5px;font-size:14px;min-height:44px;overflow:hidden;}.bk-root .is-focused .choices__inner,.bk-root .is-open .choices__inner{border-color:#b7b7b7;}.bk-root .is-open .choices__inner{border-radius:2.5px 2.5px 0 0;}.bk-root .is-flipped.is-open .choices__inner{border-radius:0 0 2.5px 2.5px;}.bk-root .choices__list{margin:0;padding-left:0;list-style:none;}.bk-root .choices__list--single{display:inline-block;padding:4px 16px 4px 4px;width:100%;}.bk-root [dir='rtl'] .choices__list--single{padding-right:4px;padding-left:16px;}.bk-root .choices__list--single .choices__item{width:100%;}.bk-root .choices__list--multiple{display:inline;}.bk-root .choices__list--multiple .choices__item{display:inline-block;vertical-align:middle;border-radius:20px;padding:4px 10px;font-size:12px;font-weight:500;margin-right:3.75px;margin-bottom:3.75px;background-color:#00bcd4;border:1px solid #00a5bb;color:#ffffff;word-break:break-all;box-sizing:border-box;}.bk-root .choices__list--multiple .choices__item[data-deletable]{padding-right:5px;}.bk-root [dir='rtl'] .choices__list--multiple .choices__item{margin-right:0;margin-left:3.75px;}.bk-root .choices__list--multiple .choices__item.is-highlighted{background-color:#00a5bb;border:1px solid #008fa1;}.bk-root .is-disabled .choices__list--multiple .choices__item{background-color:#aaaaaa;border:1px solid #919191;}.bk-root .choices__list--dropdown{visibility:hidden;z-index:1;position:absolute;width:100%;background-color:#ffffff;border:1px solid #dddddd;top:100%;margin-top:-1px;border-bottom-left-radius:2.5px;border-bottom-right-radius:2.5px;overflow:hidden;word-break:break-all;will-change:visibility;}.bk-root .choices__list--dropdown.is-active{visibility:visible;}.bk-root .is-open .choices__list--dropdown{border-color:#b7b7b7;}.bk-root .is-flipped .choices__list--dropdown{top:auto;bottom:100%;margin-top:0;margin-bottom:-1px;border-radius:0.25rem 0.25rem 0 0;}.bk-root .choices__list--dropdown .choices__list{position:relative;max-height:300px;overflow:auto;-webkit-overflow-scrolling:touch;will-change:scroll-position;}.bk-root .choices__list--dropdown .choices__item{position:relative;padding:10px;font-size:14px;}.bk-root [dir='rtl'] .choices__list--dropdown .choices__item{text-align:right;}@media (min-width: 640px){.bk-root .choices__list--dropdown .choices__item--selectable{padding-right:100px;}.bk-root .choices__list--dropdown .choices__item--selectable:after{content:attr(data-select-text);font-size:12px;opacity:0;position:absolute;right:10px;top:50%;transform:translateY(-50%);}.bk-root [dir='rtl'] .choices__list--dropdown .choices__item--selectable{text-align:right;padding-left:100px;padding-right:10px;}.bk-root [dir='rtl'] .choices__list--dropdown .choices__item--selectable:after{right:auto;left:10px;}}.bk-root .choices__list--dropdown .choices__item--selectable.is-highlighted{background-color:#f2f2f2;}.bk-root .choices__list--dropdown .choices__item--selectable.is-highlighted:after{opacity:0.5;}.bk-root .choices__item{cursor:default;}.bk-root .choices__item--selectable{cursor:pointer;}.bk-root .choices__item--disabled{cursor:not-allowed;-webkit-user-select:none;-ms-user-select:none;user-select:none;opacity:0.5;}.bk-root .choices__heading{font-weight:600;font-size:12px;padding:10px;border-bottom:1px solid #f7f7f7;color:gray;}.bk-root .choices__button{text-indent:-9999px;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;background-color:transparent;background-repeat:no-repeat;background-position:center;cursor:pointer;}.bk-root .choices__button:focus{outline:none;}.bk-root .choices__input{display:inline-block;vertical-align:baseline;background-color:#f9f9f9;font-size:14px;margin-bottom:5px;border:0;border-radius:0;max-width:100%;padding:4px 0 4px 2px;}.bk-root .choices__input:focus{outline:0;}.bk-root [dir='rtl'] .choices__input{padding-right:2px;padding-left:0;}.bk-root .choices__placeholder{opacity:0.5;}.bk-root .choices{width:100%;}.bk-root .choices{box-sizing:border-box;}.bk-root .choices *,.bk-root .choices *:before,.bk-root .choices *:after{box-sizing:inherit;}.bk-root .choices__inner .choices__item.light{background-color:rgba(0, 126, 255, 0.08);border-radius:5px;border:1px solid rgba(0, 126, 255, 0.24);color:#007eff;}.bk-root .choices__inner .choices__item.solid{background-color:#1f77b4;border:none;border-radius:5px;color:white;}.bk-root .choices__inner .choices__item.solid .is-highlighted{background-color:#1f77b4;border:none;}.bk-root .choices__input{background-color:transparent;}.bk-root .choices__inner{background:transparent;border:1px solid darkgray;border-radius:5px;min-height:unset;}.bk-root .choices__list{white-space:initial;}.bk-root .choices__list--dropdown{z-index:100;}.bk-root .choices[data-type*=select-multiple] .choices__button.light{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMSAyMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjMDA3ZWZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjU5Mi4wNDRsMTguMzY0IDE4LjM2NC0yLjU0OCAyLjU0OEwuMDQ0IDIuNTkyeiIvPjxwYXRoIGQ9Ik0wIDE4LjM2NEwxOC4zNjQgMGwyLjU0OCAyLjU0OEwyLjU0OCAyMC45MTJ6Ii8+PC9nPjwvc3ZnPg==);}.bk-root .choices[data-type*=select-multiple] .choices__button.solid{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjEiIHZpZXdCb3g9IjAgMCAyMSAyMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjZmZmZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjU5Mi4wNDRsMTguMzY0IDE4LjM2NC0yLjU0OCAyLjU0OEwuMDQ0IDIuNTkyeiIvPjxwYXRoIGQ9Ik0wIDE4LjM2NEwxOC4zNjQgMGwyLjU0OCAyLjU0OEwyLjU0OCAyMC45MTJ6Ii8+PC9nPjwvc3ZnPg==);border-left:1px solid white;opacity:1;}";class MultiChoiceView extends InputWidgetView{constructor(){super(...arguments),this._last_height=null}connect_signals(){super.connect_signals(),this.connect(this.model.properties.disabled.change,(()=>this.set_disabled()));const{value:e,max_items:t,option_limit:i,delete_button:n,placeholder:o,options:r,name:s,title:a}=this.model.properties;this.on_change([e,t,i,n,o,r,s,a],(()=>this.render()))}styles(){return[...super.styles(),choices_css]}_update_layout(){this.layout=new CachedVariadicBox(this.el),this.layout.set_sizing(this.box_sizing())}render(){super.render(),this.input_el=select({multiple:!0,class:input,name:this.model.name,disabled:this.model.disabled}),this.group_el.appendChild(this.input_el);const e=new Set(this.model.value),t=this.model.options.map((t=>{let i,n;return isString(t)?i=n=t:[i,n]=t,{value:i,label:n,selected:e.has(i)}})),i=this.model.solid?"solid":"light",n=`choices__item ${i}`,o=`choices__button ${i}`,r={choices:t,duplicateItemsAllowed:!1,removeItemButton:this.model.delete_button,classNames:{item:n,button:o}};null!=this.model.placeholder&&(r.placeholderValue=this.model.placeholder),null!=this.model.max_items&&(r.maxItemCount=this.model.max_items),null!=this.model.option_limit&&(r.renderChoiceLimit=this.model.option_limit),this.choice_el=new Choices(this.input_el,r);const s=()=>this.choice_el.containerOuter.element.getBoundingClientRect().height;null!=this._last_height&&this._last_height!=s()&&this.root.invalidate_layout(),this._last_height=s(),this.input_el.addEventListener("change",(()=>this.change_input()))}set_disabled(){this.model.disabled?this.choice_el.disable():this.choice_el.enable()}change_input(){const e=null!=this.el.querySelector("select:focus"),t=[];for(const i of this.el.querySelectorAll("option"))i.selected&&t.push(i.value);this.model.value=t,super.change_input(),e&&this.input_el.focus()}}MultiChoiceView.__name__="MultiChoiceView";class MultiChoice extends InputWidget{constructor(e){super(e)}static init_MultiChoice(){this.prototype.default_view=MultiChoiceView,this.define((({Boolean:e,Int:t,String:i,Array:n,Tuple:o,Or:r,Nullable:s})=>({value:[n(i),[]],options:[n(r(i,o(i,i))),[]],max_items:[s(t),null],delete_button:[e,!0],placeholder:[s(i),null],option_limit:[s(t),null],solid:[e,!0]})))}}MultiChoice.__name__="MultiChoice",MultiChoice.init_MultiChoice();const int_regex=/^[-+]?\d*$/,float_regex=/^[-+]?\d*\.?\d*(?:(?:\d|\d.)[eE][-+]?)*\d*$/;class NumericInputView extends InputWidgetView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.name.change,(()=>{var e;return this.input_el.name=null!=(e=this.model.name)?e:""})),this.connect(this.model.properties.value.change,(()=>{this.input_el.value=this.format_value,this.old_value=this.input_el.value})),this.connect(this.model.properties.low.change,(()=>{const{value:e,low:t,high:i}=this.model;null!=t&&null!=i&&assert(t<=i,"Invalid bounds, low must be inferior to high"),null!=e&&null!=t&&(this.model.value=Math.max(e,t))})),this.connect(this.model.properties.high.change,(()=>{const{value:e,low:t,high:i}=this.model;null!=t&&null!=i&&assert(i>=t,"Invalid bounds, high must be superior to low"),null!=e&&null!=i&&(this.model.value=Math.min(e,i))})),this.connect(this.model.properties.high.change,(()=>this.input_el.placeholder=this.model.placeholder)),this.connect(this.model.properties.disabled.change,(()=>this.input_el.disabled=this.model.disabled)),this.connect(this.model.properties.placeholder.change,(()=>this.input_el.placeholder=this.model.placeholder))}get format_value(){return null!=this.model.value?this.model.pretty(this.model.value):""}_set_input_filter(e){this.input_el.addEventListener("input",(()=>{const{selectionStart:t,selectionEnd:i}=this.input_el;if(e(this.input_el.value))this.old_value=this.input_el.value;else{const e=this.old_value.length-this.input_el.value.length;this.input_el.value=this.old_value,t&&i&&this.input_el.setSelectionRange(t-1,i+e)}}))}render(){super.render(),this.input_el=input$1({type:"text",class:input,name:this.model.name,value:this.format_value,disabled:this.model.disabled,placeholder:this.model.placeholder}),this.old_value=this.format_value,this.set_input_filter(),this.input_el.addEventListener("change",(()=>this.change_input())),this.input_el.addEventListener("focusout",(()=>this.input_el.value=this.format_value)),this.group_el.appendChild(this.input_el)}set_input_filter(){"int"==this.model.mode?this._set_input_filter((e=>int_regex.test(e))):"float"==this.model.mode&&this._set_input_filter((e=>float_regex.test(e)))}bound_value(e){let t=e;const{low:i,high:n}=this.model;return t=null!=i?Math.max(i,t):t,t=null!=n?Math.min(n,t):t,t}get value(){let e=""!=this.input_el.value?Number(this.input_el.value):null;return null!=e&&(e=this.bound_value(e)),e}change_input(){null==this.value?this.model.value=null:Number.isNaN(this.value)||(this.model.value=this.value)}}NumericInputView.__name__="NumericInputView";class NumericInput extends InputWidget{constructor(e){super(e)}static init_NumericInput(){this.prototype.default_view=NumericInputView,this.define((({Number:e,String:t,Enum:i,Ref:n,Or:o,Nullable:r})=>({value:[r(e),null],placeholder:[t,""],mode:[i("int","float"),"int"],format:[r(o(t,n(TickFormatter))),null],low:[r(e),null],high:[r(e),null]})))}_formatter(e,t){return isString(t)?numbro.exports.format(e,t):t.doFormat([e],{loc:0})[0]}pretty(e){return null!=this.format?this._formatter(e,this.format):`${e}`}}NumericInput.__name__="NumericInput",NumericInput.init_NumericInput();class PreTextView extends MarkupView{render(){super.render();const e=pre({style:{overflow:"auto"}},this.model.text);this.markup_el.appendChild(e)}}PreTextView.__name__="PreTextView";class PreText extends Markup{constructor(e){super(e)}static init_PreText(){this.prototype.default_view=PreTextView}}PreText.__name__="PreText",PreText.init_PreText();class RadioButtonGroupView extends ButtonGroupView{change_active(e){this.model.active!==e&&(this.model.active=e)}_update_active(){const{active:e}=this.model;this._buttons.forEach(((t,i)=>{classes(t).toggle(active,e===i)}))}}RadioButtonGroupView.__name__="RadioButtonGroupView";class RadioButtonGroup extends ButtonGroup{constructor(e){super(e)}static init_RadioButtonGroup(){this.prototype.default_view=RadioButtonGroupView,this.define((({Int:e,Nullable:t})=>({active:[t(e),null]})))}}RadioButtonGroup.__name__="RadioButtonGroup",RadioButtonGroup.init_RadioButtonGroup();class RadioGroupView extends InputGroupView{render(){super.render();const e=div({class:[input_group,this.model.inline?inline:null]});this.el.appendChild(e);const t=uniqueId(),{active:i,labels:n}=this.model;this._inputs=[];for(let o=0;o<n.length;o++){const r=input$1({type:"radio",name:t,value:`${o}`});r.addEventListener("change",(()=>this.change_active(o))),this._inputs.push(r),this.model.disabled&&(r.disabled=!0),o==i&&(r.checked=!0);const s=label({},r,span({},n[o]));e.appendChild(s)}}change_active(e){this.model.active=e}}RadioGroupView.__name__="RadioGroupView";class RadioGroup extends InputGroup{constructor(e){super(e)}static init_RadioGroup(){this.prototype.default_view=RadioGroupView,this.define((({Boolean:e,Int:t,String:i,Array:n,Nullable:o})=>({active:[o(t),null],labels:[n(i),[]],inline:[e,!1]})))}}RadioGroup.__name__="RadioGroup",RadioGroup.init_RadioGroup();class RangeSliderView extends AbstractRangeSliderView{}RangeSliderView.__name__="RangeSliderView";class RangeSlider extends AbstractSlider{constructor(e){super(e),this.behaviour="drag",this.connected=[!1,!0,!1]}static init_RangeSlider(){this.prototype.default_view=RangeSliderView,this.override({format:"0[.]00"})}_formatter(e,t){return isString(t)?numbro.exports.format(e,t):t.compute(e)}}RangeSlider.__name__="RangeSlider",RangeSlider.init_RangeSlider();class SelectView extends InputWidgetView{constructor(){super(...arguments),this._known_values=new Set}connect_signals(){super.connect_signals();const{value:e,options:t}=this.model.properties;this.on_change(e,(()=>{this._update_value()})),this.on_change(t,(()=>{empty$1(this.input_el),append(this.input_el,...this.options_el()),this._update_value()}))}options_el(){const{_known_values:e}=this;function t(t){return t.map((t=>{let i,n;return isString(t)?i=n=t:[i,n]=t,e.add(i),option({value:i},n)}))}e.clear();const{options:i}=this.model;return isArray(i)?t(i):entries(i).map((([e,i])=>optgroup({label:e},t(i))))}render(){super.render(),this.input_el=select({class:input,name:this.model.name,disabled:this.model.disabled},this.options_el()),this._update_value(),this.input_el.addEventListener("change",(()=>this.change_input())),this.group_el.appendChild(this.input_el)}change_input(){const e=this.input_el.value;this.model.value=e,super.change_input()}_update_value(){const{value:e}=this.model;this._known_values.has(e)?this.input_el.value=e:this.input_el.removeAttribute("value")}}SelectView.__name__="SelectView";class Select extends InputWidget{constructor(e){super(e)}static init_Select(){this.prototype.default_view=SelectView,this.define((({String:e,Array:t,Tuple:i,Dict:n,Or:o})=>{const r=t(o(e,i(e,e)));return{value:[e,""],options:[o(r,n(r)),[]]}}))}}Select.__name__="Select",Select.init_Select();class SliderView extends AbstractSliderView{}SliderView.__name__="SliderView";class Slider extends AbstractSlider{constructor(e){super(e),this.behaviour="tap",this.connected=[!0,!1]}static init_Slider(){this.prototype.default_view=SliderView,this.override({format:"0[.]00"})}_formatter(e,t){return isString(t)?numbro.exports.format(e,t):t.compute(e)}}Slider.__name__="Slider",Slider.init_Slider();const{min:min$1,max:max$1,floor:floor,abs:abs}=Math;function precision(e){return floor(e)!==e?e.toFixed(16).replace(/0+$/,"").split(".")[1].length:0}function debounce(e,t,i=!1){let n;return function(...o){const r=this,s=i&&void 0===n;void 0!==n&&clearTimeout(n),n=setTimeout((function(){n=void 0,i||e.apply(r,o)}),t),s&&e.apply(r,o)}}class SpinnerView extends NumericInputView{*buttons(){yield this.btn_up_el,yield this.btn_down_el}initialize(){super.initialize(),this._handles={interval:void 0,timeout:void 0},this._interval=200}connect_signals(){super.connect_signals();const e=this.model.properties;this.on_change(e.disabled,(()=>{for(const e of this.buttons())toggle_attribute(e,"disabled",this.model.disabled)}))}render(){super.render(),this.wrapper_el=div({class:"bk-spin-wrapper"}),this.group_el.replaceChild(this.wrapper_el,this.input_el),this.btn_up_el=button({class:"bk-spin-btn bk-spin-btn-up"}),this.btn_down_el=button({class:"bk-spin-btn bk-spin-btn-down"}),this.wrapper_el.appendChild(this.input_el),this.wrapper_el.appendChild(this.btn_up_el),this.wrapper_el.appendChild(this.btn_down_el);for(const e of this.buttons())toggle_attribute(e,"disabled",this.model.disabled),e.addEventListener("mousedown",(e=>this._btn_mouse_down(e))),e.addEventListener("mouseup",(()=>this._btn_mouse_up())),e.addEventListener("mouseleave",(()=>this._btn_mouse_leave()));this.input_el.addEventListener("keydown",(e=>this._input_key_down(e))),this.input_el.addEventListener("keyup",(()=>this.model.value_throttled=this.model.value)),this.input_el.addEventListener("wheel",(e=>this._input_mouse_wheel(e))),this.input_el.addEventListener("wheel",debounce((()=>{this.model.value_throttled=this.model.value}),this.model.wheel_wait,!1))}get precision(){const{low:e,high:t,step:i}=this.model,n=precision;return max$1(n(abs(null!=e?e:0)),n(abs(null!=t?t:0)),n(abs(i)))}remove(){this._stop_incrementation(),super.remove()}_start_incrementation(e){clearInterval(this._handles.interval),this._counter=0;const{step:t}=this.model,i=e=>{if(this._counter+=1,this._counter%5==0){const t=Math.floor(this._counter/5);t<10?(clearInterval(this._handles.interval),this._handles.interval=setInterval((()=>i(e)),this._interval/(t+1))):t>=10&&t<=13&&(clearInterval(this._handles.interval),this._handles.interval=setInterval((()=>i(2*e)),this._interval/10))}this.increment(e)};this._handles.interval=setInterval((()=>i(e*t)),this._interval)}_stop_incrementation(){clearTimeout(this._handles.timeout),this._handles.timeout=void 0,clearInterval(this._handles.interval),this._handles.interval=void 0,this.model.value_throttled=this.model.value}_btn_mouse_down(e){e.preventDefault();const t=e.currentTarget===this.btn_up_el?1:-1;this.increment(t*this.model.step),this.input_el.focus(),this._handles.timeout=setTimeout((()=>this._start_incrementation(t)),this._interval)}_btn_mouse_up(){this._stop_incrementation()}_btn_mouse_leave(){this._stop_incrementation()}_input_mouse_wheel(e){if(document.activeElement===this.input_el){e.preventDefault();const t=e.deltaY>0?-1:1;this.increment(t*this.model.step)}}_input_key_down(e){switch(e.keyCode){case Keys.Up:return e.preventDefault(),this.increment(this.model.step);case Keys.Down:return e.preventDefault(),this.increment(-this.model.step);case Keys.PageUp:return e.preventDefault(),this.increment(this.model.page_step_multiplier*this.model.step);case Keys.PageDown:return e.preventDefault(),this.increment(-this.model.page_step_multiplier*this.model.step)}}adjust_to_precision(e){return this.bound_value(Number(e.toFixed(this.precision)))}increment(e){const{low:t,high:i}=this.model;null==this.model.value?e>0?this.model.value=null!=t?t:null!=i?min$1(0,i):0:e<0&&(this.model.value=null!=i?i:null!=t?max$1(t,0):0):this.model.value=this.adjust_to_precision(this.model.value+e)}change_input(){super.change_input(),this.model.value_throttled=this.model.value}}SpinnerView.__name__="SpinnerView";class Spinner extends NumericInput{constructor(e){super(e)}static init_Spinner(){this.prototype.default_view=SpinnerView,this.define((({Number:e,Nullable:t})=>({value_throttled:[t(e),null],step:[e,1],page_step_multiplier:[e,10],wheel_wait:[e,100]}))),this.override({mode:"float"})}}Spinner.__name__="Spinner",Spinner.init_Spinner();class TextAreaInputView extends TextLikeInputView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.rows.change,(()=>this.input_el.rows=this.model.rows)),this.connect(this.model.properties.cols.change,(()=>this.input_el.cols=this.model.cols))}_render_input(){this.input_el=textarea({class:input})}render(){super.render(),this.input_el.cols=this.model.cols,this.input_el.rows=this.model.rows}}TextAreaInputView.__name__="TextAreaInputView";class TextAreaInput extends TextLikeInput{constructor(e){super(e)}static init_TextAreaInput(){this.prototype.default_view=TextAreaInputView,this.define((({Int:e})=>({cols:[e,20],rows:[e,2]}))),this.override({max_length:500})}}TextAreaInput.__name__="TextAreaInput",TextAreaInput.init_TextAreaInput();class ToggleView extends AbstractButtonView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.active.change,(()=>this._update_active()))}render(){super.render(),this._update_active()}click(){this.model.active=!this.model.active,super.click()}_update_active(){classes(this.button_el).toggle(active,this.model.active)}}ToggleView.__name__="ToggleView";class Toggle extends AbstractButton{constructor(e){super(e)}static init_Toggle(){this.prototype.default_view=ToggleView,this.define((({Boolean:e})=>({active:[e,!1]}))),this.override({label:"Toggle"})}}Toggle.__name__="Toggle",Toggle.init_Toggle();var Widgets=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AbstractButton:AbstractButton,AbstractIcon:AbstractIcon,AutocompleteInput:AutocompleteInput,Button:Button,CheckboxButtonGroup:CheckboxButtonGroup,CheckboxGroup:CheckboxGroup,ColorPicker:ColorPicker,DatePicker:DatePicker,DateRangeSlider:DateRangeSlider,DateSlider:DateSlider,Div:Div,Dropdown:Dropdown,FileInput:FileInput,InputWidget:InputWidget,Markup:Markup,MultiSelect:MultiSelect,Paragraph:Paragraph,PasswordInput:PasswordInput,MultiChoice:MultiChoice,NumericInput:NumericInput,PreText:PreText,RadioButtonGroup:RadioButtonGroup,RadioGroup:RadioGroup,RangeSlider:RangeSlider,Select:Select,Slider:Slider,Spinner:Spinner,TextInput:TextInput,TextAreaInput:TextAreaInput,Toggle:Toggle,Widget:Widget});register_models(Widgets);const DTINDEX_NAME="__bkdt_internal_index__",data_table="bk-data-table",cell_select="bk-cell-select",cell_index="bk-cell-index",header_index="bk-header-index",cell_editor="bk-cell-editor";var tables_css='.bk-root .bk-data-table{box-sizing:content-box;font-size:11px;}.bk-root .bk-data-table input[type="checkbox"]{margin-left:4px;margin-right:4px;}.bk-root .bk-cell-special-defaults{border-right-color:silver;border-right-style:solid;background:#f5f5f5;}.bk-root .bk-cell-select{border-right-color:silver;border-right-style:solid;background:#f5f5f5;}.bk-root .slick-cell.bk-cell-index{border-right-color:silver;border-right-style:solid;background:#f5f5f5;text-align:right;background:#f0f0f0;color:#909090;}.bk-root .bk-header-index .slick-column-name{float:right;}.bk-root .slick-row.selected .bk-cell-index{background-color:transparent;}.bk-root .slick-row.odd{background:#f0f0f0;}.bk-root .slick-cell{padding-left:4px;padding-right:4px;border-right-color:transparent;border:0.25px solid transparent;}.bk-root .slick-cell .bk{line-height:inherit;}.bk-root .slick-cell.active{border-style:dashed;}.bk-root .slick-cell.selected{background-color:#F0F8FF;}.bk-root .slick-cell.editable{padding-left:0;padding-right:0;}.bk-root .bk-cell-editor{display:contents;}.bk-root .bk-cell-editor input,.bk-root .bk-cell-editor select{width:100%;height:100%;border:0;margin:0;padding:0;outline:0;background:transparent;vertical-align:baseline;}.bk-root .bk-cell-editor input{padding-left:4px;padding-right:4px;}.bk-root .bk-cell-editor-completion{font-size:11px;}';class CellEditorView extends DOMView{constructor(e){const{model:t,parent:i}=e.column;super(__spreadValues({model:t,parent:i},e)),this.args=e,this.initialize(),this.render()}get emptyValue(){return null}initialize(){super.initialize(),this.inputEl=this._createInput(),this.defaultValue=null}async lazy_initialize(){throw new Error("unsupported")}css_classes(){return super.css_classes().concat(cell_editor)}render(){super.render(),this.args.container.append(this.el),this.el.appendChild(this.inputEl),this.renderEditor(),this.disableNavigation()}renderEditor(){}disableNavigation(){this.inputEl.addEventListener("keydown",(e=>{switch(e.keyCode){case Keys.Left:case Keys.Right:case Keys.Up:case Keys.Down:case Keys.PageUp:case Keys.PageDown:e.stopImmediatePropagation()}}))}destroy(){this.remove()}focus(){this.inputEl.focus()}show(){}hide(){}position(){}getValue(){return this.inputEl.value}setValue(e){this.inputEl.value=e}serializeValue(){return this.getValue()}isValueChanged(){return!(""==this.getValue()&&null==this.defaultValue)&&this.getValue()!==this.defaultValue}applyValue(e,t){const i=this.args.grid.getData(),n=i.index.indexOf(e[DTINDEX_NAME]);i.setField(n,this.args.column.field,t)}loadValue(e){const t=e[this.args.column.field];this.defaultValue=null!=t?t:this.emptyValue,this.setValue(this.defaultValue)}validateValue(e){if(this.args.column.validator){const t=this.args.column.validator(e);if(!t.valid)return t}return{valid:!0,msg:null}}validate(){return this.validateValue(this.getValue())}}CellEditorView.__name__="CellEditorView";class CellEditor extends Model{}CellEditor.__name__="CellEditor";class StringEditorView extends CellEditorView{get emptyValue(){return""}_createInput(){return input$1({type:"text"})}renderEditor(){this.inputEl.focus(),this.inputEl.select()}loadValue(e){super.loadValue(e),this.inputEl.defaultValue=this.defaultValue,this.inputEl.select()}}StringEditorView.__name__="StringEditorView";class StringEditor extends CellEditor{static init_StringEditor(){this.prototype.default_view=StringEditorView,this.define((({String:e,Array:t})=>({completions:[t(e),[]]})))}}StringEditor.__name__="StringEditor",StringEditor.init_StringEditor();class TextEditorView extends CellEditorView{_createInput(){return textarea()}renderEditor(){this.inputEl.focus(),this.inputEl.select()}}TextEditorView.__name__="TextEditorView";class TextEditor$1 extends CellEditor{static init_TextEditor(){this.prototype.default_view=TextEditorView}}TextEditor$1.__name__="TextEditor",TextEditor$1.init_TextEditor();class SelectEditorView extends CellEditorView{_createInput(){return select()}renderEditor(){for(const e of this.model.options)this.inputEl.appendChild(option({value:e},e));this.focus()}}SelectEditorView.__name__="SelectEditorView";class SelectEditor extends CellEditor{static init_SelectEditor(){this.prototype.default_view=SelectEditorView,this.define((({String:e,Array:t})=>({options:[t(e),[]]})))}}SelectEditor.__name__="SelectEditor",SelectEditor.init_SelectEditor();class PercentEditorView extends CellEditorView{_createInput(){return input$1({type:"text"})}}PercentEditorView.__name__="PercentEditorView";class PercentEditor extends CellEditor{static init_PercentEditor(){this.prototype.default_view=PercentEditorView}}PercentEditor.__name__="PercentEditor",PercentEditor.init_PercentEditor();class CheckboxEditorView extends CellEditorView{_createInput(){return input$1({type:"checkbox"})}renderEditor(){this.focus()}loadValue(e){this.defaultValue=!!e[this.args.column.field],this.inputEl.checked=this.defaultValue}serializeValue(){return this.inputEl.checked}}CheckboxEditorView.__name__="CheckboxEditorView";class CheckboxEditor$1 extends CellEditor{static init_CheckboxEditor(){this.prototype.default_view=CheckboxEditorView}}CheckboxEditor$1.__name__="CheckboxEditor",CheckboxEditor$1.init_CheckboxEditor();class IntEditorView extends CellEditorView{_createInput(){return input$1({type:"text"})}renderEditor(){this.inputEl.focus(),this.inputEl.select()}remove(){super.remove()}serializeValue(){var e;return null!=(e=parseInt(this.getValue(),10))?e:0}loadValue(e){super.loadValue(e),this.inputEl.defaultValue=this.defaultValue,this.inputEl.select()}validateValue(e){return isNaN(e)?{valid:!1,msg:"Please enter a valid integer"}:super.validateValue(e)}}IntEditorView.__name__="IntEditorView";class IntEditor extends CellEditor{static init_IntEditor(){this.prototype.default_view=IntEditorView,this.define((({Int:e})=>({step:[e,1]})))}}IntEditor.__name__="IntEditor",IntEditor.init_IntEditor();class NumberEditorView extends CellEditorView{_createInput(){return input$1({type:"text"})}renderEditor(){this.inputEl.focus(),this.inputEl.select()}remove(){super.remove()}serializeValue(){var e;return null!=(e=parseFloat(this.getValue()))?e:0}loadValue(e){super.loadValue(e),this.inputEl.defaultValue=this.defaultValue,this.inputEl.select()}validateValue(e){return isNaN(e)?{valid:!1,msg:"Please enter a valid number"}:super.validateValue(e)}}NumberEditorView.__name__="NumberEditorView";class NumberEditor extends CellEditor{static init_NumberEditor(){this.prototype.default_view=NumberEditorView,this.define((({Number:e})=>({step:[e,.01]})))}}NumberEditor.__name__="NumberEditor",NumberEditor.init_NumberEditor();class TimeEditorView extends CellEditorView{_createInput(){return input$1({type:"text"})}}TimeEditorView.__name__="TimeEditorView";class TimeEditor extends CellEditor{static init_TimeEditor(){this.prototype.default_view=TimeEditorView}}TimeEditor.__name__="TimeEditor",TimeEditor.init_TimeEditor();class DateEditorView extends CellEditorView{_createInput(){return input$1({type:"text"})}get emptyValue(){return new Date}renderEditor(){this.inputEl.focus(),this.inputEl.select()}destroy(){super.destroy()}show(){super.show()}hide(){super.hide()}position(){return super.position()}getValue(){}setValue(e){}}DateEditorView.__name__="DateEditorView";class DateEditor$1 extends CellEditor{static init_DateEditor(){this.prototype.default_view=DateEditorView}}DateEditor$1.__name__="DateEditor",DateEditor$1.init_DateEditor();var breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeKeys=Object.keys,nativeIsArray=Array.isArray,_$1=function(){},each=_$1.each=_$1.forEach=function(e,t,i){if(null!=e)if(nativeForEach&&e.forEach===nativeForEach)e.forEach(t,i);else if(e.length===+e.length){for(var n=0,o=e.length;n<o;n++)if(t.call(i,e[n],n,e)===breaker)return}else{var r=_$1.keys(e);for(n=0,o=r.length;n<o;n++)if(t.call(i,e[r[n]],r[n],e)===breaker)return}};_$1.keys=nativeKeys||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)_$1.has(e,i)&&t.push(i);return t},_$1.defaults=function(e){return each(slice.call(arguments,1),(function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])})),e},_$1.isArray=nativeIsArray||function(e){return"[object Array]"===toString.call(e)},_$1.has=function(e,t){if(!_$1.isArray(t))return null!=e&&hasOwnProperty.call(e,t);for(var i=t.length,n=0;n<i;n++){var o=t[n];if(null==e||!hasOwnProperty.call(e,o))return!1;e=e[o]}return!!i};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}},entityRegexes={escape:new RegExp("["+_$1.keys(entityMap.escape).join("")+"]","g")};_$1.each(["escape"],(function(e){_$1[e]=function(t){return null==t?"":(""+t).replace(entityRegexes[e],(function(t){return entityMap[e][t]}))}})),_$1.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_$1.template=function(e,t,i){var n;i=_$1.defaults({},i,_$1.templateSettings);var o=new RegExp([(i.escape||noMatch).source,(i.interpolate||noMatch).source,(i.evaluate||noMatch).source].join("|")+"|$","g"),r=0,s="__p+='";e.replace(o,(function(t,i,n,o,a){return s+=e.slice(r,a).replace(escaper,(function(e){return"\\"+escapes[e]})),i&&(s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),r=a+t.length,t})),s+="';\n",i.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(i.variable||"obj","_",s)}catch(l){throw l.source=s,l}if(t)return n(t,_$1);var a=function(e){return n.call(this,e,_$1)};return a.source="function("+(i.variable||"obj")+"){\n"+s+"}",a};var underscore_template=_$1,_=underscore_template,UnderscoreTemplate=_.template;function Template(e,t,i){return UnderscoreTemplate(e,t,i)}Template._=_;var lib=Template;"undefined"==typeof window&&"undefined"==typeof navigator||(window.UnderscoreTemplate=Template);class CellFormatter extends Model{constructor(e){super(e)}doFormat(e,t,i,n,o){return null==i?"":(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}CellFormatter.__name__="CellFormatter";class StringFormatter extends CellFormatter{constructor(e){super(e)}static init_StringFormatter(){this.define((({Color:e,Nullable:t})=>({font_style:[FontStyle,"normal"],text_align:[TextAlign,"left"],text_color:[t(e),null]})))}doFormat(e,t,i,n,o){const{font_style:r,text_align:s,text_color:a}=this,l=div({},null==i?"":`${i}`);switch(r){case"bold":l.style.fontWeight="bold";break;case"italic":l.style.fontStyle="italic"}return null!=s&&(l.style.textAlign=s),null!=a&&(l.style.color=color2css(a)),l.outerHTML}}StringFormatter.__name__="StringFormatter",StringFormatter.init_StringFormatter();class ScientificFormatter extends StringFormatter{constructor(e){super(e)}static init_ScientificFormatter(){this.define((({Number:e,String:t,Nullable:i})=>({nan_format:[i(t),null],precision:[e,10],power_limit_high:[e,5],power_limit_low:[e,-3]})))}get scientific_limit_low(){return 10**this.power_limit_low}get scientific_limit_high(){return 10**this.power_limit_high}doFormat(e,t,i,n,o){const r=Math.abs(i)<=this.scientific_limit_low||Math.abs(i)>=this.scientific_limit_high;let s=this.precision;return s<1&&(s=1),i=null!=i&&!isNaN(i)||null==this.nan_format?0==i?to_fixed(i,1):r?i.toExponential(s):to_fixed(i,s):this.nan_format,super.doFormat(e,t,i,n,o)}}ScientificFormatter.__name__="ScientificFormatter",ScientificFormatter.init_ScientificFormatter();class NumberFormatter extends StringFormatter{constructor(e){super(e)}static init_NumberFormatter(){this.define((({String:e,Nullable:t})=>({format:[e,"0,0"],language:[e,"en"],rounding:[RoundingFunction,"round"],nan_format:[t(e),null]})))}doFormat(e,t,i,n,o){const{format:r,language:s,nan_format:a}=this,l=(()=>{switch(this.rounding){case"round":case"nearest":return Math.round;case"floor":case"rounddown":return Math.floor;case"ceil":case"roundup":return Math.ceil}})();return i=null!=i&&!isNaN(i)||null==a?numbro.exports.format(i,r,s,l):a,super.doFormat(e,t,i,n,o)}}NumberFormatter.__name__="NumberFormatter",NumberFormatter.init_NumberFormatter();class BooleanFormatter extends CellFormatter{constructor(e){super(e)}static init_BooleanFormatter(){this.define((({String:e})=>({icon:[e,"check"]})))}doFormat(e,t,n,o,r){return n?i({class:this.icon}).outerHTML:""}}BooleanFormatter.__name__="BooleanFormatter",BooleanFormatter.init_BooleanFormatter();class DateFormatter extends StringFormatter{constructor(e){super(e)}static init_DateFormatter(){this.define((({String:e,Nullable:t})=>({format:[e,"ISO-8601"],nan_format:[t(e),null]})))}getFormat(){switch(this.format){case"ATOM":case"W3C":case"RFC-3339":case"ISO-8601":return"%Y-%m-%d";case"COOKIE":return"%a, %d %b %Y";case"RFC-850":return"%A, %d-%b-%y";case"RFC-1123":case"RFC-2822":return"%a, %e %b %Y";case"RSS":case"RFC-822":case"RFC-1036":return"%a, %e %b %y";case"TIMESTAMP":return;default:return this.format}}doFormat(e,t,i,n,o){const{nan_format:r}=this;let s;return s=null!=(i=isString(i)?parseInt(i,10):i)&&!isNaN(i)&&-9223372036854776!==i||null==r?null==i?"":tz(i,this.getFormat()):r,super.doFormat(e,t,s,n,o)}}DateFormatter.__name__="DateFormatter",DateFormatter.init_DateFormatter();class HTMLTemplateFormatter extends CellFormatter{constructor(e){super(e)}static init_HTMLTemplateFormatter(){this.define((({String:e})=>({template:[e,"<%= value %>"]})))}doFormat(e,t,i,n,o){const{template:r}=this;if(null==i)return"";return lib._.template(r)(__spreadProps(__spreadValues({},o),{value:i}))}}HTMLTemplateFormatter.__name__="HTMLTemplateFormatter",HTMLTemplateFormatter.init_HTMLTemplateFormatter();var jquery={exports:{}};
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */!function(e){!function(t,i){e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return i(e)}}("undefined"!=typeof window?window:commonjsGlobal,(function(e,t){var i=[],n=Object.getPrototypeOf,o=i.slice,r=function(e){return i.concat.apply([],e)},s=i.push,a=i.indexOf,l={},c=l.toString,d=l.hasOwnProperty,h=d.toString,u=h.call(Object),p={},_=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},f=function(e){return null!=e&&e===e.window},g=e.document,m={type:!0,src:!0,nonce:!0,noModule:!0};function v(e,t,i){var n,o,r=(i=i||g).createElement("script");if(r.text=e,t)for(n in m)(o=t[n]||t.getAttribute&&t.getAttribute(n))&&r.setAttribute(n,o);i.head.appendChild(r).parentNode.removeChild(r)}function b(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var y="3.6.0",w=function(e,t){return new w.fn.init(e,t)};function A(e){var t=!!e&&"length"in e&&e.length,i=b(e);return!_(e)&&!f(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}w.fn=w.prototype={jquery:y,constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(w.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:i.sort,splice:i.splice},w.extend=w.fn.extend=function(){var e,t,i,n,o,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||_(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)n=e[t],"__proto__"!==t&&s!==n&&(c&&n&&(w.isPlainObject(n)||(o=Array.isArray(n)))?(i=s[t],r=o&&!Array.isArray(i)?[]:o||w.isPlainObject(i)?i:{},o=!1,s[t]=w.extend(c,r,n)):void 0!==n&&(s[t]=n));return s},w.extend({expando:"jQuery"+(y+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;return!(!e||"[object Object]"!==c.call(e))&&(!(t=n(e))||"function"==typeof(i=d.call(t,"constructor")&&t.constructor)&&h.call(i)===u)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,i){v(e,{nonce:t&&t.nonce},i)},each:function(e,t){var i,n=0;if(A(e))for(i=e.length;n<i&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},makeArray:function(e,t){var i=t||[];return null!=e&&(A(Object(e))?w.merge(i,"string"==typeof e?[e]:e):s.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:a.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,o=e.length;n<i;n++)e[o++]=t[n];return e.length=o,e},grep:function(e,t,i){for(var n=[],o=0,r=e.length,s=!i;o<r;o++)!t(e[o],o)!==s&&n.push(e[o]);return n},map:function(e,t,i){var n,o,s=0,a=[];if(A(e))for(n=e.length;s<n;s++)null!=(o=t(e[s],s,i))&&a.push(o);else for(s in e)null!=(o=t(e[s],s,i))&&a.push(o);return r(a)},guid:1,support:p}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=i[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()}));var x=function(e){var t,i,n,o,r,s,a,l,c,d,h,u,p,_,f,g,m,v,b,y="sizzle"+1*new Date,w=e.document,A=0,x=0,k=le(),C=le(),S=le(),T=le(),R=function(e,t){return e===t&&(h=!0),0},E={}.hasOwnProperty,P=[],M=P.pop,D=P.push,I=P.push,B=P.slice,z=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",$="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",V="\\[[\\x20\\t\\r\\n\\f]*("+$+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+$+"))|)"+N+"*\\]",O=":("+$+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+V+")*)|.*)\\)|)",F=new RegExp(N+"+","g"),G=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),H=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),j=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),U=new RegExp(N+"|>"),W=new RegExp(O),Y=new RegExp("^"+$+"$"),q={ID:new RegExp("^#("+$+")"),CLASS:new RegExp("^\\.("+$+")"),TAG:new RegExp("^("+$+"|[*])"),ATTR:new RegExp("^"+V),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),ie=function(e,t){var i="0x"+e.slice(1)-65536;return t||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},ne=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,oe=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},re=function(){u()},se=ye((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{I.apply(P=B.call(w.childNodes),w.childNodes),P[w.childNodes.length].nodeType}catch(Ce){I={apply:P.length?function(e,t){D.apply(e,B.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}function ae(e,t,n,o){var r,a,c,d,h,_,m,v=t&&t.ownerDocument,w=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return n;if(!o&&(u(t),t=t||p,f)){if(11!==w&&(h=Z.exec(e)))if(r=h[1]){if(9===w){if(!(c=t.getElementById(r)))return n;if(c.id===r)return n.push(c),n}else if(v&&(c=v.getElementById(r))&&b(t,c)&&c.id===r)return n.push(c),n}else{if(h[2])return I.apply(n,t.getElementsByTagName(e)),n;if((r=h[3])&&i.getElementsByClassName&&t.getElementsByClassName)return I.apply(n,t.getElementsByClassName(r)),n}if(i.qsa&&!T[e+" "]&&(!g||!g.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(m=e,v=t,1===w&&(U.test(e)||j.test(e))){for((v=ee.test(e)&&me(t.parentNode)||t)===t&&i.scope||((d=t.getAttribute("id"))?d=d.replace(ne,oe):t.setAttribute("id",d=y)),a=(_=s(e)).length;a--;)_[a]=(d?"#"+d:":scope")+" "+be(_[a]);m=_.join(",")}try{return I.apply(n,v.querySelectorAll(m)),n}catch(A){T(e,!0)}finally{d===y&&t.removeAttribute("id")}}}return l(e.replace(G,"$1"),t,n,o)}function le(){var e=[];return function t(i,o){return e.push(i+" ")>n.cacheLength&&delete t[e.shift()],t[i+" "]=o}}function ce(e){return e[y]=!0,e}function de(e){var t=p.createElement("fieldset");try{return!!e(t)}catch(Ce){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function he(e,t){for(var i=e.split("|"),o=i.length;o--;)n.attrHandle[i[o]]=t}function ue(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function _e(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function fe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ge(e){return ce((function(t){return t=+t,ce((function(i,n){for(var o,r=e([],i.length,t),s=r.length;s--;)i[o=r[s]]&&(i[o]=!(n[o]=i[o]))}))}))}function me(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in i=ae.support={},r=ae.isXML=function(e){var t=e&&e.namespaceURI,i=e&&(e.ownerDocument||e).documentElement;return!X.test(t||i&&i.nodeName||"HTML")},u=ae.setDocument=function(e){var t,o,s=e?e.ownerDocument||e:w;return s!=p&&9===s.nodeType&&s.documentElement?(_=(p=s).documentElement,f=!r(p),w!=p&&(o=p.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",re,!1):o.attachEvent&&o.attachEvent("onunload",re)),i.scope=de((function(e){return _.appendChild(e).appendChild(p.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),i.attributes=de((function(e){return e.className="i",!e.getAttribute("className")})),i.getElementsByTagName=de((function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length})),i.getElementsByClassName=Q.test(p.getElementsByClassName),i.getById=de((function(e){return _.appendChild(e).id=y,!p.getElementsByName||!p.getElementsByName(y).length})),i.getById?(n.filter.ID=function(e){var t=e.replace(te,ie);return function(e){return e.getAttribute("id")===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var i=t.getElementById(e);return i?[i]:[]}}):(n.filter.ID=function(e){var t=e.replace(te,ie);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var i,n,o,r=t.getElementById(e);if(r){if((i=r.getAttributeNode("id"))&&i.value===e)return[r];for(o=t.getElementsByName(e),n=0;r=o[n++];)if((i=r.getAttributeNode("id"))&&i.value===e)return[r]}return[]}}),n.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;i=r[o++];)1===i.nodeType&&n.push(i);return n}return r},n.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&f)return t.getElementsByClassName(e)},m=[],g=[],(i.qsa=Q.test(p.querySelectorAll))&&(de((function(e){var t;_.appendChild(e).innerHTML="<a id='"+y+"'></a><select id='"+y+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+L+")"),e.querySelectorAll("[id~="+y+"-]").length||g.push("~="),(t=p.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||g.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll("a#"+y+"+*").length||g.push(".#.+[+~]"),e.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")})),de((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),_.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=Q.test(v=_.matches||_.webkitMatchesSelector||_.mozMatchesSelector||_.oMatchesSelector||_.msMatchesSelector))&&de((function(e){i.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),m.push("!=",O)})),g=g.length&&new RegExp(g.join("|")),m=m.length&&new RegExp(m.join("|")),t=Q.test(_.compareDocumentPosition),b=t||Q.test(_.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},R=t?function(e,t){if(e===t)return h=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===n?e==p||e.ownerDocument==w&&b(w,e)?-1:t==p||t.ownerDocument==w&&b(w,t)?1:d?z(d,e)-z(d,t):0:4&n?-1:1)}:function(e,t){if(e===t)return h=!0,0;var i,n=0,o=e.parentNode,r=t.parentNode,s=[e],a=[t];if(!o||!r)return e==p?-1:t==p?1:o?-1:r?1:d?z(d,e)-z(d,t):0;if(o===r)return ue(e,t);for(i=e;i=i.parentNode;)s.unshift(i);for(i=t;i=i.parentNode;)a.unshift(i);for(;s[n]===a[n];)n++;return n?ue(s[n],a[n]):s[n]==w?-1:a[n]==w?1:0},p):p},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if(u(e),i.matchesSelector&&f&&!T[t+" "]&&(!m||!m.test(t))&&(!g||!g.test(t)))try{var n=v.call(e,t);if(n||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(Ce){T(t,!0)}return ae(t,p,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!=p&&u(e),b(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!=p&&u(e);var o=n.attrHandle[t.toLowerCase()],r=o&&E.call(n.attrHandle,t.toLowerCase())?o(e,t,!f):void 0;return void 0!==r?r:i.attributes||!f?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},ae.escape=function(e){return(e+"").replace(ne,oe)},ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,n=[],o=0,r=0;if(h=!i.detectDuplicates,d=!i.sortStable&&e.slice(0),e.sort(R),h){for(;t=e[r++];)t===e[r]&&(o=n.push(r));for(;o--;)e.splice(n[o],1)}return d=null,e},o=ae.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=o(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)i+=o(t);return i},(n=ae.selectors={cacheLength:50,createPseudo:ce,match:q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return q.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&W.test(i)&&(t=s(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=k[e+" "];return t||(t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"("+N+"|$)"))&&k(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,i){return function(n){var o=ae.attr(n,e);return null==o?"!="===t:!t||(o+="","="===t?o===i:"!="===t?o!==i:"^="===t?i&&0===o.indexOf(i):"*="===t?i&&o.indexOf(i)>-1:"$="===t?i&&o.slice(-i.length)===i:"~="===t?(" "+o.replace(F," ")+" ").indexOf(i)>-1:"|="===t&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,n,o){var r="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===o?function(e){return!!e.parentNode}:function(t,i,l){var c,d,h,u,p,_,f=r!==s?"nextSibling":"previousSibling",g=t.parentNode,m=a&&t.nodeName.toLowerCase(),v=!l&&!a,b=!1;if(g){if(r){for(;f;){for(u=t;u=u[f];)if(a?u.nodeName.toLowerCase()===m:1===u.nodeType)return!1;_=f="only"===e&&!_&&"nextSibling"}return!0}if(_=[s?g.firstChild:g.lastChild],s&&v){for(b=(p=(c=(d=(h=(u=g)[y]||(u[y]={}))[u.uniqueID]||(h[u.uniqueID]={}))[e]||[])[0]===A&&c[1])&&c[2],u=p&&g.childNodes[p];u=++p&&u&&u[f]||(b=p=0)||_.pop();)if(1===u.nodeType&&++b&&u===t){d[e]=[A,p,b];break}}else if(v&&(b=p=(c=(d=(h=(u=t)[y]||(u[y]={}))[u.uniqueID]||(h[u.uniqueID]={}))[e]||[])[0]===A&&c[1]),!1===b)for(;(u=++p&&u&&u[f]||(b=p=0)||_.pop())&&((a?u.nodeName.toLowerCase()!==m:1!==u.nodeType)||!++b||(v&&((d=(h=u[y]||(u[y]={}))[u.uniqueID]||(h[u.uniqueID]={}))[e]=[A,b]),u!==t)););return(b-=o)===n||b%n==0&&b/n>=0}}},PSEUDO:function(e,t){var i,o=n.pseudos[e]||n.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return o[y]?o(t):o.length>1?(i=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?ce((function(e,i){for(var n,r=o(e,t),s=r.length;s--;)e[n=z(e,r[s])]=!(i[n]=r[s])})):function(e){return o(e,0,i)}):o}},pseudos:{not:ce((function(e){var t=[],i=[],n=a(e.replace(G,"$1"));return n[y]?ce((function(e,t,i,o){for(var r,s=n(e,null,o,[]),a=e.length;a--;)(r=s[a])&&(e[a]=!(t[a]=r))})):function(e,o,r){return t[0]=e,n(t,null,r,i),t[0]=null,!i.pop()}})),has:ce((function(e){return function(t){return ae(e,t).length>0}})),contains:ce((function(e){return e=e.replace(te,ie),function(t){return(t.textContent||o(t)).indexOf(e)>-1}})),lang:ce((function(e){return Y.test(e||"")||ae.error("unsupported lang: "+e),e=e.replace(te,ie).toLowerCase(),function(t){var i;do{if(i=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===_},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:fe(!1),disabled:fe(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!n.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ge((function(){return[0]})),last:ge((function(e,t){return[t-1]})),eq:ge((function(e,t,i){return[i<0?i+t:i]})),even:ge((function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e})),odd:ge((function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e})),lt:ge((function(e,t,i){for(var n=i<0?i+t:i>t?t:i;--n>=0;)e.push(n);return e})),gt:ge((function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e}))}}).pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[t]=pe(t);for(t in{submit:!0,reset:!0})n.pseudos[t]=_e(t);function ve(){}function be(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function ye(e,t,i){var n=t.dir,o=t.next,r=o||n,s=i&&"parentNode"===r,a=x++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,o);return!1}:function(t,i,l){var c,d,h,u=[A,a];if(l){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,l))return!0}else for(;t=t[n];)if(1===t.nodeType||s)if(d=(h=t[y]||(t[y]={}))[t.uniqueID]||(h[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[n]||t;else{if((c=d[r])&&c[0]===A&&c[1]===a)return u[2]=c[2];if(d[r]=u,u[2]=e(t,i,l))return!0}return!1}}function we(e){return e.length>1?function(t,i,n){for(var o=e.length;o--;)if(!e[o](t,i,n))return!1;return!0}:e[0]}function Ae(e,t,i,n,o){for(var r,s=[],a=0,l=e.length,c=null!=t;a<l;a++)(r=e[a])&&(i&&!i(r,n,o)||(s.push(r),c&&t.push(a)));return s}function xe(e,t,i,n,o,r){return n&&!n[y]&&(n=xe(n)),o&&!o[y]&&(o=xe(o,r)),ce((function(r,s,a,l){var c,d,h,u=[],p=[],_=s.length,f=r||function(e,t,i){for(var n=0,o=t.length;n<o;n++)ae(e,t[n],i);return i}(t||"*",a.nodeType?[a]:a,[]),g=!e||!r&&t?f:Ae(f,u,e,a,l),m=i?o||(r?e:_||n)?[]:s:g;if(i&&i(g,m,a,l),n)for(c=Ae(m,p),n(c,[],a,l),d=c.length;d--;)(h=c[d])&&(m[p[d]]=!(g[p[d]]=h));if(r){if(o||e){if(o){for(c=[],d=m.length;d--;)(h=m[d])&&c.push(g[d]=h);o(null,m=[],c,l)}for(d=m.length;d--;)(h=m[d])&&(c=o?z(r,h):u[d])>-1&&(r[c]=!(s[c]=h))}}else m=Ae(m===s?m.splice(_,m.length):m),o?o(null,s,m,l):I.apply(s,m)}))}function ke(e){for(var t,i,o,r=e.length,s=n.relative[e[0].type],a=s||n.relative[" "],l=s?1:0,d=ye((function(e){return e===t}),a,!0),h=ye((function(e){return z(t,e)>-1}),a,!0),u=[function(e,i,n){var o=!s&&(n||i!==c)||((t=i).nodeType?d(e,i,n):h(e,i,n));return t=null,o}];l<r;l++)if(i=n.relative[e[l].type])u=[ye(we(u),i)];else{if((i=n.filter[e[l].type].apply(null,e[l].matches))[y]){for(o=++l;o<r&&!n.relative[e[o].type];o++);return xe(l>1&&we(u),l>1&&be(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(G,"$1"),i,l<o&&ke(e.slice(l,o)),o<r&&ke(e=e.slice(o)),o<r&&be(e))}u.push(i)}return we(u)}return ve.prototype=n.filters=n.pseudos,n.setFilters=new ve,s=ae.tokenize=function(e,t){var i,o,r,s,a,l,c,d=C[e+" "];if(d)return t?0:d.slice(0);for(a=e,l=[],c=n.preFilter;a;){for(s in i&&!(o=H.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),i=!1,(o=j.exec(a))&&(i=o.shift(),r.push({value:i,type:o[0].replace(G," ")}),a=a.slice(i.length)),n.filter)!(o=q[s].exec(a))||c[s]&&!(o=c[s](o))||(i=o.shift(),r.push({value:i,type:s,matches:o}),a=a.slice(i.length));if(!i)break}return t?a.length:a?ae.error(e):C(e,l).slice(0)},a=ae.compile=function(e,t){var i,o=[],r=[],a=S[e+" "];if(!a){for(t||(t=s(e)),i=t.length;i--;)(a=ke(t[i]))[y]?o.push(a):r.push(a);(a=S(e,function(e,t){var i=t.length>0,o=e.length>0,r=function(r,s,a,l,d){var h,_,g,m=0,v="0",b=r&&[],y=[],w=c,x=r||o&&n.find.TAG("*",d),k=A+=null==w?1:Math.random()||.1,C=x.length;for(d&&(c=s==p||s||d);v!==C&&null!=(h=x[v]);v++){if(o&&h){for(_=0,s||h.ownerDocument==p||(u(h),a=!f);g=e[_++];)if(g(h,s||p,a)){l.push(h);break}d&&(A=k)}i&&((h=!g&&h)&&m--,r&&b.push(h))}if(m+=v,i&&v!==m){for(_=0;g=t[_++];)g(b,y,s,a);if(r){if(m>0)for(;v--;)b[v]||y[v]||(y[v]=M.call(l));y=Ae(y)}I.apply(l,y),d&&!r&&y.length>0&&m+t.length>1&&ae.uniqueSort(l)}return d&&(A=k,c=w),b};return i?ce(r):r}(r,o))).selector=e}return a},l=ae.select=function(e,t,i,o){var r,l,c,d,h,u="function"==typeof e&&e,p=!o&&s(e=u.selector||e);if(i=i||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&f&&n.relative[l[1].type]){if(!(t=(n.find.ID(c.matches[0].replace(te,ie),t)||[])[0]))return i;u&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(r=q.needsContext.test(e)?0:l.length;r--&&(c=l[r],!n.relative[d=c.type]);)if((h=n.find[d])&&(o=h(c.matches[0].replace(te,ie),ee.test(l[0].type)&&me(t.parentNode)||t))){if(l.splice(r,1),!(e=o.length&&be(l)))return I.apply(i,o),i;break}}return(u||a(e,p))(o,t,!f,i,!t||ee.test(e)&&me(t.parentNode)||t),i},i.sortStable=y.split("").sort(R).join("")===y,i.detectDuplicates=!!h,u(),i.sortDetached=de((function(e){return 1&e.compareDocumentPosition(p.createElement("fieldset"))})),de((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||he("type|href|height|width",(function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&de((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||he("value",(function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),de((function(e){return null==e.getAttribute("disabled")}))||he(L,(function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null})),ae}(e);w.find=x,w.expr=x.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=x.uniqueSort,w.text=x.getText,w.isXMLDoc=x.isXML,w.contains=x.contains,w.escapeSelector=x.escape;var k=function(e,t,i){for(var n=[],o=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&w(e).is(i))break;n.push(e)}return n},C=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},S=w.expr.match.needsContext;function T(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var R=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function E(e,t,i){return _(t)?w.grep(e,(function(e,n){return!!t.call(e,n,e)!==i})):t.nodeType?w.grep(e,(function(e){return e===t!==i})):"string"!=typeof t?w.grep(e,(function(e){return a.call(t,e)>-1!==i})):w.filter(t,e,i)}w.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?w.find.matchesSelector(n,e)?[n]:[]:w.find.matches(e,w.grep(t,(function(e){return 1===e.nodeType})))},w.fn.extend({find:function(e){var t,i,n=this.length,o=this;if("string"!=typeof e)return this.pushStack(w(e).filter((function(){for(t=0;t<n;t++)if(w.contains(o[t],this))return!0})));for(i=this.pushStack([]),t=0;t<n;t++)w.find(e,o[t],i);return n>1?w.uniqueSort(i):i},filter:function(e){return this.pushStack(E(this,e||[],!1))},not:function(e){return this.pushStack(E(this,e||[],!0))},is:function(e){return!!E(this,"string"==typeof e&&S.test(e)?w(e):e||[],!1).length}});var P,M=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,i){var n,o;if(!e)return this;if(i=i||P,"string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:M.exec(e))||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:g,!0)),R.test(n[1])&&w.isPlainObject(t))for(n in t)_(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(o=g.getElementById(n[2]))&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):_(e)?void 0!==i.ready?i.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,P=w(g);var D=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};function B(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),i=t.length;return this.filter((function(){for(var e=0;e<i;e++)if(w.contains(this,t[e]))return!0}))},closest:function(e,t){var i,n=0,o=this.length,r=[],s="string"!=typeof e&&w(e);if(!S.test(e))for(;n<o;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&w.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(r.length>1?w.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?a.call(w(e),this[0]):a.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return k(e,"parentNode")},parentsUntil:function(e,t,i){return k(e,"parentNode",i)},next:function(e){return B(e,"nextSibling")},prev:function(e){return B(e,"previousSibling")},nextAll:function(e){return k(e,"nextSibling")},prevAll:function(e){return k(e,"previousSibling")},nextUntil:function(e,t,i){return k(e,"nextSibling",i)},prevUntil:function(e,t,i){return k(e,"previousSibling",i)},siblings:function(e){return C((e.parentNode||{}).firstChild,e)},children:function(e){return C(e.firstChild)},contents:function(e){return null!=e.contentDocument&&n(e.contentDocument)?e.contentDocument:(T(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},(function(e,t){w.fn[e]=function(i,n){var o=w.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=w.filter(n,o)),this.length>1&&(I[e]||w.uniqueSort(o),D.test(e)&&o.reverse()),this.pushStack(o)}}));var z=/[^\x20\t\r\n\f]+/g;function L(e){return e}function N(e){throw e}function $(e,t,i,n){var o;try{e&&_(o=e.promise)?o.call(e).done(t).fail(i):e&&_(o=e.then)?o.call(e,t,i):t.apply(void 0,[e].slice(n))}catch(r){i.apply(void 0,[r])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(z)||[],(function(e,i){t[i]=!0})),t}(e):w.extend({},e);var t,i,n,o,r=[],s=[],a=-1,l=function(){for(o=o||e.once,n=t=!0;s.length;a=-1)for(i=s.shift();++a<r.length;)!1===r[a].apply(i[0],i[1])&&e.stopOnFalse&&(a=r.length,i=!1);e.memory||(i=!1),t=!1,o&&(r=i?[]:"")},c={add:function(){return r&&(i&&!t&&(a=r.length-1,s.push(i)),function t(i){w.each(i,(function(i,n){_(n)?e.unique&&c.has(n)||r.push(n):n&&n.length&&"string"!==b(n)&&t(n)}))}(arguments),i&&!t&&l()),this},remove:function(){return w.each(arguments,(function(e,t){for(var i;(i=w.inArray(t,r,i))>-1;)r.splice(i,1),i<=a&&a--})),this},has:function(e){return e?w.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=s=[],r=i="",this},disabled:function(){return!r},lock:function(){return o=s=[],i||t||(r=i=""),this},locked:function(){return!!o},fireWith:function(e,i){return o||(i=[e,(i=i||[]).slice?i.slice():i],s.push(i),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},w.extend({Deferred:function(t){var i=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var e=arguments;return w.Deferred((function(t){w.each(i,(function(i,n){var o=_(e[n[4]])&&e[n[4]];r[n[1]]((function(){var e=o&&o.apply(this,arguments);e&&_(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[n[0]+"With"](this,o?[e]:arguments)}))})),e=null})).promise()},then:function(t,n,o){var r=0;function s(t,i,n,o){return function(){var a=this,l=arguments,c=function(){var e,c;if(!(t<r)){if((e=n.apply(a,l))===i.promise())throw new TypeError("Thenable self-resolution");c=e&&("object"==typeof e||"function"==typeof e)&&e.then,_(c)?o?c.call(e,s(r,i,L,o),s(r,i,N,o)):(r++,c.call(e,s(r,i,L,o),s(r,i,N,o),s(r,i,L,i.notifyWith))):(n!==L&&(a=void 0,l=[e]),(o||i.resolveWith)(a,l))}},d=o?c:function(){try{c()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,d.stackTrace),t+1>=r&&(n!==N&&(a=void 0,l=[e]),i.rejectWith(a,l))}};t?d():(w.Deferred.getStackHook&&(d.stackTrace=w.Deferred.getStackHook()),e.setTimeout(d))}}return w.Deferred((function(e){i[0][3].add(s(0,e,_(o)?o:L,e.notifyWith)),i[1][3].add(s(0,e,_(t)?t:L)),i[2][3].add(s(0,e,_(n)?n:N))})).promise()},promise:function(e){return null!=e?w.extend(e,o):o}},r={};return w.each(i,(function(e,t){var s=t[2],a=t[5];o[t[1]]=s.add,a&&s.add((function(){n=a}),i[3-e][2].disable,i[3-e][3].disable,i[0][2].lock,i[0][3].lock),s.add(t[3].fire),r[t[0]]=function(){return r[t[0]+"With"](this===r?void 0:this,arguments),this},r[t[0]+"With"]=s.fireWith})),o.promise(r),t&&t.call(r,r),r},when:function(e){var t=arguments.length,i=t,n=Array(i),r=o.call(arguments),s=w.Deferred(),a=function(e){return function(i){n[e]=this,r[e]=arguments.length>1?o.call(arguments):i,--t||s.resolveWith(n,r)}};if(t<=1&&($(e,s.done(a(i)).resolve,s.reject,!t),"pending"===s.state()||_(r[i]&&r[i].then)))return s.then();for(;i--;)$(r[i],a(i),s.reject);return s.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,i){e.console&&e.console.warn&&t&&V.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,i)},w.readyException=function(t){e.setTimeout((function(){throw t}))};var O=w.Deferred();function F(){g.removeEventListener("DOMContentLoaded",F),e.removeEventListener("load",F),w.ready()}w.fn.ready=function(e){return O.then(e).catch((function(e){w.readyException(e)})),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||O.resolveWith(g,[w]))}}),w.ready.then=O.then,"complete"===g.readyState||"loading"!==g.readyState&&!g.documentElement.doScroll?e.setTimeout(w.ready):(g.addEventListener("DOMContentLoaded",F),e.addEventListener("load",F));var G=function(e,t,i,n,o,r,s){var a=0,l=e.length,c=null==i;if("object"===b(i))for(a in o=!0,i)G(e,t,a,i[a],!0,r,s);else if(void 0!==n&&(o=!0,_(n)||(s=!0),c&&(s?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(w(e),i)})),t))for(;a<l;a++)t(e[a],i,s?n:n.call(e[a],a,t(e[a],i)));return o?e:c?t.call(e):l?t(e[0],i):r},H=/^-ms-/,j=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function W(e){return e.replace(H,"ms-").replace(j,U)}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function q(){this.expando=w.expando+q.uid++}q.uid=1,q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,o=this.cache(e);if("string"==typeof t)o[W(t)]=i;else for(n in t)o[W(n)]=t[n];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][W(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n=e[this.expando];if(void 0!==n){if(void 0!==t){i=(t=Array.isArray(t)?t.map(W):(t=W(t))in n?[t]:t.match(z)||[]).length;for(;i--;)delete n[t[i]]}(void 0===t||w.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var X=new q,K=new q,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function Z(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(Q,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(n))){try{i=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:J.test(e)?JSON.parse(e):e)}(i)}catch(o){}K.set(e,t,i)}else i=void 0;return i}w.extend({hasData:function(e){return K.hasData(e)||X.hasData(e)},data:function(e,t,i){return K.access(e,t,i)},removeData:function(e,t){K.remove(e,t)},_data:function(e,t,i){return X.access(e,t,i)},_removeData:function(e,t){X.remove(e,t)}}),w.fn.extend({data:function(e,t){var i,n,o,r=this[0],s=r&&r.attributes;if(void 0===e){if(this.length&&(o=K.get(r),1===r.nodeType&&!X.get(r,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&0===(n=s[i].name).indexOf("data-")&&(n=W(n.slice(5)),Z(r,n,o[n]));X.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each((function(){K.set(this,e)})):G(this,(function(t){var i;if(r&&void 0===t)return void 0!==(i=K.get(r,e))||void 0!==(i=Z(r,e))?i:void 0;this.each((function(){K.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){K.remove(this,e)}))}}),w.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=X.get(e,t),i&&(!n||Array.isArray(i)?n=X.access(e,t,w.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=w.queue(e,t),n=i.length,o=i.shift(),r=w._queueHooks(e,t);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===t&&i.unshift("inprogress"),delete r.stop,o.call(e,(function(){w.dequeue(e,t)}),r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return X.get(e,i)||X.access(e,i,{empty:w.Callbacks("once memory").add((function(){X.remove(e,[t+"queue",i])}))})}}),w.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?w.queue(this[0],e):void 0===t?this:this.each((function(){var i=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&w.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){w.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,o=w.Deferred(),r=this,s=this.length,a=function(){--n||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(i=X.get(r[s],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),o.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ie=["Top","Right","Bottom","Left"],ne=g.documentElement,oe=function(e){return w.contains(e.ownerDocument,e)},re={composed:!0};ne.getRootNode&&(oe=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(re)===e.ownerDocument});var se=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&oe(e)&&"none"===w.css(e,"display")};function ae(e,t,i,n){var o,r,s=20,a=n?function(){return n.cur()}:function(){return w.css(e,t,"")},l=a(),c=i&&i[3]||(w.cssNumber[t]?"":"px"),d=e.nodeType&&(w.cssNumber[t]||"px"!==c&&+l)&&te.exec(w.css(e,t));if(d&&d[3]!==c){for(l/=2,c=c||d[3],d=+l||1;s--;)w.style(e,t,d+c),(1-r)*(1-(r=a()/l||.5))<=0&&(s=0),d/=r;d*=2,w.style(e,t,d+c),i=i||[]}return i&&(d=+d||+l||0,o=i[1]?d+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=d,n.end=o)),o}var le={};function ce(e){var t,i=e.ownerDocument,n=e.nodeName,o=le[n];return o||(t=i.body.appendChild(i.createElement(n)),o=w.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),le[n]=o,o)}function de(e,t){for(var i,n,o=[],r=0,s=e.length;r<s;r++)(n=e[r]).style&&(i=n.style.display,t?("none"===i&&(o[r]=X.get(n,"display")||null,o[r]||(n.style.display="")),""===n.style.display&&se(n)&&(o[r]=ce(n))):"none"!==i&&(o[r]="none",X.set(n,"display",i)));for(r=0;r<s;r++)null!=o[r]&&(e[r].style.display=o[r]);return e}w.fn.extend({show:function(){return de(this,!0)},hide:function(){return de(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){se(this)?w(this).show():w(this).hide()}))}});var he,ue,pe=/^(?:checkbox|radio)$/i,_e=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,fe=/^$|^module$|\/(?:java|ecma)script/i;he=g.createDocumentFragment().appendChild(g.createElement("div")),(ue=g.createElement("input")).setAttribute("type","radio"),ue.setAttribute("checked","checked"),ue.setAttribute("name","t"),he.appendChild(ue),p.checkClone=he.cloneNode(!0).cloneNode(!0).lastChild.checked,he.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!he.cloneNode(!0).lastChild.defaultValue,he.innerHTML="<option></option>",p.option=!!he.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function me(e,t){var i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&T(e,t)?w.merge([e],i):i}function ve(e,t){for(var i=0,n=e.length;i<n;i++)X.set(e[i],"globalEval",!t||X.get(t[i],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,p.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var be=/<|&#?\w+;/;function ye(e,t,i,n,o){for(var r,s,a,l,c,d,h=t.createDocumentFragment(),u=[],p=0,_=e.length;p<_;p++)if((r=e[p])||0===r)if("object"===b(r))w.merge(u,r.nodeType?[r]:r);else if(be.test(r)){for(s=s||h.appendChild(t.createElement("div")),a=(_e.exec(r)||["",""])[1].toLowerCase(),l=ge[a]||ge._default,s.innerHTML=l[1]+w.htmlPrefilter(r)+l[2],d=l[0];d--;)s=s.lastChild;w.merge(u,s.childNodes),(s=h.firstChild).textContent=""}else u.push(t.createTextNode(r));for(h.textContent="",p=0;r=u[p++];)if(n&&w.inArray(r,n)>-1)o&&o.push(r);else if(c=oe(r),s=me(h.appendChild(r),"script"),c&&ve(s),i)for(d=0;r=s[d++];)fe.test(r.type||"")&&i.push(r);return h}var we=/^([^.]*)(?:\.(.+)|)/;function Ae(){return!0}function xe(){return!1}function ke(e,t){return e===function(){try{return g.activeElement}catch(e){}}()==("focus"===t)}function Ce(e,t,i,n,o,r){var s,a;if("object"==typeof t){for(a in"string"!=typeof i&&(n=n||i,i=void 0),t)Ce(e,a,i,n,t[a],r);return e}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=xe;else if(!o)return e;return 1===r&&(s=o,(o=function(e){return w().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=w.guid++)),e.each((function(){w.event.add(this,t,o,n,i)}))}function Se(e,t,i){i?(X.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var n,r,s=X.get(this,t);if(1&e.isTrigger&&this[t]){if(s.length)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(s=o.call(arguments),X.set(this,t,s),n=i(this,t),this[t](),s!==(r=X.get(this,t))||n?X.set(this,t,!1):r={},s!==r)return e.stopImmediatePropagation(),e.preventDefault(),r&&r.value}else s.length&&(X.set(this,t,{value:w.event.trigger(w.extend(s[0],w.Event.prototype),s.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===X.get(e,t)&&w.event.add(e,t,Ae)}w.event={global:{},add:function(e,t,i,n,o){var r,s,a,l,c,d,h,u,p,_,f,g=X.get(e);if(Y(e))for(i.handler&&(i=(r=i).handler,o=r.selector),o&&w.find.matchesSelector(ne,o),i.guid||(i.guid=w.guid++),(l=g.events)||(l=g.events=Object.create(null)),(s=g.handle)||(s=g.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(z)||[""]).length;c--;)p=f=(a=we.exec(t[c])||[])[1],_=(a[2]||"").split(".").sort(),p&&(h=w.event.special[p]||{},p=(o?h.delegateType:h.bindType)||p,h=w.event.special[p]||{},d=w.extend({type:p,origType:f,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&w.expr.match.needsContext.test(o),namespace:_.join(".")},r),(u=l[p])||((u=l[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,n,_,s)||e.addEventListener&&e.addEventListener(p,s)),h.add&&(h.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),o?u.splice(u.delegateCount++,0,d):u.push(d),w.event.global[p]=!0)},remove:function(e,t,i,n,o){var r,s,a,l,c,d,h,u,p,_,f,g=X.hasData(e)&&X.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(z)||[""]).length;c--;)if(p=f=(a=we.exec(t[c])||[])[1],_=(a[2]||"").split(".").sort(),p){for(h=w.event.special[p]||{},u=l[p=(n?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+_.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=u.length;r--;)d=u[r],!o&&f!==d.origType||i&&i.guid!==d.guid||a&&!a.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(u.splice(r,1),d.selector&&u.delegateCount--,h.remove&&h.remove.call(e,d));s&&!u.length&&(h.teardown&&!1!==h.teardown.call(e,_,g.handle)||w.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)w.event.remove(e,p+t[c],i,n,!0);w.isEmptyObject(l)&&X.remove(e,"handle events")}},dispatch:function(e){var t,i,n,o,r,s,a=new Array(arguments.length),l=w.event.fix(e),c=(X.get(this,"events")||Object.create(null))[l.type]||[],d=w.event.special[l.type]||{};for(a[0]=l,t=1;t<arguments.length;t++)a[t]=arguments[t];if(l.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,l)){for(s=w.event.handlers.call(this,l,c),t=0;(o=s[t++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,i=0;(r=o.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==r.namespace&&!l.rnamespace.test(r.namespace)||(l.handleObj=r,l.data=r.data,void 0!==(n=((w.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,a))&&!1===(l.result=n)&&(l.preventDefault(),l.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,l),l.result}},handlers:function(e,t){var i,n,o,r,s,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(r=[],s={},i=0;i<l;i++)void 0===s[o=(n=t[i]).selector+" "]&&(s[o]=n.needsContext?w(o,this).index(c)>-1:w.find(o,this,null,[c]).length),s[o]&&r.push(n);r.length&&a.push({elem:c,handlers:r})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:_(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&T(t,"input")&&Se(t,"click",Ae),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&T(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&T(t,"input")&&X.get(t,"click")||T(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ae:xe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:xe,isPropagationStopped:xe,isImmediatePropagationStopped:xe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ae,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ae,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ae,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(e,t){w.event.special[e]={setup:function(){return Se(this,e,ke),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,o=e.relatedTarget,r=e.handleObj;return o&&(o===n||w.contains(n,o))||(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}})),w.fn.extend({on:function(e,t,i,n){return Ce(this,e,t,i,n)},one:function(e,t,i,n){return Ce(this,e,t,i,n,1)},off:function(e,t,i){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,w(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=xe),this.each((function(){w.event.remove(this,e,i,t)}))}});var Te=/<script|<style|<link/i,Re=/checked\s*(?:[^=]|=\s*.checked.)/i,Ee=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Pe(e,t){return T(e,"table")&&T(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function Me(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function De(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ie(e,t){var i,n,o,r,s,a;if(1===t.nodeType){if(X.hasData(e)&&(a=X.get(e).events))for(o in X.remove(t,"handle events"),a)for(i=0,n=a[o].length;i<n;i++)w.event.add(t,o,a[o][i]);K.hasData(e)&&(r=K.access(e),s=w.extend({},r),K.set(t,s))}}function Be(e,t,i,n){t=r(t);var o,s,a,l,c,d,h=0,u=e.length,f=u-1,g=t[0],m=_(g);if(m||u>1&&"string"==typeof g&&!p.checkClone&&Re.test(g))return e.each((function(o){var r=e.eq(o);m&&(t[0]=g.call(this,o,r.html())),Be(r,t,i,n)}));if(u&&(s=(o=ye(t,e[0].ownerDocument,!1,e,n)).firstChild,1===o.childNodes.length&&(o=s),s||n)){for(l=(a=w.map(me(o,"script"),Me)).length;h<u;h++)c=o,h!==f&&(c=w.clone(c,!0,!0),l&&w.merge(a,me(c,"script"))),i.call(e[h],c,h);if(l)for(d=a[a.length-1].ownerDocument,w.map(a,De),h=0;h<l;h++)c=a[h],fe.test(c.type||"")&&!X.access(c,"globalEval")&&w.contains(d,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?w._evalUrl&&!c.noModule&&w._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},d):v(c.textContent.replace(Ee,""),c,d))}return e}function ze(e,t,i){for(var n,o=t?w.filter(t,e):e,r=0;null!=(n=o[r]);r++)i||1!==n.nodeType||w.cleanData(me(n)),n.parentNode&&(i&&oe(n)&&ve(me(n,"script")),n.parentNode.removeChild(n));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,i){var n,o,r,s,a,l,c,d=e.cloneNode(!0),h=oe(e);if(!(p.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(s=me(d),n=0,o=(r=me(e)).length;n<o;n++)a=r[n],l=s[n],c=void 0,"input"===(c=l.nodeName.toLowerCase())&&pe.test(a.type)?l.checked=a.checked:"input"!==c&&"textarea"!==c||(l.defaultValue=a.defaultValue);if(t)if(i)for(r=r||me(e),s=s||me(d),n=0,o=r.length;n<o;n++)Ie(r[n],s[n]);else Ie(e,d);return(s=me(d,"script")).length>0&&ve(s,!h&&me(e,"script")),d},cleanData:function(e){for(var t,i,n,o=w.event.special,r=0;void 0!==(i=e[r]);r++)if(Y(i)){if(t=i[X.expando]){if(t.events)for(n in t.events)o[n]?w.event.remove(i,n):w.removeEvent(i,n,t.handle);i[X.expando]=void 0}i[K.expando]&&(i[K.expando]=void 0)}}}),w.fn.extend({detach:function(e){return ze(this,e,!0)},remove:function(e){return ze(this,e)},text:function(e){return G(this,(function(e){return void 0===e?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Be(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Pe(this,e).appendChild(e)}))},prepend:function(){return Be(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Pe(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Be(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(me(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return w.clone(this,e,t)}))},html:function(e){return G(this,(function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Te.test(e)&&!ge[(_e.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(w.cleanData(me(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Be(this,arguments,(function(t){var i=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(me(this)),i&&i.replaceChild(t,this))}),e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){w.fn[e]=function(e){for(var i,n=[],o=w(e),r=o.length-1,a=0;a<=r;a++)i=a===r?this:this.clone(!0),w(o[a])[t](i),s.apply(n,i.get());return this.pushStack(n)}}));var Le=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Ne=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)},$e=function(e,t,i){var n,o,r={};for(o in t)r[o]=e.style[o],e.style[o]=t[o];for(o in n=i.call(e),t)e.style[o]=r[o];return n},Ve=new RegExp(ie.join("|"),"i");function Oe(e,t,i){var n,o,r,s,a=e.style;return(i=i||Ne(e))&&(""!==(s=i.getPropertyValue(t)||i[t])||oe(e)||(s=w.style(e,t)),!p.pixelBoxStyles()&&Le.test(s)&&Ve.test(t)&&(n=a.width,o=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=o,a.maxWidth=r)),void 0!==s?s+"":s}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(d){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",d.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ne.appendChild(c).appendChild(d);var t=e.getComputedStyle(d);n="1%"!==t.top,l=12===i(t.marginLeft),d.style.right="60%",s=36===i(t.right),o=36===i(t.width),d.style.position="absolute",r=12===i(d.offsetWidth/3),ne.removeChild(c),d=null}}function i(e){return Math.round(parseFloat(e))}var n,o,r,s,a,l,c=g.createElement("div"),d=g.createElement("div");d.style&&(d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===d.style.backgroundClip,w.extend(p,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),n},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),r},reliableTrDimensions:function(){var t,i,n,o;return null==a&&(t=g.createElement("table"),i=g.createElement("tr"),n=g.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",i.style.cssText="border:1px solid",i.style.height="1px",n.style.height="9px",n.style.display="block",ne.appendChild(t).appendChild(i).appendChild(n),o=e.getComputedStyle(i),a=parseInt(o.height,10)+parseInt(o.borderTopWidth,10)+parseInt(o.borderBottomWidth,10)===i.offsetHeight,ne.removeChild(t)),a}}))}();var Ge=["Webkit","Moz","ms"],He=g.createElement("div").style,je={};function Ue(e){var t=w.cssProps[e]||je[e];return t||(e in He?e:je[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),i=Ge.length;i--;)if((e=Ge[i]+t)in He)return e}(e)||e)}var We=/^(none|table(?!-c[ea]).+)/,Ye=/^--/,qe={position:"absolute",visibility:"hidden",display:"block"},Xe={letterSpacing:"0",fontWeight:"400"};function Ke(e,t,i){var n=te.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function Je(e,t,i,n,o,r){var s="width"===t?1:0,a=0,l=0;if(i===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===i&&(l+=w.css(e,i+ie[s],!0,o)),n?("content"===i&&(l-=w.css(e,"padding"+ie[s],!0,o)),"margin"!==i&&(l-=w.css(e,"border"+ie[s]+"Width",!0,o))):(l+=w.css(e,"padding"+ie[s],!0,o),"padding"!==i?l+=w.css(e,"border"+ie[s]+"Width",!0,o):a+=w.css(e,"border"+ie[s]+"Width",!0,o));return!n&&r>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-r-l-a-.5))||0),l}function Qe(e,t,i){var n=Ne(e),o=(!p.boxSizingReliable()||i)&&"border-box"===w.css(e,"boxSizing",!1,n),r=o,s=Oe(e,t,n),a="offset"+t[0].toUpperCase()+t.slice(1);if(Le.test(s)){if(!i)return s;s="auto"}return(!p.boxSizingReliable()&&o||!p.reliableTrDimensions()&&T(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===w.css(e,"display",!1,n))&&e.getClientRects().length&&(o="border-box"===w.css(e,"boxSizing",!1,n),(r=a in e)&&(s=e[a])),(s=parseFloat(s)||0)+Je(e,t,i||(o?"border":"content"),r,n,s)+"px"}function Ze(e,t,i,n,o){return new Ze.prototype.init(e,t,i,n,o)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Oe(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,s,a=W(t),l=Ye.test(t),c=e.style;if(l||(t=Ue(a)),s=w.cssHooks[t]||w.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(o=s.get(e,!1,n))?o:c[t];"string"===(r=typeof i)&&(o=te.exec(i))&&o[1]&&(i=ae(e,t,o),r="number"),null!=i&&i==i&&("number"!==r||l||(i+=o&&o[3]||(w.cssNumber[a]?"":"px")),p.clearCloneStyle||""!==i||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(i=s.set(e,i,n))||(l?c.setProperty(t,i):c[t]=i))}},css:function(e,t,i,n){var o,r,s,a=W(t);return Ye.test(t)||(t=Ue(a)),(s=w.cssHooks[t]||w.cssHooks[a])&&"get"in s&&(o=s.get(e,!0,i)),void 0===o&&(o=Oe(e,t,n)),"normal"===o&&t in Xe&&(o=Xe[t]),""===i||i?(r=parseFloat(o),!0===i||isFinite(r)?r||0:o):o}}),w.each(["height","width"],(function(e,t){w.cssHooks[t]={get:function(e,i,n){if(i)return!We.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Qe(e,t,n):$e(e,qe,(function(){return Qe(e,t,n)}))},set:function(e,i,n){var o,r=Ne(e),s=!p.scrollboxSize()&&"absolute"===r.position,a=(s||n)&&"border-box"===w.css(e,"boxSizing",!1,r),l=n?Je(e,t,n,a,r):0;return a&&s&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(r[t])-Je(e,t,"border",!1,r)-.5)),l&&(o=te.exec(i))&&"px"!==(o[3]||"px")&&(e.style[t]=i,i=w.css(e,t)),Ke(0,i,l)}}})),w.cssHooks.marginLeft=Fe(p.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Oe(e,"marginLeft"))||e.getBoundingClientRect().left-$e(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(e,t){w.cssHooks[e+t]={expand:function(i){for(var n=0,o={},r="string"==typeof i?i.split(" "):[i];n<4;n++)o[e+ie[n]+t]=r[n]||r[n-2]||r[0];return o}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)})),w.fn.extend({css:function(e,t){return G(this,(function(e,t,i){var n,o,r={},s=0;if(Array.isArray(t)){for(n=Ne(e),o=t.length;s<o;s++)r[t[s]]=w.css(e,t[s],!1,n);return r}return void 0!==i?w.style(e,t,i):w.css(e,t)}),e,t,arguments.length>1)}}),w.Tween=Ze,Ze.prototype={constructor:Ze,init:function(e,t,i,n,o,r){this.elem=e,this.prop=i,this.easing=o||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(w.cssNumber[i]?"":"px")},cur:function(){var e=Ze.propHooks[this.prop];return e&&e.get?e.get(this):Ze.propHooks._default.get(this)},run:function(e){var t,i=Ze.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Ze.propHooks._default.set(this),this}},Ze.prototype.init.prototype=Ze.prototype,Ze.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[Ue(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},Ze.propHooks.scrollTop=Ze.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=Ze.prototype.init,w.fx.step={};var et,tt,it=/^(?:toggle|show|hide)$/,nt=/queueHooks$/;function ot(){tt&&(!1===g.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(ot):e.setTimeout(ot,w.fx.interval),w.fx.tick())}function rt(){return e.setTimeout((function(){et=void 0})),et=Date.now()}function st(e,t){var i,n=0,o={height:e};for(t=t?1:0;n<4;n+=2-t)o["margin"+(i=ie[n])]=o["padding"+i]=e;return t&&(o.opacity=o.width=e),o}function at(e,t,i){for(var n,o=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),r=0,s=o.length;r<s;r++)if(n=o[r].call(i,t,e))return n}function lt(e,t,i){var n,o,r=0,s=lt.prefilters.length,a=w.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var t=et||rt(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0),r=0,s=c.tweens.length;r<s;r++)c.tweens[r].run(n);return a.notifyWith(e,[c,n,i]),n<1&&s?i:(s||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},i),originalProperties:t,originalOptions:i,startTime:et||rt(),duration:i.duration,tweens:[],createTween:function(t,i){var n=w.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)c.tweens[i].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),d=c.props;for(!function(e,t){var i,n,o,r,s;for(i in e)if(o=t[n=W(i)],r=e[i],Array.isArray(r)&&(o=r[1],r=e[i]=r[0]),i!==n&&(e[n]=r,delete e[i]),(s=w.cssHooks[n])&&"expand"in s)for(i in r=s.expand(r),delete e[n],r)i in e||(e[i]=r[i],t[i]=o);else t[n]=o}(d,c.opts.specialEasing);r<s;r++)if(n=lt.prefilters[r].call(c,e,d,c.opts))return _(n.stop)&&(w._queueHooks(c.elem,c.opts.queue).stop=n.stop.bind(n)),n;return w.map(d,at,c),_(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),w.fx.timer(w.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}w.Animation=w.extend(lt,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return ae(i.elem,e,te.exec(t),i),i}]},tweener:function(e,t){_(e)?(t=e,e=["*"]):e=e.match(z);for(var i,n=0,o=e.length;n<o;n++)i=e[n],lt.tweeners[i]=lt.tweeners[i]||[],lt.tweeners[i].unshift(t)},prefilters:[function(e,t,i){var n,o,r,s,a,l,c,d,h="width"in t||"height"in t,u=this,p={},_=e.style,f=e.nodeType&&se(e),g=X.get(e,"fxshow");for(n in i.queue||(null==(s=w._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,u.always((function(){u.always((function(){s.unqueued--,w.queue(e,"fx").length||s.empty.fire()}))}))),t)if(o=t[n],it.test(o)){if(delete t[n],r=r||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[n])continue;f=!0}p[n]=g&&g[n]||w.style(e,n)}if((l=!w.isEmptyObject(t))||!w.isEmptyObject(p))for(n in h&&1===e.nodeType&&(i.overflow=[_.overflow,_.overflowX,_.overflowY],null==(c=g&&g.display)&&(c=X.get(e,"display")),"none"===(d=w.css(e,"display"))&&(c?d=c:(de([e],!0),c=e.style.display||c,d=w.css(e,"display"),de([e]))),("inline"===d||"inline-block"===d&&null!=c)&&"none"===w.css(e,"float")&&(l||(u.done((function(){_.display=c})),null==c&&(d=_.display,c="none"===d?"":d)),_.display="inline-block")),i.overflow&&(_.overflow="hidden",u.always((function(){_.overflow=i.overflow[0],_.overflowX=i.overflow[1],_.overflowY=i.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(f=g.hidden):g=X.access(e,"fxshow",{display:c}),r&&(g.hidden=!f),f&&de([e],!0),u.done((function(){for(n in f||de([e]),X.remove(e,"fxshow"),p)w.style(e,n,p[n])}))),l=at(f?g[n]:0,n,u),n in g||(g[n]=l.start,f&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),w.speed=function(e,t,i){var n=e&&"object"==typeof e?w.extend({},e):{complete:i||!i&&t||_(e)&&e,duration:e,easing:i&&t||t&&!_(t)&&t};return w.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in w.fx.speeds?n.duration=w.fx.speeds[n.duration]:n.duration=w.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){_(n.old)&&n.old.call(this),n.queue&&w.dequeue(this,n.queue)},n},w.fn.extend({fadeTo:function(e,t,i,n){return this.filter(se).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var o=w.isEmptyObject(e),r=w.speed(t,i,n),s=function(){var t=lt(this,w.extend({},e),r);(o||X.get(this,"finish"))&&t.stop(!0)};return s.finish=s,o||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,o=null!=e&&e+"queueHooks",r=w.timers,s=X.get(this);if(o)s[o]&&s[o].stop&&n(s[o]);else for(o in s)s[o]&&s[o].stop&&nt.test(o)&&n(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(i),t=!1,r.splice(o,1));!t&&i||w.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,i=X.get(this),n=i[e+"queue"],o=i[e+"queueHooks"],r=w.timers,s=n?n.length:0;for(i.finish=!0,w.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<s;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish}))}}),w.each(["toggle","show","hide"],(function(e,t){var i=w.fn[t];w.fn[t]=function(e,n,o){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(t,!0),e,n,o)}})),w.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){w.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}})),w.timers=[],w.fx.tick=function(){var e,t=0,i=w.timers;for(et=Date.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||w.fx.stop(),et=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){tt||(tt=!0,ot())},w.fx.stop=function(){tt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,i){return t=w.fx&&w.fx.speeds[t]||t,i=i||"fx",this.queue(i,(function(i,n){var o=e.setTimeout(i,t);n.stop=function(){e.clearTimeout(o)}}))},function(){var e=g.createElement("input"),t=g.createElement("select").appendChild(g.createElement("option"));e.type="checkbox",p.checkOn=""!==e.value,p.optSelected=t.selected,(e=g.createElement("input")).value="t",e.type="radio",p.radioValue="t"===e.value}();var ct,dt=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return G(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){w.removeAttr(this,e)}))}}),w.extend({attr:function(e,t,i){var n,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===e.getAttribute?w.prop(e,t,i):(1===r&&w.isXMLDoc(e)||(o=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?ct:void 0)),void 0!==i?null===i?void w.removeAttr(e,t):o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:(e.setAttribute(t,i+""),i):o&&"get"in o&&null!==(n=o.get(e,t))?n:null==(n=w.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){if(!p.radioValue&&"radio"===t&&T(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n=0,o=t&&t.match(z);if(o&&1===e.nodeType)for(;i=o[n++];)e.removeAttribute(i)}}),ct={set:function(e,t,i){return!1===t?w.removeAttr(e,i):e.setAttribute(i,i),i}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(e,t){var i=dt[t]||w.find.attr;dt[t]=function(e,t,n){var o,r,s=t.toLowerCase();return n||(r=dt[s],dt[s]=o,o=null!=i(e,t,n)?s:null,dt[s]=r),o}}));var ht=/^(?:input|select|textarea|button)$/i,ut=/^(?:a|area)$/i;function pt(e){return(e.match(z)||[]).join(" ")}function _t(e){return e.getAttribute&&e.getAttribute("class")||""}function ft(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(z)||[]}w.fn.extend({prop:function(e,t){return G(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[w.propFix[e]||e]}))}}),w.extend({prop:function(e,t,i){var n,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&w.isXMLDoc(e)||(t=w.propFix[t]||t,o=w.propHooks[t]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:e[t]=i:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):ht.test(e.nodeName)||ut.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(e){var t,i,n,o,r,s,a,l=0;if(_(e))return this.each((function(t){w(this).addClass(e.call(this,t,_t(this)))}));if((t=ft(e)).length)for(;i=this[l++];)if(o=_t(i),n=1===i.nodeType&&" "+pt(o)+" "){for(s=0;r=t[s++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");o!==(a=pt(n))&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,n,o,r,s,a,l=0;if(_(e))return this.each((function(t){w(this).removeClass(e.call(this,t,_t(this)))}));if(!arguments.length)return this.attr("class","");if((t=ft(e)).length)for(;i=this[l++];)if(o=_t(i),n=1===i.nodeType&&" "+pt(o)+" "){for(s=0;r=t[s++];)for(;n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");o!==(a=pt(n))&&i.setAttribute("class",a)}return this},toggleClass:function(e,t){var i=typeof e,n="string"===i||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):_(e)?this.each((function(i){w(this).toggleClass(e.call(this,i,_t(this),t),t)})):this.each((function(){var t,o,r,s;if(n)for(o=0,r=w(this),s=ft(e);t=s[o++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else void 0!==e&&"boolean"!==i||((t=_t(this))&&X.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":X.get(this,"__className__")||""))}))},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+pt(_t(i))+" ").indexOf(t)>-1)return!0;return!1}});var gt=/\r/g;w.fn.extend({val:function(e){var t,i,n,o=this[0];return arguments.length?(n=_(e),this.each((function(i){var o;1===this.nodeType&&(null==(o=n?e.call(this,i,w(this).val()):e)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=w.map(o,(function(e){return null==e?"":e+""}))),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))}))):o?(t=w.valHooks[o.type]||w.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(gt,""):null==i?"":i:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:pt(w.text(e))}},select:{get:function(e){var t,i,n,o=e.options,r=e.selectedIndex,s="select-one"===e.type,a=s?null:[],l=s?r+1:o.length;for(n=r<0?l:s?r:0;n<l;n++)if(((i=o[n]).selected||n===r)&&!i.disabled&&(!i.parentNode.disabled||!T(i.parentNode,"optgroup"))){if(t=w(i).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var i,n,o=e.options,r=w.makeArray(t),s=o.length;s--;)((n=o[s]).selected=w.inArray(w.valHooks.option.get(n),r)>-1)&&(i=!0);return i||(e.selectedIndex=-1),r}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},p.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),p.focusin="onfocusin"in e;var mt=/^(?:focusinfocus|focusoutblur)$/,vt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,i,n,o){var r,s,a,l,c,h,u,p,m=[n||g],v=d.call(t,"type")?t.type:t,b=d.call(t,"namespace")?t.namespace.split("."):[];if(s=p=a=n=n||g,3!==n.nodeType&&8!==n.nodeType&&!mt.test(v+w.event.triggered)&&(v.indexOf(".")>-1&&(b=v.split("."),v=b.shift(),b.sort()),c=v.indexOf(":")<0&&"on"+v,(t=t[w.expando]?t:new w.Event(v,"object"==typeof t&&t)).isTrigger=o?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:w.makeArray(i,[t]),u=w.event.special[v]||{},o||!u.trigger||!1!==u.trigger.apply(n,i))){if(!o&&!u.noBubble&&!f(n)){for(l=u.delegateType||v,mt.test(l+v)||(s=s.parentNode);s;s=s.parentNode)m.push(s),a=s;a===(n.ownerDocument||g)&&m.push(a.defaultView||a.parentWindow||e)}for(r=0;(s=m[r++])&&!t.isPropagationStopped();)p=s,t.type=r>1?l:u.bindType||v,(h=(X.get(s,"events")||Object.create(null))[t.type]&&X.get(s,"handle"))&&h.apply(s,i),(h=c&&s[c])&&h.apply&&Y(s)&&(t.result=h.apply(s,i),!1===t.result&&t.preventDefault());return t.type=v,o||t.isDefaultPrevented()||u._default&&!1!==u._default.apply(m.pop(),i)||!Y(n)||c&&_(n[v])&&!f(n)&&((a=n[c])&&(n[c]=null),w.event.triggered=v,t.isPropagationStopped()&&p.addEventListener(v,vt),n[v](),t.isPropagationStopped()&&p.removeEventListener(v,vt),w.event.triggered=void 0,a&&(n[c]=a)),t.result}},simulate:function(e,t,i){var n=w.extend(new w.Event,i,{type:e,isSimulated:!0});w.event.trigger(n,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each((function(){w.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var i=this[0];if(i)return w.event.trigger(e,t,i,!0)}}),p.focusin||w.each({focus:"focusin",blur:"focusout"},(function(e,t){var i=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var n=this.ownerDocument||this.document||this,o=X.access(n,t);o||n.addEventListener(e,i,!0),X.access(n,t,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,o=X.access(n,t)-1;o?X.access(n,t,o):(n.removeEventListener(e,i,!0),X.remove(n,t))}}}));var bt=e.location,yt={guid:Date.now()},wt=/\?/;w.parseXML=function(t){var i,n;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(o){}return n=i&&i.getElementsByTagName("parsererror")[0],i&&!n||w.error("Invalid XML: "+(n?w.map(n.childNodes,(function(e){return e.textContent})).join("\n"):t)),i};var At=/\[\]$/,xt=/\r?\n/g,kt=/^(?:submit|button|image|reset|file)$/i,Ct=/^(?:input|select|textarea|keygen)/i;function St(e,t,i,n){var o;if(Array.isArray(t))w.each(t,(function(t,o){i||At.test(e)?n(e,o):St(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,i,n)}));else if(i||"object"!==b(t))n(e,t);else for(o in t)St(e+"["+o+"]",t[o],i,n)}w.param=function(e,t){var i,n=[],o=function(e,t){var i=_(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,(function(){o(this.name,this.value)}));else for(i in e)St(i,e[i],t,o);return n.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&Ct.test(this.nodeName)&&!kt.test(e)&&(this.checked||!pe.test(e))})).map((function(e,t){var i=w(this).val();return null==i?null:Array.isArray(i)?w.map(i,(function(e){return{name:t.name,value:e.replace(xt,"\r\n")}})):{name:t.name,value:i.replace(xt,"\r\n")}})).get()}});var Tt=/%20/g,Rt=/#.*$/,Et=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Mt=/^(?:GET|HEAD)$/,Dt=/^\/\//,It={},Bt={},zt="*/".concat("*"),Lt=g.createElement("a");function Nt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,o=0,r=t.toLowerCase().match(z)||[];if(_(i))for(;n=r[o++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function $t(e,t,i,n){var o={},r=e===Bt;function s(a){var l;return o[a]=!0,w.each(e[a]||[],(function(e,a){var c=a(t,i,n);return"string"!=typeof c||r||o[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)})),l}return s(t.dataTypes[0])||!o["*"]&&s("*")}function Vt(e,t){var i,n,o=w.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((o[i]?e:n||(n={}))[i]=t[i]);return n&&w.extend(!0,e,n),e}Lt.href=bt.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Vt(Vt(e,w.ajaxSettings),t):Vt(w.ajaxSettings,e)},ajaxPrefilter:Nt(It),ajaxTransport:Nt(Bt),ajax:function(t,i){"object"==typeof t&&(i=t,t=void 0),i=i||{};var n,o,r,s,a,l,c,d,h,u,p=w.ajaxSetup({},i),_=p.context||p,f=p.context&&(_.nodeType||_.jquery)?w(_):w.event,m=w.Deferred(),v=w.Callbacks("once memory"),b=p.statusCode||{},y={},A={},x="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s)for(s={};t=Pt.exec(r);)s[t[1].toLowerCase()+" "]=(s[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=s[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?r:null},setRequestHeader:function(e,t){return null==c&&(e=A[e.toLowerCase()]=A[e.toLowerCase()]||e,y[e]=t),this},overrideMimeType:function(e){return null==c&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)k.always(e[k.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||x;return n&&n.abort(t),C(0,t),this}};if(m.promise(k),p.url=((t||p.url||bt.href)+"").replace(Dt,bt.protocol+"//"),p.type=i.method||i.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(z)||[""],null==p.crossDomain){l=g.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Lt.protocol+"//"+Lt.host!=l.protocol+"//"+l.host}catch(S){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=w.param(p.data,p.traditional)),$t(It,p,i,k),c)return k;for(h in(d=w.event&&p.global)&&0==w.active++&&w.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Mt.test(p.type),o=p.url.replace(Rt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Tt,"+")):(u=p.url.slice(o.length),p.data&&(p.processData||"string"==typeof p.data)&&(o+=(wt.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(o=o.replace(Et,"$1"),u=(wt.test(o)?"&":"?")+"_="+yt.guid+++u),p.url=o+u),p.ifModified&&(w.lastModified[o]&&k.setRequestHeader("If-Modified-Since",w.lastModified[o]),w.etag[o]&&k.setRequestHeader("If-None-Match",w.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||i.contentType)&&k.setRequestHeader("Content-Type",p.contentType),k.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+zt+"; q=0.01":""):p.accepts["*"]),p.headers)k.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(_,k,p)||c))return k.abort();if(x="abort",v.add(p.complete),k.done(p.success),k.fail(p.error),n=$t(Bt,p,i,k)){if(k.readyState=1,d&&f.trigger("ajaxSend",[k,p]),c)return k;p.async&&p.timeout>0&&(a=e.setTimeout((function(){k.abort("timeout")}),p.timeout));try{c=!1,n.send(y,C)}catch(S){if(c)throw S;C(-1,S)}}else C(-1,"No Transport");function C(t,i,s,l){var h,u,g,y,A,x=i;c||(c=!0,a&&e.clearTimeout(a),n=void 0,r=l||"",k.readyState=t>0?4:0,h=t>=200&&t<300||304===t,s&&(y=function(e,t,i){for(var n,o,r,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(o in a)if(a[o]&&a[o].test(n)){l.unshift(o);break}if(l[0]in i)r=l[0];else{for(o in i){if(!l[0]||e.converters[o+" "+l[0]]){r=o;break}s||(s=o)}r=r||s}if(r)return r!==l[0]&&l.unshift(r),i[r]}(p,k,s)),!h&&w.inArray("script",p.dataTypes)>-1&&w.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),y=function(e,t,i,n){var o,r,s,a,l,c={},d=e.dataTypes.slice();if(d[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(r=d.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=d.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(o in c)if((a=o.split(" "))[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[o]:!0!==c[o]&&(r=a[0],d.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(S){return{state:"parsererror",error:s?S:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}(p,y,k,h),h?(p.ifModified&&((A=k.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=A),(A=k.getResponseHeader("etag"))&&(w.etag[o]=A)),204===t||"HEAD"===p.type?x="nocontent":304===t?x="notmodified":(x=y.state,u=y.data,h=!(g=y.error))):(g=x,!t&&x||(x="error",t<0&&(t=0))),k.status=t,k.statusText=(i||x)+"",h?m.resolveWith(_,[u,x,k]):m.rejectWith(_,[k,x,g]),k.statusCode(b),b=void 0,d&&f.trigger(h?"ajaxSuccess":"ajaxError",[k,p,h?u:g]),v.fireWith(_,[k,x]),d&&(f.trigger("ajaxComplete",[k,p]),--w.active||w.event.trigger("ajaxStop")))}return k},getJSON:function(e,t,i){return w.get(e,t,i,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],(function(e,t){w[t]=function(e,i,n,o){return _(i)&&(o=o||n,n=i,i=void 0),w.ajax(w.extend({url:e,type:t,dataType:o,data:i,success:n},w.isPlainObject(e)&&e))}})),w.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),w._evalUrl=function(e,t,i){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,i)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(_(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return _(e)?this.each((function(t){w(this).wrapInner(e.call(this,t))})):this.each((function(){var t=w(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap:function(e){var t=_(e);return this.each((function(i){w(this).wrapAll(t?e.call(this,i):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(t){}};var Ot={0:200,1223:204},Ft=w.ajaxSettings.xhr();p.cors=!!Ft&&"withCredentials"in Ft,p.ajax=Ft=!!Ft,w.ajaxTransport((function(t){var i,n;if(p.cors||Ft&&!t.crossDomain)return{send:function(o,r){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)a.setRequestHeader(s,o[s]);i=function(e){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(Ot[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=a.ontimeout=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout((function(){i&&n()}))},i=i("abort");try{a.send(t.hasContent&&t.data||null)}catch(l){if(i)throw l}},abort:function(){i&&i()}}})),w.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),w.ajaxTransport("script",(function(e){var t,i;if(e.crossDomain||e.scriptAttrs)return{send:function(n,o){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&o("error"===e.type?404:200,e.type)}),g.head.appendChild(t[0])},abort:function(){i&&i()}}}));var Gt,Ht=[],jt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ht.pop()||w.expando+"_"+yt.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",(function(t,i,n){var o,r,s,a=!1!==t.jsonp&&(jt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&jt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=_(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(jt,"$1"+o):!1!==t.jsonp&&(t.url+=(wt.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||w.error(o+" was not called"),s[0]},t.dataTypes[0]="json",r=e[o],e[o]=function(){s=arguments},n.always((function(){void 0===r?w(e).removeProp(o):e[o]=r,t[o]&&(t.jsonpCallback=i.jsonpCallback,Ht.push(o)),s&&_(r)&&r(s[0]),s=r=void 0})),"script"})),p.createHTMLDocument=((Gt=g.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Gt.childNodes.length),w.parseHTML=function(e,t,i){return"string"!=typeof e?[]:("boolean"==typeof t&&(i=t,t=!1),t||(p.createHTMLDocument?((n=(t=g.implementation.createHTMLDocument("")).createElement("base")).href=g.location.href,t.head.appendChild(n)):t=g),r=!i&&[],(o=R.exec(e))?[t.createElement(o[1])]:(o=ye([e],t,r),r&&r.length&&w(r).remove(),w.merge([],o.childNodes)));var n,o,r},w.fn.load=function(e,t,i){var n,o,r,s=this,a=e.indexOf(" ");return a>-1&&(n=pt(e.slice(a)),e=e.slice(0,a)),_(t)?(i=t,t=void 0):t&&"object"==typeof t&&(o="POST"),s.length>0&&w.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done((function(e){r=arguments,s.html(n?w("<div>").append(w.parseHTML(e)).find(n):e)})).always(i&&function(e,t){s.each((function(){i.apply(this,r||[e.responseText,t,e])}))}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,(function(t){return e===t.elem})).length},w.offset={setOffset:function(e,t,i){var n,o,r,s,a,l,c=w.css(e,"position"),d=w(e),h={};"static"===c&&(e.style.position="relative"),a=d.offset(),r=w.css(e,"top"),l=w.css(e,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(s=(n=d.position()).top,o=n.left):(s=parseFloat(r)||0,o=parseFloat(l)||0),_(t)&&(t=t.call(e,i,w.extend({},a))),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+o),"using"in t?t.using.call(e,h):d.css(h)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){w.offset.setOffset(this,e,t)}));var t,i,n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,i,n=this[0],o={top:0,left:0};if("fixed"===w.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),i=n.ownerDocument,e=n.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&((o=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),o.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-o.top-w.css(n,"marginTop",!0),left:t.left-o.left-w.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||ne}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var i="pageYOffset"===t;w.fn[e]=function(n){return G(this,(function(e,n,o){var r;if(f(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===o)return r?r[t]:e[n];r?r.scrollTo(i?r.pageXOffset:o,i?o:r.pageYOffset):e[n]=o}),e,n,arguments.length)}})),w.each(["top","left"],(function(e,t){w.cssHooks[t]=Fe(p.pixelPosition,(function(e,i){if(i)return i=Oe(e,t),Le.test(i)?w(e).position()[t]+"px":i}))})),w.each({Height:"height",Width:"width"},(function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},(function(i,n){w.fn[n]=function(o,r){var s=arguments.length&&(i||"boolean"!=typeof o),a=i||(!0===o||!0===r?"margin":"border");return G(this,(function(t,i,o){var r;return f(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===o?w.css(t,i,a):w.style(t,i,o,a)}),t,s?o:void 0,s)}}))})),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){w.fn[t]=function(e){return this.on(t,e)}})),w.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){w.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}));var Ut=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var i,n,r;if("string"==typeof t&&(i=e[t],t=e,e=i),_(e))return n=o.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(o.call(arguments)))}).guid=e.guid=e.guid||w.guid++,r},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=T,w.isFunction=_,w.isWindow=f,w.camelCase=W,w.type=b,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Ut,"")};var Wt=e.jQuery,Yt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Yt),t&&e.jQuery===w&&(e.jQuery=Wt),w},void 0===t&&(e.jQuery=e.$=w),w}))}(jquery);var slick_jquery="undefined"!=typeof $?$:jquery.exports,$$b=slick_jquery;function EventData(){var e=!1,t=!1;this.stopPropagation=function(){e=!0},this.isPropagationStopped=function(){return e},this.stopImmediatePropagation=function(){t=!0},this.isImmediatePropagationStopped=function(){return t}}function Event(){var e=[];this.subscribe=function(t){e.push(t)},this.unsubscribe=function(t){for(var i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)},this.notify=function(t,i,n){var o;i=i||new EventData,n=n||this;for(var r=0;r<e.length&&!i.isPropagationStopped()&&!i.isImmediatePropagationStopped();r++)o=e[r].call(n,i,t);return o}}function EventHandler(){var e=[];this.subscribe=function(t,i){return e.push({event:t,handler:i}),t.subscribe(i),this},this.unsubscribe=function(t,i){for(var n=e.length;n--;)if(e[n].event===t&&e[n].handler===i)return e.splice(n,1),void t.unsubscribe(i);return this},this.unsubscribeAll=function(){for(var t=e.length;t--;)e[t].event.unsubscribe(e[t].handler);return e=[],this}}function Range(e,t,i,n){void 0===i&&void 0===n&&(i=e,n=t),this.fromRow=Math.min(e,i),this.fromCell=Math.min(t,n),this.toRow=Math.max(e,i),this.toCell=Math.max(t,n),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}}function NonDataItem(){this.__nonDataRow=!0}function Group(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function GroupTotals(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function EditorLock(){var e=null;this.isActive=function(t){return t?e===t:null!==e},this.activate=function(t){if(t!==e){if(null!==e)throw new Error("SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController");if(!t.commitCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()");if(!t.cancelCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()");e=t}},this.deactivate=function(t){if(e!==t)throw new Error("SlickGrid.EditorLock.deactivate: specified editController is not the currently active one");e=null},this.commitCurrentEdit=function(){return!e||e.commitCurrentEdit()},this.cancelCurrentEdit=function(){return!e||e.cancelCurrentEdit()}}function TreeColumns(e){var t={};function i(e){e.forEach((function(e){t[e.id]=e,e.columns&&i(e.columns)}))}function n(e,t){return e.filter((function(e){var i=t.call(e);return i&&e.columns&&(e.columns=n(e.columns,t)),i&&(!e.columns||e.columns.length)}))}function o(e,t){e.sort((function(e,i){return r(t.getColumnIndex(e.id))-r(t.getColumnIndex(i.id))})).forEach((function(e){e.columns&&o(e.columns,t)}))}function r(e){return void 0===e?-1:e}function s(e){if(!e.length)return e.columns?1+s(e.columns):1;for(var t in e)return s(e[t])}function a(e,t,i){var n=[];if(t==(i=i||0))return e.length&&e.forEach((function(e){e.columns&&(e.extractColumns=function(){return l(e)})})),e;for(var o in e)e[o].columns&&(n=n.concat(a(e[o].columns,t,i+1)));return n}function l(e){var t=[];if(e.hasOwnProperty("length"))for(var i=0;i<e.length;i++)t=t.concat(l(e[i]));else{if(!e.hasOwnProperty("columns"))return e;t=t.concat(l(e.columns))}return t}function c(){return $$b.extend(!0,[],e)}i(e),this.hasDepth=function(){for(var t in e)if(e[t].hasOwnProperty("columns"))return!0;return!1},this.getTreeColumns=function(){return e},this.extractColumns=function(){return this.hasDepth()?l(e):e},this.getDepth=function(){return s(e)},this.getColumnsInDepth=function(t){return a(e,t)},this.getColumnsInGroup=function(e){return l(e)},this.visibleColumns=function(){return n(c(),(function(){return this.visible}))},this.filter=function(e){return n(c(),e)},this.reOrder=function(t){return o(e,t)},this.getById=function(e){return t[e]},this.getInIds=function(e){return e.map((function(e){return t[e]}))}}Group.prototype=new NonDataItem,Group.prototype.equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title},GroupTotals.prototype=new NonDataItem;var slick_core={Event:Event,EventData:EventData,EventHandler:EventHandler,Range:Range,NonDataRow:NonDataItem,Group:Group,GroupTotals:GroupTotals,EditorLock:EditorLock,GlobalEditorLock:new EditorLock,TreeColumns:TreeColumns,keyCode:{SPACE:8,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,ESC:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65,C:67,V:86},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{CanvasTextSize:"CANV",HTML:"HTML"}},$$a=slick_jquery,Slick$7=slick_core;function RowSelectionModel(e){var t,i,n,o=[],r=this,s=new Slick$7.EventHandler,a={selectActiveRow:!0};function l(e){return function(){i||(i=!0,e.apply(this,arguments),i=!1)}}function c(e){for(var t=[],i=0;i<e.length;i++)for(var n=e[i].fromRow;n<=e[i].toRow;n++)t.push(n);return t}function d(e){for(var i=[],n=t.getColumns().length-1,o=0;o<e.length;o++)i.push(new Slick$7.Range(e[o],0,e[o],n));return i}function h(){return c(o)}function u(e){(o&&0!==o.length||e&&0!==e.length)&&(o=e,r.onSelectedRangesChanged.notify(o))}function p(e,i){n.selectActiveRow&&null!=i.row&&u([new Slick$7.Range(i.row,0,i.row,t.getColumns().length-1)])}function _(e){var i=t.getActiveCell();if(t.getOptions().multiSelect&&i&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.which==Slick$7.keyCode.UP||e.which==Slick$7.keyCode.DOWN)){var n=h();n.sort((function(e,t){return e-t})),n.length||(n=[i.row]);var o,r=n[0],s=n[n.length-1];if((o=e.which==Slick$7.keyCode.DOWN?i.row<s||r==s?++s:++r:i.row<s?--s:--r)>=0&&o<t.getDataLength())t.scrollRowIntoView(o),u(d(function(e,t){var i,n=[];for(i=e;i<=t;i++)n.push(i);for(i=t;i<e;i++)n.push(i);return n}(r,s)));e.preventDefault(),e.stopPropagation()}}function f(e){var i=t.getCellFromEvent(e);if(!i||!t.canCellBeActive(i.row,i.cell))return!1;if(!t.getOptions().multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;var n=c(o),r=$$a.inArray(i.row,n);if(-1===r&&(e.ctrlKey||e.metaKey))n.push(i.row),t.setActiveCell(i.row,i.cell);else if(-1!==r&&(e.ctrlKey||e.metaKey))n=$$a.grep(n,(function(e,t){return e!==i.row})),t.setActiveCell(i.row,i.cell);else if(n.length&&e.shiftKey){var s=n.pop(),a=Math.min(i.row,s),l=Math.max(i.row,s);n=[];for(var h=a;h<=l;h++)h!==s&&n.push(h);n.push(s),t.setActiveCell(i.row,i.cell)}return u(d(n)),e.stopImmediatePropagation(),!0}$$a.extend(this,{getSelectedRows:h,setSelectedRows:function(e){u(d(e))},getSelectedRanges:function(){return o},setSelectedRanges:u,init:function(i){n=$$a.extend(!0,{},a,e),t=i,s.subscribe(t.onActiveCellChanged,l(p)),s.subscribe(t.onKeyDown,l(_)),s.subscribe(t.onClick,l(f))},destroy:function(){s.unsubscribeAll()},pluginName:"RowSelectionModel",onSelectedRangesChanged:new Slick$7.Event})}var slick_rowselectionmodel={RowSelectionModel:RowSelectionModel},$$9=slick_jquery,Slick$6=slick_core;function CheckboxSelectColumn(e){var t,i=null,n=g(),o=new Slick$6.EventHandler,r={},s=!1,a=$$9.extend(!0,{},{columnId:"_checkbox_selector",cssClass:null,hideSelectAllCheckbox:!1,toolTip:"Select/Deselect All",width:30,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},e);function l(){t.updateColumnHeader(a.columnId,"","")}function c(){$$9("#filter-checkbox-selectall-container").hide()}function d(e,o){var l,c,d,h=t.getSelectedRows(),u={},p=0;if("function"==typeof i)for(d=0;d<t.getDataLength();d++){v(c,t.getDataItem(d),t)||p++}var _=[];for(c=0;c<h.length;c++){l=h[c],v(c,t.getDataItem(l),t)?(u[l]=!0,u[l]!==r[l]&&(t.invalidateRow(l),delete r[l])):_.push(l)}for(c in r)t.invalidateRow(c);(r=u,t.render(),s=h.length&&h.length+p>=t.getDataLength(),a.hideInColumnTitleRow||a.hideSelectAllCheckbox||b(s),a.hideInFilterHeaderRow)||$$9("#header-filter-selector"+n).prop("checked",s);if(_.length>0){for(c=0;c<_.length;c++){var f=h.indexOf(_[c]);h.splice(f,1)}t.setSelectedRows(h)}}function h(e,i){32==e.which&&t.getColumns()[i.cell].id===a.columnId&&(t.getEditorLock().isActive()&&!t.getEditorLock().commitCurrentEdit()||p(i.row),e.preventDefault(),e.stopImmediatePropagation())}function u(e,i){if(t.getColumns()[i.cell].id===a.columnId&&$$9(e.target).is(":checkbox")){if(t.getEditorLock().isActive()&&!t.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();p(i.row),e.stopPropagation(),e.stopImmediatePropagation()}}function p(e){var i=t.getDataItem(e);v(e,i,t)&&(r[e]?t.setSelectedRows($$9.grep(t.getSelectedRows(),(function(t){return t!=e}))):t.setSelectedRows(t.getSelectedRows().concat(e)),t.setActiveCell(e,function(){if(null===f){f=0;for(var e=t.getColumns(),i=0;i<e.length;i++)e[i].id==a.columnId&&(f=i)}return f}()))}function _(e,i){if(i.column.id==a.columnId&&$$9(e.target).is(":checkbox")){if(t.getEditorLock().isActive()&&!t.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();if($$9(e.target).is(":checked")){for(var n=[],o=0;o<t.getDataLength();o++){v(o,t.getDataItem(o),t)&&n.push(o)}t.setSelectedRows(n)}else t.setSelectedRows([]);e.stopPropagation(),e.stopImmediatePropagation()}}"function"==typeof a.selectableOverride&&y(a.selectableOverride);var f=null;function g(){return Math.round(1e7*Math.random())}function m(e,t,i,n,o,s){var a=g()+e;return o&&v(e,o,s)?r[e]?"<input id='selector"+a+"' type='checkbox' checked='checked'><label for='selector"+a+"'></label>":"<input id='selector"+a+"' type='checkbox'><label for='selector"+a+"'></label>":null}function v(e,t,n){return"function"!=typeof i||i(e,t,n)}function b(e){e?t.updateColumnHeader(a.columnId,"<input id='header-selector"+n+"' type='checkbox' checked='checked'><label for='header-selector"+n+"'></label>",a.toolTip):t.updateColumnHeader(a.columnId,"<input id='header-selector"+n+"' type='checkbox'><label for='header-selector"+n+"'></label>",a.toolTip)}function y(e){i=e}$$9.extend(this,{init:function(e){t=e,o.subscribe(t.onSelectedRowsChanged,d).subscribe(t.onClick,u).subscribe(t.onKeyDown,h),a.hideInFilterHeaderRow||function(e){e.onHeaderRowCellRendered.subscribe((function(e,t){"sel"===t.column.field&&($$9(t.node).empty(),$$9("<span id='filter-checkbox-selectall-container'><input id='header-filter-selector"+n+"' type='checkbox'><label for='header-filter-selector"+n+"'></label></span>").appendTo(t.node).on("click",(function(e){_(e,t)})))}))}(e),a.hideInColumnTitleRow||o.subscribe(t.onHeaderClick,_)},destroy:function(){o.unsubscribeAll()},pluginName:"CheckboxSelectColumn",deSelectRows:function(e){var i,n=e.length,o=[];for(i=0;i<n;i++)r[e[i]]&&(o[o.length]=e[i]);t.setSelectedRows($$9.grep(t.getSelectedRows(),(function(e){return o.indexOf(e)<0})))},selectRows:function(e){var i,n=e.length,o=[];for(i=0;i<n;i++)r[e[i]]||(o[o.length]=e[i]);t.setSelectedRows(t.getSelectedRows().concat(o))},getColumnDefinition:function(){return{id:a.columnId,name:a.hideSelectAllCheckbox||a.hideInColumnTitleRow?"":"<input id='header-selector"+n+"' type='checkbox'><label for='header-selector"+n+"'></label>",toolTip:a.hideSelectAllCheckbox||a.hideInColumnTitleRow?"":a.toolTip,field:"sel",width:a.width,resizable:!1,sortable:!1,cssClass:a.cssClass,hideSelectAllCheckbox:a.hideSelectAllCheckbox,formatter:m}},getOptions:function(){return a},selectableOverride:y,setOptions:function(e){if((a=$$9.extend(!0,{},a,e)).hideSelectAllCheckbox)l(),c();else if(a.hideInColumnTitleRow?l():(b(s),o.subscribe(t.onHeaderClick,_)),a.hideInFilterHeaderRow)c();else{var i=$$9("#filter-checkbox-selectall-container");i.show(),i.find('input[type="checkbox"]').prop("checked",s)}}})}var slick_checkboxselectcolumn={CheckboxSelectColumn:CheckboxSelectColumn},$$8=slick_jquery,Slick$5=slick_core,keyCodes=Slick$5.keyCode;function CellExternalCopyManager(e){var t,i,n=this,o=e||{},r=o.copiedCellStyleLayerKey||"copy-manager",s=o.copiedCellStyle||"copied",a=0,l=o.bodyElement||document.body,c=o.onCopyInit||null,d=o.onCopySuccess||null;function h(e){if(o.headerColumnValueExtractor){var t=o.headerColumnValueExtractor(e);if(t)return t}return e.name}function u(e,i,n){if(o.dataItemColumnValueExtractor){var r=o.dataItemColumnValueExtractor(e,i);if(r)return r}var s="";if(i.editor){var a={container:$$8("<p>"),column:i,position:{top:0,left:0},grid:t,event:n},l=new i.editor(a);l.loadValue(e),s=l.serializeValue(),l.destroy()}else s=e[i.field];return s}function p(e,i,n){if(i.denyPaste)return null;if(o.dataItemColumnValueSetter)return o.dataItemColumnValueSetter(e,i,n);if(i.editor){var r={container:$$8("body"),column:i,position:{top:0,left:0},grid:t},s=new i.editor(r);s.loadValue(e),s.applyValue(e,n),s.destroy()}else e[i.field]=n}function _(e){var t=document.createElement("textarea");return t.style.position="absolute",t.style.left="-1000px",t.style.top=document.body.scrollTop+"px",t.value=e,l.appendChild(t),t.select(),t}function f(e,r){var s;if(!t.getEditorLock().isActive()||t.getOptions().autoEdit){if(e.which==keyCodes.ESC&&i&&(e.preventDefault(),m(),n.onCopyCancelled.notify({ranges:i}),i=null),(e.which===keyCodes.C||e.which===keyCodes.INSERT)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&(c&&c.call(),0!==(s=t.getSelectionModel().getSelectedRanges()).length)){i=s,g(s),n.onCopyCells.notify({ranges:s});for(var a=t.getColumns(),f="",v=0;v<s.length;v++){for(var b=s[v],y=[],w=b.fromRow;w<b.toRow+1;w++){var A=[],x=t.getDataItem(w);if(0===y.length&&o.includeHeaderWhenCopying){for(var k=[],C=b.fromCell;C<b.toCell+1;C++)a[C].name.length>0&&k.push(h(a[C]));y.push(k.join("\t"))}for(C=b.fromCell;C<b.toCell+1;C++)A.push(u(x,a[C],e));y.push(A.join("\t"))}f+=y.join("\r\n")+"\r\n"}if(window.clipboardData)return window.clipboardData.setData("Text",f),!0;var S=document.activeElement;if((R=_(f)).focus(),setTimeout((function(){l.removeChild(R),S?S.focus():console.log("Not element to restore focus to after copy?")}),100),d){var T=0;T=1===s.length?s[0].toRow+1-s[0].fromRow:s.length,d.call(this,T)}return!1}if(!o.readOnlyMode&&(e.which===keyCodes.V&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.which===keyCodes.INSERT&&e.shiftKey&&!e.ctrlKey)){var R=_("");return setTimeout((function(){!function(e,t){var i=e.getColumns(),r=t.value.split(/[\n\f\r]/);""===r[r.length-1]&&r.pop();var s=[],a=0;l.removeChild(t);for(var c=0;c<r.length;c++)""!==r[c]?s[a++]=r[c].split("\t"):s[a++]=[""];var d=e.getActiveCell(),h=e.getSelectionModel().getSelectedRanges(),u=h&&h.length?h[0]:null,_=null,f=null;if(u)_=u.fromRow,f=u.fromCell;else{if(!d)return;_=d.row,f=d.cell}var m=!1,v=s.length,b=s.length?s[0].length:0;1==s.length&&1==s[0].length&&u&&(m=!0,v=u.toRow-u.fromRow+1,b=u.toCell-u.fromCell+1);var y=e.getData().length-_,w=0;if(y<v&&o.newRowCreator){var A=e.getData();for(w=1;w<=v-y;w++)A.push({});e.setData(A),e.render()}var x=_+v>e.getDataLength();if(o.newRowCreator&&x){var k=_+v-e.getDataLength();o.newRowCreator(k)}var C={isClipboardCommand:!0,clippedRange:s,oldValues:[],cellExternalCopyManager:n,_options:o,setDataItemValueForColumn:p,markCopySelection:g,oneCellToMultiple:m,activeRow:_,activeCell:f,destH:v,destW:b,maxDestY:e.getDataLength(),maxDestX:e.getColumns().length,h:0,w:0,execute:function(){this.h=0;for(var t=0;t<this.destH;t++){this.oldValues[t]=[],this.w=0,this.h++;for(var n=0;n<this.destW;n++){this.w++;var o=_+t,r=f+n;if(o<this.maxDestY&&r<this.maxDestX){e.getCellNode(o,r);var a=e.getDataItem(o);this.oldValues[t][n]=a[i[r].field],m?this.setDataItemValueForColumn(a,i[r],s[0][0]):this.setDataItemValueForColumn(a,i[r],s[t]?s[t][n]:""),e.updateCell(o,r),e.onCellChange.notify({row:o,cell:r,item:a,grid:e})}}}var l={fromCell:f,fromRow:_,toCell:f+this.w-1,toRow:_+this.h-1};this.markCopySelection([l]),e.getSelectionModel().setSelectedRanges([l]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[l]})},undo:function(){for(var t=0;t<this.destH;t++)for(var n=0;n<this.destW;n++){var o=_+t,r=f+n;if(o<this.maxDestY&&r<this.maxDestX){e.getCellNode(o,r);var s=e.getDataItem(o);m?this.setDataItemValueForColumn(s,i[r],this.oldValues[0][0]):this.setDataItemValueForColumn(s,i[r],this.oldValues[t][n]),e.updateCell(o,r),e.onCellChange.notify({row:o,cell:r,item:s,grid:e})}}var a={fromCell:f,fromRow:_,toCell:f+this.w-1,toRow:_+this.h-1};if(this.markCopySelection([a]),e.getSelectionModel().setSelectedRanges([a]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[a]}),w>1){for(var l=e.getData();w>1;w--)l.splice(l.length-1,1);e.setData(l),e.render()}}};o.clipboardCommandHandler?o.clipboardCommandHandler(C):C.execute()}(t,R)}),100),!1}}}function g(e){m();for(var i=t.getColumns(),o={},l=0;l<e.length;l++)for(var c=e[l].fromRow;c<=e[l].toRow;c++){o[c]={};for(var d=e[l].fromCell;d<=e[l].toCell&&d<i.length;d++)o[c][i[d].id]=s}t.setCellCssStyles(r,o),clearTimeout(a),a=setTimeout((function(){n.clearCopySelection()}),2e3)}function m(){t.removeCellCssStyles(r)}$$8.extend(this,{init:function(e){(t=e).onKeyDown.subscribe(f);var i=e.getSelectionModel();if(!i)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new Slick.CellSelectionModel())");i.onSelectedRangesChanged.subscribe((function(e,i){t.focus()}))},destroy:function(){t.onKeyDown.unsubscribe(f)},pluginName:"CellExternalCopyManager",clearCopySelection:m,handleKeyDown:f,onCopyCells:new Slick$5.Event,onCopyCancelled:new Slick$5.Event,onPasteCells:new Slick$5.Event,setIncludeHeaderWhenCopying:function(e){o.includeHeaderWhenCopying=e}})}var slick_cellexternalcopymanager={CellExternalCopyManager:CellExternalCopyManager},slickgrid={exports:{}},tslib={exports:{}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
!function(e){var t,i,n,o,r,s,a,l,c,d,h,u,p,_,f,g,m,v,b,y,w,A,x;!function(k){var C,S,T="object"==typeof commonjsGlobal?commonjsGlobal:"object"==typeof self?self:"object"==typeof this?this:{};function R(e,t){return e!==T&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(i,n){return e[i]=t?t(i,n):n}}C=R(T,R(e.exports)),S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},t=function(e,t){function i(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},i=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i},o=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},r=function(e,t){return function(i,n){t(i,n,e)}},s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{l(n.next(e))}catch(t){r(t)}}function a(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){e.done?i(e.value):o(e.value).then(s,a)}l((n=n.apply(e,t||[])).next())}))},l=function(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return l([e,t])}}function l(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(a){r=[6,a],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},x=function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]},c=function(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||(t[i]=e[i])},d=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},h=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,o,r=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return s},u=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e},p=function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],s=0,a=r.length;s<a;s++,o++)n[o]=r[s];return n},_=function(e){return this instanceof _?(this.v=e,this):new _(e)},f=function(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=i.apply(e,t||[]),r=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise((function(i,n){r.push([e,t,i,n])>1||a(e,t)}))})}function a(e,t){try{l(o[e](t))}catch(i){h(r[0][3],i)}}function l(e){e.value instanceof _?Promise.resolve(e.value.v).then(c,d):h(r[0][2],e)}function c(e){a("next",e)}function d(e){a("throw",e)}function h(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}},g=function(e){var t,i;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(i=!i)?{value:_(e[n](t)),done:"return"===n}:o?o(t):t}:o}},m=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=d(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){o(n,r,(t=e[i](t)).done,t.value)}))}}function o(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}},v=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t},y=function(e){return e&&e.__esModule?e:{default:e}},w=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},A=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,i),i},C("__extends",t),C("__assign",i),C("__rest",n),C("__decorate",o),C("__param",r),C("__metadata",s),C("__awaiter",a),C("__generator",l),C("__exportStar",c),C("__createBinding",x),C("__values",d),C("__read",h),C("__spread",u),C("__spreadArrays",p),C("__await",_),C("__asyncGenerator",f),C("__asyncDelegator",g),C("__asyncValues",m),C("__makeTemplateObject",v),C("__importStar",b),C("__importDefault",y),C("__classPrivateFieldGet",w),C("__classPrivateFieldSet",A)}()}(tslib);
/*!
 * jquery.event.drag - v 2.3.0
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
var $$7=slick_jquery;$$7.fn.drag=function(e,t,i){var n="string"==typeof e?e:"",o=$$7.isFunction(e)?e:$$7.isFunction(t)?t:null;return 0!==n.indexOf("drag")&&(n="drag"+n),i=(e==o?t:i)||{},o?this.on(n,i,o):this.trigger(n)};var $event$1=$$7.event,$special$1=$event$1.special,drag=$special$1.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(e){var t=$$7.data(this,drag.datakey),i=e.data||{};t.related+=1,$$7.each(drag.defaults,(function(e,n){void 0!==i[e]&&(t[e]=i[e])}))},remove:function(){$$7.data(this,drag.datakey).related-=1},setup:function(){if(!$$7.data(this,drag.datakey)){var e=$$7.extend({related:0},drag.defaults);$$7.data(this,drag.datakey,e),$event$1.add(this,"touchstart mousedown",drag.init,e),this.attachEvent&&this.attachEvent("ondragstart",drag.dontstart)}},teardown:function(){($$7.data(this,drag.datakey)||{}).related||($$7.removeData(this,drag.datakey),$event$1.remove(this,"touchstart mousedown",drag.init),drag.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",drag.dontstart))},init:function(e){if(!drag.touched){var t,i=e.data;if(!(0!=e.which&&i.which>0&&e.which!=i.which)){var n=$$7(e.target).attr("class")||"";if(!$$7(e.target).is(i.not)&&n&&-1!==n.toString().indexOf("slick")&&(!i.handle||$$7(e.target).closest(i.handle,e.currentTarget).length)&&(drag.touched="touchstart"==e.type?this:null,i.propagates=1,i.mousedown=this,i.interactions=[drag.interaction(this,i)],i.target=e.target,i.pageX=e.pageX,i.pageY=e.pageY,i.dragging=null,t=drag.hijack(e,"draginit",i),i.propagates))return(t=drag.flatten(t))&&t.length&&(i.interactions=[],$$7.each(t,(function(){i.interactions.push(drag.interaction(this,i))}))),i.propagates=i.interactions.length,!1!==i.drop&&$special$1.drop&&$special$1.drop.handler(e,i),drag.textselect(!1),drag.touched?$event$1.add(drag.touched,"touchmove touchend",drag.handler,i):$event$1.add(document,"mousemove mouseup",drag.handler,i),!(!drag.touched||i.live)&&void 0}}},interaction:function(e,t){var i=e&&e.ownerDocument&&$$7(e)[t.relative?"position":"offset"]()||{top:0,left:0};return{drag:e,callback:new drag.callback,droppable:[],offset:i}},handler:function(e){var t=e.data;switch(e.type){case!t.dragging&&"touchmove":e.preventDefault();case!t.dragging&&"mousemove":if(Math.pow(e.pageX-t.pageX,2)+Math.pow(e.pageY-t.pageY,2)<Math.pow(t.distance,2))break;e.target=t.target,drag.hijack(e,"dragstart",t),t.propagates&&(t.dragging=!0);case"touchmove":e.preventDefault();case"mousemove":if(t.dragging){if(drag.hijack(e,"drag",t),t.propagates){!1!==t.drop&&$special$1.drop&&$special$1.drop.handler(e,t);break}e.type="mouseup"}case"touchend":case"mouseup":default:drag.touched?$event$1.remove(drag.touched,"touchmove touchend",drag.handler):$event$1.remove(document,"mousemove mouseup",drag.handler),t.dragging&&(!1!==t.drop&&$special$1.drop&&$special$1.drop.handler(e,t),drag.hijack(e,"dragend",t)),drag.textselect(!0),!1===t.click&&t.dragging&&$$7.data(t.mousedown,"suppress.click",(new Date).getTime()+5),t.dragging=drag.touched=!1}},hijack:function(e,t,i,n,o){if(i){var r,s,a,l={event:e.originalEvent,type:e.type},c=t.indexOf("drop")?"drag":"drop",d=n||0,h=isNaN(n)?i.interactions.length:n;e.type=t;var u=function(){};e.originalEvent=new $$7.Event(l.event,{preventDefault:u,stopPropagation:u,stopImmediatePropagation:u}),i.results=[];do{if(s=i.interactions[d]){if("dragend"!==t&&s.cancelled)continue;a=drag.properties(e,i,s),s.results=[],$$7(o||s[c]||i.droppable).each((function(n,o){if(a.target=o,e.isPropagationStopped=function(){return!1},!1===(r=o?$event$1.dispatch.call(o,e,a):null)?("drag"==c&&(s.cancelled=!0,i.propagates-=1),"drop"==t&&(s[c][n]=null)):"dropinit"==t&&s.droppable.push(drag.element(r)||o),"dragstart"==t&&(s.proxy=$$7(drag.element(r)||s.drag)[0]),s.results.push(r),delete e.result,"dropinit"!==t)return r})),i.results[d]=drag.flatten(s.results),"dropinit"==t&&(s.droppable=drag.flatten(s.droppable)),"dragstart"!=t||s.cancelled||a.update()}}while(++d<h);return e.type=l.type,e.originalEvent=l.event,drag.flatten(i.results)}},properties:function(e,t,i){var n=i.callback;return n.drag=i.drag,n.proxy=i.proxy||i.drag,n.startX=t.pageX,n.startY=t.pageY,n.deltaX=e.pageX-t.pageX,n.deltaY=e.pageY-t.pageY,n.originalX=i.offset.left,n.originalY=i.offset.top,n.offsetX=n.originalX+n.deltaX,n.offsetY=n.originalY+n.deltaY,n.drop=drag.flatten((i.drop||[]).slice()),n.available=drag.flatten((i.droppable||[]).slice()),n},element:function(e){if(e&&(e.jquery||1==e.nodeType))return e},flatten:function(e){return $$7.map(e,(function(e){return e&&e.jquery?$$7.makeArray(e):e&&e.length?drag.flatten(e):e}))},textselect:function(e){$$7(document)[e?"off":"on"]("selectstart",drag.dontstart).css("MozUserSelect",e?"":"none"),document.unselectable=e?"off":"on"},dontstart:function(){return!1},callback:function(){}};drag.callback.prototype={update:function(){$special$1.drop&&this.available.length&&$$7.each(this.available,(function(e){$special$1.drop.locate(this,e)}))}};var $dispatch=$event$1.dispatch;$event$1.dispatch=function(e){if(!($$7.data(this,"suppress."+e.type)-(new Date).getTime()>0))return $dispatch.apply(this,arguments);$$7.removeData(this,"suppress."+e.type)},$special$1.draginit=$special$1.dragstart=$special$1.dragend=drag;
/*!
 * jquery.event.drop - v 2.3.0
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
var $$6=slick_jquery;$$6.fn.drop=function(e,t,i){var n="string"==typeof e?e:"",o=$$6.isFunction(e)?e:$$6.isFunction(t)?t:null;return 0!==n.indexOf("drop")&&(n="drop"+n),i=(e==o?t:i)||{},o?this.on(n,i,o):this.trigger(n)},$$6.drop=function(e){e=e||{},drop.multi=!0===e.multi?1/0:!1===e.multi?1:isNaN(e.multi)?drop.multi:e.multi,drop.delay=e.delay||drop.delay,drop.tolerance=$$6.isFunction(e.tolerance)?e.tolerance:null===e.tolerance?null:drop.tolerance,drop.mode=e.mode||drop.mode||"intersect"};var $event=$$6.event,$special=$event.special,drop=$$6.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(e){$$6.data(this,drop.datakey).related+=1},remove:function(){$$6.data(this,drop.datakey).related-=1},setup:function(){if(!$$6.data(this,drop.datakey)){$$6.data(this,drop.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}}),drop.targets.push(this)}},teardown:function(){if(!($$6.data(this,drop.datakey)||{}).related){$$6.removeData(this,drop.datakey);var e=this;drop.targets=$$6.grep(drop.targets,(function(t){return t!==e}))}},handler:function(e,t){var i;if(t)switch(e.type){case"mousedown":case"touchstart":i=$$6(drop.targets),"string"==typeof t.drop&&(i=i.filter(t.drop)),i.each((function(){var e=$$6.data(this,drop.datakey);e.active=[],e.anyactive=0,e.winner=0})),t.droppable=i,$special.drag.hijack(e,"dropinit",t);break;case"mousemove":case"touchmove":drop.event=e,drop.timer||drop.tolerate(t);break;case"mouseup":case"touchend":drop.timer=clearTimeout(drop.timer),t.propagates&&($special.drag.hijack(e,"drop",t),$special.drag.hijack(e,"dropend",t))}},locate:function(e,t){var i=$$6.data(e,drop.datakey),n=$$6(e),o=n.length&&!n.is(document)?n.offset():{},r=n.outerHeight(),s=n.outerWidth(),a={elem:e,width:s,height:r,top:o.top,left:o.left,right:o.left+s,bottom:o.top+r};return i&&(i.location=a,i.index=t,i.elem=e),a},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,i){return this.contains(i,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,i){return Math.max(0,Math.min(i.bottom,t.bottom)-Math.max(i.top,t.top))*Math.max(0,Math.min(i.right,t.right)-Math.max(i.left,t.left))},fit:function(e,t,i){return this.contains(i,t)?1:0},middle:function(e,t,i){return this.contains(i,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(e){var t,i,n,o,r,s,a,l,c=0,d=e.interactions.length,h=[drop.event.pageX,drop.event.pageY],u=drop.tolerance||drop.modes[drop.mode];do{if(l=e.interactions[c]){if(!l)return;l.drop=[],r=[],s=l.droppable.length,u&&(n=drop.locate(l.proxy)),t=0;do{if(a=l.droppable[t]){if(!(i=(o=$$6.data(a,drop.datakey)).location))continue;o.winner=u?u.call(drop,drop.event,n,i):drop.contains(i,h)?1:0,r.push(o)}}while(++t<s);r.sort(drop.sort),t=0;do{(o=r[t])&&(o.winner&&l.drop.length<drop.multi?(o.active[c]||o.anyactive||(!1!==$special.drag.hijack(drop.event,"dropstart",e,c,o.elem)[0]?(o.active[c]=1,o.anyactive+=1):o.winner=0),o.winner&&l.drop.push(o.elem)):o.active[c]&&1==o.anyactive&&($special.drag.hijack(drop.event,"dropend",e,c,o.elem),o.active[c]=0,o.anyactive-=1))}while(++t<s)}}while(++c<d);drop.last&&h[0]==drop.last.pageX&&h[1]==drop.last.pageY?delete drop.timer:drop.timer=setTimeout((function(){drop.tolerate(e)}),drop.delay),drop.last=drop.event}};$special.dropinit=$special.dropstart=$special.dropend=drop;
/**
 * @license
 * (c) 2009-2016 Michael Leibman
 * michael{dot}leibman{at}gmail{dot}com
 * http://github.com/mleibman/slickgrid
 *
 * Distributed under MIT license.
 * All rights reserved.
 *
 * SlickGrid v2.4
 *
 * NOTES:
 *     Cell/row DOM manipulations are done directly bypassing jQuery's DOM manipulation methods.
 *     This increases the speed dramatically, but can only be done safely because there are no event handlers
 *     or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()
 *     and do proper cleanup.
 */
var $$5=slick_jquery,Slick$4=slick_core,scrollbarDimensions,maxSupportedCssHeight;function SlickGrid(container,data,columns,options){$$5.fn.drag,$$5.fn.drop;var defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:Slick$4.GlobalEditorLock,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0,viewportClass:null,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,doPaging:!0,autosizeColsMode:Slick$4.GridAutosizeColsMode.LegacyOff,autosizeColPaddingPx:4,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},columnAutosizeDefaults={ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:Slick$4.ColAutosizeMode.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:Slick$4.RowSelectionMode.FirstNRows,rowSelectionCount:100,valueFilterMode:Slick$4.ValueFilterMode.None,widthEvalMode:Slick$4.WidthEvalMode.CanvasTextSize,sizeToRemaining:void 0,widthPx:void 0,colDataTypeOf:void 0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacerL,$headerRowSpacerR,$footerRow,$footerRowScroller,$footerRowSpacerL,$footerRowSpacerR,$preHeaderPanel,$preHeaderPanelScroller,$preHeaderPanelSpacer,$preHeaderPanelR,$preHeaderPanelScrollerR,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,treeColumns,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,canvasWidthL,canvasWidthR,headersWidth,headersWidthL,headersWidthR,viewportHasHScroll,viewportHasVScroll;$$5();var headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=!1,absoluteColumnMinWidth,hasFrozenRows=!1,frozenRowsHeight=0,actualFrozenRow=-1,paneTopH=0,paneBottomH=0,viewportTopH=0,topPanelH=0,headerRowH=0,footerRowH=0,tabbingDirection=1,$activeCanvasNode,$activeViewportNode,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows=0,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],pagingActive=!1,pagingIsLastPage=!1,scrollThrottle=ActionThrottle(render,50),h_editorLoader=null,h_postrender=null,h_postrenderCleanup=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,postProcessedCleanupQueue=[],counter_rows_rendered=0,counter_rows_removed=0,rowNodeFromLastMouseWheelEvent,zombieRowNodeFromLastMouseWheelEvent,$paneHeaderL,$paneHeaderR,$paneTopL,$paneTopR,$paneBottomL,$paneBottomR,$headerScrollerL,$headerScrollerR,$headerL,$headerR,$groupHeadersL,$groupHeadersR,$headerRowScrollerL,$headerRowScrollerR,$footerRowScrollerL,$footerRowScrollerR,$headerRowL,$headerRowR,$footerRowL,$footerRowR,$topPanelScrollerL,$topPanelScrollerR,$topPanelL,$topPanelR,$viewportTopL,$viewportTopR,$viewportBottomL,$viewportBottomR,$canvasTopL,$canvasTopR,$canvasBottomL,$canvasBottomR,$viewportScrollContainerX,$viewportScrollContainerY,$headerScrollContainer,$headerRowScrollContainer,$footerRowScrollContainer,cssShow={position:"absolute",visibility:"hidden",display:"block"},$hiddenParents,oldProps=[],columnResizeDragging=!1;function init(){if(($container=container instanceof $$5?container:$$5(container)).length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");if(cacheCssForHiddenInit(),maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),options=$$5.extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,treeColumns=new Slick$4.TreeColumns(columns),columns=treeColumns.extractColumns(),updateColumnProps(),options.enableColumnReorder&&!$$5.fn.sortable)throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");if(editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=$$5("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),$paneHeaderL=$$5("<div class='slick-pane slick-pane-header slick-pane-left' tabIndex='0' />").appendTo($container),$paneHeaderR=$$5("<div class='slick-pane slick-pane-header slick-pane-right' tabIndex='0' />").appendTo($container),$paneTopL=$$5("<div class='slick-pane slick-pane-top slick-pane-left' tabIndex='0' />").appendTo($container),$paneTopR=$$5("<div class='slick-pane slick-pane-top slick-pane-right' tabIndex='0' />").appendTo($container),$paneBottomL=$$5("<div class='slick-pane slick-pane-bottom slick-pane-left' tabIndex='0' />").appendTo($container),$paneBottomR=$$5("<div class='slick-pane slick-pane-bottom slick-pane-right' tabIndex='0' />").appendTo($container),options.createPreHeaderPanel&&($preHeaderPanelScroller=$$5("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderL),$preHeaderPanel=$$5("<div />").appendTo($preHeaderPanelScroller),$preHeaderPanelSpacer=$$5("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScroller),$preHeaderPanelScrollerR=$$5("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderR),$preHeaderPanelR=$$5("<div />").appendTo($preHeaderPanelScrollerR),$$5("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScrollerR),options.showPreHeaderPanel||($preHeaderPanelScroller.hide(),$preHeaderPanelScrollerR.hide())),$headerScrollerL=$$5("<div class='slick-header ui-state-default slick-header-left' />").appendTo($paneHeaderL),$headerScrollerR=$$5("<div class='slick-header ui-state-default slick-header-right' />").appendTo($paneHeaderR),$headerScroller=$$5().add($headerScrollerL).add($headerScrollerR),treeColumns.hasDepth()){$groupHeadersL=[],$groupHeadersR=[];for(var e=0;e<treeColumns.getDepth()-1;e++)$groupHeadersL[e]=$$5("<div class='slick-group-header-columns slick-group-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL),$groupHeadersR[e]=$$5("<div class='slick-group-header-columns slick-group-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR);$$5().add($groupHeadersL).add($groupHeadersR)}$headerL=$$5("<div class='slick-header-columns slick-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL),$headerR=$$5("<div class='slick-header-columns slick-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR),$headers=$$5().add($headerL).add($headerR),$headerRowScrollerL=$$5("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopL),$headerRowScrollerR=$$5("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopR),$headerRowScroller=$$5().add($headerRowScrollerL).add($headerRowScrollerR),$headerRowSpacerL=$$5("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerL),$headerRowSpacerR=$$5("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerR),$headerRowL=$$5("<div class='slick-headerrow-columns slick-headerrow-columns-left' />").appendTo($headerRowScrollerL),$headerRowR=$$5("<div class='slick-headerrow-columns slick-headerrow-columns-right' />").appendTo($headerRowScrollerR),$headerRow=$$5().add($headerRowL).add($headerRowR),$topPanelScrollerL=$$5("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopL),$topPanelScrollerR=$$5("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopR),$topPanelScroller=$$5().add($topPanelScrollerL).add($topPanelScrollerR),$topPanelL=$$5("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerL),$topPanelR=$$5("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerR),$topPanel=$$5().add($topPanelL).add($topPanelR),options.showColumnHeader||$headerScroller.hide(),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewportTopL=$$5("<div class='slick-viewport slick-viewport-top slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneTopL),$viewportTopR=$$5("<div class='slick-viewport slick-viewport-top slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneTopR),$viewportBottomL=$$5("<div class='slick-viewport slick-viewport-bottom slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneBottomL),$viewportBottomR=$$5("<div class='slick-viewport slick-viewport-bottom slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneBottomR),$viewport=$$5().add($viewportTopL).add($viewportTopR).add($viewportBottomL).add($viewportBottomR),$activeViewportNode=$viewportTopL,$canvasTopL=$$5("<div class='grid-canvas grid-canvas-top grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportTopL),$canvasTopR=$$5("<div class='grid-canvas grid-canvas-top grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportTopR),$canvasBottomL=$$5("<div class='grid-canvas grid-canvas-bottom grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportBottomL),$canvasBottomR=$$5("<div class='grid-canvas grid-canvas-bottom grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportBottomR),options.viewportClass&&$viewport.toggleClass(options.viewportClass,!0),$canvas=$$5().add($canvasTopL).add($canvasTopR).add($canvasBottomL).add($canvasBottomR),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),$activeCanvasNode=$canvasTopL,$preHeaderPanelSpacer&&$preHeaderPanelSpacer.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headers.width(getHeadersWidth()),$headerRowSpacerL.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headerRowSpacerR.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),options.createFooterRow&&($footerRowScrollerR=$$5("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopR),$footerRowScrollerL=$$5("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopL),$footerRowScroller=$$5().add($footerRowScrollerL).add($footerRowScrollerR),$footerRowSpacerL=$$5("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerL),$footerRowSpacerR=$$5("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerR),$footerRowL=$$5("<div class='slick-footerrow-columns slick-footerrow-columns-left' />").appendTo($footerRowScrollerL),$footerRowR=$$5("<div class='slick-footerrow-columns slick-footerrow-columns-right' />").appendTo($footerRowScrollerR),$footerRow=$$5().add($footerRowL).add($footerRowR),options.showFooterRow||$footerRowScroller.hide()),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,getViewportWidth(),getViewportHeight(),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.on("selectstart.ui",(function(e){return $$5(e.target).is("input,textarea")})),setFrozenOptions(),setPaneVisibility(),setScroller(),setOverflow(),updateColumnCaches(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.on("resize.slickgrid",resizeCanvas),$viewport.on("scroll",handleScroll),$$5.fn.mousewheel&&$viewport.on("mousewheel",handleMouseWheel),$headerScroller.on("contextmenu",handleHeaderContextMenu).on("click",handleHeaderClick).on("mouseenter",".slick-header-column",handleHeaderMouseEnter).on("mouseleave",".slick-header-column",handleHeaderMouseLeave),$headerRowScroller.on("scroll",handleHeaderRowScroll),options.createFooterRow&&($footerRow.on("contextmenu",handleFooterContextMenu).on("click",handleFooterClick),$footerRowScroller.on("scroll",handleFooterRowScroll)),options.createPreHeaderPanel&&$preHeaderPanelScroller.on("scroll",handlePreHeaderPanelScroll),$focusSink.add($focusSink2).on("keydown",handleKeyDown),$canvas.on("keydown",handleKeyDown).on("click",handleClick).on("dblclick",handleDblClick).on("contextmenu",handleContextMenu).on("draginit",handleDragInit).on("dragstart",{distance:3},handleDragStart).on("drag",handleDrag).on("dragend",handleDragEnd).on("mouseenter",".slick-cell",handleMouseEnter).on("mouseleave",".slick-cell",handleMouseLeave),restoreCssFromHiddenInit())}function cacheCssForHiddenInit(){($hiddenParents=$container.parents().addBack().not(":visible")).each((function(){var e={};for(var t in cssShow)e[t]=this.style[t],this.style[t]=cssShow[t];oldProps.push(e)}))}function restoreCssFromHiddenInit(){$hiddenParents.each((function(e){var t=oldProps[e];for(var i in cssShow)this.style[i]=t[i]}))}function hasFrozenColumns(){return options.frozenColumn>-1}function registerPlugin(e){plugins.unshift(e),e.init(self)}function unregisterPlugin(e){for(var t=plugins.length;t>=0;t--)if(plugins[t]===e){plugins[t].destroy&&plugins[t].destroy(),plugins.splice(t,1);break}}function getPluginByName(e){for(var t=plugins.length-1;t>=0;t--)if(plugins[t].pluginName===e)return plugins[t]}function setSelectionModel(e){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),(selectionModel=e)&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(e,t){e||(e=0),t||(t=0);var i="number"==typeof e?e:getColumnIndex(e);return hasFrozenRows&&t>=actualFrozenRow+(options.frozenBottom?0:1)?hasFrozenColumns()&&i>options.frozenColumn?$canvasBottomR[0]:$canvasBottomL[0]:hasFrozenColumns()&&i>options.frozenColumn?$canvasTopR[0]:$canvasTopL[0]}function getActiveCanvasNode(e){return setActiveCanvasNode(e),$activeCanvasNode[0]}function getCanvases(){return $canvas}function setActiveCanvasNode(e){e&&($activeCanvasNode=$$5(e.target).closest(".grid-canvas"))}function getViewportNode(){return $viewport[0]}function getActiveViewportNode(e){return setActiveViewPortNode(e),$activeViewportNode[0]}function setActiveViewportNode(e){e&&($activeViewportNode=$$5(e.target).closest(".slick-viewport"))}function measureScrollbar(){var e=$$5('<div class="'+$viewport.className+'" style="position:absolute; top:-10000px; left:-10000px; overflow:auto; width:100px; height:100px;"></div>').appendTo("body"),t=$$5('<div style="width:200px; height:200px; overflow:auto;"></div>').appendTo(e),i={width:e[0].offsetWidth-e[0].clientWidth,height:e[0].offsetHeight-e[0].clientHeight};return t.remove(),e.remove(),i}function getHeadersWidth(){headersWidth=headersWidthL=headersWidthR=0;for(var e=!options.autoHeight,t=0,i=columns.length;t<i;t++){var n=columns[t].width;options.frozenColumn>-1&&t>options.frozenColumn?headersWidthR+=n:headersWidthL+=n}return e&&(options.frozenColumn>-1&&t>options.frozenColumn?headersWidthR+=scrollbarDimensions.width:headersWidthL+=scrollbarDimensions.width),hasFrozenColumns()?(headersWidthL+=1e3,headersWidthR=Math.max(headersWidthR,viewportW)+headersWidthL,headersWidthR+=scrollbarDimensions.width):(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidth=headersWidthL+headersWidthR,Math.max(headersWidth,viewportW)+1e3}function getHeadersWidthL(){return headersWidthL=0,columns.forEach((function(e,t){options.frozenColumn>-1&&t>options.frozenColumn||(headersWidthL+=e.width)})),hasFrozenColumns()?headersWidthL+=1e3:(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidthL}function getHeadersWidthR(){return headersWidthR=0,columns.forEach((function(e,t){options.frozenColumn>-1&&t>options.frozenColumn&&(headersWidthR+=e.width)})),hasFrozenColumns()&&(headersWidthR=Math.max(headersWidthR,viewportW)+getHeadersWidthL(),headersWidthR+=scrollbarDimensions.width),headersWidthR}function getCanvasWidth(){var e=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,t=columns.length;for(canvasWidthL=canvasWidthR=0;t--;)hasFrozenColumns()&&t>options.frozenColumn?canvasWidthR+=columns[t].width:canvasWidthL+=columns[t].width;var i=canvasWidthL+canvasWidthR;return options.fullWidthRows?Math.max(i,e):i}function updateCanvasWidth(e){var t,i=canvasWidth,n=canvasWidthL,o=canvasWidthR;((t=(canvasWidth=getCanvasWidth())!==i||canvasWidthL!==n||canvasWidthR!==o)||hasFrozenColumns()||hasFrozenRows)&&($canvasTopL.width(canvasWidthL),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),hasFrozenColumns()?($canvasTopR.width(canvasWidthR),$paneHeaderL.width(canvasWidthL),$paneHeaderR.css("left",canvasWidthL),$paneHeaderR.css("width",viewportW-canvasWidthL),$paneTopL.width(canvasWidthL),$paneTopR.css("left",canvasWidthL),$paneTopR.css("width",viewportW-canvasWidthL),$headerRowScrollerL.width(canvasWidthL),$headerRowScrollerR.width(viewportW-canvasWidthL),$headerRowL.width(canvasWidthL),$headerRowR.width(canvasWidthR),options.createFooterRow&&($footerRowScrollerL.width(canvasWidthL),$footerRowScrollerR.width(viewportW-canvasWidthL),$footerRowL.width(canvasWidthL),$footerRowR.width(canvasWidthR)),options.createPreHeaderPanel&&$preHeaderPanel.width(canvasWidth),$viewportTopL.width(canvasWidthL),$viewportTopR.width(viewportW-canvasWidthL),hasFrozenRows&&($paneBottomL.width(canvasWidthL),$paneBottomR.css("left",canvasWidthL),$viewportBottomL.width(canvasWidthL),$viewportBottomR.width(viewportW-canvasWidthL),$canvasBottomL.width(canvasWidthL),$canvasBottomR.width(canvasWidthR))):($paneHeaderL.width("100%"),$paneTopL.width("100%"),$headerRowScrollerL.width("100%"),$headerRowL.width(canvasWidth),options.createFooterRow&&($footerRowScrollerL.width("100%"),$footerRowL.width(canvasWidth)),options.createPreHeaderPanel&&($preHeaderPanel.width("100%"),$preHeaderPanel.width(canvasWidth)),$viewportTopL.width("100%"),hasFrozenRows&&($viewportBottomL.width("100%"),$canvasBottomL.width(canvasWidthL))),viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width),$headerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$headerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),options.createFooterRow&&($footerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$footerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0))),(t||e)&&applyColumnWidths()}function disableSelection(e){e&&e.jquery&&e.attr("unselectable","on").css("MozUserSelect","none").on("selectstart.ui",(function(){return!1}))}function getMaxSupportedCssHeight(){for(var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,i=$$5("<div style='display:none' />").appendTo(document.body);;){var n=2*e;if(i.css("height",n),n>t||i.height()!==n)break;e=n}return i.remove(),e}function getUID(){return uid}function getHeaderColumnWidthDiff(){return headerColumnWidthDiff}function getScrollbarDimensions(){return scrollbarDimensions}function bindAncestorScrollEvents(){for(var e=hasFrozenRows&&!options.frozenBottom?$canvasBottomL[0]:$canvasTopL[0];(e=e.parentNode)!=document.body&&null!=e;)if(e==$viewportTopL[0]||e.scrollWidth!=e.clientWidth||e.scrollHeight!=e.clientHeight){var t=$$5(e);$boundAncestors=$boundAncestors?$boundAncestors.add(t):t,t.on("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.off("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(e,t,i){if(initialized){var n=getColumnIndex(e);if(null!=n){var o=columns[n],r=$headers.children().eq(n);r&&(void 0!==t&&(columns[n].name=t),void 0!==i&&(columns[n].toolTip=i),trigger(self.onBeforeHeaderCellDestroy,{node:r[0],column:o,grid:self}),r.attr("title",i||"").children().eq(0).html(t),trigger(self.onHeaderCellRendered,{node:r[0],column:o,grid:self}))}}}function getHeader(e){if(!e)return hasFrozenColumns()?$headers:$headerL;var t=getColumnIndex(e.id);return hasFrozenColumns()?t<=options.frozenColumn?$headerL:$headerR:$headerL}function getHeaderColumn(e){var t="number"==typeof e?e:getColumnIndex(e),i=hasFrozenColumns()?t<=options.frozenColumn?$headerL:$headerR:$headerL,n=hasFrozenColumns()?t<=options.frozenColumn?t:t-options.frozenColumn-1:t,o=i.children().eq(n);return o&&o[0]}function getHeaderRow(){return hasFrozenColumns()?$headerRow:$headerRow[0]}function getFooterRow(){return hasFrozenColumns()?$footerRow:$footerRow[0]}function getPreHeaderPanel(){return $preHeaderPanel[0]}function getPreHeaderPanelRight(){return $preHeaderPanelR[0]}function getHeaderRowColumn(e){var t,i="number"==typeof e?e:getColumnIndex(e);hasFrozenColumns()?i<=options.frozenColumn?t=$headerRowL:(t=$headerRowR,i-=options.frozenColumn+1):t=$headerRowL;var n=t.children().eq(i);return n&&n[0]}function getFooterRowColumn(e){var t,i="number"==typeof e?e:getColumnIndex(e);hasFrozenColumns()?i<=options.frozenColumn?t=$footerRowL:(t=$footerRowR,i-=options.frozenColumn+1):t=$footerRowL;var n=t&&t.children().eq(i);return n&&n[0]}function createColumnFooter(){if(options.createFooterRow){$footerRow.find(".slick-footerrow-column").each((function(){var e=$$5(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowL.empty(),$footerRowR.empty();for(var e=0;e<columns.length;e++){var t=columns[e],i=$$5("<div class='ui-state-default slick-footerrow-column l"+e+" r"+e+"'></div>").data("column",t).addClass(hasFrozenColumns()&&e<=options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e>options.frozenColumn?$footerRowR:$footerRowL);trigger(self.onFooterRowCellRendered,{node:i[0],column:t,grid:self})}}}function createColumnGroupHeaders(){var e=0,t=!1;if(treeColumns.hasDepth()){for(var i=0;i<$groupHeadersL.length;i++){$groupHeadersL[i].empty(),$groupHeadersR[i].empty();var n=treeColumns.getColumnsInDepth(i);for(var o in n){var r=n[o];e+=r.extractColumns().length,hasFrozenColumns()&&0===i&&e-1===options.frozenColumn&&(t=!0),$$5("<div class='ui-state-default slick-group-header-column' />").html("<span class='slick-column-name'>"+r.name+"</span>").attr("id",""+uid+r.id).attr("title",r.toolTip||"").data("column",r).addClass(r.headerCssClass||"").addClass(hasFrozenColumns()&&e-1>options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e-1>options.frozenColumn?$groupHeadersR[i]:$groupHeadersL[i])}if(hasFrozenColumns()&&0===i&&!t){$groupHeadersL[i].empty(),$groupHeadersR[i].empty(),alert("All columns of group should to be grouped!");break}}applyColumnGroupHeaderWidths()}}function createColumnHeaders(){function e(){$$5(this).addClass("ui-state-hover")}function t(){$$5(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each((function(){var e=$$5(this).data("column");e&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:e,grid:self})})),$headerL.empty(),$headerR.empty(),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),$headerRow.find(".slick-headerrow-column").each((function(){var e=$$5(this).data("column");e&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:e,grid:self})})),$headerRowL.empty(),$headerRowR.empty(),options.createFooterRow&&($footerRowL.find(".slick-footerrow-column").each((function(){var e=$$5(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowL.empty(),hasFrozenColumns()&&($footerRowR.find(".slick-footerrow-column").each((function(){var e=$$5(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowR.empty()));for(var i=0;i<columns.length;i++){var n=columns[i],o=hasFrozenColumns()?i<=options.frozenColumn?$headerL:$headerR:$headerL,r=hasFrozenColumns()?i<=options.frozenColumn?$headerRowL:$headerRowR:$headerRowL,s=$$5("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+n.name+"</span>").width(n.width-headerColumnWidthDiff).attr("id",""+uid+n.id).attr("title",n.toolTip||"").data("column",n).addClass(n.headerCssClass||"").addClass(hasFrozenColumns()&&i<=options.frozenColumn?"frozen":"").appendTo(o);if((options.enableColumnReorder||n.sortable)&&s.on("mouseenter",e).on("mouseleave",t),n.hasOwnProperty("headerCellAttrs")&&n.headerCellAttrs instanceof Object)for(var a in n.headerCellAttrs)n.headerCellAttrs.hasOwnProperty(a)&&s.attr(a,n.headerCellAttrs[a]);if(n.sortable&&(s.addClass("slick-header-sortable"),s.append("<span class='slick-sort-indicator"+(options.numberedMultiColumnSort&&!options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")+"' />"),options.numberedMultiColumnSort&&options.sortColNumberInSeparateSpan&&s.append("<span class='slick-sort-indicator-numbered' />")),trigger(self.onHeaderCellRendered,{node:s[0],column:n,grid:self}),options.showHeaderRow){var l=$$5("<div class='ui-state-default slick-headerrow-column l"+i+" r"+i+"'></div>").data("column",n).addClass(hasFrozenColumns()&&i<=options.frozenColumn?"frozen":"").appendTo(r);trigger(self.onHeaderRowCellRendered,{node:l[0],column:n,grid:self})}if(options.createFooterRow&&options.showFooterRow){var c=$$5("<div class='ui-state-default slick-footerrow-column l"+i+" r"+i+"'></div>").data("column",n).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:c[0],column:n,grid:self})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&("function"==typeof options.enableColumnReorder?options.enableColumnReorder(self,$headers,headerColumnWidthDiff,setColumns,setupColumnResize,columns,getColumnIndex,uid,trigger):setupColumnReorder())}function setupColumnSort(){$headers.click((function(e){if(!columnResizeDragging&&(e.metaKey=e.metaKey||e.ctrlKey,!$$5(e.target).hasClass("slick-resizable-handle"))){var t=$$5(e.target).closest(".slick-header-column");if(t.length){var i=t.data("column");if(i.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var n=null,o=0;o<sortColumns.length;o++)if(sortColumns[o].columnId==i.id){(n=sortColumns[o]).sortAsc=!n.sortAsc;break}var r=!!n;options.tristateMultiColumnSort?(n||(n={columnId:i.id,sortAsc:i.defaultSortAsc}),r&&n.sortAsc&&(sortColumns.splice(o,1),n=null),options.multiColumnSort||(sortColumns=[]),!n||r&&options.multiColumnSort||sortColumns.push(n)):e.metaKey&&options.multiColumnSort?n&&sortColumns.splice(o,1):((e.shiftKey||e.metaKey)&&options.multiColumnSort||(sortColumns=[]),n?0===sortColumns.length&&sortColumns.push(n):(n={columnId:i.id,sortAsc:i.defaultSortAsc},sortColumns.push(n))),setSortColumns(sortColumns),options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:$$5.map(sortColumns,(function(e){return{columnId:columns[getColumnIndex(e.columnId)].id,sortCol:columns[getColumnIndex(e.columnId)],sortAsc:e.sortAsc}}))},e):trigger(self.onSort,{multiColumnSort:!1,columnId:sortColumns.length>0?i.id:null,sortCol:sortColumns.length>0?i:null,sortAsc:!(sortColumns.length>0)||sortColumns[0].sortAsc},e)}}}}))}function currentPositionInHeader(e){var t=0;return $headers.find(".slick-header-column").each((function(i){if(this.id==e)return t=i,!1})),t}function limitPositionInGroup(e){var t,i=0,n=0;return treeColumns.getColumnsInDepth($groupHeadersL.length-1).some((function(o){return i=n,n+=o.columns.length,o.columns.some((function(i){return i.id===e&&(t=o),t})),t})),n--,{start:i,end:n,group:t}}function columnPositionValidInGroup(e){var t=currentPositionInHeader(e[0].id),i=limitPositionInGroup(e.data("column").id),n=i.start<=t&&t<=i.end;return{limit:i,valid:n,message:n?"":'Column "'.concat(e.text(),'" can be reordered only within the "',i.group.name,'" group!')}}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy");var e,t=null;function i(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft+10}function n(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft-10}$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",start:function(t,i){i.placeholder.width(i.helper.outerWidth()-headerColumnWidthDiff),e=!hasFrozenColumns()||i.placeholder.offset().left+i.placeholder.width()>$viewportScrollContainerX.offset().left,$$5(i.helper).addClass("slick-header-column-active")},beforeStop:function(e,t){$$5(t.helper).removeClass("slick-header-column-active")},sort:function(o,r){e&&o.originalEvent.pageX>$container[0].clientWidth?t||(t=setInterval(i,100)):e&&o.originalEvent.pageX<$viewportScrollContainerX.offset().left?t||(t=setInterval(n,100)):(clearInterval(t),t=null)},stop:function(e,i){var n=!1;clearInterval(t),t=null;var o=null;if(treeColumns.hasDepth()){var r=columnPositionValidInGroup(i.item);o=r.limit,(n=!r.valid)&&alert(r.message)}if(!n&&getEditorLock().commitCurrentEdit()){var s=$headerL.sortable("toArray");s=s.concat($headerR.sortable("toArray"));for(var a=[],l=0;l<s.length;l++)a.push(columns[getColumnIndex(s[l].replace(uid,""))]);setColumns(a),trigger(self.onColumnsReordered,{impactedColumns:getImpactedColumns(o)}),e.stopPropagation(),setupColumnResize()}else $$5(this).sortable("cancel")}})}function getImpactedColumns(e){var t=[];if(e)for(var i=e.start;i<=e.end;i++)t.push(columns[i]);else t=columns;return t}function setupColumnResize(){var e,t,i,n,o,r,s,a,l;(o=$headers.children()).find(".slick-resizable-handle").remove(),o.each((function(e,t){e>=columns.length||columns[e].resizable&&(void 0===a&&(a=e),l=e)})),void 0!==a&&o.each((function(c,d){c>=columns.length||c<a||options.forceFitColumns&&c>=l||($$5(d),$$5("<div class='slick-resizable-handle' />").appendTo(d).on("dragstart",(function(t,a){if(!getEditorLock().commitCurrentEdit())return!1;n=t.pageX,$$5(this).parent().addClass("slick-header-column-active");var l=null,d=null;if(o.each((function(e,t){e>=columns.length||(columns[e].previousWidth=$$5(t).outerWidth())})),options.forceFitColumns)for(l=0,d=0,e=c+1;e<columns.length;e++)(i=columns[e]).resizable&&(null!==d&&(i.maxWidth?d+=i.maxWidth-i.previousWidth:d=null),l+=i.previousWidth-Math.max(i.minWidth||0,absoluteColumnMinWidth));var h=0,u=0;for(e=0;e<=c;e++)(i=columns[e]).resizable&&(null!==u&&(i.maxWidth?u+=i.maxWidth-i.previousWidth:u=null),h+=i.previousWidth-Math.max(i.minWidth||0,absoluteColumnMinWidth));null===l&&(l=1e5),null===h&&(h=1e5),null===d&&(d=1e5),null===u&&(u=1e5),s=n+Math.min(l,u),r=n-Math.min(h,d)})).on("drag",(function(o,a){columnResizeDragging=!0;var l,d,h=Math.min(s,Math.max(r,o.pageX))-n,u=0;if(h<0){for(d=h,e=c;e>=0;e--)(i=columns[e]).resizable&&(l=Math.max(i.minWidth||0,absoluteColumnMinWidth),d&&i.previousWidth+d<l?(d+=i.previousWidth-l,i.width=l):(i.width=i.previousWidth+d,d=0));for(t=0;t<=c;t++)i=columns[t],hasFrozenColumns()&&t>options.frozenColumn?i.width:u+=i.width;if(options.forceFitColumns)for(d=-h,e=c+1;e<columns.length;e++)(i=columns[e]).resizable&&(d&&i.maxWidth&&i.maxWidth-i.previousWidth<d?(d-=i.maxWidth-i.previousWidth,i.width=i.maxWidth):(i.width=i.previousWidth+d,d=0),hasFrozenColumns()&&e>options.frozenColumn?i.width:u+=i.width);else for(e=c+1;e<columns.length;e++)i=columns[e],hasFrozenColumns()&&e>options.frozenColumn?i.width:u+=i.width;if(options.forceFitColumns)for(d=-h,e=c+1;e<columns.length;e++)(i=columns[e]).resizable&&(d&&i.maxWidth&&i.maxWidth-i.previousWidth<d?(d-=i.maxWidth-i.previousWidth,i.width=i.maxWidth):(i.width=i.previousWidth+d,d=0))}else{for(d=h,u=0,0,e=c;e>=0;e--)(i=columns[e]).resizable&&(d&&i.maxWidth&&i.maxWidth-i.previousWidth<d?(d-=i.maxWidth-i.previousWidth,i.width=i.maxWidth):(i.width=i.previousWidth+d,d=0));for(t=0;t<=c;t++)i=columns[t],hasFrozenColumns()&&t>options.frozenColumn?i.width:u+=i.width;if(options.forceFitColumns)for(d=-h,e=c+1;e<columns.length;e++)(i=columns[e]).resizable&&(l=Math.max(i.minWidth||0,absoluteColumnMinWidth),d&&i.previousWidth+d<l?(d+=i.previousWidth-l,i.width=l):(i.width=i.previousWidth+d,d=0),hasFrozenColumns()&&e>options.frozenColumn?i.width:u+=i.width);else for(e=c+1;e<columns.length;e++)i=columns[e],hasFrozenColumns()&&e>options.frozenColumn?i.width:u+=i.width}hasFrozenColumns()&&u!=canvasWidthL&&($headerL.width(u+1e3),$paneHeaderR.css("left",u)),applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths(),trigger(self.onColumnsDrag,{triggeredByColumn:$$5(this).parent().attr("id").replace(uid,""),resizeHandle:$$5(this)})})).on("dragend",(function(t,n){$$5(this).parent().removeClass("slick-header-column-active");var r,s=$$5(this).parent().attr("id").replace(uid,"");for(!0===trigger(self.onBeforeColumnsResize,{triggeredByColumn:s})&&(applyColumnHeaderWidths(),applyColumnGroupHeaderWidths()),e=0;e<columns.length;e++)i=columns[e],r=$$5(o[e]).outerWidth(),i.previousWidth!==r&&i.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{triggeredByColumn:s}),setTimeout((function(){columnResizeDragging=!1}),300)})))}))}function getVBoxDelta(e){var t=0;return e&&"function"==typeof e.css&&$$5.each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],(function(i,n){t+=parseFloat(e.css(n))||0})),t}function setFrozenOptions(){if(options.frozenColumn=options.frozenColumn>=0&&options.frozenColumn<columns.length?parseInt(options.frozenColumn):-1,options.frozenRow>-1){hasFrozenRows=!0,frozenRowsHeight=options.frozenRow*options.rowHeight;var e=getDataLength();actualFrozenRow=options.frozenBottom?e-options.frozenRow:options.frozenRow}else hasFrozenRows=!1}function setPaneVisibility(){hasFrozenColumns()?($paneHeaderR.show(),$paneTopR.show(),hasFrozenRows?($paneBottomL.show(),$paneBottomR.show()):($paneBottomR.hide(),$paneBottomL.hide())):($paneHeaderR.hide(),$paneTopR.hide(),$paneBottomR.hide(),hasFrozenRows?$paneBottomL.show():($paneBottomR.hide(),$paneBottomL.hide()))}function setOverflow(){$viewportTopL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportTopR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),hasFrozenRows?"scroll":"auto")}),$viewportBottomL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportBottomR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),"auto")}),options.viewportClass&&($viewportTopL.toggleClass(options.viewportClass,!0),$viewportTopR.toggleClass(options.viewportClass,!0),$viewportBottomL.toggleClass(options.viewportClass,!0),$viewportBottomR.toggleClass(options.viewportClass,!0))}function setScroller(){hasFrozenColumns()?($headerScrollContainer=$headerScrollerR,$headerRowScrollContainer=$headerRowScrollerR,$footerRowScrollContainer=$footerRowScrollerR,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomR,$viewportScrollContainerY=$viewportTopR):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomR:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopR):($headerScrollContainer=$headerScrollerL,$headerRowScrollContainer=$headerRowScrollerL,$footerRowScrollContainer=$footerRowScrollerL,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomL,$viewportScrollContainerY=$viewportTopL):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomL:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopL)}function measureCellPaddingAndBorder(){var e,t=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],i=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],n=$$5.fn.jquery.split(".");jQueryNewWidthBehaviour=1==n[0]&&n[1]>=8||n[0]>=2,e=$$5("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&($$5.each(t,(function(t,i){headerColumnWidthDiff+=parseFloat(e.css(i))||0})),$$5.each(i,(function(t,i){headerColumnHeightDiff+=parseFloat(e.css(i))||0}))),e.remove();var o=$$5("<div class='slick-row' />").appendTo($canvas);e=$$5("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(o),cellWidthDiff=cellHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&($$5.each(t,(function(t,i){cellWidthDiff+=parseFloat(e.css(i))||0})),$$5.each(i,(function(t,i){cellHeightDiff+=parseFloat(e.css(i))||0}))),o.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$$5("<style type='text/css' rel='stylesheet' />").appendTo($$5("head"));for(var e=options.rowHeight-cellHeightDiff,t=["."+uid+" .slick-group-header-column { left: 1000px; }","."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-preheader-panel { height:"+options.preHeaderPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-footerrow-columns { height:"+options.footerRowHeight+"px; }","."+uid+" .slick-cell { height:"+e+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"],i=0;i<columns.length;i++)t.push("."+uid+" .l"+i+" { }"),t.push("."+uid+" .r"+i+" { }");$style[0].styleSheet?$style[0].styleSheet.cssText=t.join(" "):$style[0].appendChild(document.createTextNode(t.join(" ")))}function getColumnCssRules(e){var t;if(!stylesheet){var i=document.styleSheets;for(t=0;t<i.length;t++)if((i[t].ownerNode||i[t].owningElement)==$style[0]){stylesheet=i[t];break}if(!stylesheet)throw new Error("Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];var n,o,r=stylesheet.cssRules||stylesheet.rules;for(t=0;t<r.length;t++){var s=r[t].selectorText;(n=/\.l\d+/.exec(s))?(o=parseInt(n[0].substr(2,n[0].length-2),10),columnCssRulesL[o]=r[t]):(n=/\.r\d+/.exec(s))&&(o=parseInt(n[0].substr(2,n[0].length-2),10),columnCssRulesR[o]=r[t])}}return{left:columnCssRulesL[e],right:columnCssRulesR[e]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var e=plugins.length;e--;)unregisterPlugin(plugins[e]);options.enableColumnReorder&&$headers.filter(":ui-sortable").sortable("destroy"),unbindAncestorScrollEvents(),$container.off(".slickgrid"),removeCssRules(),$canvas.off("draginit dragstart dragend drag"),$container.empty().removeClass(uid)}var canvas=null,canvas_context=null;function autosizeColumn(e,t){var i=e;if("number"==typeof e)i=columns[e];else if("string"==typeof e)for(var n=0;n<columns.length;n++)columns[n].Id===e&&(i=columns[n]);getColAutosizeWidth(i,$$5(getCanvasNode(0,0)),t)}function autosizeColumns(e,t){if((e=e||options.autosizeColsMode)!==Slick$4.GridAutosizeColsMode.LegacyForceFit&&e!==Slick$4.GridAutosizeColsMode.LegacyOff){if(e!==Slick$4.GridAutosizeColsMode.None){(canvas=document.createElement("canvas"))&&canvas.getContext&&(canvas_context=canvas.getContext("2d"));var i,n,o,r,s=$$5(getCanvasNode(0,0)),a=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,l=0,c=0,d=0,h=0,u=0;for(i=0;i<columns.length;i++)getColAutosizeWidth(n=columns[i],s,t),u+=n.autoSize.autosizeMode===Slick$4.ColAutosizeMode.Locked?n.width:0,h+=n.autoSize.autosizeMode===Slick$4.ColAutosizeMode.Locked?n.width:n.minWidth,l+=n.autoSize.widthPx,c+=n.autoSize.sizeToRemaining?0:n.autoSize.widthPx,d+=n.autoSize.sizeToRemaining&&n.minWidth||0;var p=l-c;if(e===Slick$4.GridAutosizeColsMode.FitViewportToCols){var _=l+scrollbarDimensions.width;e=Slick$4.GridAutosizeColsMode.IgnoreViewport,options.viewportMaxWidthPx&&_>options.viewportMaxWidthPx?(_=options.viewportMaxWidthPx,e=Slick$4.GridAutosizeColsMode.FitColsToViewport):options.viewportMinWidthPx&&_<options.viewportMinWidthPx&&(_=options.viewportMinWidthPx,e=Slick$4.GridAutosizeColsMode.FitColsToViewport),$container.width(_)}if(e===Slick$4.GridAutosizeColsMode.FitColsToViewport)if(p>0&&c<a-d)for(i=0;i<columns.length;i++){var f=a-c;o=(n=columns[i]).autoSize.sizeToRemaining?f*n.autoSize.widthPx/p:n.autoSize.widthPx,n.rerenderOnResize&&n.width!=o&&(r=!0),n.width=o}else if(options.viewportSwitchToScrollModeWidthPercent&&c+d>a*options.viewportSwitchToScrollModeWidthPercent/100||h>a)e=Slick$4.GridAutosizeColsMode.IgnoreViewport;else{var g=c-u,m=a-u-d;for(i=0;i<columns.length;i++)o=(n=columns[i]).width,n.autoSize.autosizeMode!==Slick$4.ColAutosizeMode.Locked&&(n.autoSize.sizeToRemaining?o=n.minWidth:((o=m/g*n.autoSize.widthPx)<n.minWidth&&(o=n.minWidth),g-=n.autoSize.widthPx,m-=o)),n.rerenderOnResize&&n.width!=o&&(r=!0),n.width=o}if(e===Slick$4.GridAutosizeColsMode.IgnoreViewport)for(i=0;i<columns.length;i++)o=columns[i].autoSize.widthPx,columns[i].rerenderOnResize&&columns[i].width!=o&&(r=!0),columns[i].width=o;reRenderColumns(r)}}else legacyAutosizeColumns()}function getColAutosizeWidth(e,t,i){var n=e.autoSize;if(n.widthPx=e.width,n.autosizeMode!==Slick$4.ColAutosizeMode.Locked&&n.autosizeMode!==Slick$4.ColAutosizeMode.Guide){var o=getDataLength();if(n.autosizeMode===Slick$4.ColAutosizeMode.ContentIntelligent){var r,s=n.colDataTypeOf;if(o>0){var a=getDataItem(0);a&&"object"===(s=typeof(r=a[e.field]))&&(r instanceof Date&&(s="date"),"undefined"!=typeof moment&&r instanceof moment&&(s="moment"))}"boolean"===s&&(n.colValueArray=[!0,!1]),"number"===s&&(n.valueFilterMode=Slick$4.ValueFilterMode.GetGreatestAndSub,n.rowSelectionMode=Slick$4.RowSelectionMode.AllRows),"string"===s&&(n.valueFilterMode=Slick$4.ValueFilterMode.GetLongestText,n.rowSelectionMode=Slick$4.RowSelectionMode.AllRows,n.allowAddlPercent=5),"date"===s&&(n.colValueArray=[new Date(2009,8,30,12,20,20)]),"moment"===s&&"undefined"!=typeof moment&&(n.colValueArray=[moment([2009,8,30,12,20,20])])}var l=getColContentSize(e,t,i);l=l*(n.allowAddlPercent?1+n.allowAddlPercent/100:1)+options.autosizeColPaddingPx,e.minWidth&&l<e.minWidth&&(l=e.minWidth),e.maxWidth&&l>e.maxWidth&&(l=e.maxWidth),n.widthPx=l}}function getColContentSize(e,t,i){var n,o=e.autoSize,r=1,s=0,a=0;if(o.ignoreHeaderText||(a=getColHeaderWidth(e)),o.colValueArray)return s=getColWidth(e,t,o.colValueArray),Math.max(a,s);var l=getData();l.getItems&&(l=l.getItems());var c=(i?o.rowSelectionModeOnInit:void 0)||o.rowSelectionMode;if(c===Slick$4.RowSelectionMode.FirstRow&&(l=l.slice(0,1)),c===Slick$4.RowSelectionMode.LastRow&&(l=l.slice(l.length-1,l.length)),c===Slick$4.RowSelectionMode.FirstNRows&&(l=l.slice(0,o.rowSelectionCount)),o.valueFilterMode===Slick$4.ValueFilterMode.DeDuplicate){var d={};for(h=0,n=l.length;h<n;h++)d[l[h][e.field]]=!0;if(Object.keys)l=Object.keys(d);else for(var h in l=[],d)l.push(h)}if(o.valueFilterMode===Slick$4.ValueFilterMode.GetGreatestAndSub){var u,p=0;for(h=0,n=l.length;h<n;h++)f=l[h][e.field],Math.abs(f)>p&&(u=f,p=Math.abs(f));u=""+u,l=[u=+(u=Array(u.length+1).join("9"))]}if(o.valueFilterMode===Slick$4.ValueFilterMode.GetLongestTextAndSub){var _=0;for(h=0,n=l.length;h<n;h++)((f=l[h][e.field])||"").length>_&&(_=f.length);f=Array(_+1).join("m"),r=options.autosizeTextAvgToMWidthRatio,l=[f]}if(o.valueFilterMode===Slick$4.ValueFilterMode.GetLongestText){_=0;var f,g=0;for(h=0,n=l.length;h<n;h++)((f=l[h][e.field])||"").length>_&&(_=f.length,g=h);l=[f=l[g][e.field]]}return s=getColWidth(e,t,l)*r,Math.max(a,s)}function getColWidth(e,t,i){var n=getColumnIndex(e.id),o=$$5('<div class="slick-row ui-widget-content"></div>'),r=$$5('<div class="slick-cell"></div>');r.css({position:"absolute",visibility:"hidden","text-overflow":"initial","white-space":"nowrap"}),o.append(r),t.append(o);var s,a,l,c,d=0;return canvas_context&&e.autoSize.widthEvalMode===Slick$4.WidthEvalMode.CanvasTextSize?(canvas_context.font=r.css("font-size")+" "+r.css("font-family"),$$5(i).each((function(t,i){c=Array.isArray(i)?i[e.field]:i,(s=(a=""+c)?canvas_context.measureText(a).width:0)>d&&(d=s,l=a)})),r.html(l),s=r.outerWidth(),o.remove(),s):($$5(i).each((function(t,i){c=Array.isArray(i)?i[e.field]:i,applyFormatResultToCellNode(e.formatterOverride?e.formatterOverride(t,n,c,e,i):e.formatter?e.formatter(t,n,c,e,i):""+c,r[0]),(s=r.outerWidth())>d&&(d=s)})),o.remove(),d)}function getColHeaderWidth(e){var t=0,i=getUID()+e.id,n=document.getElementById(i),o=i+"_";if(n){var r=n.cloneNode(!0);r.id=o,r.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",n.parentNode.insertBefore(r,n),t=r.offsetWidth,r.parentNode.removeChild(r)}else{var s=getHeader(e);t=(n=$$5("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+e.name+"</span>").attr("id",o).css({position:"absolute",visibility:"hidden",right:"auto","text-overflow:":"initial","white-space":"nowrap"}).addClass(e.headerCssClass||"").appendTo(s))[0].offsetWidth,s[0].removeChild(n[0])}return t}function legacyAutosizeColumns(){var e,t,i,n=[],o=0,r=0,s=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(e=0;e<columns.length;e++)t=columns[e],n.push(t.width),r+=t.width,t.resizable&&(o+=t.width-Math.max(t.minWidth,absoluteColumnMinWidth));for(i=r;r>s&&o;){var a=(r-s)/o;for(e=0;e<columns.length&&r>s;e++){t=columns[e];var l=n[e];if(!(!t.resizable||l<=t.minWidth||l<=absoluteColumnMinWidth)){var c=Math.max(t.minWidth,absoluteColumnMinWidth),d=Math.floor(a*(l-c))||1;r-=d=Math.min(d,l-c),o-=d,n[e]-=d}}if(i<=r)break;i=r}for(i=r;r<s;){var h=s/r;for(e=0;e<columns.length&&r<s;e++){t=columns[e];var u,p=n[e];r+=u=!t.resizable||t.maxWidth<=p?0:Math.min(Math.floor(h*p)-p,t.maxWidth-p||1e6)||1,n[e]+=r<=s?u:0}if(i>=r)break;i=r}var _=!1;for(e=0;e<columns.length;e++)columns[e].rerenderOnResize&&columns[e].width!=n[e]&&(_=!0),columns[e].width=n[e];reRenderColumns(_)}function reRenderColumns(e){applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),updateCanvasWidth(!0),trigger(self.onAutosizeColumns,{columns:columns}),e&&(invalidateAllRows(),render())}function trigger(e,t,i){return i=i||new Slick$4.EventData,(t=t||{}).grid=self,e.notify(t,i,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(e){return columnsById[e]}function applyColumnGroupHeaderWidths(){if(treeColumns.hasDepth())for(var e=$groupHeadersL.length-1;e>=0;e--)treeColumns.getColumnsInDepth(e),$$5().add($groupHeadersL[e]).add($groupHeadersR[e]).each((function(e){var t=$$5(this),i=0;t.width(0===e?getHeadersWidthL():getHeadersWidthR()),t.children().each((function(){var e=$$5(this),n=$$5(this).data("column");n.width=0,n.columns.forEach((function(){var e=t.next().children(":eq("+i+++")");n.width+=e.outerWidth()})),e.width(n.width-headerColumnWidthDiff)}))}))}function applyColumnHeaderWidths(){if(initialized){for(var e,t=0,i=$headers.children(),n=columns.length;t<n;t++)e=$$5(i[t]),jQueryNewWidthBehaviour?e.outerWidth()!==columns[t].width&&e.outerWidth(columns[t].width):e.width()!==columns[t].width-headerColumnWidthDiff&&e.width(columns[t].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var e,t,i=0,n=0;n<columns.length;n++)e=columns[n].width,(t=getColumnCssRules(n)).left.style.left=i+"px",t.right.style.right=(-1!=options.frozenColumn&&n>options.frozenColumn?canvasWidthR:canvasWidthL)-i-e+"px",options.frozenColumn==n?i=0:i+=columns[n].width}function setSortColumn(e,t){setSortColumns([{columnId:e,sortAsc:t}])}function setSortColumns(e){sortColumns=e;var t=options.numberedMultiColumnSort&&sortColumns.length>1,i=$headers.children();i.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),i.find(".slick-sort-indicator-numbered").text(""),$$5.each(sortColumns,(function(e,n){null==n.sortAsc&&(n.sortAsc=!0);var o=getColumnIndex(n.columnId);null!=o&&(i.eq(o).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(n.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&i.eq(o).find(".slick-sort-indicator-numbered").text(e+1))}))}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,t){var i=selectedRows.slice(0);selectedRows=[];for(var n={},o=0;o<t.length;o++)for(var r=t[o].fromRow;r<=t[o].toRow;r++){n[r]||(selectedRows.push(r),n[r]={});for(var s=t[o].fromCell;s<=t[o].toCell;s++)canCellBeSelected(r,s)&&(n[r][columns[s].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,n),simpleArrayEquals(i,selectedRows)||trigger(self.onSelectedRowsChanged,{rows:getSelectedRows(),previousSelectedRows:i},e)}function simpleArrayEquals(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!0;const i=new Set(e),n=new Set(t);if(i.size!=n.size)return!1;for(const o of i)if(!n.has(o))return!1;return!0}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var e=0,t=0,i=columns.length;t<i;t++)columnPosLeft[t]=e,columnPosRight[t]=e+columns[t].width,options.frozenColumn==t?e=0:e+=columns[t].width}function updateColumnProps(){columnsById={};for(var e=0;e<columns.length;e++){columns[e].width&&(columns[e].widthRequest=columns[e].width);var t=columns[e]=$$5.extend({},columnDefaults,columns[e]);t.autoSize=$$5.extend({},columnAutosizeDefaults,t.autoSize),columnsById[t.id]=e,t.minWidth&&t.width<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&t.width>t.maxWidth&&(t.width=t.maxWidth),t.resizable}}function setColumns(e){var t=new Slick$4.TreeColumns(e);columns=t.hasDepth()?(treeColumns=t).extractColumns():e,updateColumnProps(),updateColumnCaches(),initialized&&(setPaneVisibility(),setOverflow(),invalidateAllRows(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),removeCssRules(),createCssRules(),resizeCanvas(),updateCanvasWidth(),applyColumnHeaderWidths(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(e,t){if(getEditorLock().commitCurrentEdit()){makeActiveCellNormal(),void 0!==e.showColumnHeader&&setColumnHeaderVisibility(e.showColumnHeader),options.enableAddRow!==e.enableAddRow&&invalidateRow(getDataLength());var i=$$5.extend(!0,{},options);options=$$5.extend(options,e),trigger(self.onSetOptions,{optionsBefore:i,optionsAfter:options}),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),t||render(),setFrozenOptions(),setScroller(),zombieRowNodeFromLastMouseWheelEvent=null,setColumns(treeColumns.extractColumns())}}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1),options.forceFitColumns&&(options.autosizeColsMode=Slick$4.GridAutosizeColsMode.LegacyForceFit,console.log("forceFitColumns option is deprecated - use autosizeColsMode"))}function setData(e,t){data=e,invalidateAllRows(),updateRowCount(),t&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data&&data.length||0}function getDataLengthIncludingAddNew(){return getDataLength()+(options.enableAddRow&&(!pagingActive||pagingIsLastPage)?1:0)}function getDataItem(e){return data.getItem?data.getItem(e):data[e]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(e,t){var i=!1!==t;options.showTopPanel!=e&&(options.showTopPanel=e,e?i?$topPanelScroller.slideDown("fast",resizeCanvas):($topPanelScroller.show(),resizeCanvas()):i?$topPanelScroller.slideUp("fast",resizeCanvas):($topPanelScroller.hide(),resizeCanvas()))}function setHeaderRowVisibility(e,t){var i=!1!==t;options.showHeaderRow!=e&&(options.showHeaderRow=e,e?i?$headerRowScroller.slideDown("fast",resizeCanvas):($headerRowScroller.show(),resizeCanvas()):i?$headerRowScroller.slideUp("fast",resizeCanvas):($headerRowScroller.hide(),resizeCanvas()))}function setColumnHeaderVisibility(e,t){options.showColumnHeader!=e&&(options.showColumnHeader=e,e?t?$headerScroller.slideDown("fast",resizeCanvas):($headerScroller.show(),resizeCanvas()):t?$headerScroller.slideUp("fast",resizeCanvas):($headerScroller.hide(),resizeCanvas()))}function setFooterRowVisibility(e,t){var i=!1!==t;options.showFooterRow!=e&&(options.showFooterRow=e,e?i?$footerRowScroller.slideDown("fast",resizeCanvas):($footerRowScroller.show(),resizeCanvas()):i?$footerRowScroller.slideUp("fast",resizeCanvas):($footerRowScroller.hide(),resizeCanvas()))}function setPreHeaderPanelVisibility(e,t){var i=!1!==t;options.showPreHeaderPanel!=e&&(options.showPreHeaderPanel=e,e?i?$preHeaderPanelScroller.slideDown("fast",resizeCanvas):($preHeaderPanelScroller.show(),resizeCanvas()):i?$preHeaderPanelScroller.slideUp("fast",resizeCanvas):($preHeaderPanelScroller.hide(),resizeCanvas()))}function getContainerNode(){return $container.get(0)}function getRowTop(e){return options.rowHeight*e-offset}function getRowFromPosition(e){return Math.floor((e+offset)/options.rowHeight)}function scrollTo(e){e=Math.max(e,0),e=Math.min(e,th-$viewportScrollContainerY.height()+(viewportHasHScroll||hasFrozenColumns()?scrollbarDimensions.height:0));var t=offset;page=Math.min(n-1,Math.floor(e/ph));var i=e-(offset=Math.round(page*cj));offset!=t&&(cleanupRows(getVisibleRange(i)),updateRowPositions());prevScrollTop!=i&&(vScrollDir=prevScrollTop+t<i+offset?1:-1,lastRenderedScrollTop=scrollTop=prevScrollTop=i,hasFrozenColumns()&&($viewportTopL[0].scrollTop=i),hasFrozenRows&&($viewportBottomL[0].scrollTop=$viewportBottomR[0].scrollTop=i),$viewportScrollContainerY[0].scrollTop=i,trigger(self.onViewportChanged,{}))}function defaultFormatter(e,t,i,n,o,r){return null==i?"":(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(e,t){var i=data.getItemMetadata&&data.getItemMetadata(e),n=i&&i.columns&&(i.columns[t.id]||i.columns[getColumnIndex(t.id)]);return n&&n.formatter||i&&i.formatter||t.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(t)||options.defaultFormatter}function getEditor(e,t){var i=columns[t],n=data.getItemMetadata&&data.getItemMetadata(e),o=n&&n.columns;return o&&o[i.id]&&void 0!==o[i.id].editor?o[i.id].editor:o&&o[t]&&void 0!==o[t].editor?o[t].editor:i.editor||options.editorFactory&&options.editorFactory.getEditor(i)}function getDataItemValueForColumn(e,t){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(e,t):e[t.field]}function appendRowHtml(e,t,i,n,o){var r=getDataItem(i),s=i<o&&!r,a="slick-row"+(hasFrozenRows&&i<=options.frozenRow?" frozen":"")+(s?" loading":"")+(i===activeRow&&options.showCellSelection?" active":"")+(i%2==1?" odd":" even");r||(a+=" "+options.addNewRowCssClass);var l=data.getItemMetadata&&data.getItemMetadata(i);l&&l.cssClasses&&(a+=" "+l.cssClasses);var c,d,h=getFrozenRowOffset(i),u="<div class='ui-widget-content "+a+"' style='top:"+(getRowTop(i)-h)+"px'>";e.push(u),hasFrozenColumns()&&t.push(u);for(var p=0,_=columns.length;p<_;p++){if(d=columns[p],c=1,l&&l.columns){var f=l.columns[d.id]||l.columns[p];"*"===(c=f&&f.colspan||1)&&(c=_-p)}if(columnPosRight[Math.min(_-1,p+c-1)]>n.leftPx){if(!d.alwaysRenderColumn&&columnPosLeft[p]>n.rightPx)break;hasFrozenColumns()&&p>options.frozenColumn?appendCellHtml(t,i,p,c,r):appendCellHtml(e,i,p,c,r)}else(d.alwaysRenderColumn||hasFrozenColumns()&&p<=options.frozenColumn)&&appendCellHtml(e,i,p,c,r);c>1&&(p+=c-1)}e.push("</div>"),hasFrozenColumns()&&t.push("</div>")}function appendCellHtml(e,t,i,n,o){var r=columns[i],s="slick-cell l"+i+" r"+Math.min(columns.length-1,i+n-1)+(r.cssClass?" "+r.cssClass:"");for(var a in hasFrozenColumns()&&i<=options.frozenColumn&&(s+=" frozen"),t===activeRow&&i===activeCell&&options.showCellSelection&&(s+=" active"),cellCssClasses)cellCssClasses[a][t]&&cellCssClasses[a][t][r.id]&&(s+=" "+cellCssClasses[a][t][r.id]);var l=null,c="";o&&(l=getDataItemValueForColumn(o,r),null==(c=getFormatter(t,r)(t,i,l,r,o,self))&&(c=""));var d=trigger(self.onBeforeAppendCell,{row:t,cell:i,value:l,dataContext:o})||"";d+=c&&c.addClasses?(d?" ":"")+c.addClasses:"";var h=c&&c.toolTip?"title='"+c.toolTip+"'":"",u="";if(r.hasOwnProperty("cellAttrs")&&r.cellAttrs instanceof Object)for(var a in r.cellAttrs)r.cellAttrs.hasOwnProperty(a)&&(u+=" "+a+'="'+r.cellAttrs[a]+'" ');e.push("<div class='"+s+(d?" "+d:"")+"' "+h+u+">"),o&&e.push("[object Object]"!==Object.prototype.toString.call(c)?c:c.text),e.push("</div>"),rowsCache[t].cellRenderQueue.push(i),rowsCache[t].cellColSpans[i]=n}function cleanupRows(e){for(var t in rowsCache){var i=!0;hasFrozenRows&&(options.frozenBottom&&t>=actualFrozenRow||!options.frozenBottom&&t<=actualFrozenRow)&&(i=!1),(t=parseInt(t,10))!==activeRow&&(t<e.top||t>e.bottom)&&i&&removeRowFromCache(t)}options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){for(var e in currentEditor&&makeActiveCellNormal(),rowsCache)removeRowFromCache(e);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function removeRowFromCache(e){var t=rowsCache[e];t&&(rowNodeFromLastMouseWheelEvent==t.rowNode[0]||hasFrozenColumns()&&rowNodeFromLastMouseWheelEvent==t.rowNode[1]?(t.rowNode.hide(),zombieRowNodeFromLastMouseWheelEvent=t.rowNode):t.rowNode.each((function(){this.parentElement.removeChild(this)})),delete rowsCache[e],delete postProcessedRows[e],renderedRows--,counter_rows_removed++)}function invalidateRows(e){var t,i;if(e&&e.length){for(vScrollDir=0,i=e.length,t=0;t<i;t++)currentEditor&&activeRow===e[t]&&makeActiveCellNormal(),rowsCache[e[t]]&&removeRowFromCache(e[t]);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}}function invalidateRow(e){(e||0===e)&&invalidateRows([e])}function applyFormatResultToCellNode(e,t,i){null==e&&(e=""),"[object Object]"===Object.prototype.toString.call(e)?(t.innerHTML=e.text,e.removeClasses&&!i&&$$5(t).removeClass(e.removeClasses),e.addClasses&&$$5(t).addClass(e.addClasses),e.toolTip&&$$5(t).attr("title",e.toolTip)):t.innerHTML=e}function updateCell(e,t){var i=getCellNode(e,t);if(i){var n=columns[t],o=getDataItem(e);if(currentEditor&&activeRow===e&&activeCell===t)currentEditor.loadValue(o);else applyFormatResultToCellNode(o?getFormatter(e,n)(e,t,getDataItemValueForColumn(o,n),n,o,self):"",i),invalidatePostProcessingResults(e)}}function updateRow(e){var t=rowsCache[e];if(t){ensureCellNodesInRowsCache(e);var i=getDataItem(e);for(var n in t.cellNodesByColumnIdx)if(t.cellNodesByColumnIdx.hasOwnProperty(n)){var o=columns[n|=0],r=t.cellNodesByColumnIdx[n][0];e===activeRow&&n===activeCell&&currentEditor?currentEditor.loadValue(i):i?applyFormatResultToCellNode(getFormatter(e,o)(e,n,getDataItemValueForColumn(i,o),o,i,self),r):r.innerHTML=""}invalidatePostProcessingResults(e)}}function getViewportHeight(){if(options.autoHeight&&-1==options.frozenColumn||(topPanelH=options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0,headerRowH=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,footerRowH=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0),options.autoHeight){var e=$paneHeaderL.outerHeight();e+=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,e+=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0,e+=getCanvasWidth()>viewportW?scrollbarDimensions.height:0,viewportH=options.rowHeight*getDataLengthIncludingAddNew()+(-1==options.frozenColumn?e:0)}else{var t=options.showColumnHeader?parseFloat($$5.css($headerScroller[0],"height"))+getVBoxDelta($headerScroller):0,i=options.createPreHeaderPanel&&options.showPreHeaderPanel?options.preHeaderPanelHeight+getVBoxDelta($preHeaderPanelScroller):0;viewportH=parseFloat($$5.css($container[0],"height",!0))-parseFloat($$5.css($container[0],"paddingTop",!0))-parseFloat($$5.css($container[0],"paddingBottom",!0))-t-topPanelH-headerRowH-footerRowH-i}return numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportH}function getViewportWidth(){viewportW=parseFloat($container.width())}function resizeCanvas(){if(initialized){paneTopH=0,paneBottomH=0,viewportTopH=0,getViewportWidth(),getViewportHeight(),hasFrozenRows?options.frozenBottom?(paneTopH=viewportH-frozenRowsHeight-scrollbarDimensions.height,paneBottomH=frozenRowsHeight+scrollbarDimensions.height):(paneTopH=frozenRowsHeight,paneBottomH=viewportH-frozenRowsHeight):paneTopH=viewportH,paneTopH+=topPanelH+headerRowH+footerRowH,hasFrozenColumns()&&options.autoHeight&&(paneTopH+=scrollbarDimensions.height),viewportTopH=paneTopH-topPanelH-headerRowH-footerRowH,options.autoHeight&&(hasFrozenColumns()&&$container.height(paneTopH+parseFloat($$5.css($headerScrollerL[0],"height"))),$paneTopL.css("position","relative")),$paneTopL.css({top:$paneHeaderL.height(),height:paneTopH});var e=$paneTopL.position().top+paneTopH;options.autoHeight||$viewportTopL.height(viewportTopH),hasFrozenColumns()?($paneTopR.css({top:$paneHeaderL.height(),height:paneTopH}),$viewportTopR.height(viewportTopH),hasFrozenRows&&($paneBottomL.css({top:e,height:paneBottomH}),$paneBottomR.css({top:e,height:paneBottomH}),$viewportBottomR.height(paneBottomH))):hasFrozenRows&&($paneBottomL.css({width:"100%",height:paneBottomH}),$paneBottomL.css("top",e)),hasFrozenRows?($viewportBottomL.height(paneBottomH),options.frozenBottom?($canvasBottomL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasBottomR.height(frozenRowsHeight)):($canvasTopL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasTopR.height(frozenRowsHeight))):$viewportTopR.height(viewportTopH),scrollbarDimensions&&scrollbarDimensions.width||(scrollbarDimensions=measureScrollbar()),options.autosizeColsMode===Slick$4.GridAutosizeColsMode.LegacyForceFit&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render()}}function updatePagingStatusFromView(e){pagingActive=0!==e.pageSize,pagingIsLastPage=e.pageNum==e.totalPages-1}function updateRowCount(){if(initialized){var e=getDataLength(),t=getDataLengthIncludingAddNew(),i=0,o=hasFrozenRows&&!options.frozenBottom?$canvasBottomL.height():$canvasTopL.height();if(hasFrozenRows)i=getDataLength()-options.frozenRow;else i=t+(options.leaveSpaceForNewRows?numVisibleRows-1:0);var r=$viewportScrollContainerY.height(),s=viewportHasVScroll;viewportHasVScroll=options.alwaysShowVerticalScroll||!options.autoHeight&&i*options.rowHeight>r,makeActiveCellNormal();var a=e-1;for(var l in rowsCache)l>a&&removeRowFromCache(l);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup(),activeCellNode&&activeRow>a&&resetActiveCell();o=h;options.autoHeight?h=options.rowHeight*i:(th=Math.max(options.rowHeight*i,r-scrollbarDimensions.height))<maxSupportedCssHeight?(h=ph=th,n=1,cj=0):(ph=(h=maxSupportedCssHeight)/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==o&&(hasFrozenRows&&!options.frozenBottom?($canvasBottomL.css("height",h),hasFrozenColumns()&&$canvasBottomR.css("height",h)):($canvasTopL.css("height",h),$canvasTopR.css("height",h)),scrollTop=$viewportScrollContainerY[0].scrollTop);var c=scrollTop+offset<=th-r;0==th||0==scrollTop?page=offset=0:scrollTo(c?scrollTop+offset:th-r),h!=o&&options.autoHeight&&resizeCanvas(),options.autosizeColsMode===Slick$4.GridAutosizeColsMode.LegacyForceFit&&s!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(e,t){return null==e&&(e=scrollTop),null==t&&(t=scrollLeft),{top:getRowFromPosition(e),bottom:getRowFromPosition(e+viewportH)+1,leftPx:t,rightPx:t+viewportW}}function getRenderedRange(e,t){var i=getVisibleRange(e,t),n=Math.round(viewportH/options.rowHeight),o=options.minRowBuffer;return-1==vScrollDir?(i.top-=n,i.bottom+=o):1==vScrollDir?(i.top-=o,i.bottom+=n):(i.top-=o,i.bottom+=o),i.top=Math.max(0,i.top),i.bottom=Math.min(getDataLengthIncludingAddNew()-1,i.bottom),i.leftPx-=viewportW,i.rightPx+=viewportW,i.leftPx=Math.max(0,i.leftPx),i.rightPx=Math.min(canvasWidth,i.rightPx),i}function ensureCellNodesInRowsCache(e){var t=rowsCache[e];if(t&&t.cellRenderQueue.length)for(var i=t.rowNode.children().last();t.cellRenderQueue.length;){var n=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[n]=i,0===(i=i.prev()).length&&(i=$$5(t.rowNode[0]).children().last())}}function cleanUpCells(e,t){if(!hasFrozenRows||!(options.frozenBottom&&t>actualFrozenRow||t<=actualFrozenRow)){var i,n=rowsCache[t],o=[];for(var r in n.cellNodesByColumnIdx)if(n.cellNodesByColumnIdx.hasOwnProperty(r)&&!((r|=0)<=options.frozenColumn||Array.isArray(columns)&&columns[r]&&columns[r].alwaysRenderColumn)){var s=n.cellColSpans[r];(columnPosLeft[r]>e.rightPx||columnPosRight[Math.min(columns.length-1,r+s-1)]<e.leftPx)&&(t==activeRow&&r==activeCell||o.push(r))}for(;null!=(i=o.pop());)n.cellNodesByColumnIdx[i][0].parentElement.removeChild(n.cellNodesByColumnIdx[i][0]),delete n.cellColSpans[i],delete n.cellNodesByColumnIdx[i],postProcessedRows[t]&&delete postProcessedRows[t][i]}}function cleanUpAndRenderCells(e){for(var t,i,n,o=[],r=[],s=e.top,a=e.bottom;s<=a;s++)if(t=rowsCache[s]){ensureCellNodesInRowsCache(s),cleanUpCells(e,s),i=0;var l=data.getItemMetadata&&data.getItemMetadata(s);l=l&&l.columns;for(var c=getDataItem(s),d=0,h=columns.length;d<h&&!(columnPosLeft[d]>e.rightPx);d++)if(null==(n=t.cellColSpans[d])){if(n=1,l){var u=l[columns[d].id]||l[d];"*"===(n=u&&u.colspan||1)&&(n=h-d)}columnPosRight[Math.min(h-1,d+n-1)]>e.leftPx&&(appendCellHtml(o,s,d,n,c),i++),d+=n>1?n-1:0}else d+=n>1?n-1:0;i&&r.push(s)}if(o.length){var p,_,f=document.createElement("div");for(f.innerHTML=o.join("");null!=(p=r.pop());){var g;for(t=rowsCache[p];null!=(g=t.cellRenderQueue.pop());)_=f.lastChild,hasFrozenColumns()&&g>options.frozenColumn?t.rowNode[1].appendChild(_):t.rowNode[0].appendChild(_),t.cellNodesByColumnIdx[g]=$$5(_)}}}function renderRows(e){for(var t=[],i=[],n=[],o=!1,r=getDataLength(),s=e.top,a=e.bottom;s<=a;s++)rowsCache[s]||hasFrozenRows&&options.frozenBottom&&s==getDataLength()||(renderedRows++,n.push(s),rowsCache[s]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(t,i,s,e,r),activeCellNode&&activeRow===s&&(o=!0),counter_rows_rendered++);if(n.length){var l=document.createElement("div"),c=document.createElement("div");l.innerHTML=t.join(""),c.innerHTML=i.join("");for(s=0,a=n.length;s<a;s++)hasFrozenRows&&n[s]>=actualFrozenRow?hasFrozenColumns()?rowsCache[n[s]].rowNode=$$5().add($$5(l.firstChild).appendTo($canvasBottomL)).add($$5(c.firstChild).appendTo($canvasBottomR)):rowsCache[n[s]].rowNode=$$5().add($$5(l.firstChild).appendTo($canvasBottomL)):hasFrozenColumns()?rowsCache[n[s]].rowNode=$$5().add($$5(l.firstChild).appendTo($canvasTopL)).add($$5(c.firstChild).appendTo($canvasTopR)):rowsCache[n[s]].rowNode=$$5().add($$5(l.firstChild).appendTo($canvasTopL));o&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function startPostProcessingCleanup(){options.enableAsyncPostRenderCleanup&&(clearTimeout(h_postrenderCleanup),h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay))}function invalidatePostProcessingResults(e){for(var t in postProcessedRows[e])postProcessedRows[e].hasOwnProperty(t)&&(postProcessedRows[e][t]="C");postProcessFromRow=Math.min(postProcessFromRow,e),postProcessToRow=Math.max(postProcessToRow,e),startPostProcessing()}function updateRowPositions(){for(var e in rowsCache){var t=e?parseInt(e):0;rowsCache[t].rowNode[0].style.top=getRowTop(t)+"px"}}function render(){if(initialized){scrollThrottle.dequeue();var e=getVisibleRange(),t=getRenderedRange();if(cleanupRows(t),lastRenderedScrollLeft!=scrollLeft){if(hasFrozenRows){var i=$$5.extend(!0,{},t);options.frozenBottom?(i.top=actualFrozenRow,i.bottom=getDataLength()):(i.top=0,i.bottom=options.frozenRow),cleanUpAndRenderCells(i)}cleanUpAndRenderCells(t)}renderRows(t),hasFrozenRows&&(options.frozenBottom?renderRows({top:actualFrozenRow,bottom:getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):renderRows({top:0,bottom:options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),postProcessFromRow=e.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,e.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,trigger(self.onRendered,{startRow:e.top,endRow:e.bottom,grid:self})}}function handleHeaderRowScroll(){var e=$headerRowScrollContainer[0].scrollLeft;e!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=e)}function handleFooterRowScroll(){var e=$footerRowScrollContainer[0].scrollLeft;e!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=e)}function handlePreHeaderPanelScroll(){handleElementScroll($preHeaderPanelScroller[0])}function handleElementScroll(e){var t=e.scrollLeft;t!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=t)}function handleScroll(){return scrollTop=$viewportScrollContainerY[0].scrollTop,scrollLeft=$viewportScrollContainerX[0].scrollLeft,_handleScroll(!1)}function _handleScroll(e){var t=$viewportScrollContainerY[0].scrollHeight-$viewportScrollContainerY[0].clientHeight,i=$viewportScrollContainerY[0].scrollWidth-$viewportScrollContainerY[0].clientWidth;t=Math.max(0,t),i=Math.max(0,i),scrollTop>t&&(scrollTop=t),scrollLeft>i&&(scrollLeft=i);var o=Math.abs(scrollTop-prevScrollTop),r=Math.abs(scrollLeft-prevScrollLeft);if(r&&(prevScrollLeft=scrollLeft,$viewportScrollContainerX[0].scrollLeft=scrollLeft,$headerScrollContainer[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScrollContainer[0].scrollLeft=scrollLeft,options.createFooterRow&&($footerRowScrollContainer[0].scrollLeft=scrollLeft),options.createPreHeaderPanel&&(hasFrozenColumns()?$preHeaderPanelScrollerR[0].scrollLeft=scrollLeft:$preHeaderPanelScroller[0].scrollLeft=scrollLeft),hasFrozenColumns()?hasFrozenRows&&($viewportTopR[0].scrollLeft=scrollLeft):hasFrozenRows&&($viewportTopL[0].scrollLeft=scrollLeft)),o)if(vScrollDir=prevScrollTop<scrollTop?1:-1,prevScrollTop=scrollTop,e&&($viewportScrollContainerY[0].scrollTop=scrollTop),hasFrozenColumns()&&(hasFrozenRows&&!options.frozenBottom?$viewportBottomL[0].scrollTop=scrollTop:$viewportTopL[0].scrollTop=scrollTop),o<viewportH)scrollTo(scrollTop+offset);else{var s=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),s!=(offset=Math.round(page*cj))&&invalidateAllRows()}if(r||o){var a=Math.abs(lastRenderedScrollLeft-scrollLeft),l=Math.abs(lastRenderedScrollTop-scrollTop);(a>20||l>20)&&(options.forceSyncScrolling||l<viewportH&&a<viewportW?render():scrollThrottle.enqueue(),trigger(self.onViewportChanged,{}))}return trigger(self.onScroll,{scrollLeft:scrollLeft,scrollTop:scrollTop}),!(!r&&!o)}function ActionThrottle(e,t){var i=!1,n=!1;function o(){n=!1}function r(){i=!0,setTimeout(s,t),e()}function s(){n?(o(),r()):i=!1}return{enqueue:function(){i?n=!0:r()},dequeue:o}}function asyncPostProcessRows(){for(var e=getDataLength();postProcessFromRow<=postProcessToRow;){var t=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,i=rowsCache[t];if(i&&!(t>=e)){for(var n in postProcessedRows[t]||(postProcessedRows[t]={}),ensureCellNodesInRowsCache(t),i.cellNodesByColumnIdx)if(i.cellNodesByColumnIdx.hasOwnProperty(n)){var o=columns[n|=0],r=postProcessedRows[t][n];if(o.asyncPostRender&&"R"!==r){var s=i.cellNodesByColumnIdx[n];s&&o.asyncPostRender(s,t,getDataItem(t),o,"C"===r),postProcessedRows[t][n]="R"}}return void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function asyncPostProcessCleanupRows(){if(postProcessedCleanupQueue.length>0){for(var e=postProcessedCleanupQueue[0].groupId;postProcessedCleanupQueue.length>0&&postProcessedCleanupQueue[0].groupId==e;){var t=postProcessedCleanupQueue.shift();if("R"==t.actionType&&$$5(t.node).remove(),"C"==t.actionType){var i=columns[t.columnIdx];i.asyncPostRenderCleanup&&t.node&&i.asyncPostRenderCleanup(t.node,t.rowIdx,i)}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(e,t){var i,n,o,r;for(var s in rowsCache){if(r=t&&t[s],o=e&&e[s],r)for(n in r)o&&r[n]==o[n]||(i=getCellNode(s,getColumnIndex(n)))&&$$5(i).removeClass(r[n]);if(o)for(n in o)r&&r[n]==o[n]||(i=getCellNode(s,getColumnIndex(n)))&&$$5(i).addClass(o[n])}}function addCellCssStyles(e,t){if(cellCssClasses[e])throw new Error("addCellCssStyles: cell CSS hash with key '"+e+"' already exists.");cellCssClasses[e]=t,updateCellCssStylesOnRenderedRows(t,null),trigger(self.onCellCssStylesChanged,{key:e,hash:t,grid:self})}function removeCellCssStyles(e){cellCssClasses[e]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[e]),delete cellCssClasses[e],trigger(self.onCellCssStylesChanged,{key:e,hash:null,grid:self}))}function setCellCssStyles(e,t){var i=cellCssClasses[e];cellCssClasses[e]=t,updateCellCssStylesOnRenderedRows(t,i),trigger(self.onCellCssStylesChanged,{key:e,hash:t,grid:self})}function getCellCssStyles(e){return cellCssClasses[e]}function flashCell(e,t,i){(i=i||100,rowsCache[e])&&function e(t,n){n&&setTimeout((function(){t.queue((function(){t.toggleClass(options.cellFlashingCssClass).dequeue(),e(t,n-1)}))}),i)}($$5(getCellNode(e,t)),4)}function handleMouseWheel(e,t,i,n){var o=$$5(e.target).closest(".slick-row"),r=o[0];if(r!=rowNodeFromLastMouseWheelEvent){var s=o.parents(".grid-canvas").hasClass("grid-canvas-left");if(zombieRowNodeFromLastMouseWheelEvent&&zombieRowNodeFromLastMouseWheelEvent[s?0:1]!=r){var a=zombieRowNodeFromLastMouseWheelEvent[s||1==zombieRowNodeFromLastMouseWheelEvent.length?0:1];a.parentElement.removeChild(a),zombieRowNodeFromLastMouseWheelEvent=null}rowNodeFromLastMouseWheelEvent=r}scrollTop=Math.max(0,$viewportScrollContainerY[0].scrollTop-n*options.rowHeight),scrollLeft=$viewportScrollContainerX[0].scrollLeft+10*i,_handleScroll(!0)&&e.preventDefault()}function handleDragInit(e,t){var i=getCellFromEvent(e);if(!i||!cellExists(i.row,i.cell))return!1;var n=trigger(self.onDragInit,t,e);return!!e.isImmediatePropagationStopped()&&n}function handleDragStart(e,t){var i=getCellFromEvent(e);if(!i||!cellExists(i.row,i.cell))return!1;var n=trigger(self.onDragStart,t,e);return!!e.isImmediatePropagationStopped()&&n}function handleDrag(e,t){return trigger(self.onDrag,t,e)}function handleDragEnd(e,t){trigger(self.onDragEnd,t,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},e);var t=e.isImmediatePropagationStopped(),i=Slick$4.keyCode;if(!t&&!e.shiftKey&&!e.altKey){if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.which==i.HOME?t=e.ctrlKey?navigateTop():navigateRowStart():e.which==i.END&&(t=e.ctrlKey?navigateBottom():navigateRowEnd())}if(!t)if(e.shiftKey||e.altKey||e.ctrlKey)e.which!=i.TAB||!e.shiftKey||e.ctrlKey||e.altKey||(t=navigatePrev());else{if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;if(e.which==i.ESCAPE){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else e.which==i.PAGE_DOWN?(navigatePageDown(),t=!0):e.which==i.PAGE_UP?(navigatePageUp(),t=!0):e.which==i.LEFT?t=navigateLeft():e.which==i.RIGHT?t=navigateRight():e.which==i.UP?t=navigateUp():e.which==i.DOWN?t=navigateDown():e.which==i.TAB?t=navigateNext():e.which==i.ENTER&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable(void 0,void 0,e)),t=!0)}if(t){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(n){}}}function handleClick(e){currentEditor||(e.target!=document.activeElement||$$5(e.target).hasClass("slick-cell"))&&setFocus();var t=getCellFromEvent(e);if(t&&(null===currentEditor||activeRow!=t.row||activeCell!=t.cell)&&(trigger(self.onClick,{row:t.row,cell:t.cell},e),!e.isImmediatePropagationStopped()&&canCellBeActive(t.row,t.cell)&&(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()))){scrollRowIntoView(t.row,!1);var i=e.target&&e.target.className===Slick$4.preClickClassName,n=columns[t.cell],o=!!(options.editable&&n&&n.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(getCellNode(t.row,t.cell),null,i,o,e)}}function handleContextMenu(e){var t=$$5(e.target).closest(".slick-cell",$canvas);0!==t.length&&(activeCellNode===t[0]&&null!==currentEditor||trigger(self.onContextMenu,{},e))}function handleDblClick(e){var t=getCellFromEvent(e);!t||null!==currentEditor&&activeRow==t.row&&activeCell==t.cell||(trigger(self.onDblClick,{row:t.row,cell:t.cell},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(t.row,t.cell,!0,e))}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:$$5(this).data("column"),grid:self},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:$$5(this).data("column"),grid:self},e)}function handleHeaderContextMenu(e){var t=$$5(e.target).closest(".slick-header-column",".slick-header-columns"),i=t&&t.data("column");trigger(self.onHeaderContextMenu,{column:i},e)}function handleHeaderClick(e){if(!columnResizeDragging){var t=$$5(e.target).closest(".slick-header-column",".slick-header-columns"),i=t&&t.data("column");i&&trigger(self.onHeaderClick,{column:i},e)}}function handleFooterContextMenu(e){var t=$$5(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),i=t&&t.data("column");trigger(self.onFooterContextMenu,{column:i},e)}function handleFooterClick(e){var t=$$5(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),i=t&&t.data("column");trigger(self.onFooterClick,{column:i},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(e,t){return!(e<0||e>=getDataLength()||t<0||t>=columns.length)}function getCellFromPoint(e,t){for(var i=getRowFromPosition(t),n=0,o=0,r=0;r<columns.length&&o<e;r++)o+=columns[r].width,n++;return n<0&&(n=0),{row:i,cell:n-1}}function getCellFromNode(e){var t=/l\d+/.exec(e.className);if(!t)throw new Error("getCellFromNode: cannot get cell - "+e.className);return parseInt(t[0].substr(1,t[0].length-1),10)}function getRowFromNode(e){for(var t in rowsCache)for(var i in rowsCache[t].rowNode)if(rowsCache[t].rowNode[i]===e)return t?parseInt(t):0;return null}function getFrozenRowOffset(e){return hasFrozenRows?options.frozenBottom?e>=actualFrozenRow?h<viewportTopH?actualFrozenRow*options.rowHeight:h:0:e>=actualFrozenRow?frozenRowsHeight:0:0}function getCellFromEvent(e){var t,i,n=$$5(e.target).closest(".slick-cell",$canvas);if(!n.length)return null;if(t=getRowFromNode(n[0].parentNode),hasFrozenRows){var o=n.parents(".grid-canvas").offset(),r=0;n.parents(".grid-canvas-bottom").length&&(r=options.frozenBottom?$canvasTopL.height():frozenRowsHeight),t=getCellFromPoint(e.clientX-o.left,e.clientY-o.top+r+$$5(document).scrollTop()).row}return i=getCellFromNode(n[0]),null==t||null==i?null:{row:t,cell:i}}function getCellNodeBox(e,t){if(!cellExists(e,t))return null;for(var i=getFrozenRowOffset(e),n=getRowTop(e)-i,o=n+options.rowHeight-1,r=0,s=0;s<t;s++)r+=columns[s].width,options.frozenColumn==s&&(r=0);return{top:n,left:r,bottom:o,right:r+columns[t].width}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(e,t,i){if(scrollRowIntoView(e,i),!(t<=options.frozenColumn)){var n=getColspan(e,t);internalScrollColumnIntoView(columnPosLeft[t],columnPosRight[t+(n>1?n-1:0)])}}function internalScrollColumnIntoView(e,t){var i=scrollLeft+$viewportScrollContainerX.width();e<scrollLeft?($viewportScrollContainerX.scrollLeft(e),handleScroll(),render()):t>i&&($viewportScrollContainerX.scrollLeft(Math.min(e,t-$viewportScrollContainerX[0].clientWidth)),handleScroll(),render())}function scrollColumnIntoView(e){internalScrollColumnIntoView(columnPosLeft[e],columnPosRight[e])}function setActiveCellInternal(e,t,i,n,o){if(null!==activeCellNode&&(makeActiveCellNormal(),$$5(activeCellNode).removeClass("active"),rowsCache[activeRow]&&$$5(rowsCache[activeRow].rowNode).removeClass("active")),null!=(activeCellNode=e)){var r=$$5(activeCellNode),s=r.offset(),a=Math.floor(r.parents(".grid-canvas").offset().top),l=r.parents(".grid-canvas-bottom").length;hasFrozenRows&&l&&(a-=options.frozenBottom?$canvasTopL.height():frozenRowsHeight);var c=getCellFromPoint(s.left,Math.ceil(s.top)-a);activeRow=c.row,activeCell=activePosX=activeCell=activePosX=getCellFromNode(activeCellNode),null==t&&(t=activeRow==getDataLength()||options.autoEdit),options.showCellSelection&&(r.addClass("active"),rowsCache[activeRow]&&$$5(rowsCache[activeRow].rowNode).addClass("active")),options.editable&&t&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout((function(){makeActiveCellEditable(void 0,i,o)}),options.asyncEditorLoadDelay):makeActiveCellEditable(void 0,i,o))}else activeRow=activeCell=null;n||trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(t){}else if(window.getSelection){var e=window.getSelection();e&&e.removeAllRanges&&e.removeAllRanges()}}function isCellPotentiallyEditable(e,t){var i=getDataLength();return!(e<i&&!getDataItem(e))&&(!(columns[t].cannotTriggerInsert&&e>=i)&&!!getEditor(e,t))}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode){var e=getDataItem(activeRow);if($$5(activeCellNode).removeClass("editable invalid"),e){var t=columns[activeCell];applyFormatResultToCellNode(getFormatter(activeRow,t)(activeRow,activeCell,getDataItemValueForColumn(e,t),t,e,self),activeCellNode),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(e,t,i){if(activeCellNode){if(!options.editable)throw new Error("Grid : makeActiveCellEditable : should never get called when options.editable is false");if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var n=columns[activeCell],o=getDataItem(activeRow);if(!1!==trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:o,column:n})){getEditorLock().activate(editController),$$5(activeCellNode).addClass("editable");var r=e||getEditor(activeRow,activeCell);e||r.suppressClearOnEdit||(activeCellNode.innerHTML="");var s=data.getItemMetadata&&data.getItemMetadata(activeRow),a=(s=s&&s.columns)&&(s[n.id]||s[activeCell]);currentEditor=new r({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:n,columnMetaData:a,item:o||{},event:i,commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),o&&(currentEditor.loadValue(o),t&&currentEditor.preClick&&currentEditor.preClick()),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}else setFocus()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(e){var t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:$$5(e).outerWidth(),height:$$5(e).outerHeight(),visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;for(var i=e.offsetParent;(e=e.parentNode)!=document.body&&null!=e;)t.visible&&e.scrollHeight!=e.offsetHeight&&"visible"!=$$5(e).css("overflowY")&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!=e.offsetWidth&&"visible"!=$$5(e).css("overflowX")&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===i&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,i=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width;return t}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{}),currentEditor)){var e=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(e.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(e)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(e,t){if(!hasFrozenRows||!options.frozenBottom&&e>actualFrozenRow-1||options.frozenBottom&&e<actualFrozenRow-1){var i=$viewportScrollContainerY.height(),n=hasFrozenRows&&!options.frozenBottom?e-options.frozenRow:e,o=n*options.rowHeight,r=(n+1)*options.rowHeight-i+(viewportHasHScroll?scrollbarDimensions.height:0);(n+1)*options.rowHeight>scrollTop+i+offset?(scrollTo(t?o:r),render()):n*options.rowHeight<scrollTop+offset&&(scrollTo(t?r:o),render())}}function scrollRowToTop(e){scrollTo(e*options.rowHeight),render()}function scrollPage(e){var t=e*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop+options.rowHeight-1)+t)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var i=activeRow+t,n=getDataLengthIncludingAddNew();i>=n&&(i=n-1),i<0&&(i=0);for(var o=0,r=null,s=activePosX;o<=activePosX;)canCellBeActive(i,o)&&(r=o),o+=getColspan(i,o);null!==r?(setActiveCellInternal(getCellNode(i,r)),activePosX=s):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function navigateTop(){navigateToRow(0)}function navigateBottom(){navigateToRow(getDataLength()-1)}function navigateToRow(e){var t=getDataLength();if(!t)return!0;if(e<0?e=0:e>=t&&(e=t-1),scrollCellIntoView(e,0,!0),options.enableCellNavigation&&null!=activeRow){for(var i=0,n=null,o=activePosX;i<=activePosX;)canCellBeActive(e,i)&&(n=i),i+=getColspan(e,i);null!==n?(setActiveCellInternal(getCellNode(e,n)),activePosX=o):resetActiveCell()}return!0}function getColspan(e,t){var i=data.getItemMetadata&&data.getItemMetadata(e);if(!i||!i.columns)return 1;var n=i.columns[columns[t].id]||i.columns[t],o=n&&n.colspan;return o="*"===o?columns.length-t:o||1}function findFirstFocusableCell(e){for(var t=0;t<columns.length;){if(canCellBeActive(e,t))return t;t+=getColspan(e,t)}return null}function findLastFocusableCell(e){for(var t=0,i=null;t<columns.length;)canCellBeActive(e,t)&&(i=t),t+=getColspan(e,t);return i}function gotoRight(e,t,i){if(t>=columns.length)return null;do{t+=getColspan(e,t)}while(t<columns.length&&!canCellBeActive(e,t));return t<columns.length?{row:e,cell:t,posX:t}:null}function gotoLeft(e,t,i){if(t<=0)return null;var n=findFirstFocusableCell(e);if(null===n||n>=t)return null;for(var o,r={row:e,cell:n,posX:n};;){if(!(o=gotoRight(r.row,r.cell,r.posX)))return null;if(o.cell>=t)return r;r=o}}function gotoDown(e,t,i){for(var n,o=getDataLengthIncludingAddNew();;){if(++e>=o)return null;for(n=t=0;t<=i;)n=t,t+=getColspan(e,t);if(canCellBeActive(e,n))return{row:e,cell:n,posX:i}}}function gotoUp(e,t,i){for(var n;;){if(--e<0)return null;for(n=t=0;t<=i;)n=t,t+=getColspan(e,t);if(canCellBeActive(e,n))return{row:e,cell:n,posX:i}}}function gotoNext(e,t,i){if(null==e&&null==t&&canCellBeActive(e=t=0,t))return{row:e,cell:t,posX:t};var n=gotoRight(e,t);if(n)return n;var o=null,r=getDataLengthIncludingAddNew();for(e===r-1&&e--;++e<r;)if(null!==(o=findFirstFocusableCell(e)))return{row:e,cell:o,posX:o};return null}function gotoPrev(e,t,i){if(null==e&&null==t&&canCellBeActive(e=getDataLengthIncludingAddNew()-1,t=columns.length-1))return{row:e,cell:t,posX:t};for(var n,o;!n&&!(n=gotoLeft(e,t));){if(--e<0)return null;t=0,null!==(o=findLastFocusableCell(e))&&(n={row:e,cell:o,posX:o})}return n}function gotoRowStart(e,t,i){var n=findFirstFocusableCell(e);return null===n?null:{row:e,cell:n,posX:n}}function gotoRowEnd(e,t,i){var n=findLastFocusableCell(e);return null===n?null:{row:e,cell:n,posX:n}}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigateRowStart(){return navigate("home")}function navigateRowEnd(){return navigate("end")}function navigate(e){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=e&&"next"!=e)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus();tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];var t=(0,{up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext,home:gotoRowStart,end:gotoRowEnd}[e])(activeRow,activeCell,activePosX);if(t){if(hasFrozenRows&&options.frozenBottom&t.row==getDataLength())return;var i=t.row==getDataLength();return(!options.frozenBottom&&t.row>=actualFrozenRow||options.frozenBottom&&t.row<actualFrozenRow)&&scrollCellIntoView(t.row,t.cell,!i&&options.emulatePagingWhenScrolling),setActiveCellInternal(getCellNode(t.row,t.cell)),activePosX=t.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell)),!1}function getCellNode(e,t){if(rowsCache[e]){ensureCellNodesInRowsCache(e);try{return rowsCache[e].cellNodesByColumnIdx.length>t?rowsCache[e].cellNodesByColumnIdx[t][0]:null}catch(i){return rowsCache[e].cellNodesByColumnIdx[t]}}return null}function setActiveCell(e,t,i,n,o){initialized&&(e>getDataLength()||e<0||t>=columns.length||t<0||options.enableCellNavigation&&(scrollCellIntoView(e,t,!1),setActiveCellInternal(getCellNode(e,t),i,n,o)))}function canCellBeActive(e,t){if(!options.enableCellNavigation||e>=getDataLengthIncludingAddNew()||e<0||t>=columns.length||t<0)return!1;var i=data.getItemMetadata&&data.getItemMetadata(e);if(i&&void 0!==i.focusable)return!!i.focusable;var n=i&&i.columns;return n&&n[columns[t].id]&&void 0!==n[columns[t].id].focusable?!!n[columns[t].id].focusable:n&&n[t]&&void 0!==n[t].focusable?!!n[t].focusable:!!columns[t].focusable}function canCellBeSelected(e,t){if(e>=getDataLength()||e<0||t>=columns.length||t<0)return!1;var i=data.getItemMetadata&&data.getItemMetadata(e);if(i&&void 0!==i.selectable)return!!i.selectable;var n=i&&i.columns&&(i.columns[columns[t].id]||i.columns[t]);return n&&void 0!==n.selectable?!!n.selectable:!!columns[t].selectable}function gotoCell(e,t,i,n){if(initialized&&canCellBeActive(e,t)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(e,t,!1);var o=getCellNode(e,t),r=columns[t],s=!!(options.editable&&r&&r.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(o,i||e===getDataLength()||options.autoEdit,null,s,n),currentEditor||setFocus()}}function commitCurrentEdit(){var e=getDataItem(activeRow),t=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var i=currentEditor.validate();if(i.valid){if(activeRow<getDataLength()){var n={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(e,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:e})},undo:function(){this.editor.applyValue(e,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{row:this.row,cell:this.cell,item:e})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(e,t,n)):(n.execute(),makeActiveCellNormal())}else{var o={};currentEditor.applyValue(o,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:o,column:t})}return!getEditorLock().isActive()}return $$5(activeCellNode).removeClass("invalid"),$$5(activeCellNode).width(),$$5(activeCellNode).addClass("invalid"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:i,row:activeRow,cell:activeCell,column:t}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(e){for(var t=[],i=columns.length-1,n=0;n<e.length;n++)t.push(new Slick$4.Range(e[n],0,e[n],i));return t}function getSelectedRows(){if(!selectionModel)throw new Error("Selection model is not set");return selectedRows.slice(0)}function setSelectedRows(e){if(!selectionModel)throw new Error("Selection model is not set");self&&self.getEditorLock&&!self.getEditorLock().isActive()&&selectionModel.setSelectedRanges(rowsToRanges(e))}this.debug=function(){var e="";e+="\ncounter_rows_rendered:  "+counter_rows_rendered,e+="\ncounter_rows_removed:  "+counter_rows_removed,e+="\nrenderedRows:  "+renderedRows,e+="\nnumVisibleRows:  "+numVisibleRows,e+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,e+="\nn(umber of pages):  "+n,e+="\n(current) page:  "+page,e+="\npage height (ph):  "+ph,e+="\nvScrollDir:  "+vScrollDir,alert(e)},this.eval=function(expr){return eval(expr)},$$5.extend(this,{slickGridVersion:"2.4.27",onScroll:new Slick$4.Event,onSort:new Slick$4.Event,onHeaderMouseEnter:new Slick$4.Event,onHeaderMouseLeave:new Slick$4.Event,onHeaderContextMenu:new Slick$4.Event,onHeaderClick:new Slick$4.Event,onHeaderCellRendered:new Slick$4.Event,onBeforeHeaderCellDestroy:new Slick$4.Event,onHeaderRowCellRendered:new Slick$4.Event,onFooterRowCellRendered:new Slick$4.Event,onFooterContextMenu:new Slick$4.Event,onFooterClick:new Slick$4.Event,onBeforeHeaderRowCellDestroy:new Slick$4.Event,onBeforeFooterRowCellDestroy:new Slick$4.Event,onMouseEnter:new Slick$4.Event,onMouseLeave:new Slick$4.Event,onClick:new Slick$4.Event,onDblClick:new Slick$4.Event,onContextMenu:new Slick$4.Event,onKeyDown:new Slick$4.Event,onAddNewRow:new Slick$4.Event,onBeforeAppendCell:new Slick$4.Event,onValidationError:new Slick$4.Event,onViewportChanged:new Slick$4.Event,onColumnsReordered:new Slick$4.Event,onColumnsDrag:new Slick$4.Event,onColumnsResized:new Slick$4.Event,onBeforeColumnsResize:new Slick$4.Event,onCellChange:new Slick$4.Event,onBeforeEditCell:new Slick$4.Event,onBeforeCellEditorDestroy:new Slick$4.Event,onBeforeDestroy:new Slick$4.Event,onActiveCellChanged:new Slick$4.Event,onActiveCellPositionChanged:new Slick$4.Event,onDragInit:new Slick$4.Event,onDragStart:new Slick$4.Event,onDrag:new Slick$4.Event,onDragEnd:new Slick$4.Event,onSelectedRowsChanged:new Slick$4.Event,onCellCssStylesChanged:new Slick$4.Event,onAutosizeColumns:new Slick$4.Event,onRendered:new Slick$4.Event,onSetOptions:new Slick$4.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getPluginByName:getPluginByName,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,setSortColumns:setSortColumns,getSortColumns:getSortColumns,autosizeColumns:autosizeColumns,autosizeColumn:autosizeColumn,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getContainerNode:getContainerNode,updatePagingStatusFromView:updatePagingStatusFromView,applyFormatResultToCellNode:applyFormatResultToCellNode,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,getRenderedRange:getRenderedRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,scrollRowToTop:scrollRowToTop,scrollCellIntoView:scrollCellIntoView,scrollColumnIntoView:scrollColumnIntoView,getCanvasNode:getCanvasNode,getUID:getUID,getHeaderColumnWidthDiff:getHeaderColumnWidthDiff,getScrollbarDimensions:getScrollbarDimensions,getHeadersWidth:getHeadersWidth,getCanvasWidth:getCanvasWidth,getCanvases:getCanvases,getActiveCanvasNode:getActiveCanvasNode,setActiveCanvasNode:setActiveCanvasNode,getViewportNode:getViewportNode,getActiveViewportNode:getActiveViewportNode,setActiveViewportNode:setActiveViewportNode,focus:setFocus,scrollTo:scrollTo,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,navigatePageUp:navigatePageUp,navigatePageDown:navigatePageDown,navigateTop:navigateTop,navigateBottom:navigateBottom,navigateRowStart:navigateRowStart,navigateRowEnd:navigateRowEnd,gotoCell:gotoCell,getTopPanel:getTopPanel,setTopPanelVisibility:setTopPanelVisibility,getPreHeaderPanel:getPreHeaderPanel,getPreHeaderPanelLeft:getPreHeaderPanel,getPreHeaderPanelRight:getPreHeaderPanelRight,setPreHeaderPanelVisibility:setPreHeaderPanelVisibility,getHeader:getHeader,getHeaderColumn:getHeaderColumn,setHeaderRowVisibility:setHeaderRowVisibility,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,setFooterRowVisibility:setFooterRowVisibility,getFooterRow:getFooterRow,getFooterRowColumn:getFooterRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,getCellCssStyles:getCellCssStyles,getFrozenRowOffset:getFrozenRowOffset,setColumnHeaderVisibility:setColumnHeaderVisibility,init:finishInitialization,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}var slick_grid={Grid:SlickGrid},$$4=slick_jquery,Slick$3=slick_core;function DataView$1(e){var t,i,n,o,r,s=this,a="id",l=[],c=[],d={},h=null,u=null,p=null,_=!1,f=!0,g={},m={},v=[],b=[],y={getter:null,formatter:null,comparer:function(e,t){return e.value===t.value?0:e.value>t.value?1:-1},predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},w=[],A=[],x=[],k=":|:",C=0,S=0,T=0,R=new Slick$3.Event,E=new Slick$3.Event,P=new Slick$3.Event,M=new Slick$3.Event,D=new Slick$3.Event,I=new Slick$3.Event,B=new Slick$3.Event,z=new Slick$3.Event;function L(e){for(var t,i=e=e||0,n=l.length;i<n;i++){if(void 0===(t=l[i][a]))throw new Error("Each data element must implement a unique 'id' property");d[t]=i}}function N(){var e=C?Math.max(1,Math.ceil(T/C)):1;return{pageSize:C,pageNum:S,totalRows:T,totalPages:e,dataView:s}}function $(e,n){f=n,i=e,t=null,!1===n&&l.reverse(),l.sort(e),!1===n&&l.reverse(),d={},L(),se()}function V(e,n){f=n,t=e,i=null;var o=Object.prototype.toString;Object.prototype.toString="function"==typeof e?e:function(){return this[e]},!1===n&&l.reverse(),l.sort(),Object.prototype.toString=o,!1===n&&l.reverse(),d={},L(),se()}function O(t){e.groupItemMetadataProvider||(e.groupItemMetadataProvider=new Slick$3.Data.GroupItemMetadataProvider),A=[],x=[],w=(t=t||[])instanceof Array?t:[t];for(var i=0;i<w.length;i++){var n=w[i]=$$4.extend(!0,{},y,w[i]);n.getterIsAFn="function"==typeof n.getter,n.compiledAccumulators=[];for(var o=n.aggregators.length;o--;)n.compiledAccumulators[o]=te(n.aggregators[o]);x[i]={}}se()}function F(){if(!h){h={};for(var e=0,t=c.length;e<t;e++)h[c[e][a]]=e}}function G(e){return l[d[e]]}function H(e,t){if(void 0===d[e])throw new Error("Invalid id");if(e!==t[a]){var i=t[a];if(null==i)throw new Error("Cannot update item to associate with a null id");if(void 0!==d[i])throw new Error("Cannot update item to associate with a non-unique id");d[i]=d[e],delete d[e],p&&p[e]&&delete p[e],e=i}l[d[e]]=t,p||(p={}),p[e]=!0,se()}function j(e,t){l.splice(e,0,t),L(e),se()}function U(e){var t=d[e];if(void 0===t)throw new Error("Invalid id");delete d[e],l.splice(t,1),L(t),se()}function W(e){if(!i)throw new Error("sortedAddItem() requires a sort comparer, use sort()");j(function(e){var t=0,n=l.length;for(;t<n;){var o=t+n>>>1;-1===i(l[o],e)?t=o+1:n=o}return t}(e),e)}function Y(e,t){if(null==e)for(var i=0;i<w.length;i++)x[i]={},w[i].collapsed=t,!0===t?z.notify({level:i,groupingKey:null}):B.notify({level:i,groupingKey:null});else x[e]={},w[e].collapsed=t,!0===t?z.notify({level:e,groupingKey:null}):B.notify({level:e,groupingKey:null});se()}function q(e,t,i){x[e][t]=w[e].collapsed^i,se()}function X(e,t){for(var i,n,o,r=[],s={},a=t?t.level+1:0,l=w[a],c=0,d=l.predefinedValues.length;c<d;c++)(i=s[n=l.predefinedValues[c]])||((i=new Slick$3.Group).value=n,i.level=a,i.groupingKey=(t?t.groupingKey+k:"")+n,r[r.length]=i,s[n]=i);for(c=0,d=e.length;c<d;c++)o=e[c],(i=s[n=l.getterIsAFn?l.getter(o):o[l.getter]])||((i=new Slick$3.Group).value=n,i.level=a,i.groupingKey=(t?t.groupingKey+k:"")+n,r[r.length]=i,s[n]=i),i.rows[i.count++]=o;if(a<w.length-1)for(c=0;c<r.length;c++)(i=r[c]).groups=X(i.rows,i);return r.length&&Q(r,a),r.sort(w[a].comparer),r}function K(e){var t,i=e.group,n=w[i.level],o=i.level==w.length,r=n.aggregators.length;if(!o&&n.aggregateChildGroups)for(var s=i.groups.length;s--;)i.groups[s].totals.initialized||K(i.groups[s].totals);for(;r--;)(t=n.aggregators[r]).init(),!o&&n.aggregateChildGroups?n.compiledAccumulators[r].call(t,i.groups):n.compiledAccumulators[r].call(t,i.rows),t.storeResult(e);e.initialized=!0}function J(e){var t=w[e.level],i=new Slick$3.GroupTotals;i.group=e,e.totals=i,t.lazyTotalsCalculation||K(i)}function Q(e,t){for(var i,n=w[t=t||0],o=n.collapsed,r=x[t],s=e.length;s--;)(i=e[s]).collapsed&&!n.aggregateCollapsed||(i.groups&&Q(i.groups,t+1),n.aggregators.length&&(n.aggregateEmpty||i.rows.length||i.groups&&i.groups.length)&&J(i),i.collapsed=o^r[i.groupingKey],i.title=n.formatter?n.formatter(i):i.value)}function Z(e,t){for(var i,n,o=w[t=t||0],r=[],s=0,a=0,l=e.length;a<l;a++){if(n=e[a],r[s++]=n,!n.collapsed)for(var c=0,d=(i=n.groups?Z(n.groups,t+1):n.rows).length;c<d;c++)r[s++]=i[c];n.totals&&o.displayTotalsRow&&(!n.collapsed||o.aggregateCollapsed)&&(r[s++]=n.totals)}return r}function ee(e){var t=e.toString().indexOf("function")>=0?/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/:/^[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/,i=e.toString().match(t);return{params:i[1].split(","),body:i[2]}}function te(e){if(e.accumulate){var t=ee(e.accumulate),i=new Function("_items","for (var "+t.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+t.params[0]+" = _items[_i]; "+t.body+"}"),n="compiledAccumulatorLoop";return i.displayName=n,i.name=ie(i,n),i}return function(){}}function ie(e,t){try{Object.defineProperty(e,"name",{writable:!0,value:t})}catch(i){e.name=t}}function ne(e,t){for(var i=[],n=0,o=0,r=e.length;o<r;o++)u(e[o],t)&&(i[n++]=e[o]);return i}function oe(e,t,i){for(var n,o=[],r=0,s=0,a=e.length;s<a;s++)n=e[s],i[s]?o[r++]=n:u(n,t)&&(o[r++]=n,i[s]=!0);return o}function re(t){h=null,g.isFilterNarrowing==m.isFilterNarrowing&&g.isFilterExpanding==m.isFilterExpanding||(b=[]);var i=function(t){if(u){var i=e.inlineFilters?o:ne,s=e.inlineFilters?r:oe;g.isFilterNarrowing?v=i(v,n):g.isFilterExpanding?v=s(t,n,b):g.isFilterUnchanged||(v=i(t,n))}else v=C?t:t.concat();var a;return C?(v.length<=S*C&&(S=0===v.length?0:Math.floor((v.length-1)/C)),a=v.slice(C*S,C*S+C)):a=v,{totalRows:v.length,rows:a}}(t);T=i.totalRows;var s=i.rows;A=[],w.length&&(A=X(s)).length&&(s=Z(A));var l=function(e,t){var i,n,o,r=[],s=0,l=Math.max(t.length,e.length);g&&g.ignoreDiffsBefore&&(s=Math.max(0,Math.min(t.length,g.ignoreDiffsBefore))),g&&g.ignoreDiffsAfter&&(l=Math.min(t.length,Math.max(0,g.ignoreDiffsAfter)));for(var c=s,d=e.length;c<l;c++)c>=d?r[r.length]=c:(i=t[c],n=e[c],(!i||w.length&&(o=i.__nonDataRow||n.__nonDataRow)&&i.__group!==n.__group||i.__group&&!i.equals(n)||o&&(i.__groupTotals||n.__groupTotals)||i[a]!=n[a]||p&&p[i[a]])&&(r[r.length]=c));return r}(c,s);return c=s,l}function se(){if(!_){var e=$$4.extend(!0,{},N()),t=c.length,i=T,n=re(l);C&&T<S*C&&(S=Math.max(0,Math.ceil(T/C)-1),n=re(l)),p=null,m=g,g={},i!==T&&(D.notify(e,null,s),I.notify(N(),null,s)),t!==c.length&&E.notify({previous:t,current:c.length,dataView:s,callingOnRowsChanged:n.length>0},null,s),n.length>0&&P.notify({rows:n,dataView:s,calledOnRowCountChanged:t!==c.length},null,s),(t!==c.length||n.length>0)&&M.notify({rowsDiff:n,previousRowCount:t,currentRowCount:c.length,rowCountChanged:t!==c.length,rowsChanged:n.length>0,dataView:s},null,s)}}e=$$4.extend(!0,{},{groupItemMetadataProvider:null,inlineFilters:!1},e),$$4.extend(this,{beginUpdate:function(){_=!0},endUpdate:function(){_=!1,se()},setPagingOptions:function(e){D.notify(N(),null,s),null!=e.pageSize&&(C=e.pageSize,S=C?Math.min(S,Math.max(0,Math.ceil(T/C)-1)):0),null!=e.pageNum&&(S=Math.min(e.pageNum,Math.max(0,Math.ceil(T/C)-1))),I.notify(N(),null,s),se()},getPagingInfo:N,getIdPropertyName:function(){return a},getItems:function(){return l},setItems:function(e,t){void 0!==t&&(a=t),l=v=e,d={},L(),function(){for(var e,t=0,i=l.length;t<i;t++)if(void 0===(e=l[t][a])||d[e]!==t)throw new Error("Each data element must implement a unique 'id' property")}(),se(),R.notify({idProperty:t},null,s)},setFilter:function(t){u=t,e.inlineFilters&&(o=function(){var e=ee(u),t="{ continue _coreloop; }$1",i="{ _retval[_idx++] = $item$; continue _coreloop; }$1",n=e.body.replace(/return false\s*([;}]|\}|$)/gi,t).replace(/return!1([;}]|\}|$)/gi,t).replace(/return true\s*([;}]|\}|$)/gi,i).replace(/return!0([;}]|\}|$)/gi,i).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),o=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");o=(o=(o=o.replace(/\$filter\$/gi,n)).replace(/\$item\$/gi,e.params[0])).replace(/\$args\$/gi,e.params[1]);var r=new Function("_items,_args",o),s="compiledFilter";return r.displayName=s,r.name=ie(r,s),r}(),r=function(){var e=ee(u),t="{ continue _coreloop; }$1",i="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1",n=e.body.replace(/return false\s*([;}]|\}|$)/gi,t).replace(/return!1([;}]|\}|$)/gi,t).replace(/return true\s*([;}]|\}|$)/gi,i).replace(/return!0([;}]|\}|$)/gi,i).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),o=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");o=(o=(o=o.replace(/\$filter\$/gi,n)).replace(/\$item\$/gi,e.params[0])).replace(/\$args\$/gi,e.params[1]);var r=new Function("_items,_args,_cache",o),s="compiledFilterWithCaching";return r.displayName=s,r.name=ie(r,s),r}()),se()},getFilter:function(){return u},getFilteredItems:function(){return v},sort:$,fastSort:V,reSort:function(){i?$(i,f):t&&V(t,f)},setGrouping:O,getGrouping:function(){return w},groupBy:function(e,t,i){O(null!=e?{getter:e,formatter:t,comparer:i}:[])},setAggregators:function(e,t){if(!w.length)throw new Error("At least one grouping must be specified before calling setAggregators().");w[0].aggregators=e,w[0].aggregateCollapsed=t,O(w)},collapseAllGroups:function(e){Y(e,!0)},expandAllGroups:function(e){Y(e,!1)},collapseGroup:function(e){var t,i,n=Array.prototype.slice.call(arguments),o=n[0];1===n.length&&-1!==o.indexOf(k)?(t=o,i=o.split(k).length-1):(t=n.join(k),i=n.length-1),q(i,t,!0),z.notify({level:i,groupingKey:t})},expandGroup:function(e){var t,i,n=Array.prototype.slice.call(arguments),o=n[0];1===n.length&&-1!==o.indexOf(k)?(i=o.split(k).length-1,t=o):(i=n.length-1,t=n.join(k)),q(i,t,!1),B.notify({level:i,groupingKey:t})},getGroups:function(){return A},getIdxById:function(e){return d[e]},getRowByItem:function(e){return F(),h[e[a]]},getRowById:function(e){return F(),h[e]},getItemById:G,getItemByIdx:function(e){return l[e]},mapItemsToRows:function(e){var t=[];F();for(var i=0,n=e.length;i<n;i++){var o=h[e[i][a]];null!=o&&(t[t.length]=o)}return t},mapRowsToIds:function(e){for(var t=[],i=0,n=e.length;i<n;i++)e[i]<c.length&&(t[t.length]=c[e[i]][a]);return t},mapIdsToRows:function(e){var t=[];F();for(var i=0,n=e.length;i<n;i++){var o=h[e[i]];null!=o&&(t[t.length]=o)}return t},setRefreshHints:function(e){g=e},setFilterArgs:function(e){n=e},refresh:se,updateItem:H,insertItem:j,addItem:function(e){l.push(e),L(l.length-1),se()},deleteItem:U,sortedAddItem:W,sortedUpdateItem:function(e,t){if(void 0===d[e]||e!==t[a])throw new Error("Invalid or non-matching id "+d[e]);if(!i)throw new Error("sortedUpdateItem() requires a sort comparer, use sort()");var n=G(e);0!==i(n,t)?(U(e),W(t)):H(e,t)},syncGridSelection:function(e,t,i){var n,o=this,r=o.mapRowsToIds(e.getSelectedRows()),s=new Slick$3.Event;function a(t){r.join(",")!=t.join(",")&&(r=t,s.notify({grid:e,ids:r,dataView:o},new Slick$3.EventData,o))}return e.onSelectedRowsChanged.subscribe((function(t,s){if(!n){var l=o.mapRowsToIds(e.getSelectedRows());if(i&&e.getOptions().multiSelect)a($$4.grep(r,(function(e){return void 0===o.getRowById(e)})).concat(l));else a(l)}})),this.onRowsOrCountChanged.subscribe((function(){if(r.length>0){n=!0;var i=o.mapIdsToRows(r);t||a(o.mapRowsToIds(i)),e.setSelectedRows(i),n=!1}})),s},syncGridCellCssStyles:function(e,t){var i,n;function o(e){for(var t in i={},e){var n=c[t][a];i[n]=e[t]}}function r(){if(i){n=!0,F();var o={};for(var r in i){var s=h[r];null!=s&&(o[s]=i[r])}e.setCellCssStyles(t,o),n=!1}}o(e.getCellCssStyles(t)),e.onCellCssStylesChanged.subscribe((function(i,a){n||t==a.key&&(a.hash?o(a.hash):(e.onCellCssStylesChanged.unsubscribe(),s.onRowsOrCountChanged.unsubscribe(r)))})),this.onRowsOrCountChanged.subscribe(r)},getLength:function(){return c.length},getItem:function(e){var t=c[e];if(t&&t.__group&&t.totals&&!t.totals.initialized){var i=w[t.level];i.displayTotalsRow||(K(t.totals),t.title=i.formatter?i.formatter(t):t.value)}else t&&t.__groupTotals&&!t.initialized&&K(t);return t},getItemMetadata:function(t){var i=c[t];return void 0===i?null:i.__group?e.groupItemMetadataProvider.getGroupRowMetadata(i):i.__groupTotals?e.groupItemMetadataProvider.getTotalsRowMetadata(i):null},onSetItemsCalled:R,onRowCountChanged:E,onRowsChanged:P,onRowsOrCountChanged:M,onBeforePagingInfoChanged:D,onPagingInfoChanged:I,onGroupExpanded:B,onGroupCollapsed:z})}function AvgAggregator$1(e){this.field_=e,this.init=function(){this.count_=0,this.nonNullCount_=0,this.sum_=0},this.accumulate=function(e){var t=e[this.field_];this.count_++,null==t||""===t||isNaN(t)||(this.nonNullCount_++,this.sum_+=parseFloat(t))},this.storeResult=function(e){e.avg||(e.avg={}),0!==this.nonNullCount_&&(e.avg[this.field_]=this.sum_/this.nonNullCount_)}}function MinAggregator$1(e){this.field_=e,this.init=function(){this.min_=null},this.accumulate=function(e){var t=e[this.field_];null==t||""===t||isNaN(t)||(null==this.min_||t<this.min_)&&(this.min_=t)},this.storeResult=function(e){e.min||(e.min={}),e.min[this.field_]=this.min_}}function MaxAggregator$1(e){this.field_=e,this.init=function(){this.max_=null},this.accumulate=function(e){var t=e[this.field_];null==t||""===t||isNaN(t)||(null==this.max_||t>this.max_)&&(this.max_=t)},this.storeResult=function(e){e.max||(e.max={}),e.max[this.field_]=this.max_}}function SumAggregator$1(e){this.field_=e,this.init=function(){this.sum_=null},this.accumulate=function(e){var t=e[this.field_];null==t||""===t||isNaN(t)||(this.sum_+=parseFloat(t))},this.storeResult=function(e){e.sum||(e.sum={}),e.sum[this.field_]=this.sum_}}function CountAggregator(e){this.field_=e,this.init=function(){},this.storeResult=function(e){e.count||(e.count={}),e.count[this.field_]=e.group.rows.length}}var Aggregators={Avg:AvgAggregator$1,Min:MinAggregator$1,Max:MaxAggregator$1,Sum:SumAggregator$1,Count:CountAggregator},slick_dataview={DataView:DataView$1,Aggregators:Aggregators,Data:{Aggregators:Aggregators}},$$3=slick_jquery,Slick$2=slick_core;function TextEditor(e){var t,i;this.init=function(){var i=e.grid.getOptions().editorCellNavOnLRKeys;t=$$3("<INPUT type=text class='editor-text' />").appendTo(e.container).on("keydown.nav",i?handleKeydownLRNav:handleKeydownLRNoNav).focus().select()},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.getValue=function(){return t.val()},this.setValue=function(e){t.val(e)},this.loadValue=function(n){i=n[e.column.field]||"",t.val(i),t[0].defaultValue=i,t.select()},this.serializeValue=function(){return t.val()},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return!(""===t.val()&&null==i)&&t.val()!=i},this.validate=function(){if(e.column.validator){var i=e.column.validator(t.val());if(!i.valid)return i}return{valid:!0,msg:null}},this.init()}function IntegerEditor(e){var t,i;this.init=function(){var i=e.grid.getOptions().editorCellNavOnLRKeys;t=$$3("<INPUT type=text class='editor-text' />").appendTo(e.container).on("keydown.nav",i?handleKeydownLRNav:handleKeydownLRNoNav).focus().select()},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.loadValue=function(n){i=n[e.column.field],t.val(i),t[0].defaultValue=i,t.select()},this.serializeValue=function(){return parseInt(t.val(),10)||0},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return!(""===t.val()&&null==i)&&t.val()!=i},this.validate=function(){if(isNaN(t.val()))return{valid:!1,msg:"Please enter a valid integer"};if(e.column.validator){var i=e.column.validator(t.val());if(!i.valid)return i}return{valid:!0,msg:null}},this.init()}function FloatEditor(e){var t,i;function n(){var t=e.column.editorFixedDecimalPlaces;return void 0===t&&(t=FloatEditor.DefaultDecimalPlaces),t||0===t?t:null}this.init=function(){var i=e.grid.getOptions().editorCellNavOnLRKeys;t=$$3("<INPUT type=text class='editor-text' />").appendTo(e.container).on("keydown.nav",i?handleKeydownLRNav:handleKeydownLRNoNav).focus().select()},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.loadValue=function(o){i=o[e.column.field];var r=n();null!==r&&(i||0===i)&&i.toFixed&&(i=i.toFixed(r)),t.val(i),t[0].defaultValue=i,t.select()},this.serializeValue=function(){var e=parseFloat(t.val());FloatEditor.AllowEmptyValue?e||0===e||(e=""):e=e||0;var i=n();return null!==i&&(e||0===e)&&e.toFixed&&(e=parseFloat(e.toFixed(i))),e},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return!(""===t.val()&&null==i)&&t.val()!=i},this.validate=function(){if(isNaN(t.val()))return{valid:!1,msg:"Please enter a valid number"};if(e.column.validator){var i=e.column.validator(t.val());if(!i.valid)return i}return{valid:!0,msg:null}},this.init()}function DateEditor(e){var t,i,n=!1;this.init=function(){(t=$$3("<INPUT type=text class='editor-text' />")).appendTo(e.container),t.focus().select(),t.datepicker({showOn:"button",buttonImageOnly:!0,beforeShow:function(){n=!0},onClose:function(){n=!1}}),t.width(t.width()-18)},this.destroy=function(){$$3.datepicker.dpDiv.stop(!0,!0),t.datepicker("hide"),t.datepicker("destroy"),t.remove()},this.show=function(){n&&$$3.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){n&&$$3.datepicker.dpDiv.stop(!0,!0).hide()},this.position=function(e){n&&$$3.datepicker.dpDiv.css("top",e.top+30).css("left",e.left)},this.focus=function(){t.focus()},this.loadValue=function(n){i=n[e.column.field],t.val(i),t[0].defaultValue=i,t.select()},this.serializeValue=function(){return t.val()},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return!(""===t.val()&&null==i)&&t.val()!=i},this.validate=function(){if(e.column.validator){var i=e.column.validator(t.val());if(!i.valid)return i}return{valid:!0,msg:null}},this.init()}function YesNoSelectEditor(e){var t,i;this.init=function(){(t=$$3("<SELECT tabIndex='0' class='editor-yesno'><OPTION value='yes'>Yes</OPTION><OPTION value='no'>No</OPTION></SELECT>")).appendTo(e.container),t.focus()},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.loadValue=function(n){t.val((i=n[e.column.field])?"yes":"no"),t.select()},this.serializeValue=function(){return"yes"==t.val()},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return t.val()!=i},this.validate=function(){return{valid:!0,msg:null}},this.init()}function CheckboxEditor(e){var t,i;this.init=function(){(t=$$3("<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus>")).appendTo(e.container),t.focus()},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.loadValue=function(n){(i=!!n[e.column.field])?t.prop("checked",!0):t.prop("checked",!1)},this.preClick=function(){t.prop("checked",!t.prop("checked"))},this.serializeValue=function(){return t.prop("checked")},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return this.serializeValue()!==i},this.validate=function(){return{valid:!0,msg:null}},this.init()}function PercentCompleteEditor(e){var t,i,n;this.init=function(){(t=$$3("<INPUT type=text class='editor-percentcomplete' />")).width($$3(e.container).innerWidth()-25),t.appendTo(e.container),(i=$$3("<div class='editor-percentcomplete-picker' />").appendTo(e.container)).append("<div class='editor-percentcomplete-helper'><div class='editor-percentcomplete-wrapper'><div class='editor-percentcomplete-slider' /><div class='editor-percentcomplete-buttons' /></div></div>"),i.find(".editor-percentcomplete-buttons").append("<button val=0>Not started</button><br/><button val=50>In Progress</button><br/><button val=100>Complete</button>"),t.focus().select(),i.find(".editor-percentcomplete-slider").slider({orientation:"vertical",range:"min",value:n,slide:function(e,i){t.val(i.value)}}),i.find(".editor-percentcomplete-buttons button").on("click",(function(e){t.val($$3(this).attr("val")),i.find(".editor-percentcomplete-slider").slider("value",$$3(this).attr("val"))}))},this.destroy=function(){t.remove(),i.remove()},this.focus=function(){t.focus()},this.loadValue=function(i){t.val(n=i[e.column.field]),t.select()},this.serializeValue=function(){return parseInt(t.val(),10)||0},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return!(""===t.val()&&null==n)&&(parseInt(t.val(),10)||0)!=n},this.validate=function(){return isNaN(parseInt(t.val(),10))?{valid:!1,msg:"Please enter a valid positive number"}:{valid:!0,msg:null}},this.init()}function LongTextEditor(e){var t,i,n,o=this;this.init=function(){var n=$$3("body");e.grid.getOptions().editorCellNavOnLRKeys,i=$$3("<DIV style='z-index:10000;position:absolute;background:white;padding:5px;border:3px solid gray; -moz-border-radius:10px; border-radius:10px;'/>").appendTo(n),t=$$3("<TEXTAREA hidefocus rows=5 style='background:white;width:250px;height:80px;border:0;outline:0'>").appendTo(i),$$3("<DIV style='text-align:right'><BUTTON>Save</BUTTON><BUTTON>Cancel</BUTTON></DIV>").appendTo(i),i.find("button:first").on("click",this.save),i.find("button:last").on("click",this.cancel),t.on("keydown",this.handleKeyDown),o.position(e.position),t.focus().select()},this.handleKeyDown=function(t){if(t.which==Slick$2.keyCode.ENTER&&t.ctrlKey)o.save();else if(t.which==Slick$2.keyCode.ESCAPE)t.preventDefault(),o.cancel();else if(t.which==Slick$2.keyCode.TAB&&t.shiftKey)t.preventDefault(),e.grid.navigatePrev();else if(t.which==Slick$2.keyCode.TAB)t.preventDefault(),e.grid.navigateNext();else if((t.which==Slick$2.keyCode.LEFT||t.which==Slick$2.keyCode.RIGHT)&&e.grid.getOptions().editorCellNavOnLRKeys){var i=this.selectionStart,n=this.value.length;t.keyCode===Slick$2.keyCode.LEFT&&0===i&&e.grid.navigatePrev(),t.keyCode===Slick$2.keyCode.RIGHT&&i>=n-1&&e.grid.navigateNext()}},this.save=function(){e.commitChanges()},this.cancel=function(){t.val(n),e.cancelChanges()},this.hide=function(){i.hide()},this.show=function(){i.show()},this.position=function(e){i.css("top",e.top-5).css("left",e.left-5)},this.destroy=function(){i.remove()},this.focus=function(){t.focus()},this.loadValue=function(i){t.val(n=i[e.column.field]),t.select()},this.serializeValue=function(){return t.val()},this.applyValue=function(t,i){t[e.column.field]=i},this.isValueChanged=function(){return!(""===t.val()&&null==n)&&t.val()!=n},this.validate=function(){if(e.column.validator){var i=e.column.validator(t.val());if(!i.valid)return i}return{valid:!0,msg:null}},this.init()}function handleKeydownLRNav(e){var t=this.selectionStart,i=this.value.length;(e.keyCode===Slick$2.keyCode.LEFT&&t>0||e.keyCode===Slick$2.keyCode.RIGHT&&t<i-1)&&e.stopImmediatePropagation()}function handleKeydownLRNoNav(e){e.keyCode!==Slick$2.keyCode.LEFT&&e.keyCode!==Slick$2.keyCode.RIGHT||e.stopImmediatePropagation()}FloatEditor.DefaultDecimalPlaces=null,FloatEditor.AllowEmptyValue=!1;var slick_editors={Editors:{Text:TextEditor,Integer:IntegerEditor,Float:FloatEditor,Date:DateEditor,YesNoSelect:YesNoSelectEditor,Checkbox:CheckboxEditor,PercentComplete:PercentCompleteEditor,LongText:LongTextEditor}};function PercentCompleteFormatter(e,t,i,n,o){return null==i||""===i?"-":i<50?"<span style='color:red;font-weight:bold;'>"+i+"%</span>":"<span style='color:green'>"+i+"%</span>"}function PercentCompleteBarFormatter(e,t,i,n,o){return null==i||""===i?"":"<span class='percent-complete-bar' style='background:"+(i<30?"red":i<70?"silver":"green")+";width:"+i+"%'></span>"}function YesNoFormatter(e,t,i,n,o){return i?"Yes":"No"}function CheckboxFormatter(e,t,i,n,o){return'<img class="slick-edit-preclick" src="../images/'+(i?"CheckboxY":"CheckboxN")+'.png">'}function CheckmarkFormatter(e,t,i,n,o){return i?"<img src='../images/tick.png'>":""}var slick_formatters={Formatters:{PercentComplete:PercentCompleteFormatter,PercentCompleteBar:PercentCompleteBarFormatter,YesNo:YesNoFormatter,Checkmark:CheckmarkFormatter,Checkbox:CheckboxFormatter}},$$2=slick_jquery,Slick$1=slick_core;function RemoteModel(){var e=50,t={length:0},i="",n=null,o=1,r=null,s=null,a=new Slick$1.Event,l=new Slick$1.Event;function c(){for(var e in t)delete t[e];t.length=0}function d(c,d){if(s){s.abort();for(var u=s.fromPage;u<=s.toPage;u++)t[u*e]=void 0}c<0&&(c=0),t.length>0&&(d=Math.min(d,t.length-1));for(var p=Math.floor(c/e),_=Math.floor(d/e);void 0!==t[p*e]&&p<_;)p++;for(;void 0!==t[_*e]&&p<_;)_--;if(p>_||p==_&&void 0!==t[p*e])l.notify({from:c,to:d});else{var f="http://octopart.com/api/v3/parts/search?apikey=68b25f31&include[]=short_description&show[]=uid&show[]=manufacturer&show[]=mpn&show[]=brand&show[]=octopart_url&show[]=short_description&q="+i+"&start="+p*e+"&limit="+((_-p)*e+e);null!=n&&(f+="&sortby="+n+(o>0?"+asc":"+desc")),null!=r&&clearTimeout(r),r=setTimeout((function(){for(var i=p;i<=_;i++)t[i*e]=null;a.notify({from:c,to:d}),(s=$$2.jsonp({url:f,callbackParameter:"callback",cache:!0,success:h,error:function(){!function(e,t){alert("error loading pages "+e+" to "+t)}(p,_)}})).fromPage=p,s.toPage=_}),50)}}function h(e){var i=e.request.start,n=i+e.results.length;t.length=Math.min(parseInt(e.hits),1e3);for(var o=0;o<e.results.length;o++){var r=e.results[o].item;t[i+o]=r,t[i+o].index=i+o}s=null,l.notify({from:i,to:n})}return{data:t,clear:c,isDataLoaded:function(e,i){for(var n=e;n<=i;n++)if(null==t[n]||null==t[n])return!1;return!0},ensureData:d,reloadData:function(e,i){for(var n=e;n<=i;n++)delete t[n];d(e,i)},setSort:function(e,t){n=e,o=t,c()},setSearch:function(e){i=e,c()},onDataLoading:a,onDataLoaded:l}}var slick_remotemodel={RemoteModel:RemoteModel},$$1=slick_jquery,Slick=slick_core;function GroupItemMetadataProvider(e){var t,i={checkboxSelect:!1,checkboxSelectCssClass:"slick-group-select-checkbox",checkboxSelectPlugin:null,groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0,groupFormatter:function(e,t,i,o,r,s){if(!n.enableExpandCollapse)return r.title;var a=15*r.level+"px";return(n.checkboxSelect?'<span class="'+n.checkboxSelectCssClass+" "+(r.selectChecked?"checked":"unchecked")+'"></span>':"")+"<span class='"+n.toggleCssClass+" "+(r.collapsed?n.toggleCollapsedCssClass:n.toggleExpandedCssClass)+"' style='margin-left:"+a+"'></span><span class='"+n.groupTitleCssClass+"' level='"+r.level+"'>"+r.title+"</span>"},totalsFormatter:function(e,t,i,n,o,r){return n.groupTotalsFormatter&&n.groupTotalsFormatter(o,n,r)||""},includeHeaderTotals:!1},n=$$1.extend(!0,{},i,e);function o(e,i){var o=$$1(e.target),r=this.getDataItem(i.row);if(r&&r instanceof Slick.Group&&o.hasClass(n.toggleCssClass)){var s=t.getRenderedRange();this.getData().setRefreshHints({ignoreDiffsBefore:s.top,ignoreDiffsAfter:s.bottom+1}),r.collapsed?this.getData().expandGroup(r.groupingKey):this.getData().collapseGroup(r.groupingKey),e.stopImmediatePropagation(),e.preventDefault()}if(r&&r instanceof Slick.Group&&o.hasClass(n.checkboxSelectCssClass)){r.selectChecked=!r.selectChecked,o.removeClass(r.selectChecked?"unchecked":"checked"),o.addClass(r.selectChecked?"checked":"unchecked");var a=t.getData().mapItemsToRows(r.rows);(r.selectChecked?n.checkboxSelectPlugin.selectRows:n.checkboxSelectPlugin.deSelectRows)(a)}}function r(e,i){if(n.enableExpandCollapse&&e.which==Slick.keyCode.SPACE){var o=this.getActiveCell();if(o){var r=this.getDataItem(o.row);if(r&&r instanceof Slick.Group){var s=t.getRenderedRange();this.getData().setRefreshHints({ignoreDiffsBefore:s.top,ignoreDiffsAfter:s.bottom+1}),r.collapsed?this.getData().expandGroup(r.groupingKey):this.getData().collapseGroup(r.groupingKey),e.stopImmediatePropagation(),e.preventDefault()}}}}return{init:function(e){(t=e).onClick.subscribe(o),t.onKeyDown.subscribe(r)},destroy:function(){t&&(t.onClick.unsubscribe(o),t.onKeyDown.unsubscribe(r))},getGroupRowMetadata:function(e){var t=e&&e.level;return{selectable:!1,focusable:n.groupFocusable,cssClasses:n.groupCssClass+" slick-group-level-"+t,formatter:n.includeHeaderTotals&&n.totalsFormatter,columns:{0:{colspan:n.includeHeaderTotals?"1":"*",formatter:n.groupFormatter,editor:null}}}},getTotalsRowMetadata:function(e){var t=e&&e.group&&e.group.level;return{selectable:!1,focusable:n.totalsFocusable,cssClasses:n.totalsCssClass+" slick-group-level-"+t,formatter:n.totalsFormatter,editor:null}},getOptions:function(){return n},setOptions:function(e){$$1.extend(!0,n,e)}}}var slick_groupitemmetadataprovider={GroupItemMetadataProvider:GroupItemMetadataProvider};!function(e){var t=tslib.exports;t.__exportStar(slick_core,e.exports),t.__exportStar(slick_grid,e.exports),t.__exportStar(slick_dataview,e.exports),t.__exportStar(slick_editors,e.exports),t.__exportStar(slick_formatters,e.exports),t.__exportStar(slick_remotemodel,e.exports),t.__exportStar(slick_groupitemmetadataprovider,e.exports)}(slickgrid);class TableWidget extends Widget{constructor(e){super(e)}static init_TableWidget(){this.define((({Ref:e})=>({source:[e(ColumnDataSource),()=>new ColumnDataSource],view:[e(CDSView),()=>new CDSView]})))}initialize(){super.initialize(),null==this.view.source&&(this.view.source=this.source,this.view.compute_indices())}}TableWidget.__name__="TableWidget",TableWidget.init_TableWidget();class TableColumn extends Model{constructor(e){super(e)}static init_TableColumn(){this.define((({Boolean:e,Number:t,String:i,Nullable:n,Ref:o})=>({field:[i],title:[n(i),null],width:[t,300],formatter:[o(StringFormatter),()=>new StringFormatter],editor:[o(StringEditor),()=>new StringEditor],sortable:[e,!0],default_sort:[Sort,"ascending"]})))}toColumn(){var e;return{id:uniqueId(),field:this.field,name:null!=(e=this.title)?e:this.field,width:this.width,formatter:null!=this.formatter?this.formatter.doFormat.bind(this.formatter):void 0,model:this.editor,editor:this.editor.default_view,sortable:this.sortable,defaultSortAsc:"ascending"==this.default_sort}}}TableColumn.__name__="TableColumn",TableColumn.init_TableColumn();var slickgrid_css='.bk-root{}.bk-root .slick-header.ui-state-default,.bk-root .slick-headerrow.ui-state-default,.bk-root .slick-footerrow.ui-state-default,.bk-root .slick-top-panel-scroller.ui-state-default,.bk-root .slick-group-header.ui-state-default{width:100%;overflow:auto;position:relative;border-left:0px !important;}.bk-root .slick-header.ui-state-default{overflow:inherit;}.bk-root .slick-header::-webkit-scrollbar,.bk-root .slick-headerrow::-webkit-scrollbar,.bk-root .slick-footerrow::-webkit-scrollbar{display:none;}.bk-root .slick-header-columns,.bk-root .slick-headerrow-columns,.bk-root .slick-footerrow-columns,.bk-root .slick-group-header-columns{position:relative;white-space:nowrap;cursor:default;overflow:hidden;}.bk-root .slick-header-column.ui-state-default,.bk-root .slick-group-header-column.ui-state-default{position:relative;display:inline-block;box-sizing:content-box !important;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:16px;line-height:16px;margin:0;padding:4px;border-right:1px solid silver;border-left:0px !important;border-top:0px !important;border-bottom:0px !important;float:left;}.bk-root .slick-footerrow-column.ui-state-default{-o-text-overflow:ellipsis;text-overflow:ellipsis;margin:0;padding:4px;border-right:1px solid silver;border-left:0px;border-top:0px;border-bottom:0px;float:left;line-height:20px;vertical-align:middle;}.bk-root .slick-headerrow-column.ui-state-default,.bk-root .slick-footerrow-column.ui-state-default{padding:4px;}.bk-root .slick-header-column-sorted{font-style:italic;}.bk-root .slick-sort-indicator{display:inline-block;width:8px;height:5px;margin-left:4px;margin-top:6px;float:left;}.bk-root .slick-sort-indicator-numbered{display:inline-block;width:8px;height:5px;margin-left:4px;margin-top:0;line-height:20px;float:left;font-family:Arial;font-style:normal;font-weight:bold;color:#6190CD;}.bk-root .slick-sort-indicator-desc{background:url(images/sort-desc.gif);}.bk-root .slick-sort-indicator-asc{background:url(images/sort-asc.gif);}.bk-root .slick-resizable-handle{position:absolute;font-size:0.1px;display:block;cursor:col-resize;width:9px;right:-5px;top:0;height:100%;z-index:1;}.bk-root .slick-sortable-placeholder{background:silver;}.bk-root .grid-canvas{position:relative;outline:0;}.bk-root .slick-row.ui-widget-content,.bk-root .slick-row.ui-state-active{position:absolute;border:0px;width:100%;}.bk-root .slick-cell,.bk-root .slick-headerrow-column,.bk-root .slick-footerrow-column{position:absolute;border:1px solid transparent;border-right:1px dotted silver;border-bottom-color:silver;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;vertical-align:middle;z-index:1;padding:1px 2px 2px 1px;margin:0;white-space:nowrap;cursor:default;}.bk-root .slick-cell,.bk-root .slick-headerrow-column{border-bottom-color:silver;}.bk-root .slick-footerrow-column{border-top-color:silver;}.bk-root .slick-group-toggle{display:inline-block;}.bk-root .slick-cell.highlighted{background:lightskyblue;background:rgba(0, 0, 255, 0.2);-webkit-transition:all 0.5s;-moz-transition:all 0.5s;-o-transition:all 0.5s;transition:all 0.5s;}.bk-root .slick-cell.flashing{border:1px solid red !important;}.bk-root .slick-cell.editable{z-index:11;overflow:visible;background:white;border-color:black;border-style:solid;}.bk-root .slick-cell:focus{outline:none;}.bk-root .slick-reorder-proxy{display:inline-block;background:blue;opacity:0.15;cursor:move;}.bk-root .slick-reorder-guide{display:inline-block;height:2px;background:blue;opacity:0.7;}.bk-root .slick-selection{z-index:10;position:absolute;border:2px dashed black;}.bk-root .slick-pane{position:absolute;outline:0;overflow:hidden;width:100%;}.bk-root .slick-pane-header{display:block;}.bk-root .slick-header{overflow:hidden;position:relative;}.bk-root .slick-headerrow{overflow:hidden;position:relative;}.bk-root .slick-top-panel-scroller{overflow:hidden;position:relative;}.bk-root .slick-top-panel{width:10000px;}.bk-root .slick-viewport{position:relative;outline:0;width:100%;}.bk-root .slick-header-columns{background:url(\'images/header-columns-bg.gif\') repeat-x center bottom;border-bottom:1px solid silver;}.bk-root .slick-header-column{background:url(\'images/header-columns-bg.gif\') repeat-x center bottom;border-right:1px solid silver;}.bk-root .slick-header-column:hover,.bk-root .slick-header-column-active{background:white url(\'images/header-columns-over-bg.gif\') repeat-x center bottom;}.bk-root .slick-headerrow{background:#fafafa;}.bk-root .slick-headerrow-column{background:#fafafa;border-bottom:0;height:100%;}.bk-root .slick-row.ui-state-active{background:#F5F7D7;}.bk-root .slick-row{position:absolute;background:white;border:0px;line-height:20px;}.bk-root .slick-row.selected{z-index:10;background:#DFE8F6;}.bk-root .slick-cell{padding-left:4px;padding-right:4px;}.bk-root .slick-group{border-bottom:2px solid silver;}.bk-root .slick-group-toggle{width:9px;height:9px;margin-right:5px;}.bk-root .slick-group-toggle.expanded{background:url(images/collapse.gif) no-repeat center center;}.bk-root .slick-group-toggle.collapsed{background:url(images/expand.gif) no-repeat center center;}.bk-root .slick-group-totals{color:gray;background:white;}.bk-root .slick-group-select-checkbox{width:13px;height:13px;margin:3px 10px 0 0;display:inline-block;}.bk-root .slick-group-select-checkbox.checked{background:url(images/GrpCheckboxY.png) no-repeat center center;}.bk-root .slick-group-select-checkbox.unchecked{background:url(images/GrpCheckboxN.png) no-repeat center center;}.bk-root .slick-cell.selected{background-color:beige;}.bk-root .slick-cell.active{border-color:gray;border-style:solid;}.bk-root .slick-sortable-placeholder{background:silver !important;}.bk-root .slick-row.odd{background:#fafafa;}.bk-root .slick-row.ui-state-active{background:#F5F7D7;}.bk-root .slick-row.loading{opacity:0.5;}.bk-root .slick-cell.invalid{border-color:red;-moz-animation-duration:0.2s;-webkit-animation-duration:0.2s;-moz-animation-name:slickgrid-invalid-hilite;-webkit-animation-name:slickgrid-invalid-hilite;}@-moz-keyframes slickgrid-invalid-hilite{from{box-shadow:0 0 6px red;}to{box-shadow:none;}}@-webkit-keyframes slickgrid-invalid-hilite{from{box-shadow:0 0 6px red;}to{box-shadow:none;}}.bk-root .slick-column-name,.bk-root .slick-sort-indicator{display:inline-block;float:left;margin-bottom:100px;}.bk-root .slick-header-button{display:inline-block;float:right;vertical-align:top;margin:1px;margin-bottom:100px;height:15px;width:15px;background-repeat:no-repeat;background-position:center center;cursor:pointer;}.bk-root .slick-header-button-hidden{width:0;-webkit-transition:0.2s width;-ms-transition:0.2s width;transition:0.2s width;}.bk-root .slick-header-column:hover > .slick-header-button{width:15px;}.bk-root .slick-header-menubutton{position:absolute;right:0;top:0;bottom:0;width:14px;background-repeat:no-repeat;background-position:left center;background-image:url(../images/down.gif);cursor:pointer;display:none;border-left:thin ridge silver;}.bk-root .slick-header-column:hover > .slick-header-menubutton,.bk-root .slick-header-column-active .slick-header-menubutton{display:inline-block;}.bk-root .slick-header-menu{position:absolute;display:inline-block;margin:0;padding:2px;cursor:default;}.bk-root .slick-header-menuitem{list-style:none;margin:0;padding:0;cursor:pointer;}.bk-root .slick-header-menuicon{display:inline-block;width:16px;height:16px;vertical-align:middle;margin-right:4px;background-repeat:no-repeat;background-position:center center;}.bk-root .slick-header-menucontent{display:inline-block;vertical-align:middle;}.bk-root .slick-header-menuitem-disabled{color:silver;}.bk-root .slick-header-menuitem.slick-header-menuitem-divider{cursor:default;border:none;overflow:hidden;padding:0;height:1px;margin:8px 2px;background-color:#cecece;}.bk-root .slick-header-menuitem-divider.slick-header-menuitem:hover{background-color:#cecece;}.bk-root .slick-columnpicker{border:1px solid #718BB7;background:#f0f0f0;padding:6px;-moz-box-shadow:2px 2px 2px silver;-webkit-box-shadow:2px 2px 2px silver;box-shadow:2px 2px 2px silver;min-width:150px;cursor:default;position:absolute;z-index:20;overflow:auto;resize:both;}.bk-root .slick-columnpicker > .close{float:right;}.bk-root .slick-columnpicker .title{font-size:16px;width:60%;border-bottom:solid 1px #d6d6d6;margin-bottom:10px;}.bk-root .slick-columnpicker li{list-style:none;margin:0;padding:0;background:none;}.bk-root .slick-columnpicker input{margin:4px;}.bk-root .slick-columnpicker li a{display:block;padding:4px;font-weight:bold;}.bk-root .slick-columnpicker li a:hover{background:white;}.bk-root .slick-columnpicker-list li.hidden{display:none;}.bk-root .slick-pager{width:100%;height:26px;border:1px solid gray;border-top:0;background:url(\'../images/header-columns-bg.gif\') repeat-x center bottom;vertical-align:middle;}.bk-root .slick-pager .slick-pager-status{display:inline-block;padding:6px;}.bk-root .slick-pager .ui-icon-container{display:inline-block;margin:2px;border-color:gray;}.bk-root .slick-pager .slick-pager-nav{display:inline-block;float:left;padding:2px;}.bk-root .slick-pager .slick-pager-settings{display:block;float:right;padding:2px;}.bk-root .slick-pager .slick-pager-settings *{vertical-align:middle;}.bk-root .slick-pager .slick-pager-settings a{padding:2px;text-decoration:underline;cursor:pointer;}.bk-root .slick-header-columns{border-bottom:1px solid silver;background-image:none;}.bk-root .slick-header-column{border-right:1px solid transparent;background-image:none;}.bk-root .slick-header-column:last-of-type{border-right-color:transparent;}.bk-root .slick-header-column:hover,.bk-root .slick-header-column-active{background-color:#F0F8FF;background-image:none;}.bk-root .slick-group-toggle.expanded{background-image:url("data:image/gif;base64,R0lGODlhCQAJAPcAAAFGeoCAgNXz/+v5/+v6/+z5/+36//L7//X8//j9/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAACQAJAAAIMwADCBxIUIDBgwIEChgwwECBAgQUFjBAkaJCABgxGlB4AGHCAAIQiBypEEECkScJqgwQEAA7");}.bk-root .slick-group-toggle.collapsed{background-image:url("data:image/gif;base64,R0lGODlhCQAJAPcAAAFGeoCAgNXz/+v5/+v6/+z5/+36//L7//X8//j9/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAACQAJAAAIOAADCBxIUIDBgwIEChgwAECBAgQUFjAAQIABAwoBaNSIMYCAAwIqGlSIAEHFkiQTIBCgkqDLAAEBADs=");}.bk-root .slick-group-select-checkbox.checked{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwQAADsEBuJFr7QAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAAEcSURBVChTjdI9S8NQFAbg/raQXVwCRRFE7GK7OXTwD+ikk066VF3a0ja0hQTyQdJrwNq0zrYSQRLEXMSWSlCIb8glqRcFD+9yz3nugXwU4n9XQqMoGjj36uBJsTwuaNo3EwBG4Yy7pe7Gv8YcvhJCGFVsjxsjxujj6OTSGlHv+U2WZUZbPWKOv1ZjT5a7pbIoiptbO5b73mwrjHa1B27l8VlTEIS1damlTnEE+EEN9/P8WrfH81qdAIGeXvTTmzltdCy46sEhxpKUINReZR9NnqZbr9puugxV3NjWh/k74WmmEdWhmUNy2jNmWRc6fZTVADCqao52u+DGWTACYNT3fRxwtatPufTNR4yCIGAUn5hS+vJHhWGY/ANx/A3tvdv+1tZmuwAAAABJRU5ErkJggg==");}.bk-root .slick-group-select-checkbox.unchecked{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwQAADsEBuJFr7QAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAACXSURBVChT1dIxC4MwEAXg/v8/VOhQVDBNakV0KA6pxS4JhWRSIYPEJxwdDi1de7wleR+3JIf486w0hKCKRpSvvOhZcCmvNQBRuKqdah03U7UjNNH81rOaBYDo8SQaPX8JANFEaLaGBeAPaaY61rGksiN6TmR5H1j9CSoAosYYHLA7vTxYMvVEZa0liif23r93xjm3/oEYF8PiDn/I2FHCAAAAAElFTkSuQmCC");}.bk-root .slick-sort-indicator-desc{background-image:url("data:image/gif;base64,R0lGODlhDQAFAIcAAGGQzUD/QOPu+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAANAAUAAAgeAAUAGEgQgIAACBEKLHgwYcKFBh1KFNhQosOKEgMCADs=");}.bk-root .slick-sort-indicator-asc{background-image:url("data:image/gif;base64,R0lGODlhDQAFAIcAAGGQzUD/QOPu+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAANAAUAAAgbAAMIDABgoEGDABIeRJhQ4cKGEA8KmEiRosGAADs=");}.bk-root .slick-header-menubutton{background-image:url("data:image/gif;base64,R0lGODlhDgAOAIABADtKYwAAACH5BAEAAAEALAAAAAAOAA4AAAISjI+py+0PHZgUsGobhTn6DxoFADs=");}.bk-root .slick-pager{background-image:none;}';const AutosizeModes={fit_columns:"FCV",fit_viewport:"FVC",force_fit:"LFF",none:"NOA"};let _warned_not_reorderable=!1;class TableDataProvider{constructor(e,t){this.init(e,t)}init(e,t){if(DTINDEX_NAME in e.data)throw new Error(`special name ${DTINDEX_NAME} cannot be used as a data table column`);this.source=e,this.view=t,this.index=[...this.view.indices]}getLength(){return this.index.length}getItem(e){const t={};for(const i of keys(this.source.data))t[i]=this.source.data[i][this.index[e]];return t[DTINDEX_NAME]=this.index[e],t}getField(e,t){return t==DTINDEX_NAME?this.index[e]:this.source.data[t][this.index[e]]}setField(e,t,i){const n=this.index[e];this.source.patch({[t]:[[n,i]]})}getRecords(){return range(0,this.getLength()).map((e=>this.getItem(e)))}getItems(){return this.getRecords()}slice(e,t,i){return range(e=null!=e?e:0,t=null!=t?t:this.getLength(),i=null!=i?i:1).map((e=>this.getItem(e)))}sort(e){let t=e.map((e=>[e.sortCol.field,e.sortAsc?1:-1]));0==t.length&&(t=[[DTINDEX_NAME,1]]);const i=this.getRecords(),n=this.index.slice();this.index.sort(((e,o)=>{for(const[r,s]of t){const t=i[n.indexOf(e)][r],a=i[n.indexOf(o)][r];if(t!==a)return isNumber(t)&&isNumber(a)?s*(t-a||+isNaN(t)-+isNaN(a)):`${t}`>`${a}`?s:-s}return 0}))}}TableDataProvider.__name__="TableDataProvider";class DataTableView extends WidgetView{constructor(){super(...arguments),this._in_selection_update=!1,this._width=null}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.render())),this.connect(this.model.source.streaming,(()=>this.updateGrid())),this.connect(this.model.source.patching,(()=>this.updateGrid())),this.connect(this.model.source.change,(()=>this.updateGrid())),this.connect(this.model.source.properties.data.change,(()=>this.updateGrid())),this.connect(this.model.source.selected.change,(()=>this.updateSelection())),this.connect(this.model.source.selected.properties.indices.change,(()=>this.updateSelection()))}remove(){var e;null==(e=this.grid)||e.destroy(),super.remove()}styles(){return[...super.styles(),slickgrid_css,tables_css]}update_position(){super.update_position(),this.grid.resizeCanvas()}after_layout(){super.after_layout(),this.updateLayout(!0,!1)}box_sizing(){const e=super.box_sizing();return"fit_viewport"===this.model.autosize_mode&&null!=this._width&&(e.width=this._width),e}updateLayout(e,t){const i=this.autosize;i===AutosizeModes.fit_columns||i===AutosizeModes.force_fit?(e||this.grid.resizeCanvas(),this.grid.autosizeColumns()):e&&t&&i===AutosizeModes.fit_viewport&&this.invalidate_layout()}updateGrid(){if(this.model.view.compute_indices(),this.data.init(this.model.source,this.model.view),this.model.sortable){const e=this.grid.getColumns(),t=this.grid.getSortColumns().map((t=>({sortCol:{field:e[this.grid.getColumnIndex(t.columnId)].field},sortAsc:t.sortAsc})));this.data.sort(t)}this.grid.invalidate(),this.updateLayout(!0,!0)}updateSelection(){if(this._in_selection_update)return;const{selected:e}=this.model.source,t=e.indices.map((e=>this.data.index.indexOf(e))).sort();this._in_selection_update=!0,this.grid.setSelectedRows(t),this._in_selection_update=!1;const i=this.grid.getViewport(),n=this.model.get_scroll_index(i,t);null!=n&&this.grid.scrollRowToTop(n)}newIndexColumn(){return{id:uniqueId(),name:this.model.index_header,field:DTINDEX_NAME,width:this.model.index_width,behavior:"select",cannotTriggerInsert:!0,resizable:!1,selectable:!1,sortable:!0,cssClass:cell_index,headerCssClass:header_index}}css_classes(){return super.css_classes().concat(data_table)}get autosize(){let e;return e=!0===this.model.fit_columns?AutosizeModes.force_fit:!1===this.model.fit_columns?AutosizeModes.none:AutosizeModes[this.model.autosize_mode],e}render(){var e;const t=this.model.columns.map((e=>__spreadProps(__spreadValues({},e.toColumn()),{parent:this})));let i=null;if("checkbox"==this.model.selectable&&(i=new slick_checkboxselectcolumn.CheckboxSelectColumn({cssClass:cell_select}),t.unshift(i.getColumnDefinition())),null!=this.model.index_position){const e=this.model.index_position,i=this.newIndexColumn();-1==e?t.push(i):e<-1?t.splice(e+1,0,i):t.splice(e,0,i)}let{reorderable:n}=this.model;!n||"undefined"!=typeof $&&null!=$.fn&&null!=$.fn.sortable||(_warned_not_reorderable||(logger.warn("jquery-ui is required to enable DataTable.reorderable"),_warned_not_reorderable=!0),n=!1);let o=-1,r=!1;const{frozen_rows:s,frozen_columns:a}=this.model,l=null==a?-1:a-1;null!=s&&(r=s<0,o=Math.abs(s));const c={enableCellNavigation:!1!==this.model.selectable,enableColumnReorder:n,autosizeColsMode:this.autosize,multiColumnSort:this.model.sortable,editable:this.model.editable,autoEdit:this.model.auto_edit,autoHeight:!1,rowHeight:this.model.row_height,frozenColumn:l,frozenRow:o,frozenBottom:r},d=null!=this.grid;if(this.data=new TableDataProvider(this.model.source,this.model.view),this.grid=new slickgrid.exports.Grid(this.el,this.data,t,c),this.autosize==AutosizeModes.fit_viewport){this.grid.autosizeColumns();let i=0;for(const n of t)i+=null!=(e=n.width)?e:0;this._width=Math.ceil(i)}if(this.grid.onSort.subscribe(((e,t)=>{if(!this.model.sortable)return;const i=t.sortCols;null!=i&&(this.data.sort(i),this.grid.invalidate(),this.updateSelection(),this.grid.render(),this.model.header_row||this._hide_header(),this.model.update_sort_columns(i))})),!1!==this.model.selectable){this.grid.setSelectionModel(new slick_rowselectionmodel.RowSelectionModel({selectActiveRow:null==i})),null!=i&&this.grid.registerPlugin(i);const e={dataItemColumnValueExtractor(e,t){let i=e[t.field];return isString(i)&&(i=i.replace(/\n/g,"\\n")),i},includeHeaderWhenCopying:!1};this.grid.registerPlugin(new slick_cellexternalcopymanager.CellExternalCopyManager(e)),this.grid.onSelectedRowsChanged.subscribe(((e,t)=>{this._in_selection_update||(this.model.source.selected.indices=t.rows.map((e=>this.data.index[e])))})),this.updateSelection(),this.model.header_row||this._hide_header()}d&&this.updateLayout(d,!1)}_hide_header(){for(const e of this.el.querySelectorAll(".slick-header-columns"))e.style.height="0px";this.grid.resizeCanvas()}}DataTableView.__name__="DataTableView";class DataTable extends TableWidget{constructor(e){super(e),this._sort_columns=[]}get sort_columns(){return this._sort_columns}static init_DataTable(){this.prototype.default_view=DataTableView,this.define((({Array:e,Boolean:t,Int:i,Ref:n,String:o,Enum:r,Or:s,Nullable:a})=>({autosize_mode:[r("fit_columns","fit_viewport","none","force_fit"),"force_fit"],auto_edit:[t,!1],columns:[e(n(TableColumn)),[]],fit_columns:[a(t),null],frozen_columns:[a(i),null],frozen_rows:[a(i),null],sortable:[t,!0],reorderable:[t,!0],editable:[t,!1],selectable:[s(t,r("checkbox")),!0],index_position:[a(i),0],index_header:[o,"#"],index_width:[i,40],scroll_to_selection:[t,!0],header_row:[t,!0],row_height:[i,25]}))),this.override({width:600,height:400})}update_sort_columns(e){this._sort_columns=e.map((({sortCol:e,sortAsc:t})=>({field:e.field,sortAsc:t})))}get_scroll_index(e,t){return this.scroll_to_selection&&0!=t.length?some(t,(t=>e.top<=t&&t<=e.bottom))?null:Math.max(0,Math.min(...t)-1):null}}DataTable.__name__="DataTable",DataTable.init_DataTable();const{Avg:Avg,Min:Min,Max:Max,Sum:Sum}=slickgrid.exports.Data.Aggregators;class RowAggregator extends Model{constructor(e){super(e)}static init_RowAggregator(){this.define((({String:e})=>({field_:[e,""]})))}}RowAggregator.__name__="RowAggregator",RowAggregator.init_RowAggregator();const avg=new Avg;class AvgAggregator extends RowAggregator{constructor(){super(...arguments),this.key="avg",this.init=avg.init,this.accumulate=avg.accumulate,this.storeResult=avg.storeResult}}AvgAggregator.__name__="AvgAggregator";const min=new Min;class MinAggregator extends RowAggregator{constructor(){super(...arguments),this.key="min",this.init=min.init,this.accumulate=min.accumulate,this.storeResult=min.storeResult}}MinAggregator.__name__="MinAggregator";const max=new Max;class MaxAggregator extends RowAggregator{constructor(){super(...arguments),this.key="max",this.init=max.init,this.accumulate=max.accumulate,this.storeResult=max.storeResult}}MaxAggregator.__name__="MaxAggregator";const sum=new Sum;class SumAggregator extends RowAggregator{constructor(){super(...arguments),this.key="sum",this.init=sum.init,this.accumulate=sum.accumulate,this.storeResult=sum.storeResult}}function groupCellFormatter(e,t,i,n,o){const{collapsed:r,level:s,title:a}=o,l=span({class:"slick-group-toggle "+(r?"collapsed":"expanded"),style:{"margin-left":15*s+"px"}}),c=span({class:"slick-group-title",level:s},a);return`${l.outerHTML}${c.outerHTML}`}function indentFormatter(e,t){return(i,n,o,r,s)=>{const a=span({class:"slick-group-toggle",style:{"margin-left":15*(null!=t?t:0)+"px"}}),l=e?e(i,n,o,r,s):`${o}`;return`${a.outerHTML}${l&&l.replace(/^<div/,"<span").replace(/div>$/,"span>")}`}}function handleGridClick(e,t){const i=this.getDataItem(t.row);i instanceof slickgrid.exports.Group&&e.target.classList.contains("slick-group-toggle")&&(i.collapsed?this.getData().expandGroup(i.groupingKey):this.getData().collapseGroup(i.groupingKey),e.stopImmediatePropagation(),e.preventDefault(),this.invalidate(),this.render())}SumAggregator.__name__="SumAggregator";class GroupingInfo extends Model{constructor(e){super(e)}static init_GroupingInfo(){this.define((({Boolean:e,String:t,Array:i,Ref:n})=>({getter:[t,""],aggregators:[i(n(RowAggregator)),[]],collapsed:[e,!1]})))}get comparer(){return(e,t)=>e.value===t.value?0:e.value>t.value?1:-1}}GroupingInfo.__name__="GroupingInfo",GroupingInfo.init_GroupingInfo();class DataCubeProvider extends TableDataProvider{constructor(e,t,i,n){super(e,t),this.columns=i,this.groupingInfos=[],this.groupingDelimiter=":|:",this.target=n}setGrouping(e){this.groupingInfos=e,this.toggledGroupsByLevel=e.map((()=>({}))),this.refresh()}extractGroups(e,t){const i=[],n=new Map,o=t?t.level+1:0,{comparer:r,getter:s}=this.groupingInfos[o];return e.forEach((e=>{const r=this.source.data[s][e];let a=n.get(r);if(!a){const e=t?`${t.groupingKey}${this.groupingDelimiter}${r}`:`${r}`;a=Object.assign(new slickgrid.exports.Group,{value:r,level:o,groupingKey:e}),i.push(a),n.set(r,a)}a.rows.push(e)})),o<this.groupingInfos.length-1&&i.forEach((e=>{e.groups=this.extractGroups(e.rows,e)})),i.sort(r),i}calculateTotals(e,t){const i={avg:{},max:{},min:{},sum:{}},{source:{data:n}}=this,o=Object.keys(n),r=e.rows.map((e=>o.reduce(((t,i)=>__spreadProps(__spreadValues({},t),{[i]:n[i][e]})),{})));return t.forEach((e=>{e.init(),r.forEach((t=>e.accumulate(t))),e.storeResult(i)})),i}addTotals(e,t=0){const{aggregators:i,collapsed:n}=this.groupingInfos[t],o=this.toggledGroupsByLevel[t];e.forEach((e=>{e.groups&&this.addTotals(e.groups,t+1),i.length&&e.rows.length&&(e.totals=this.calculateTotals(e,i)),e.collapsed=n!==o[e.groupingKey],e.title=e.value?`${e.value}`:""}))}flattenedGroupedRows(e,t=0){const i=[];return e.forEach((e=>{if(i.push(e),!e.collapsed){const n=e.groups?this.flattenedGroupedRows(e.groups,t+1):e.rows;i.push(...n)}})),i}refresh(){const e=this.extractGroups([...this.view.indices]),t=this.source.data[this.columns[0].field];e.length&&(this.addTotals(e),this.rows=this.flattenedGroupedRows(e),this.target.data={row_indices:this.rows.map((e=>e instanceof slickgrid.exports.Group?e.rows:e)),labels:this.rows.map((e=>e instanceof slickgrid.exports.Group?e.title:t[e]))})}getLength(){return this.rows.length}getItem(e){const t=this.rows[e],{source:{data:i}}=this;return t instanceof slickgrid.exports.Group?t:Object.keys(i).reduce(((e,n)=>__spreadProps(__spreadValues({},e),{[n]:i[n][t]})),{[DTINDEX_NAME]:t})}getItemMetadata(e){const t=this.rows[e],i=this.columns.slice(1),n=t instanceof slickgrid.exports.Group?this.groupingInfos[t.level].aggregators:[];return t instanceof slickgrid.exports.Group?{selectable:!1,focusable:!1,cssClasses:"slick-group",columns:[{formatter:groupCellFormatter},...i.map((function(e){const{field:t,formatter:i}=e,o=n.find((({field_:e})=>e===t));if(o){const{key:e}=o;return{formatter:(n,o,r,s,a)=>i?i(n,o,a.totals[e][t],s,a):""}}return{}}))]}:{}}collapseGroup(e){const t=e.split(this.groupingDelimiter).length-1;this.toggledGroupsByLevel[t][e]=!this.groupingInfos[t].collapsed,this.refresh()}expandGroup(e){const t=e.split(this.groupingDelimiter).length-1;this.toggledGroupsByLevel[t][e]=this.groupingInfos[t].collapsed,this.refresh()}}DataCubeProvider.__name__="DataCubeProvider";class DataCubeView extends DataTableView{render(){const e={enableCellNavigation:!1!==this.model.selectable,enableColumnReorder:!1,autosizeColsMode:this.autosize,multiColumnSort:!1,editable:this.model.editable,autoEdit:this.model.auto_edit,rowHeight:this.model.row_height},t=this.model.columns.map((e=>e.toColumn()));t[0].formatter=indentFormatter(t[0].formatter,this.model.grouping.length),delete t[0].editor,this.data=new DataCubeProvider(this.model.source,this.model.view,t,this.model.target),this.data.setGrouping(this.model.grouping),this.el.style.width=`${this.model.width}px`,this.grid=new slickgrid.exports.Grid(this.el,this.data,t,e),this.grid.onClick.subscribe(handleGridClick)}}DataCubeView.__name__="DataCubeView";class DataCube extends DataTable{constructor(e){super(e)}static init_DataCube(){this.prototype.default_view=DataCubeView,this.define((({Array:e,Ref:t})=>({grouping:[e(t(GroupingInfo)),[]],target:[t(ColumnDataSource)]})))}}DataCube.__name__="DataCube",DataCube.init_DataCube();var Tables=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",DataTable:DataTable,TableColumn:TableColumn,TableWidget:TableWidget,AvgAggregator:AvgAggregator,MinAggregator:MinAggregator,MaxAggregator:MaxAggregator,SumAggregator:SumAggregator,GroupingInfo:GroupingInfo,DataCube:DataCube,CellEditorView:CellEditorView,CellEditor:CellEditor,StringEditorView:StringEditorView,StringEditor:StringEditor,TextEditorView:TextEditorView,TextEditor:TextEditor$1,SelectEditorView:SelectEditorView,SelectEditor:SelectEditor,PercentEditorView:PercentEditorView,PercentEditor:PercentEditor,CheckboxEditorView:CheckboxEditorView,CheckboxEditor:CheckboxEditor$1,IntEditorView:IntEditorView,IntEditor:IntEditor,NumberEditorView:NumberEditorView,NumberEditor:NumberEditor,TimeEditorView:TimeEditorView,TimeEditor:TimeEditor,DateEditorView:DateEditorView,DateEditor:DateEditor$1,CellFormatter:CellFormatter,StringFormatter:StringFormatter,ScientificFormatter:ScientificFormatter,NumberFormatter:NumberFormatter,BooleanFormatter:BooleanFormatter,DateFormatter:DateFormatter,HTMLTemplateFormatter:HTMLTemplateFormatter});register_models(Tables);var Bokeh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:version,index:index$2,embed:index$1,protocol:index,_testing:testing,logger:logger,set_log_level:set_log_level,settings:settings,Models:Models,documents:documents,safely:safely,Document:Document,sprintf:sprintf,Annotation:Annotation,Arrow:Arrow,ArrowHead:ArrowHead,OpenHead:OpenHead,NormalHead:NormalHead,TeeHead:TeeHead,VeeHead:VeeHead,Band:Band,BoxAnnotation:BoxAnnotation,ColorBar:ColorBar,Label:Label,LabelSet:LabelSet,Legend:Legend,LegendItem:LegendItem,PolyAnnotation:PolyAnnotation,Slope:Slope,Span:Span,TextAnnotation:TextAnnotation,Title:Title,ToolbarPanel:ToolbarPanel,Tooltip:Tooltip,Whisker:Whisker,Axis:Axis,CategoricalAxis:CategoricalAxis,ContinuousAxis:ContinuousAxis,DatetimeAxis:DatetimeAxis,LinearAxis:LinearAxis,LogAxis:LogAxis,MercatorAxis:MercatorAxis,CustomJS:CustomJS,OpenURL:OpenURL,Canvas:Canvas,CartesianFrame:CartesianFrame,Expression:Expression,CustomJSExpr:CustomJSExpr,Stack:Stack,CumSum:CumSum,ScalarExpression:ScalarExpression,Minimum:Minimum,Maximum:Maximum,BooleanFilter:BooleanFilter,CustomJSFilter:CustomJSFilter,Filter:Filter,GroupFilter:GroupFilter,IndexFilter:IndexFilter,BasicTickFormatter:BasicTickFormatter,CategoricalTickFormatter:CategoricalTickFormatter,DatetimeTickFormatter:DatetimeTickFormatter,FuncTickFormatter:FuncTickFormatter,LogTickFormatter:LogTickFormatter,MercatorTickFormatter:MercatorTickFormatter,NumeralTickFormatter:NumeralTickFormatter,PrintfTickFormatter:PrintfTickFormatter,TickFormatter:TickFormatter,AnnularWedge:AnnularWedge,Annulus:Annulus,Arc:Arc,Bezier:Bezier,Circle:Circle,Ellipse:Ellipse,EllipseOval:EllipseOval,Glyph:Glyph,HArea:HArea,HBar:HBar,HexTile:HexTile,Image:Image$1,ImageRGBA:ImageRGBA,ImageURL:ImageURL,Line:Line,MultiLine:MultiLine,MultiPolygons:MultiPolygons,Oval:Oval,Patch:Patch,Patches:Patches,Quad:Quad,Quadratic:Quadratic,Ray:Ray,Rect:Rect,Scatter:Scatter,Segment:Segment,Spline:Spline,Step:Step,Text:Text,VArea:VArea,VBar:VBar,Wedge:Wedge,GraphHitTestPolicy:GraphHitTestPolicy,EdgesOnly:EdgesOnly,NodesOnly:NodesOnly,NodesAndLinkedEdges:NodesAndLinkedEdges,EdgesAndLinkedNodes:EdgesAndLinkedNodes,LayoutProvider:LayoutProvider,StaticLayoutProvider:StaticLayoutProvider,Grid:Grid,Box:Box,Column:Column,GridBox:GridBox,HTMLBox:HTMLBox,LayoutDOM:LayoutDOM,Panel:Panel,Row:Row,Spacer:Spacer,Tabs:Tabs,WidgetBox:WidgetBox,CategoricalColorMapper:CategoricalColorMapper,CategoricalMarkerMapper:CategoricalMarkerMapper,CategoricalPatternMapper:CategoricalPatternMapper,ContinuousColorMapper:ContinuousColorMapper,ColorMapper:ColorMapper,LinearColorMapper:LinearColorMapper,LogColorMapper:LogColorMapper,ScanningColorMapper:ScanningColorMapper,EqHistColorMapper:EqHistColorMapper,CustomJSTransform:CustomJSTransform,Dodge:Dodge,Interpolator:Interpolator,Jitter:Jitter,LinearInterpolator:LinearInterpolator,StepInterpolator:StepInterpolator,Transform:Transform,MapOptions:MapOptions,GMapOptions:GMapOptions,GMapPlot:GMapPlot,Plot:Plot,LabelingPolicy:LabelingPolicy,AllLabels:AllLabels,NoOverlap:NoOverlap,CustomLabelingPolicy:CustomLabelingPolicy,DataRange:DataRange,DataRange1d:DataRange1d,FactorRange:FactorRange,Range:Range$1,Range1d:Range1d,GlyphRenderer:GlyphRenderer,GraphRenderer:GraphRenderer,GuideRenderer:GuideRenderer,Renderer:Renderer,CategoricalScale:CategoricalScale,ContinuousScale:ContinuousScale,LinearScale:LinearScale,LinearInterpolationScale:LinearInterpolationScale,LogScale:LogScale,Scale:Scale,Selection:Selection,SelectionPolicy:SelectionPolicy,IntersectRenderers:IntersectRenderers,UnionRenderers:UnionRenderers,ServerSentDataSource:ServerSentDataSource,AjaxDataSource:AjaxDataSource,ColumnDataSource:ColumnDataSource,ColumnarDataSource:ColumnarDataSource,CDSView:CDSView,DataSource:DataSource,GeoJSONDataSource:GeoJSONDataSource,WebDataSource:WebDataSource,AdaptiveTicker:AdaptiveTicker,BasicTicker:BasicTicker,CategoricalTicker:CategoricalTicker,CompositeTicker:CompositeTicker,ContinuousTicker:ContinuousTicker,DatetimeTicker:DatetimeTicker,DaysTicker:DaysTicker,FixedTicker:FixedTicker,LogTicker:LogTicker,MercatorTicker:MercatorTicker,MonthsTicker:MonthsTicker,SingleIntervalTicker:SingleIntervalTicker,Ticker:Ticker,YearsTicker:YearsTicker,BinnedTicker:BinnedTicker,BBoxTileSource:BBoxTileSource,MercatorTileSource:MercatorTileSource,QUADKEYTileSource:QUADKEYTileSource,TileRenderer:TileRenderer,TileSource:TileSource,TMSTileSource:TMSTileSource,WMTSTileSource:WMTSTileSource,CanvasTexture:CanvasTexture,ImageURLTexture:ImageURLTexture,Texture:Texture,ActionTool:ActionTool,CustomAction:CustomAction,HelpTool:HelpTool,RedoTool:RedoTool,ResetTool:ResetTool,SaveTool:SaveTool,UndoTool:UndoTool,ZoomInTool:ZoomInTool,ZoomOutTool:ZoomOutTool,ButtonTool:ButtonTool,EditTool:EditTool,BoxEditTool:BoxEditTool,FreehandDrawTool:FreehandDrawTool,PointDrawTool:PointDrawTool,PolyDrawTool:PolyDrawTool,PolyTool:PolyTool,PolyEditTool:PolyEditTool,BoxSelectTool:BoxSelectTool,BoxZoomTool:BoxZoomTool,GestureTool:GestureTool,LassoSelectTool:LassoSelectTool,LineEditTool:LineEditTool,PanTool:PanTool,PolySelectTool:PolySelectTool,RangeTool:RangeTool,SelectTool:SelectTool,TapTool:TapTool,WheelPanTool:WheelPanTool,WheelZoomTool:WheelZoomTool,CrosshairTool:CrosshairTool,CustomJSHover:CustomJSHover,HoverTool:HoverTool,InspectTool:InspectTool,Tool:Tool,ToolProxy:ToolProxy,Toolbar:Toolbar,ToolbarBase:ToolbarBase,ProxyToolbar:ProxyToolbar,ToolbarBox:ToolbarBox,LinAlg:linalg,Charts:charts,Plotting:plotting,Widgets:Widgets,Tables:Tables}),style_scss_vue_type_style_index_0_src_lang=".app-container {\n  padding: 30px 100px;\n  min-width: 1000px;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n}\n.app-container-left {\n  padding: 30px 100px;\n  min-width: 1100px;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n}\n.text-center {\n  text-align: center;\n}\n@keyframes fade-in-from-bottom-lg {\n0% {\n    opacity: 0;\n    transform: translateY(100px);\n}\n100% {\n    opacity: 1;\n    transform: translateY(0);\n}\n}\n.fade-in-section {\n  animation: 0.5s 0.6s both fade-in-from-bottom-lg;\n}\n.title_2 {\n  -webkit-font-smoothing: antialiased;\n  font-smoothing: antialiased;\n  font-weight: 400;\n  font-stretch: 100%;\n  font-size: 25px;\n  color: darkblue;\n  text-transform: uppercase;\n}\n.title {\n  font-size: 18px;\n  font-weight: bold;\n  margin-bottom: 3px;\n}\n.section {\n  width: 1000px;\n  background-color: white;\n  margin-bottom: 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px 0;\n}\n.author {\n  margin: 0px 15px;\n  font-size: 18px;\n}\n.title_1 {\n  font-size: 22px;\n}\n.title_2 {\n  font-size: 22px;\n  margin-bottom: 20px;\n}\n.title_3 {\n  font-size: 20px;\n  margin-bottom: 10px;\n}";const _sfc_main={name:"index",components:{},methods:{get_value(){let e=document.getElementsByClassName("bk bk-slider-value")[0];return parseInt(e.innerText)},onclickme(){let e=document.getElementsByClassName("bk bk-btn bk-btn-primary")[0];" Play"===document.getElementsByClassName("click_buttion_class")[0].innerText||e.click(),e.style.display="none"},click_buttion(){let e=document.getElementsByClassName("click_buttion_class")[0];" Play"===e.innerText?e.innerText=" Pause":e.innerText=" Play"}},mounted(){this.timer=setInterval(this.onclickme,150)}};var fn=function(){window.Bokeh=Bokeh,safely((function(){}))};"loading"!=document.readyState?fn():document.addEventListener("DOMContentLoaded",fn),NProgress.done();const _hoisted_1={class:"app-container",style:{"background-color":"white","font-size":"18px"}},_hoisted_2={class:"section"},_hoisted_3=createBaseVNode("div",{class:"title_1",style:{"margin-bottom":"30px"}}," DenseTNT: End-to-end Trajectory Prediction from Dense Goal Sets ",-1),_hoisted_4={style:{display:"flex"}},_hoisted_5=createTextVNode("Junru Gu "),_hoisted_6=createTextVNode("Chen Sun "),_hoisted_7=createTextVNode("Hang Zhao "),_hoisted_8=createBaseVNode("div",null,"IIIS, Tsinghua University",-1),_hoisted_9=createBaseVNode("div",null,"International Conference on Computer Vision (ICCV), 2021",-1),_hoisted_10=createBaseVNode("div",null,"2021 Waymo Motion Prediction Challenge Winner",-1),_hoisted_11=createTextVNode("[Paper] "),_hoisted_12=createTextVNode("[Report] "),_hoisted_13=createBaseVNode("div",{class:"section"},[createBaseVNode("div",{class:"title_2"}," Overview "),createBaseVNode("div",null," Due to the stochasticity of human behaviors, predicting the future trajectories of road agents is challenging for autonomous driving. Recently, goal-based multi-trajectory prediction methods are proved to be effective, where they first score over-sampled goal candidates and then select a final set from them. However, these methods usually involve goal predictions based on sparse pre-defined anchors and heuristic goal selection algorithms. In this work, we propose an anchor-free and end-to-end trajectory prediction model, named DenseTNT, that directly outputs a set of trajectories from dense goal candidates. In addition, we introduce an offline optimization-based technique to provide multi-future pseudo-labels for our final online model. Experiments show that DenseTNT achieves state-of-the-art performance, ranking 1st on the Argoverse motion forecasting benchmark and being the 1st place winner of the 2021 Waymo Open Dataset Motion Prediction Challenge. ")],-1),_hoisted_14={class:"section"},_hoisted_15=createBaseVNode("div",{class:"title_2"}," Method ",-1),_hoisted_16=createBaseVNode("div",{style:{"margin-top":"30px"}}," We propose an anchor-free and end-to-end trajectory prediction model, named DenseTNT, that directly outputs a set of trajectories from dense goal candidates. First, a sparse context encoder is used to extract the features of HD maps and agents; and then a dense goal encoder is employed to output dense goal probability distribution; finally a goal set predictor takes the probability distribution of the goals as input and generates a set of predicted goals. In addition, we introduce an offline optimization-based technique to provide multi-future pseudo-labels for our DenseTNT. ",-1),_hoisted_17=createBaseVNode("div",{class:"section",style:{"align-items":"flex-start"}},[createBaseVNode("div",{class:"title_3"}," BibTeX "),createBaseVNode("pre",{style:{"font-size":"14px",background:"#f4f4f5",width:"100%","font-family":"Arial"}},"  @misc{densetnt,\n        title={DenseTNT: End-to-end Trajectory Prediction from Dense Goal Sets},\n        author={Junru Gu and Chen Sun and Hang Zhao},\n        year={2021},\n        eprint={2108.09640},\n        archivePrefix={arXiv},\n        primaryClass={cs.CV}\n  }        ")],-1);function _sfc_render(e,t,i,n,o,r){const s=resolveComponent("el-link"),a=resolveComponent("el-image");return openBlock(),createElementBlock("div",null,[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[_hoisted_3,createBaseVNode("div",_hoisted_4,[createVNode(s,{onclick:"",class:"text author",type:"primary",href:"http://group.iiis.tsinghua.edu.cn/~marslab/#/people",target:"_blank"},{default:withCtx((()=>[_hoisted_5])),_:1}),createVNode(s,{class:"text author",type:"primary",href:"https://chensun.me/",target:"_blank"},{default:withCtx((()=>[_hoisted_6])),_:1}),createVNode(s,{class:"text author",type:"primary",href:"http://people.csail.mit.edu/hangzhao/",target:"_blank"},{default:withCtx((()=>[_hoisted_7])),_:1})]),_hoisted_8,_hoisted_9,_hoisted_10,createBaseVNode("div",null,[createVNode(s,{class:"text author",type:"primary",href:"https://arxiv.org/abs/2108.09640",target:"_blank"},{default:withCtx((()=>[_hoisted_11])),_:1}),createVNode(s,{class:"text author",type:"primary",href:"https://arxiv.org/abs/2106.14160",target:"_blank"},{default:withCtx((()=>[_hoisted_12])),_:1})])]),_hoisted_13,createBaseVNode("div",_hoisted_14,[_hoisted_15,createVNode(a,{style:{width:"1000px"},src:"src/assets/images/method.png",fit:"contain"},null,8,["src"]),_hoisted_16]),_hoisted_17])])}_sfc_main.render=_sfc_render;export{_sfc_main as default};
